<!DOCTYPE html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Graql Rules">
<meta name="keywords" content="graqlreasoner,  graql, reasoner, GRAKN.AI, Grakn Labs, grakn, graql, grakn.ai, Mindmaps Research, Mindmaps Research Ltd, MindmapsDB, mindmaps, mindmaps graph, mindmaps.io, knowledge graph, distributed knowledge graph, development platform, developer tool, data platform, programming langauge, query langauge, database, semantic database, distributed semantic database, distributed database, graph database, semantic search, data exploration, recommendation system, knowledge management, knowledge engineering, real-time analytics, advanced analytics, reasoning engine, inference engine, expert systems, semantic applications, research engines, data management, business intelligence, big data, semantic web, semantic data, knowledge representation, automated reasoning, semantic network, knowledge ontology, semantic graph, ontology engineering, graph based knowledge representation, artificial intelligence,">
<title>GRAKN.AI | Graql Rules</title>
<link rel="stylesheet" href="/pages/css/syntax.css">


<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="/pages/css/modern-business.css">
<link rel="stylesheet" href="/pages/css/lavish-bootstrap.css">
<link rel="stylesheet" href="/pages/css/customstyles.css">
<link rel="stylesheet" href="/pages/css/theme-white.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="/pages/js/jquery.navgoco.min.js"></script>


<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/2.0.0/anchor.min.js"></script>
<script src="/pages/js/toc.js"></script>
<script src="/pages/js/customscripts.js"></script>

<link rel="shortcut icon" href="/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="" href="http://grakn.ai/pages/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    

</head>
<body>
<svg xmlns="http://www.w3.org/2000/svg" width="0" height="0" style="display: none;">
    <symbol id="logo" viewBox="0 0 40 40" aria-labelledby="GRAKN.AI">
       <value>GRAKN.AI</value>
       <desc>A Distributed Knowledge Graph</desc>
       <polygon vector-effect="non-scaling-stroke" fill="transparent" stroke-linejoin="round" points="20,2 38,20 20,38 2,20"/>
       <polyline vector-effect="non-scaling-stroke" fill="transparent" stroke-linejoin="round" points="7.27,32.73 7.27,7.27 20,20 32.73,7.27 32.73,32.73"/>
    </symbol>
    <symbol id="github" viewBox="0 0 16 16" aria-labelledby="GitHub">
        <value>GitHub</value>
        <desc>GitHub</desc>
        <path vector-effect="non-scaling-stroke" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
    </symbol>
    <symbol id="gitter" viewBox="0 0 28 40" aria-labelledby="Gitter">
        <value>Gitter</value>
        <desc>Gitter</desc>
        <rect vector-effect="non-scaling-stroke" x="15.6" y="6.4" width="3.2" height="33.6"/>
        <rect vector-effect="non-scaling-stroke" x="22" y="6.4" width="3.2" height="17.6"/>
        <rect vector-effect="non-scaling-stroke" x="9.2" y="6.4" width="3.2" height="33.6"/>
        <rect vector-effect="non-scaling-stroke" x="2.8" width="3.2" height="24"/>
    </symbol>
    <symbol id="slack" viewBox="0 0 256 256" aria-labelledby="Slack">
        <path d="M165.963541,15.8384262 C162.07318,3.86308197 149.212328,-2.69009836 137.239082,1.20236066 C125.263738,5.09272131 118.710557,17.9535738 122.603016,29.9268197 L181.550164,211.292328 C185.597902,222.478689 197.682361,228.765377 209.282098,225.426885 C221.381246,221.943607 228.756984,209.093246 224.896,197.21023 C224.749115,196.756984 165.963541,15.8384262 165.963541,15.8384262"></path>
        <path d="M74.6260984,45.515541 C70.7336393,33.5422951 57.8727869,26.9891148 45.899541,30.8794754 C33.9241967,34.7698361 27.3710164,47.6306885 31.2634754,59.6060328 L90.210623,240.971541 C94.2583607,252.157902 106.34282,258.44459 117.942557,255.104 C130.041705,251.62282 137.417443,238.772459 133.556459,226.887344 C133.409574,226.436197 74.6260984,45.515541 74.6260984,45.515541"></path>
        <path d="M240.161574,166.045377 C252.136918,162.155016 258.688,149.294164 254.797639,137.31882 C250.907279,125.345574 238.046426,118.792393 226.07318,122.682754 L44.7076721,181.632 C33.5213115,185.677639 27.234623,197.762098 30.5731148,209.361836 C34.0563934,221.460984 46.9067541,228.836721 58.7897705,224.975738 C59.2430164,224.828852 240.161574,166.045377 240.161574,166.045377"></path>
        <path d="M82.507541,217.270557 C94.312918,213.434754 109.528131,208.491016 125.855475,203.186361 C122.019672,191.380984 117.075934,176.163672 111.76918,159.83423 L68.4191475,173.924721 L82.507541,217.270557"></path>
        <path d="M173.847082,187.591344 C190.235279,182.267803 205.467279,177.31777 217.195016,173.507148 C213.359213,161.70177 208.413377,146.480262 203.106623,130.146623 L159.75659,144.237115 L173.847082,187.591344"></path>
        <path d="M210.484459,74.7058361 C222.457705,70.8154754 229.010885,57.954623 225.120525,45.9792787 C221.230164,34.0060328 208.369311,27.4528525 196.393967,31.3432131 L15.028459,90.292459 C3.84209836,94.3380984 -2.44459016,106.422557 0.896,118.022295 C4.37718033,130.121443 17.227541,137.49718 29.1126557,133.636197 C29.5638033,133.489311 210.484459,74.7058361 210.484459,74.7058361"></path>
        <path d="M52.8220328,125.933115 C64.6274098,122.097311 79.8468197,117.151475 96.1762623,111.84682 C90.8527213,95.4565246 85.9026885,80.2245246 82.0920656,68.4946885 L38.731541,82.5872787 L52.8220328,125.933115"></path>
        <path d="M144.159475,96.256 C160.551869,90.9303607 175.785967,85.9803279 187.515803,82.1676066 C182.190164,65.7752131 177.240131,50.5390164 173.42741,38.807082 L130.068984,52.8996721 L144.159475,96.256"></path>
    </symbol>
</svg>

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">
                <svg><use xlink:href="#logo" /></svg>
                <span class="projectTitle">GRAKN.AI</span>
            </a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                
                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                
                
                <!-- <li class="dropdown">
                    <a>Documentation</a>
                    <ul>
                        <li><a href="#">Overview</a></li>
                        <li><a href="#">Core API</a></li>
                        <li><a href="#">Graql API</a></li>
                        <li><a href="#">Rest API</a></li>
                        <li><a href="#">Javadoc</a></li>
                    </ul>
                </li> -->
                <li><a href="/pages/platform/index.html">Platform</a></li>
                <li><a href="/pages/index.html">Documentation</a></li>
                <li><a rel="me" href="//grakn.ai/community.html">Community</a></li>
                <li><a rel="me" href="//discuss.grakn.ai/">Discussion</a></li>
                <li><a rel="me" href="//blog.grakn.ai/" target="_blank">Blog</a></li>
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="Search">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="/pages/js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                        SimpleJekyllSearch.init({
                            searchInput: document.getElementById('search-input'),
                            resultsContainer: document.getElementById('results-container'),
                            
                            dataSource: '/pages/search.json',
                            
                            searchResultTemplate: '<li><a href="{url}" title="Graql Rules">{title}</a></li>',
                            noResultsText: '<li><a class="empty">No results found</a></li>',
                            limit: 10,
                            fuzzy: true
                        });
                    </script>
                    <!--end search-->
                </li>
                <!--comment out this block if you want to hide github link-->
                <li>
                    <a rel="me" href="//github.com/graknlabs/grakn" target="_blank" class="github">
                        <svg><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#github"></use></svg>
                    </a>
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
    <!-- Content Row -->
    <div class="row">
        <!-- Sidebar Column -->
        <div class="col-md-3">
          





<ul id="mysidebar" class="nav">
    <li class="sidebarTitle">Grakn 0.8</li>
    
    
    
    <li>
        <a href="#">Get Started</a>
        <ul>
            
            
            
            <li><a href="/pages/index.html">Home</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/get-started/setup-guide.html">Setup Guide</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">The Basics</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/the-basics/grakn-basics.html">Grakn Basics</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/the-basics/grakn-knowledge-model.html">Grakn Knowledge Model</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/the-basics/quickstart-tutorial.html">Quickstart Tutorial</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/the-basics/visualiser.html">Visualising a Graph</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Graph API</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/core-api/overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/core-api/simple-schema-definition.html">Simple Schema Definition</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/core-api/advanced-schema-definition.html">Advanced Schema Definition</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Graql</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/graql/overview.html">Overview</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/graql-shell.html">Graql Shell</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/match-queries.html">Match Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/ask-queries.html">Ask Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/delete-queries.html">Delete Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/insert-queries.html">Insert Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/aggregate-queries.html">Aggregate Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/compute-queries.html">Compute Queries</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/graql-templating.html">Graql Templating</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/graql-cheatsheet.html">Graql Cheatsheet</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql/java-graql.html">Java Graql</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Graql Analytics</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/graql-analytics/analytics-overview.html">Graql Analytics Overview</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql-analytics/analytics-statistics.html">Analytics Statistics</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql-analytics/analytics-degrees.html">Analytics Degrees</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql-analytics/analytics-persist.html">Analytics Persist</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/graql-analytics/analytics-connected-components.html">Connected Components</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Migrating to Grakn</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/migration/migration.html">Migrating to Grakn</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/migration/CSV-migration.html">CSV Migration</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/migration/JSON-migration.html">JSON Migration</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/migration/SQL-migration.html">SQL Migration</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/migration/OWL-migration.html">OWL Migration</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Advanced Grakn</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/advanced-grakn/post-processing.html">Post Processing</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/advanced-grakn/validation.html">Validation</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">API Reference</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/api-reference/api-reference.html">API Reference</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Resources</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/resources/resources.html">Resources</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/resources/faq.html">Grakn FAQ</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/resources/downloads.html">Downloads</a></li>
            
            
            
            
        </ul>
        
        
    
    <li>
        <a href="#">Examples</a>
        <ul>
            
            
            
            <li><a href="/pages/documentation/examples/examples.html">Examples</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/pokemon.html">Pokemon example</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/philosophers.html">Philosophers example</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/moogi.html">Moogi example</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/modern.html">Modern example</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/OWL-migration.html">OWL migration</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/SQL-migration.html">SQL migration</a></li>
            
            
            
            
            
            
            <li><a href="/pages/documentation/examples/projects.html">Example Projects</a></li>
            
            
            
            
        </ul>
        
        

        
        
        <!-- if you aren't using the accordion, uncomment this block:
           <p class="external">
               <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
           </p>
           -->
    </li>
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

        </div>
        <!-- Content Column -->
        <div class="col-md-9">
            <div class="post-header">
   <h1 class="post-title-main">Graql Rules</h1>
</div>



<div class="post-content">

   
    <div class="summary">Graql Rules</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})

});
</script>

<div id="toc"></div>

    

    

    

    <a target="_blank" href="https://github.com/graknlabs/docs/blob/master/pages/documentation/4-graql/graql-rules.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit me</a>

    

    

  <!--Page to comprise: 
(1) section that talks about rules, 
(2) description of their syntax, what is allowed in their conclusion and what is not, 
(3) configuration options, whether to materialize or not, 
(4) maybe cover the future options for a choice of different reasoning algorithms etc?

?? Comparison of FC and BC?

Look through documentation on internal wiki:
http://wiki.grakn.ai/docs/mindmaps-reasoner-project-definition
and associated pages
-->

<h2 id="rule-objects">Rule Objects</h2>

<p>We define the following hierarchy of rule objects - concepts:</p>

<p>{ConceptType}&lt;–(ako)–{RuleType}
{RuleType}&lt;–(isa)–{Inference Rule}
{RuleType}&lt;–(isa)–{Ronstraint Rule}
{inference rule}&lt;–(isa)–{instance of inference rule, e.g. if daughter+brother then niece}
{constraint rule}&lt;–(isa)–{instance of constraint rule, e.g. if daughter then not married}</p>

<p>We introduce a single rule object in the Object Model being able to accommodate inference rules and constraint rules:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>class Rule extends ConceptInstance - wrapped around a tinkerpop vertex class
// to check for possible inference/satisfiability, we always evaluate if(lhs){evaluate rhs}
// action specifies action executed on RHS pattern if expectation is not met
{
Query (String?) LHS
Query (String?) RHS

//only for constraint rules, this may be removed after graql implements negation
Boolean expectation {true, false}
Boolean materialise {true, false}

//specifies whether it is an inference or constraint rule
// this inherited from Concept.java
String type 

//add an edge with label "hypothesis" from conceptType to Rule concept
addHypothesis(ConceptType conceptType)

//add an edge with label "conclusion" from Rule concept to conceptType
addConclusion(ConceptType conceptType)
}
</code></pre>
</div>

<h2 id="rule-examples">Rule Examples</h2>

<h3 id="example-rule-all-swedish-women-are-pretty">Example Rule: “All Swedish women are pretty”</h3>

<pre><code class="language-Graql">Rule:
LHS: match
   $x isa person;
	 $x has gender "female";
   $x has nationality Sweden";

RHS: insert
     $x has beauty-score 9;
</code></pre>

<p>Upon addition of this rule instance, the concept types of Person, Gender, and Nationality will be linked to it.</p>

<p>Once an instance of Gender or Nationality is added to the graph, it can be checked for being a partial instantiation of the rule by checking whether the value of the resource is met after downloading the relevant connected Rule Instance. If it is a partial instantiation then the LHS is executed with a where chain specifying the given instance.</p>

<h3 id="example-rule-if-two-companies-have-the-same-location-and-their-directors-are-related-flag-them-as-suspicious">Example Rule: If two companies have the same location and their directors are related, flag them as “suspicious”</h3>

<pre><code class="language-Graql">select match
    $x isa company;
    $y isa company;
    $x has address "address";
    $y has address "address";
    ($x, $u) isa directorship;
    ($y, $v) isa directorship;
    ($u, $v) select $x, $y;

insert
    $x has flag "suspicious";
    $y has flag "suspicious";
</code></pre>

<p>Upon addition of this rule instance, the concept types of Company, Address and Directorship will be linked to it.</p>

<h3 id="example-rule-if-a-persons-parent-has-a-brother-the-person-has-an-uncle">Example Rule: “If a Person’s parent has a brother, the person has an uncle”</h3>

<pre><code class="language-Graql">Rule:
LHS: match
  	 ($x, $y);
     ($y, $z);
  
     $x isa person;
     $y isa person;
     $z isa person;
     $a (child $x, parent $z) isa hasParent;

     ($z, $y) isa hasBrother select $x, $y;
  
RHS: insert 
     isa hasUncle(nephew/niece $x, uncle $y);
</code></pre>

<h3 id="example-rule-transitivity-of-a-specific-relation">Example Rule: “Transitivity of a specific relation”</h3>

<pre><code class="language-Graql">Rule:
LHS: match
  	 (roleA $x, roleB $y) isa someRelationType;
     (roleA $y, roleB $z) isa someRelationType select $x, $z;
     
RHS: insert 
		 isa someRelationType(roleA $x, roleB $z);
</code></pre>

<h3 id="example-rule-two-concepts-being-related-results-in-something">Example Rule: “Two concepts being related results in something”</h3>

<pre><code class="language-Graql">Rule:
LHS: match
     ($x, $y)
  
RHS: insert
     isa someRelationType($x, $y);
</code></pre>

<h2 id="constraint-examples">Constraint examples</h2>

<h3 id="example-constraint-every-person-that-is-employed-by-a-company-must-have-a-contract-between-them">Example Constraint: “Every person that is employed by a company must have a contract between them”</h3>

<pre><code class="language-Graql">Constraint:
IF (LHS)
        match
        $x isa person
        $y isa person
        (employee $x, employer $y) isa employment
THEN (RHS)
        match
        ($x, $y) isa contract ask;
    
expectation = true
</code></pre>

<p>Suppose the following piece of information is added:
<code class="highlighter-rouge">
$x = 'bob'
</code></p>

<p>We then execute the constraint LHS on ‘bob’:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">Check</span> <span class="n">whether</span> <span class="n">bob</span> <span class="n">is</span> <span class="n">an</span> <span class="n">instantiation</span> <span class="n">of</span> <span class="nl">LHS:</span>

        <span class="n">Query</span><span class="o">.</span><span class="na">parser</span><span class="o">(</span><span class="s">"match
        $x isa person;$y isa person;
        (employee $x, employer $y) isa employment"</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">$x</span> <span class="n">id</span> <span class="err">'</span><span class="n">bob</span><span class="err">'</span><span class="o">)</span>
       
        <span class="n">we</span> <span class="n">also</span> <span class="n">need</span> <span class="n">to</span> <span class="n">check</span> <span class="k">for</span><span class="o">:</span>
       
        <span class="n">Query</span><span class="o">.</span><span class="na">parser</span><span class="o">(</span><span class="s">"match
        $x isa person;$y isa person;
        (employee $x, employer $y) isa employment"</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">$y</span> <span class="n">id</span> <span class="err">'</span><span class="n">bob</span><span class="err">'</span><span class="o">)</span>
       
        <span class="n">put</span> <span class="n">the</span> <span class="n">result</span> <span class="n">of</span> <span class="n">all</span> <span class="n">queries</span> <span class="n">above</span> <span class="n">in</span> <span class="n">to</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span> <span class="n">pairs</span> <span class="n">called</span> <span class="n">LHS</span>
<span class="n">then</span>
<span class="n">check</span> <span class="k">if</span> <span class="n">RHS</span> <span class="n">meets</span> <span class="n">the</span> <span class="nl">expectation:</span>
                     
        <span class="k">for</span> <span class="n">every</span> <span class="n">item</span> <span class="n">i</span><span class="o">(</span><span class="n">x</span><span class="o">,</span><span class="n">y</span><span class="o">)</span> <span class="n">in</span> <span class="n">LHS</span>
        <span class="n">Constraint</span><span class="o">.</span><span class="na">expectation</span> <span class="o">?=</span> <span class="n">Query</span><span class="o">.</span><span class="na">parser</span><span class="o">(</span><span class="s">"match
        ($x, $y) isa contract ask"</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">$x</span> <span class="n">id</span> <span class="n">i</span><span class="o">.</span><span class="na">x</span><span class="o">,</span> <span class="n">$y</span> <span class="n">id</span> <span class="n">i</span><span class="o">.</span><span class="na">y</span><span class="o">);</span>
</code></pre>
</div>

<p>Alternatively we can process data on a relation basis, say the following information is added:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Employment(bob, alice)        
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">Check</span> <span class="n">whether</span> <span class="n">added</span> <span class="n">relation</span> <span class="n">leads</span> <span class="n">to</span> <span class="n">instantiation</span> <span class="n">of</span> <span class="nl">LHS:</span>

<span class="o">(</span><span class="n">x</span><span class="o">,</span> <span class="n">y</span><span class="o">)</span> <span class="o">=</span> <span class="n">Query</span><span class="o">.</span><span class="na">parser</span><span class="o">(</span><span class="n">Constraint</span><span class="o">.</span><span class="na">LHS</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">$x</span> <span class="n">id</span> <span class="err">'</span><span class="n">bob</span><span class="err">'</span><span class="o">,</span> <span class="n">$y</span> <span class="n">id</span> <span class="err">'</span><span class="n">alice</span><span class="err">'</span><span class="o">)</span>
  
<span class="n">Then</span> <span class="n">check</span> <span class="k">if</span> <span class="n">RHS</span> <span class="n">meets</span> <span class="n">the</span> <span class="nl">expectation:</span>
<span class="n">Constraint</span><span class="o">.</span><span class="na">expectation</span> <span class="o">?=</span> <span class="n">Query</span><span class="o">.</span><span class="na">parser</span><span class="o">(</span><span class="n">Constraint</span><span class="o">.</span><span class="na">RHS</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">$x</span> <span class="n">id</span> <span class="n">x</span><span class="o">,</span> <span class="n">$y</span> <span class="n">id</span> <span class="n">y</span><span class="o">)</span>
</code></pre>
</div>

<h2 id="support-of-graql-constructs">Support of Graql Constructs</h2>

<h3 id="queries">Queries</h3>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: center">Example</th>
      <th style="text-align: left">Input</th>
      <th style="text-align: left">Body</th>
      <th style="text-align: left">Head</th>
      <th style="text-align: right">Level of support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>conjunctive queries</td>
      <td style="text-align: center">-</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>disjunctive queries</td>
      <td style="text-align: center">-</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>nested queries</td>
      <td style="text-align: center">queries with multiply nested conjunctions/disjunctions</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>reified queries</td>
      <td style="text-align: center">queries with complex constructs represented as variables (e.g. relations as roleplayers )</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">experimental support</td>
    </tr>
  </tbody>
</table>

<h3 id="variable-patterns">Variable Patterns</h3>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: left">Example</th>
      <th style="text-align: left">Body</th>
      <th style="text-align: left">Head</th>
      <th style="text-align: right">Level of support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>isa</td>
      <td style="text-align: left">match $x isa pokemon;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>id</td>
      <td style="text-align: left">match $x id “Articuno”;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">indirect only</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>value</td>
      <td style="text-align: left">match $x value contains “lightning”;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">indirect only</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>has</td>
      <td style="text-align: left">match $x has pokedex-no &lt; 20;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left"> </td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations with specified types</td>
      <td style="text-align: left">match (ancestor: $x, descendant: $y) isa ancestorship;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations with incomplete roles</td>
      <td style="text-align: left">match (ancestor: $x, $y) isa ancestorship;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓, not recommended</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations without type</td>
      <td style="text-align: left">match (ancestor: $x, $y);</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>match all relations</td>
      <td style="text-align: left">match ($x, $y);</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations with rscs in one line</td>
      <td style="text-align: left">match (ancestor: $x, $y) isa rel-typel has resource-type ‘value’;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations with user specified var</td>
      <td style="text-align: left">match $r ($x, $y);</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>relations with roles as variables</td>
      <td style="text-align: left">match ($r: $x, $y) isa rel-type;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: right">experimental support</td>
    </tr>
    <tr>
      <td>relations with type var</td>
      <td style="text-align: left">match (ancestor: $x, $y) isa $rel;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>resource comparison</td>
      <td style="text-align: left">match $x value &gt; $y;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>!=</td>
      <td style="text-align: left">match $x != $y;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>has-scope</td>
      <td style="text-align: left">match ($x, $y) has-scope $z;match $x has-scope $y;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
  </tbody>
</table>

<h3 id="type-properties">Type Properties</h3>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: left">Example</th>
      <th style="text-align: left">Body</th>
      <th style="text-align: left">Head</th>
      <th style="text-align: right">Level of support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>sub</td>
      <td style="text-align: left">match $x sub type;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>plays-role</td>
      <td style="text-align: left">match $x plays-role ancestor;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>has-resource</td>
      <td style="text-align: left">match $x has-resource name;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>has-role</td>
      <td style="text-align: left">match evolution has-role $x;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>is-abstract</td>
      <td style="text-align: left">match $x is-abstract;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>datatype</td>
      <td style="text-align: left">match $x isa resource-type, datatype string;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>regex</td>
      <td style="text-align: left">match $x isa resource-type, regex /hello/;</td>
      <td style="text-align: left">✓</td>
      <td style="text-align: left">x</td>
      <td style="text-align: right">supported</td>
    </tr>
  </tbody>
</table>

<h3 id="predicates">Predicates</h3>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: left">Example</th>
      <th style="text-align: right">Level of support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Comparators</td>
      <td style="text-align: left">match $x has height = 19, has weight &gt; 1500;</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>Contains</td>
      <td style="text-align: left">match $x has description $desc;$desc value contains “underground”;</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>Regex</td>
      <td style="text-align: left">match $x value /.*(fast|quick).*/;</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>And and Or</td>
      <td style="text-align: left">match $x has weight &gt;20 and &lt;30;</td>
      <td style="text-align: right">supported</td>
    </tr>
  </tbody>
</table>

<h3 id="modifiers">Modifiers</h3>

<table>
  <thead>
    <tr>
      <th>Description</th>
      <th style="text-align: right">Level of support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>limit</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>offset</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>distinct</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>order</td>
      <td style="text-align: right">supported</td>
    </tr>
    <tr>
      <td>select</td>
      <td style="text-align: right">supported</td>
    </tr>
  </tbody>
</table>



    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="/pages/tag_graql.html" class="btn btn-default navbar-btn cursorNorm" role="button">graql</a>
        
        
        
        <a href="/pages/tag_reasoner.html" class="btn btn-default navbar-btn cursorNorm" role="button">reasoner</a>
        
        
        
    </div>

    

</div>

<!-- <hr class="shaded"/> -->

<footer class="row">
    <div class="col-lg-4 footer">
        <span class="footer-header">Get in touch</span>
        <p>
            <a class="slack" href="https://grakn.ai/slack.html">
                <svg><use xmlns:xlink="https://www.w3.org/1999/xlink" xlink:href="#slack"></use></svg> Grakn on Slack
            </a>
            <br>
            <a rel="me" class="github" href="https://github.com/graknlabs/grakn" target="_blank">
                <svg><use xmlns:xlink="https://www.w3.org/1999/xlink" xlink:href="#github"></use></svg> Grakn on GitHub
            </a>
            <br><br>
            <a href="mailto:info@grakn.ai">info@grakn.ai</a><br>
            Unit 22, 8 Hornsey Street<br>
            London, UK, N7 8EG
        </p>
        <br>
        <p>© 2016 <a href="https://grakn.ai">Grakn Labs Ltd</a></p>
        <!-- &copy;2016 GRAKN.AI. All rights reserved. <br />
        <span>Page last updated:</span> December 9th 2016<br/> Site last generated: Dec 12, 2016 <br />
        <p><img src="images/company_logo.png" alt="Company logo"/></p> -->
    </div>
    <div class="col-lg-2 footer">
        <span class="footer-header">Get Started</span>
        <ul>
            <li><a href="/pages/platform/index.html">Introduction</a></li>
            <li><a href="/pages/documentation/get-started/setup-guide.html">Install</a></li>
            <li><a href="/pages/documentation/the-basics/quickstart-tutorial.html">Quickstart</a></li>
        </ul>
    </div>
    <div class="col-lg-2 footer">
        <span class="footer-header">Resources</span>
        <ul>
            <li><a href="/pages/index.html">Documentation</a></li>
            <li><a rel="me" href="https://github.com/graknlabs/grakn" target="_blank">GitHub</a></li>
            <li><a href="https://grakn.ai/javadocs.html">Javadoc</a></li>
            <li><a href="https://grakn.ai/community.html">Community</a></li>
        </ul>
    </div>
    <div class="col-lg-2 footer">
        <span class="footer-header">Community</span>
        <ul>
            <li><a rel="me" href="https://discuss.grakn.ai">Discussion</a></li>
            <li><a rel="me" href="https://stackoverflow.com/questions/tagged/graql+or+grakn" target="_blank">Stack Overflow</a></li>
            <li><a href="https://grakn.ai/slack.html">Slack</a></li>
            <li><a rel="me" href="https://twitter.com/graknlabs" target="_blank">Twitter</a></li>
        </ul>
    </div>
    <div class="col-lg-2 footer">
        <span class="footer-header">Company</span>
        <ul>
            <li><a rel="me" href="https://blog.grakn.ai" target="_blank">Blog</a></li>
            <li><a href="https://grakn.ai/careers.html">Careers</a></li>
            <li><a href="https://grakn.ai/about.html">About</a></li>
        </ul>
    </div>
</footer>


        </div>
    </div>
</div>
<!-- /.container -->
    </div>

</body>

</html>