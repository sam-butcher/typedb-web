(function(global,factory){if(typeof module==="object"&&typeof module.exports==="object")module.exports=global.document?factory(global,true):function(w){if(!w.document)throw new Error("jQuery requires a window with a document");return factory(w)};else factory(global)})(typeof window!=="undefined"?window:this,function(window,noGlobal){var arr=[];var document=window.document;var slice=arr.slice;var concat=arr.concat;var push=arr.push;var indexOf=arr.indexOf;var class2type={};var toString=class2type.toString;
var hasOwn=class2type.hasOwnProperty;var support={};var version="2.2.1",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?num<0?this[num+this.length]:this[num]:slice.call(this)},
pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback){return jQuery.each(this,callback)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=
0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor()},push:push,sort:arr.sort,splice:arr.splice};jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}if(typeof target!=="object"&&!jQuery.isFunction(target))target={};if(i===length){target=this;i--}for(;i<length;i++)if((options=arguments[i])!=null)for(name in options){src=
target[name];copy=options[name];if(target===copy)continue;if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else clone=src&&jQuery.isPlainObject(src)?src:{};target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined)target[name]=copy}return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:true,error:function(msg){throw new Error(msg);},noop:function(){},
isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray,isWindow:function(obj){return obj!=null&&obj===obj.window},isNumeric:function(obj){var realStringObj=obj&&obj.toString();return!jQuery.isArray(obj)&&realStringObj-parseFloat(realStringObj)+1>=0},isPlainObject:function(obj){if(jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj))return false;if(obj.constructor&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return false;return true},isEmptyObject:function(obj){var name;
for(name in obj)return false;return true},type:function(obj){if(obj==null)return obj+"";return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(code){var script,indirect=eval;code=jQuery.trim(code);if(code)if(code.indexOf("use strict")===1){script=document.createElement("script");script.text=code;document.head.appendChild(script).parentNode.removeChild(script)}else indirect(code)},camelCase:function(string){return string.replace(rmsPrefix,
"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback){var length,i=0;if(isArrayLike(obj)){length=obj.length;for(;i<length;i++)if(callback.call(obj[i],i,obj[i])===false)break}else for(i in obj)if(callback.call(obj[i],i,obj[i])===false)break;return obj},trim:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null)if(isArrayLike(Object(arr)))jQuery.merge(ret,
typeof arr==="string"?[arr]:arr);else push.call(ret,arr);return ret},inArray:function(elem,arr,i){return arr==null?-1:indexOf.call(arr,elem,i)},merge:function(first,second){var len=+second.length,j=0,i=first.length;for(;j<len;j++)first[i++]=second[j];first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect)matches.push(elems[i])}return matches},
map:function(elems,callback,arg){var length,value,i=0,ret=[];if(isArrayLike(elems)){length=elems.length;for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null)ret.push(value)}}else for(i in elems){value=callback(elems[i],i,arg);if(value!=null)ret.push(value)}return concat.apply([],ret)},guid:1,proxy:function(fn,context){var tmp,args,proxy;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn))return undefined;args=slice.call(arguments,2);proxy=function(){return fn.apply(context||
this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:Date.now,support:support});if(typeof Symbol==="function")jQuery.fn[Symbol.iterator]=arr[Symbol.iterator];jQuery.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArrayLike(obj){var length=!!obj&&"length"in obj&&obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj))return false;
return type==="array"||length===0||typeof length==="number"&&length>0&&length-1 in obj}var Sizzle=function(window){var i,support,Expr,getText,isXML,tokenize,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+1*new Date,preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b)hasDuplicate=true;return 0},
MAX_NEGATIVE=1<<31,hasOwn={}.hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=function(list,elem){var i=0,len=list.length;for(;i<len;i++)if(list[i]===elem)return i;return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",identifier="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",attributes="\\["+whitespace+"*("+identifier+")(?:"+whitespace+"*([*^$|!~]?=)"+
whitespace+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+identifier+"))|)"+whitespace+"*\\]",pseudos=":("+identifier+")(?:\\(("+"('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|"+"((?:\\\\.|[^\\\\()[\\]]|"+attributes+")*)|"+".*"+")\\)|)",rwhitespace=new RegExp(whitespace+"+","g"),rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+
whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+identifier+")"),"CLASS":new RegExp("^\\.("+identifier+")"),"TAG":new RegExp("^("+identifier+"|[*])"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+
whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)",
"ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)},unloadHandler=function(){setDocument()};try{push.apply(arr=slice.call(preferredDoc.childNodes),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=
target.length,i=0;while(target[j++]=els[i++]);target.length=j-1}}}function Sizzle(selector,context,results,seed){var m,i,elem,nid,nidselect,match,groups,newSelector,newContext=context&&context.ownerDocument,nodeType=context?context.nodeType:9;results=results||[];if(typeof selector!=="string"||!selector||nodeType!==1&&nodeType!==9&&nodeType!==11)return results;if(!seed){if((context?context.ownerDocument||context:preferredDoc)!==document)setDocument(context);context=context||document;if(documentIsHTML){if(nodeType!==
11&&(match=rquickExpr.exec(selector)))if(m=match[1])if(nodeType===9)if(elem=context.getElementById(m)){if(elem.id===m){results.push(elem);return results}}else return results;else{if(newContext&&(elem=newContext.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));
return results}if(support.qsa&&!compilerCache[selector+" "]&&(!rbuggyQSA||!rbuggyQSA.test(selector))){if(nodeType!==1){newContext=context;newSelector=selector}else if(context.nodeName.toLowerCase()!=="object"){if(nid=context.getAttribute("id"))nid=nid.replace(rescape,"\\$&");else context.setAttribute("id",nid=expando);groups=tokenize(selector);i=groups.length;nidselect=ridentifier.test(nid)?"#"+nid:"[id='"+nid+"']";while(i--)groups[i]=nidselect+" "+toSelector(groups[i]);newSelector=groups.join(",");
newContext=rsibling.test(selector)&&testContext(context.parentNode)||context}if(newSelector)try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(nid===expando)context.removeAttribute("id")}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength)delete cache[keys.shift()];return cache[key+" "]=value}return cache}function markFunction(fn){fn[expando]=
true;return fn}function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return false}finally{if(div.parentNode)div.parentNode.removeChild(div);div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=arr.length;while(i--)Expr.attrHandle[arr[i]]=handler}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff)return diff;if(cur)while(cur=cur.nextSibling)if(cur===
b)return-1;return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;
while(i--)if(seed[j=matchIndexes[i]])seed[j]=!(matches[j]=seed[j])})})}function testContext(context){return context&&typeof context.getElementsByTagName!=="undefined"&&context}support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};setDocument=Sizzle.setDocument=function(node){var hasCompare,parent,doc=node?node.ownerDocument||node:preferredDoc;if(doc===document||
doc.nodeType!==9||!doc.documentElement)return document;document=doc;docElem=document.documentElement;documentIsHTML=!isXML(document);if((parent=document.defaultView)&&parent.top!==parent)if(parent.addEventListener)parent.addEventListener("unload",unloadHandler,false);else if(parent.attachEvent)parent.attachEvent("onunload",unloadHandler);support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(document.createComment(""));
return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(document.getElementsByClassName);support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!document.getElementsByName||!document.getElementsByName(expando).length});if(support.getById){Expr.find["ID"]=function(id,context){if(typeof context.getElementById!=="undefined"&&documentIsHTML){var m=context.getElementById(id);return m?[m]:[]}};Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,
funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find["ID"];Expr.filter["ID"]=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find["TAG"]=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!=="undefined")return context.getElementsByTagName(tag);else if(support.qsa)return context.querySelectorAll(tag)}:
function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while(elem=results[i++])if(elem.nodeType===1)tmp.push(elem);return tmp}return results};Expr.find["CLASS"]=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!=="undefined"&&documentIsHTML)return context.getElementsByClassName(className)};rbuggyMatches=[];rbuggyQSA=[];if(support.qsa=rnative.test(document.querySelectorAll)){assert(function(div){docElem.appendChild(div).innerHTML=
"<a id='"+expando+"'></a>"+"<select id='"+expando+"-\r\\' msallowcapture=''>"+"<option selected=''></option></select>";if(div.querySelectorAll("[msallowcapture^='']").length)rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")");if(!div.querySelectorAll("[selected]").length)rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")");if(!div.querySelectorAll("[id~="+expando+"-]").length)rbuggyQSA.push("~=");if(!div.querySelectorAll(":checked").length)rbuggyQSA.push(":checked");if(!div.querySelectorAll("a#"+
expando+"+*").length)rbuggyQSA.push(".#.+[+~]")});assert(function(div){var input=document.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length)rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=");if(!div.querySelectorAll(":enabled").length)rbuggyQSA.push(":enabled",":disabled");div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if(support.matchesSelector=rnative.test(matches=docElem.matches||docElem.webkitMatchesSelector||
docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector))assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)});rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:
a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return true;return false};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare)return compare;compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||!support.sortDetached&&
b.compareDocumentPosition(a)===compare){if(a===document||a.ownerDocument===preferredDoc&&contains(preferredDoc,a))return-1;if(b===document||b.ownerDocument===preferredDoc&&contains(preferredDoc,b))return 1;return sortInput?indexOf(sortInput,a)-indexOf(sortInput,b):0}return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=true;return 0}var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup)return a===document?-1:b===document?1:aup?-1:bup?1:sortInput?indexOf(sortInput,a)-indexOf(sortInput,
b):0;else if(aup===bup)return siblingCheck(a,b);cur=a;while(cur=cur.parentNode)ap.unshift(cur);cur=b;while(cur=cur.parentNode)bp.unshift(cur);while(ap[i]===bp[i])i++;return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return document};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document)setDocument(elem);expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&
documentIsHTML&&!compilerCache[expr+" "]&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr)))try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11)return ret}catch(e){}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document)setDocument(context);return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||
elem)!==document)setDocument(elem);var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;
sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while(elem=results[i++])if(elem===results[i])j=duplicates.push(i);while(j--)results.splice(duplicates[j],1)}sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType)while(node=elem[i++])ret+=getText(node);else if(nodeType===1||nodeType===9||nodeType===11)if(typeof elem.textContent==="string")return elem.textContent;else for(elem=elem.firstChild;elem;elem=
elem.nextSibling)ret+=getText(elem);else if(nodeType===3||nodeType===4)return elem.nodeValue;return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[3]||match[4]||match[5]||"").replace(runescape,funescape);if(match[2]===
"~=")match[3]=" "+match[3]+" ";return match.slice(0,4)},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3])Sizzle.error(match[0]);match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+(match[7]+match[8]||match[3]==="odd")}else if(match[3])Sizzle.error(match[0]);return match},"PSEUDO":function(match){var excess,unquoted=!match[6]&&match[2];if(matchExpr["CHILD"].test(match[0]))return null;if(match[3])match[2]=
match[4]||match[5]||"";else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}return match.slice(0,3)}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},
"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!=="undefined"&&elem.getAttribute("class")||"")})},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null)return operator==="!=";if(!operator)return true;result+=
"";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result.replace(rwhitespace," ")+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",
ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,uniqueCache,outerCache,node,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType,diff=false;if(parent){if(simple){while(dir){node=elem;while(node=node[dir])if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)return false;start=dir=type==="only"&&!start&&"nextSibling"}return true}start=
[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){node=parent;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())if(node.nodeType===1&&++diff&&node===elem){uniqueCache[type]=[dirruns,nodeIndex,diff];break}}else{if(useCache){node=
elem;outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});cache=uniqueCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=nodeIndex}if(diff===false)while(node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){outerCache=node[expando]||(node[expando]={});uniqueCache=outerCache[node.uniqueID]||(outerCache[node.uniqueID]={});uniqueCache[type]=
[dirruns,diff]}if(node===elem)break}}diff-=last;return diff===first||diff%first===0&&diff/first>=0}}},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando])return fn(argument);if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf(seed,
matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--)if(elem=unmatched[i])seed[i]=!(matches[i]=elem)}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);input[0]=null;return!results.pop()}}),
"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),"contains":markFunction(function(text){text=text.replace(runescape,funescape);return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||""))Sizzle.error("unsupported lang: "+lang);lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do if(elemLang=documentIsHTML?
elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang")){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},"root":function(elem){return elem===docElem},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||
~elem.tabIndex)},"enabled":function(elem){return elem.disabled===false},"disabled":function(elem){return elem.disabled===true},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return nodeName==="input"&&!!elem.checked||nodeName==="option"&&!!elem.selected},"selected":function(elem){if(elem.parentNode)elem.parentNode.selectedIndex;return elem.selected===true},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling)if(elem.nodeType<6)return false;return true},"parent":function(elem){return!Expr.pseudos["empty"](elem)},
"header":function(elem){return rheader.test(elem.nodeName)},"input":function(elem){return rinputs.test(elem.nodeName)},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},"first":createPositionalPseudo(function(){return[0]}),"last":createPositionalPseudo(function(matchIndexes,
length){return[length-1]}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2)matchIndexes.push(i);return matchIndexes}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;
for(;--i>=0;)matchIndexes.push(i);return matchIndexes}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;)matchIndexes.push(i);return matchIndexes})}};Expr.pseudos["nth"]=Expr.pseudos["eq"];for(i in{radio:true,checkbox:true,file:true,password:true,image:true})Expr.pseudos[i]=createInputPseudo(i);for(i in{submit:true,reset:true})Expr.pseudos[i]=createButtonPseudo(i);function setFilters(){}setFilters.prototype=Expr.filters=
Expr.pseudos;Expr.setFilters=new setFilters;tokenize=Sizzle.tokenize=function(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached)return parseOnly?0:cached.slice(0);soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match)soFar=soFar.slice(match[0].length)||soFar;groups.push(tokens=[])}matched=false;if(match=rcombinators.exec(soFar)){matched=match.shift();tokens.push({value:matched,
type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter)if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}if(!matched)break}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)};function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++)selector+=
tokens[i].value;return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while(elem=elem[dir])if(elem.nodeType===1||checkNonElements)return matcher(elem,context,xml)}:function(elem,context,xml){var oldCache,uniqueCache,outerCache,newCache=[dirruns,doneName];if(xml)while(elem=elem[dir]){if(elem.nodeType===1||checkNonElements)if(matcher(elem,context,xml))return true}else while(elem=
elem[dir])if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});uniqueCache=outerCache[elem.uniqueID]||(outerCache[elem.uniqueID]={});if((oldCache=uniqueCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName)return newCache[2]=oldCache[2];else{uniqueCache[dir]=newCache;if(newCache[2]=matcher(elem,context,xml))return true}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--)if(!matchers[i](elem,context,
xml))return false;return true}:matchers[0]}function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++)Sizzle(selector,contexts[i],results);return results}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++)if(elem=unmatched[i])if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped)map.push(i)}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,
postFinder,postSelector){if(postFilter&&!postFilter[expando])postFilter=setMatcher(postFilter);if(postFinder&&!postFinder[expando])postFinder=setMatcher(postFinder,postSelector);return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?
preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher)matcher(matcherIn,matcherOut,context,xml);if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--)if(elem=temp[i])matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--)if(elem=matcherOut[i])temp.push(matcherIn[i]=elem);postFinder(null,matcherOut=[],temp,xml)}i=matcherOut.length;while(i--)if((elem=
matcherOut[i])&&(temp=postFinder?indexOf(seed,elem):preMap[i])>-1)seed[temp]=!(results[temp]=elem)}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder)postFinder(null,results,matcherOut,xml);else push.apply(results,matcherOut)}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,
matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){var ret=!leadingRelative&&(xml||context!==outermostContext)||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml));checkContext=null;return ret}];for(;i<len;i++)if(matcher=Expr.relative[tokens[i].type])matchers=[addCombinator(elementMatcher(matchers),
matcher)];else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++)if(Expr.relative[tokens[j].type])break;return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens(tokens=tokens.slice(j)),j<len&&toSelector(tokens))}matchers.push(matcher)}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,
setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find["TAG"]("*",outermost),dirrunsUnique=dirruns+=contextBackup==null?1:Math.random()||.1,len=elems.length;if(outermost)outermostContext=context===document||context||outermost;for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=
0;if(!context&&elem.ownerDocument!==document){setDocument(elem);xml=!documentIsHTML}while(matcher=elementMatchers[j++])if(matcher(elem,context||document,xml)){results.push(elem);break}if(outermost)dirruns=dirrunsUnique}if(bySet){if(elem=!matcher&&elem)matchedCount--;if(seed)unmatched.push(elem)}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while(matcher=setMatchers[j++])matcher(unmatched,setMatched,context,xml);if(seed){if(matchedCount>0)while(i--)if(!(unmatched[i]||setMatched[i]))setMatched[i]=
pop.call(results);setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&matchedCount+setMatchers.length>1)Sizzle.uniqueSort(results)}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match)match=tokenize(selector);i=match.length;
while(i--){cached=matcherFromTokens(match[i]);if(cached[expando])setMatchers.push(cached);else elementMatchers.push(cached)}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize(selector=compiled.selector||selector);results=results||[];if(match.length===1){tokens=match[0]=
match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find["ID"](token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context)return results;else if(compiled)context=context.parentNode;selector=selector.slice(tokens.shift().value.length)}i=matchExpr["needsContext"].test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[type=token.type])break;if(find=
Expr.find[type])if(seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context)){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,!context||rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===
expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"}))addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML)return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)});if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value",
"");return div.firstChild.getAttribute("value")===""}))addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input")return elem.defaultValue});if(!assert(function(div){return div.getAttribute("disabled")==null}))addHandle(booleans,function(elem,name,isXML){var val;if(!isXML)return elem[name]===true?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null});return Sizzle}(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=
jQuery.expr.pseudos;jQuery.uniqueSort=jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var dir=function(elem,dir,until){var matched=[],truncate=until!==undefined;while((elem=elem[dir])&&elem.nodeType!==9)if(elem.nodeType===1){if(truncate&&jQuery(elem).is(until))break;matched.push(elem)}return matched};var siblings=function(n,elem){var matched=[];for(;n;n=n.nextSibling)if(n.nodeType===1&&n!==elem)matched.push(n);return matched};
var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/;var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not});if(qualifier.nodeType)return jQuery.grep(elements,function(elem){return elem===qualifier!==not});if(typeof qualifier==="string"){if(risSimple.test(qualifier))return jQuery.filter(qualifier,elements,not);qualifier=
jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return indexOf.call(qualifier,elem)>-1!==not})}jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not)expr=":not("+expr+")";return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,len=this.length,ret=[],self=this;if(typeof selector!=="string")return this.pushStack(jQuery(selector).filter(function(){for(i=
0;i<len;i++)if(jQuery.contains(self[i],this))return true}));for(i=0;i<len;i++)jQuery.find(selector,self[i],ret);ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):
selector||[],false).length}});var rootjQuery,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context,root){var match,elem;if(!selector)return this;root=root||rootjQuery;if(typeof selector==="string"){if(selector[0]==="<"&&selector[selector.length-1]===">"&&selector.length>=3)match=[null,selector,null];else match=rquickExpr.exec(selector);if(match&&(match[1]||!context))if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],
context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context))for(match in context)if(jQuery.isFunction(this[match]))this[match](context[match]);else this.attr(match,context[match]);return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}else if(!context||context.jquery)return(context||root).find(selector);else return this.constructor(context).find(selector)}else if(selector.nodeType){this.context=
this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector))return root.ready!==undefined?root.ready(selector):selector(jQuery);if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({has:function(target){var targets=
jQuery(target,this),l=targets.length;return this.filter(function(){var i=0;for(;i<l;i++)if(jQuery.contains(this,targets[i]))return true})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++)for(cur=this[i];cur&&cur!==context;cur=cur.parentNode)if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);
break}return this.pushStack(matched.length>1?jQuery.uniqueSort(matched):matched)},index:function(elem){if(!elem)return this[0]&&this[0].parentNode?this.first().prevAll().length:-1;if(typeof elem==="string")return indexOf.call(jQuery(elem),this[0]);return indexOf.call(this,elem.jquery?elem[0]:elem)},add:function(selector,context){return this.pushStack(jQuery.uniqueSort(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});
function sibling(cur,dir){while((cur=cur[dir])&&cur.nodeType!==1);return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return dir(elem,"nextSibling")},prevAll:function(elem){return dir(elem,
"previousSibling")},nextUntil:function(elem,i,until){return dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return dir(elem,"previousSibling",until)},siblings:function(elem){return siblings((elem.parentNode||{}).firstChild,elem)},children:function(elem){return siblings(elem.firstChild)},contents:function(elem){return elem.contentDocument||jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var matched=jQuery.map(this,fn,until);if(name.slice(-5)!==
"Until")selector=until;if(selector&&typeof selector==="string")matched=jQuery.filter(selector,matched);if(this.length>1){if(!guaranteedUnique[name])jQuery.uniqueSort(matched);if(rparentsprev.test(name))matched.reverse()}return this.pushStack(matched)}});var rnotwhite=/\S+/g;function createOptions(options){var object={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?createOptions(options):
jQuery.extend({},options);var firing,memory,fired,locked,list=[],queue=[],firingIndex=-1,fire=function(){locked=options.once;fired=firing=true;for(;queue.length;firingIndex=-1){memory=queue.shift();while(++firingIndex<list.length)if(list[firingIndex].apply(memory[0],memory[1])===false&&options.stopOnFalse){firingIndex=list.length;memory=false}}if(!options.memory)memory=false;firing=false;if(locked)if(memory)list=[];else list=""},self={add:function(){if(list){if(memory&&!firing){firingIndex=list.length-
1;queue.push(memory)}(function add(args){jQuery.each(args,function(_,arg){if(jQuery.isFunction(arg)){if(!options.unique||!self.has(arg))list.push(arg)}else if(arg&&arg.length&&jQuery.type(arg)!=="string")add(arg)})})(arguments);if(memory&&!firing)fire()}return this},remove:function(){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(index<=firingIndex)firingIndex--}});return this},has:function(fn){return fn?jQuery.inArray(fn,list)>
-1:list.length>0},empty:function(){if(list)list=[];return this},disable:function(){locked=queue=[];list=memory="";return this},disabled:function(){return!list},lock:function(){locked=queue=[];if(!memory)list=memory="";return this},locked:function(){return!!locked},fireWith:function(context,args){if(!locked){args=args||[];args=[context,args.slice?args.slice():args];queue.push(args);if(!firing)fire()}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};
return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&
fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise))returned.promise().progress(newDefer.notify).done(newDefer.resolve).fail(newDefer.reject);else newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],
stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString)list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock);deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func)func.call(deferred,deferred);return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||subordinate&&
jQuery.isFunction(subordinate.promise)?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues)deferred.notifyWith(contexts,values);else if(!--remaining)deferred.resolveWith(contexts,values)}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=
new Array(length);for(;i<length;i++)if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise))resolveValues[i].promise().progress(updateFunc(i,progressContexts,progressValues)).done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject);else--remaining}if(!remaining)deferred.resolveWith(resolveContexts,resolveValues);return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:false,readyWait:1,holdReady:function(hold){if(hold)jQuery.readyWait++;
else jQuery.ready(true)},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady)return;jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0)return;readyList.resolveWith(document,[jQuery]);if(jQuery.fn.triggerHandler){jQuery(document).triggerHandler("ready");jQuery(document).off("ready")}}});function completed(){document.removeEventListener("DOMContentLoaded",completed);window.removeEventListener("load",completed);jQuery.ready()}jQuery.ready.promise=function(obj){if(!readyList){readyList=
jQuery.Deferred();if(document.readyState==="complete"||document.readyState!=="loading"&&!document.documentElement.doScroll)window.setTimeout(jQuery.ready);else{document.addEventListener("DOMContentLoaded",completed);window.addEventListener("load",completed)}}return readyList.promise(obj)};jQuery.ready.promise();var access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,len=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key)access(elems,fn,i,key[i],
true,emptyGet,raw)}else if(value!==undefined){chainable=true;if(!jQuery.isFunction(value))raw=true;if(bulk)if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}if(fn)for(;i<len;i++)fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}return chainable?elems:bulk?fn.call(elems):len?fn(elems[0],key):emptyGet};var acceptData=function(owner){return owner.nodeType===1||owner.nodeType===9||!+owner.nodeType};function Data(){this.expando=
jQuery.expando+Data.uid++}Data.uid=1;Data.prototype={register:function(owner,initial){var value=initial||{};if(owner.nodeType)owner[this.expando]=value;else Object.defineProperty(owner,this.expando,{value:value,writable:true,configurable:true});return owner[this.expando]},cache:function(owner){if(!acceptData(owner))return{};var value=owner[this.expando];if(!value){value={};if(acceptData(owner))if(owner.nodeType)owner[this.expando]=value;else Object.defineProperty(owner,this.expando,{value:value,configurable:true})}return value},
set:function(owner,data,value){var prop,cache=this.cache(owner);if(typeof data==="string")cache[data]=value;else for(prop in data)cache[prop]=data[prop];return cache},get:function(owner,key){return key===undefined?this.cache(owner):owner[this.expando]&&owner[this.expando][key]},access:function(owner,key,value){var stored;if(key===undefined||key&&typeof key==="string"&&value===undefined){stored=this.get(owner,key);return stored!==undefined?stored:this.get(owner,jQuery.camelCase(key))}this.set(owner,
key,value);return value!==undefined?value:key},remove:function(owner,key){var i,name,camel,cache=owner[this.expando];if(cache===undefined)return;if(key===undefined)this.register(owner);else{if(jQuery.isArray(key))name=key.concat(key.map(jQuery.camelCase));else{camel=jQuery.camelCase(key);if(key in cache)name=[key,camel];else{name=camel;name=name in cache?[name]:name.match(rnotwhite)||[]}}i=name.length;while(i--)delete cache[name[i]]}if(key===undefined||jQuery.isEmptyObject(cache))if(owner.nodeType)owner[this.expando]=
undefined;else delete owner[this.expando]},hasData:function(owner){var cache=owner[this.expando];return cache!==undefined&&!jQuery.isEmptyObject(cache)}};var dataPriv=new Data;var dataUser=new Data;var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/[A-Z]/g;function dataAttr(elem,key,data){var name;if(data===undefined&&elem.nodeType===1){name="data-"+key.replace(rmultiDash,"-$&").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:
data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}dataUser.set(elem,key,data)}else data=undefined}return data}jQuery.extend({hasData:function(elem){return dataUser.hasData(elem)||dataPriv.hasData(elem)},data:function(elem,name,data){return dataUser.access(elem,name,data)},removeData:function(elem,name){dataUser.remove(elem,name)},_data:function(elem,name,data){return dataPriv.access(elem,name,data)},_removeData:function(elem,name){dataPriv.remove(elem,
name)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=dataUser.get(elem);if(elem.nodeType===1&&!dataPriv.get(elem,"hasDataAttrs")){i=attrs.length;while(i--)if(attrs[i]){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}dataPriv.set(elem,"hasDataAttrs",true)}}return data}if(typeof key==="object")return this.each(function(){dataUser.set(this,
key)});return access(this,function(value){var data,camelKey;if(elem&&value===undefined){data=dataUser.get(elem,key)||dataUser.get(elem,key.replace(rmultiDash,"-$&").toLowerCase());if(data!==undefined)return data;camelKey=jQuery.camelCase(key);data=dataUser.get(elem,camelKey);if(data!==undefined)return data;data=dataAttr(elem,camelKey,undefined);if(data!==undefined)return data;return}camelKey=jQuery.camelCase(key);this.each(function(){var data=dataUser.get(this,camelKey);dataUser.set(this,camelKey,
value);if(key.indexOf("-")>-1&&data!==undefined)dataUser.set(this,key,value)})},null,value,arguments.length>1,null,true)},removeData:function(key){return this.each(function(){dataUser.remove(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=dataPriv.get(elem,type);if(data)if(!queue||jQuery.isArray(data))queue=dataPriv.access(elem,type,jQuery.makeArray(data));else queue.push(data);return queue||[]}},dequeue:function(elem,type){type=type||
"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx")queue.unshift("inprogress");delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks)hooks.empty.fire()},_queueHooks:function(elem,type){var key=type+"queueHooks";return dataPriv.get(elem,key)||dataPriv.access(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){dataPriv.remove(elem,
[type+"queue",key])})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter)return jQuery.queue(this[0],type);return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress")jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||
"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!--count)defer.resolveWith(elements,[elements])};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=dataPriv.get(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source;var rcssNum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$",
"i");var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};function adjustCSS(elem,prop,valueParts,tween){var adjusted,scale=1,maxIterations=20,currentValue=tween?function(){return tween.cur()}:function(){return jQuery.css(elem,prop,"")},initial=currentValue(),unit=valueParts&&valueParts[3]||(jQuery.cssNumber[prop]?"":"px"),initialInUnit=(jQuery.cssNumber[prop]||unit!=="px"&&
+initial)&&rcssNum.exec(jQuery.css(elem,prop));if(initialInUnit&&initialInUnit[3]!==unit){unit=unit||initialInUnit[3];valueParts=valueParts||[];initialInUnit=+initial||1;do{scale=scale||".5";initialInUnit=initialInUnit/scale;jQuery.style(elem,prop,initialInUnit+unit)}while(scale!==(scale=currentValue()/initial)&&scale!==1&&--maxIterations)}if(valueParts){initialInUnit=+initialInUnit||+initial||0;adjusted=valueParts[1]?initialInUnit+(valueParts[1]+1)*valueParts[2]:+valueParts[2];if(tween){tween.unit=
unit;tween.start=initialInUnit;tween.end=adjusted}}return adjusted}var rcheckableType=/^(?:checkbox|radio)$/i;var rtagName=/<([\w:-]+)/;var rscriptType=/^$|\/(?:java|ecma)script/i;var wrapMap={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=
wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var ret=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!=="undefined"?context.querySelectorAll(tag||"*"):[];return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],ret):ret}function setGlobalEval(elems,refElements){var i=0,l=elems.length;for(;i<l;i++)dataPriv.set(elems[i],"globalEval",!refElements||dataPriv.get(refElements[i],
"globalEval"))}var rhtml=/<|&#?\w+;/;function buildFragment(elems,context,scripts,selection,ignored){var elem,tmp,tag,wrap,contains,j,fragment=context.createDocumentFragment(),nodes=[],i=0,l=elems.length;for(;i<l;i++){elem=elems[i];if(elem||elem===0)if(jQuery.type(elem)==="object")jQuery.merge(nodes,elem.nodeType?[elem]:elem);else if(!rhtml.test(elem))nodes.push(context.createTextNode(elem));else{tmp=tmp||fragment.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();
wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+jQuery.htmlPrefilter(elem)+wrap[2];j=wrap[0];while(j--)tmp=tmp.lastChild;jQuery.merge(nodes,tmp.childNodes);tmp=fragment.firstChild;tmp.textContent=""}}fragment.textContent="";i=0;while(elem=nodes[i++]){if(selection&&jQuery.inArray(elem,selection)>-1){if(ignored)ignored.push(elem);continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(fragment.appendChild(elem),"script");if(contains)setGlobalEval(tmp);if(scripts){j=0;while(elem=
tmp[j++])if(rscriptType.test(elem.type||""))scripts.push(elem)}}return fragment}(function(){var fragment=document.createDocumentFragment(),div=fragment.appendChild(document.createElement("div")),input=document.createElement("input");input.setAttribute("type","radio");input.setAttribute("checked","checked");input.setAttribute("name","t");div.appendChild(input);support.checkClone=div.cloneNode(true).cloneNode(true).lastChild.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(true).lastChild.defaultValue})();
var rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,rtypenamespace=/^([^.]*)(?:\.(.+)|)/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}function on(elem,types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types)on(elem,type,selector,data,types[type],one);return elem}if(data==
null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null)if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}if(fn===false)fn=returnFalse;else if(!fn)return elem;if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return elem.each(function(){jQuery.event.add(this,types,fn,data,selector)})}jQuery.event={global:{},add:function(elem,types,handler,
data,selector){var handleObjIn,eventHandle,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.get(elem);if(!elemData)return;if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid)handler.guid=jQuery.guid++;if(!(events=elemData.events))events=elemData.events={};if(!(eventHandle=elemData.handle))eventHandle=elemData.handle=function(e){return typeof jQuery!=="undefined"&&jQuery.event.triggered!==e.type?jQuery.event.dispatch.apply(elem,
arguments):undefined};types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type)continue;special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),
namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false)if(elem.addEventListener)elem.addEventListener(type,eventHandle)}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid)handleObj.handler.guid=handler.guid}if(selector)handlers.splice(handlers.delegateCount++,0,handleObj);else handlers.push(handleObj);jQuery.event.global[type]=
true}},remove:function(elem,types,handler,selector,mappedTypes){var j,origCount,tmp,events,t,handleObj,special,handlers,type,namespaces,origType,elemData=dataPriv.hasData(elem)&&dataPriv.get(elem);if(!elemData||!(events=elemData.events))return;types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,true);
continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,
1);if(handleObj.selector)handlers.delegateCount--;if(special.remove)special.remove.call(elem,handleObj)}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false)jQuery.removeEvent(elem,type,elemData.handle);delete events[type]}}if(jQuery.isEmptyObject(events))dataPriv.remove(elem,"handle events")},dispatch:function(event){event=jQuery.event.fix(event);var i,j,ret,matched,handleObj,handlerQueue=[],args=slice.call(arguments),handlers=(dataPriv.get(this,
"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false)return;handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped())if(!event.rnamespace||event.rnamespace.test(handleObj.namespace)){event.handleObj=
handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined)if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}if(special.postDispatch)special.postDispatch.call(this,event);return event.result},handlers:function(event,handlers){var i,matches,sel,handleObj,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(event.type!=="click"||
isNaN(event.button)||event.button<1))for(;cur!==this;cur=cur.parentNode||this)if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined)matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>-1:jQuery.find(sel,this,null,[cur]).length;if(matches[sel])matches.push(handleObj)}if(matches.length)handlerQueue.push({elem:cur,handlers:matches})}if(delegateCount<handlers.length)handlerQueue.push({elem:this,
handlers:handlers.slice(delegateCount)});return handlerQueue},props:("altKey bubbles cancelable ctrlKey currentTarget detail eventPhase "+"metaKey relatedTarget shiftKey target timeStamp view which").split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null)event.which=original.charCode!=null?original.charCode:original.keyCode;return event}},mouseHooks:{props:("button buttons clientX clientY offsetX offsetY pageX pageY "+"screenX screenY toElement").split(" "),
filter:function(event,original){var eventDoc,doc,body,button=original.button;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.which&&button!==undefined)event.which=
button&1?1:button&2?3:button&4?2:0;return event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook)this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{};copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target)event.target=
document;if(event.target.nodeType===3)event.target=event.target.parentNode;return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){this.focus();return false}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(this.type==="checkbox"&&this.click&&jQuery.nodeName(this,"input")){this.click();
return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined&&event.originalEvent)event.originalEvent.returnValue=event.result}}}};jQuery.removeEvent=function(elem,type,handle){if(elem.removeEventListener)elem.removeEventListener(type,handle)};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=
src.defaultPrevented||src.defaultPrevented===undefined&&src.returnValue===false?returnTrue:returnFalse}else this.type=src;if(props)jQuery.extend(this,props);this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={constructor:jQuery.Event,isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(e)e.preventDefault()},stopPropagation:function(){var e=
this.originalEvent;this.isPropagationStopped=returnTrue;if(e)e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=returnTrue;if(e)e.stopImmediatePropagation();this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,
handleObj=event.handleObj;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});jQuery.fn.extend({on:function(types,selector,data,fn){return on(this,types,selector,data,fn)},one:function(types,selector,data,fn){return on(this,types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?
handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types)this.off(type,selector,types[type]);return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false)fn=returnFalse;return this.each(function(){jQuery.event.remove(this,types,fn,selector)})}});var rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,rnoInnerhtml=/<script|<style|<link/i,
rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(elem.getAttribute("type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=
rscriptTypeMasked.exec(elem.type);if(match)elem.type=match[1];else elem.removeAttribute("type");return elem}function cloneCopyEvent(src,dest){var i,l,type,pdataOld,pdataCur,udataOld,udataCur,events;if(dest.nodeType!==1)return;if(dataPriv.hasData(src)){pdataOld=dataPriv.access(src);pdataCur=dataPriv.set(dest,pdataOld);events=pdataOld.events;if(events){delete pdataCur.handle;pdataCur.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,type,events[type][i])}}if(dataUser.hasData(src)){udataOld=
dataUser.access(src);udataCur=jQuery.extend({},udataOld);dataUser.set(dest,udataCur)}}function fixInput(src,dest){var nodeName=dest.nodeName.toLowerCase();if(nodeName==="input"&&rcheckableType.test(src.type))dest.checked=src.checked;else if(nodeName==="input"||nodeName==="textarea")dest.defaultValue=src.defaultValue}function domManip(collection,args,callback,ignored){args=concat.apply([],args);var fragment,first,scripts,hasScripts,node,doc,i=0,l=collection.length,iNoClone=l-1,value=args[0],isFunction=
jQuery.isFunction(value);if(isFunction||l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))return collection.each(function(index){var self=collection.eq(index);if(isFunction)args[0]=value.call(this,index,self.html());domManip(self,args,callback,ignored)});if(l){fragment=buildFragment(args,collection[0].ownerDocument,false,collection,ignored);first=fragment.firstChild;if(fragment.childNodes.length===1)fragment=first;if(first||ignored){scripts=jQuery.map(getAll(fragment,"script"),
disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts)jQuery.merge(scripts,getAll(node,"script"))}callback.call(collection[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!dataPriv.access(node,"globalEval")&&jQuery.contains(doc,node))if(node.src){if(jQuery._evalUrl)jQuery._evalUrl(node.src)}else jQuery.globalEval(node.textContent.replace(rcleanScript,
""))}}}}return collection}function remove(elem,selector,keepData){var node,nodes=selector?jQuery.filter(selector,elem):elem,i=0;for(;(node=nodes[i])!=null;i++){if(!keepData&&node.nodeType===1)jQuery.cleanData(getAll(node));if(node.parentNode){if(keepData&&jQuery.contains(node.ownerDocument,node))setGlobalEval(getAll(node,"script"));node.parentNode.removeChild(node)}}return elem}jQuery.extend({htmlPrefilter:function(html){return html.replace(rxhtmlTag,"<$1></$2>")},clone:function(elem,dataAndEvents,
deepDataAndEvents){var i,l,srcElements,destElements,clone=elem.cloneNode(true),inPage=jQuery.contains(elem.ownerDocument,elem);if(!support.noCloneChecked&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0,l=srcElements.length;i<l;i++)fixInput(srcElements[i],destElements[i])}if(dataAndEvents)if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0,l=srcElements.length;i<l;i++)cloneCopyEvent(srcElements[i],
destElements[i])}else cloneCopyEvent(elem,clone);destElements=getAll(clone,"script");if(destElements.length>0)setGlobalEval(destElements,!inPage&&getAll(elem,"script"));return clone},cleanData:function(elems){var data,elem,type,special=jQuery.event.special,i=0;for(;(elem=elems[i])!==undefined;i++)if(acceptData(elem)){if(data=elem[dataPriv.expando]){if(data.events)for(type in data.events)if(special[type])jQuery.event.remove(elem,type);else jQuery.removeEvent(elem,type,data.handle);elem[dataPriv.expando]=
undefined}if(elem[dataUser.expando])elem[dataUser.expando]=undefined}}});jQuery.fn.extend({domManip:domManip,detach:function(selector){return remove(this,selector,true)},remove:function(selector){return remove(this,selector)},text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().each(function(){if(this.nodeType===1||this.nodeType===11||this.nodeType===9)this.textContent=value})},null,value,arguments.length)},append:function(){return domManip(this,
arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return domManip(this,arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return domManip(this,arguments,function(elem){if(this.parentNode)this.parentNode.insertBefore(elem,this)})},after:function(){return domManip(this,
arguments,function(elem){if(this.parentNode)this.parentNode.insertBefore(elem,this.nextSibling)})},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++)if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.textContent=""}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},
html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined&&elem.nodeType===1)return elem.innerHTML;if(typeof value==="string"&&!rnoInnerhtml.test(value)&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=jQuery.htmlPrefilter(value);try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem)this.empty().append(value)},null,value,arguments.length)},
replaceWith:function(){var ignored=[];return domManip(this,arguments,function(elem){var parent=this.parentNode;if(jQuery.inArray(this,ignored)<0){jQuery.cleanData(getAll(this));if(parent)parent.replaceChild(elem,this)}},ignored)}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,ret=[],insert=jQuery(selector),last=insert.length-1,i=0;for(;i<=last;i++){elems=i===
last?this:this.clone(true);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}return this.pushStack(ret)}});var iframe,elemdisplay={HTML:"block",BODY:"block"};function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.detach();return display}function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||
jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=iframe[0].contentDocument;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}var rmargin=/^margin/;var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles=function(elem){var view=elem.ownerDocument.defaultView;if(!view||!view.opener)view=window;return view.getComputedStyle(elem)};var swap=function(elem,options,callback,args){var ret,
name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options)elem.style[name]=old[name];return ret};var documentElement=document.documentElement;(function(){var pixelPositionVal,boxSizingReliableVal,pixelMarginRightVal,reliableMarginLeftVal,container=document.createElement("div"),div=document.createElement("div");if(!div.style)return;div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";
support.clearCloneStyle=div.style.backgroundClip==="content-box";container.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;"+"padding:0;margin-top:1px;position:absolute";container.appendChild(div);function computeStyleTests(){div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;"+"position:relative;display:block;"+"margin:auto;border:1px;padding:1px;"+"top:1%;width:50%";div.innerHTML="";documentElement.appendChild(container);var divStyle=
window.getComputedStyle(div);pixelPositionVal=divStyle.top!=="1%";reliableMarginLeftVal=divStyle.marginLeft==="2px";boxSizingReliableVal=divStyle.width==="4px";div.style.marginRight="50%";pixelMarginRightVal=divStyle.marginRight==="4px";documentElement.removeChild(container)}jQuery.extend(support,{pixelPosition:function(){computeStyleTests();return pixelPositionVal},boxSizingReliable:function(){if(boxSizingReliableVal==null)computeStyleTests();return boxSizingReliableVal},pixelMarginRight:function(){if(boxSizingReliableVal==
null)computeStyleTests();return pixelMarginRightVal},reliableMarginLeft:function(){if(boxSizingReliableVal==null)computeStyleTests();return reliableMarginLeftVal},reliableMarginRight:function(){var ret,marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText="-webkit-box-sizing:content-box;box-sizing:content-box;"+"display:block;margin:0;border:0;padding:0";marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";documentElement.appendChild(container);
ret=!parseFloat(window.getComputedStyle(marginDiv).marginRight);documentElement.removeChild(container);div.removeChild(marginDiv);return ret}})})();function curCSS(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;if((ret===""||ret===undefined)&&!jQuery.contains(elem.ownerDocument,elem))ret=jQuery.style(elem,name);if(computed)if(!support.pixelMarginRight()&&rnumnonpx.test(ret)&&
rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}return ret!==undefined?ret+"":ret}function addGetHookIf(conditionFn,hookFn){return{get:function(){if(conditionFn()){delete this.get;return}return(this.get=hookFn).apply(this,arguments)}}}var rdisplayswap=/^(none|table(?!-c[ea]).+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},
cssNormalTransform={letterSpacing:"0",fontWeight:"400"},cssPrefixes=["Webkit","O","Moz","ms"],emptyStyle=document.createElement("div").style;function vendorPropName(name){if(name in emptyStyle)return name;var capName=name[0].toUpperCase()+name.slice(1),i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in emptyStyle)return name}}function setPositiveNumber(elem,value,subtract){var matches=rcssNum.exec(value);return matches?Math.max(0,matches[2]-(subtract||0))+(matches[3]||"px"):value}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin")val+=jQuery.css(elem,extra+cssExpand[i],true,styles);if(isBorderBox){if(extra==="content")val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="margin")val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding")val+=jQuery.css(elem,
"border"+cssExpand[i]+"Width",true,styles)}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(document.msFullscreenElement&&window.top!==window)if(elem.getClientRects().length)val=Math.round(elem.getBoundingClientRect()[name]*100);if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null)val=elem.style[name];
if(rnumnonpx.test(val))return val;valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}return val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles)+"px"}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style)continue;values[index]=dataPriv.get(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&
display==="none")elem.style.display="";if(elem.style.display===""&&isHidden(elem))values[index]=dataPriv.access(elem,"olddisplay",defaultDisplay(elem.nodeName))}else{hidden=isHidden(elem);if(display!=="none"||!hidden)dataPriv.set(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style)continue;if(!show||elem.style.display==="none"||elem.style.display==="")elem.style.display=show?values[index]||"":"none"}return elements}jQuery.extend({cssHooks:{opacity:{get:function(elem,
computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{"animationIterationCount":true,"columnCount":true,"fillOpacity":true,"flexGrow":true,"flexShrink":true,"fontWeight":true,"lineHeight":true,"opacity":true,"order":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":"cssFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style)return;var ret,type,hooks,origName=jQuery.camelCase(name),
style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName);hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rcssNum.exec(value))&&ret[1]){value=adjustCSS(elem,name,ret);type="number"}if(value==null||value!==value)return;if(type==="number")value+=ret&&ret[3]||(jQuery.cssNumber[origName]?"":"px");if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0)style[name]=
"inherit";if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value,extra))!==undefined)style[name]=value}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined)return ret;return style[name]}},css:function(elem,name,extra,styles){var val,num,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(origName)||origName);hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get"in hooks)val=hooks.get(elem,true,extra);
if(val===undefined)val=curCSS(elem,name,styles);if(val==="normal"&&name in cssNormalTransform)val=cssNormalTransform[name];if(extra===""||extra){num=parseFloat(val);return extra===true||isFinite(num)?num||0:val}return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed)return rdisplayswap.test(jQuery.css(elem,"display"))&&elem.offsetWidth===0?swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,
name,extra)},set:function(elem,value,extra){var matches,styles=extra&&getStyles(elem),subtract=extra&&augmentWidthOrHeight(elem,name,extra,jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles);if(subtract&&(matches=rcssNum.exec(value))&&(matches[3]||"px")!=="px"){elem.style[name]=value;value=jQuery.css(elem,name)}return setPositiveNumber(elem,value,subtract)}}});jQuery.cssHooks.marginLeft=addGetHookIf(support.reliableMarginLeft,function(elem,computed){if(computed)return(parseFloat(curCSS(elem,
"marginLeft"))||elem.getBoundingClientRect().left-swap(elem,{marginLeft:0},function(){return elem.getBoundingClientRect().left}))+"px"});jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed)return swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"])});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):
[value];for(;i<4;i++)expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0];return expanded}};if(!rmargin.test(prefix))jQuery.cssHooks[prefix+suffix].set=setPositiveNumber});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++)map[name[i]]=jQuery.css(elem,name[i],false,styles);return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,
name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean")return state?this.show():this.hide();return this.each(function(){if(isHidden(this))jQuery(this).show();else jQuery(this).hide()})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,
easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||jQuery.easing._default;this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration)this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,
1,this.options.duration);else this.pos=eased=percent;this.now=(this.end-this.start)*eased+this.start;if(this.options.step)this.options.step.call(this.elem,this.now,this);if(hooks&&hooks.set)hooks.set(this);else Tween.propHooks._default.set(this);return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem.nodeType!==1||tween.elem[tween.prop]!=null&&tween.elem.style[tween.prop]==null)return tween.elem[tween.prop];result=jQuery.css(tween.elem,
tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop])jQuery.fx.step[tween.prop](tween);else if(tween.elem.nodeType===1&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop]))jQuery.style(tween.elem,tween.prop,tween.now+tween.unit);else tween.elem[tween.prop]=tween.now}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode)tween.elem[tween.prop]=tween.now}};
jQuery.easing={linear:function(p){return p},swing:function(p){return.5-Math.cos(p*Math.PI)/2},_default:"swing"};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rrun=/queueHooks$/;function createFxNow(){window.setTimeout(function(){fxNow=undefined});return fxNow=jQuery.now()}function genFx(type,includeWidth){var which,i=0,attrs={height:type};includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+
which]=type}if(includeWidth)attrs.opacity=attrs.width=type;return attrs}function createTween(value,prop,animation){var tween,collection=(Animation.tweeners[prop]||[]).concat(Animation.tweeners["*"]),index=0,length=collection.length;for(;index<length;index++)if(tween=collection[index].call(animation,prop,value))return tween}function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,checkDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),
dataShow=dataPriv.get(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued)oldfire()}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length)hooks.empty.fire()})})}if(elem.nodeType===1&&("height"in props||"width"in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");
checkDisplay=display==="none"?dataPriv.get(elem,"olddisplay")||defaultDisplay(elem.nodeName):display;if(checkDisplay==="inline"&&jQuery.css(elem,"float")==="none")style.display="inline-block"}if(opts.overflow){style.overflow="hidden";anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show"))if(value===
"show"&&dataShow&&dataShow[prop]!==undefined)hidden=true;else continue;orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}else display=undefined}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden"in dataShow)hidden=dataShow.hidden}else dataShow=dataPriv.access(elem,"fxshow",{});if(toggle)dataShow.hidden=!hidden;if(hidden)jQuery(elem).show();else anim.done(function(){jQuery(elem).hide()});anim.done(function(){var prop;dataPriv.remove(elem,"fxshow");for(prop in orig)jQuery.style(elem,
prop,orig[prop])});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}else if((display==="none"?defaultDisplay(elem.nodeName):display)==="inline")style.display=display}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=
value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand"in hooks){value=hooks.expand(value);delete props[name];for(index in value)if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}else specialEasing[name]=easing}}function Animation(elem,properties,options){var result,stopped,index=0,length=Animation.prefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped)return false;
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++)animation.tweens[index].run(percent);deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length)return remaining;else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,
{specialEasing:{},easing:jQuery.easing._default},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped)return this;stopped=true;for(;index<length;index++)animation.tweens[index].run(1);
if(gotoEnd){deferred.notifyWith(elem,[animation,1,0]);deferred.resolveWith(elem,[animation,gotoEnd])}else deferred.rejectWith(elem,[animation,gotoEnd]);return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=Animation.prefilters[index].call(animation,elem,props,animation.opts);if(result){if(jQuery.isFunction(result.stop))jQuery._queueHooks(animation.elem,animation.opts.queue).stop=jQuery.proxy(result.stop,result);return result}}jQuery.map(props,
createTween,animation);if(jQuery.isFunction(animation.opts.start))animation.opts.start.call(elem,animation);jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}jQuery.Animation=jQuery.extend(Animation,{tweeners:{"*":[function(prop,value){var tween=this.createTween(prop,value);adjustCSS(tween.elem,prop,rcssNum.exec(value),
tween);return tween}]},tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else props=props.match(rnotwhite);var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];Animation.tweeners[prop]=Animation.tweeners[prop]||[];Animation.tweeners[prop].unshift(callback)}},prefilters:[defaultPrefilter],prefilter:function(callback,prepend){if(prepend)Animation.prefilters.unshift(callback);else Animation.prefilters.push(callback)}});jQuery.speed=
function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true)opt.queue="fx";opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old))opt.old.call(this);
if(opt.queue)jQuery.dequeue(this,opt.queue)};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||dataPriv.get(this,"finish"))anim.stop(true)};doAnimation.finish=doAnimation;
return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false)this.queue(type||"fx",[]);return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=dataPriv.get(this);if(index){if(data[index]&&
data[index].stop)stopQueue(data[index])}else for(index in data)if(data[index]&&data[index].stop&&rrun.test(index))stopQueue(data[index]);for(index=timers.length;index--;)if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}if(dequeue||!gotoEnd)jQuery.dequeue(this,type)})},finish:function(type){if(type!==false)type=type||"fx";return this.each(function(){var index,data=dataPriv.get(this),queue=data[type+"queue"],
hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop)hooks.stop.call(this,true);for(index=timers.length;index--;)if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}for(index=0;index<length;index++)if(queue[index]&&queue[index].finish)queue[index].finish.call(this);delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=
jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=
function(){var timer,i=0,timers=jQuery.timers;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer)timers.splice(i--,1)}if(!timers.length)jQuery.fx.stop();fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer())jQuery.fx.start();else jQuery.timers.pop()};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId)timerId=window.setInterval(jQuery.fx.tick,jQuery.fx.interval)};jQuery.fx.stop=function(){window.clearInterval(timerId);
timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=window.setTimeout(next,time);hooks.stop=function(){window.clearTimeout(timeout)}})};(function(){var input=document.createElement("input"),select=document.createElement("select"),opt=select.appendChild(document.createElement("option"));input.type="checkbox";support.checkOn=input.value!==
"";support.optSelected=opt.selected;select.disabled=true;support.optDisabled=!opt.disabled;input=document.createElement("input");input.value="t";input.type="radio";support.radioValue=input.value==="t"})();var boolHook,attrHandle=jQuery.expr.attrHandle;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var ret,
hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2)return;if(typeof elem.getAttribute==="undefined")return jQuery.prop(elem,name,value);if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:undefined)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name);return}if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined)return ret;elem.setAttribute(name,value+"");return value}if(hooks&&
"get"in hooks&&(ret=hooks.get(elem,name))!==null)return ret;ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val)elem.value=val;return value}}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1)while(name=attrNames[i++]){propName=jQuery.propFix[name]||
name;if(jQuery.expr.match.bool.test(name))elem[propName]=false;elem.removeAttribute(name)}}});boolHook={set:function(elem,value,name){if(value===false)jQuery.removeAttr(elem,name);else elem.setAttribute(name,name);return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():
null;attrHandle[name]=handle}return ret}});var rfocusable=/^(?:input|select|textarea|button)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){return this.each(function(){delete this[jQuery.propFix[name]||name]})}});jQuery.extend({prop:function(elem,name,value){var ret,hooks,nType=elem.nodeType;if(nType===3||nType===8||nType===2)return;if(nType!==1||!jQuery.isXMLDoc(elem)){name=jQuery.propFix[name]||
name;hooks=jQuery.propHooks[name]}if(value!==undefined){if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined)return ret;return elem[name]=value}if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null)return ret;return elem[name]},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}});
if(!support.optSelected)jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent&&parent.parentNode)parent.parentNode.selectedIndex;return null}};jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});var rclass=/[\t\r\n\f]/g;function getClass(elem){return elem.getAttribute&&elem.getAttribute("class")||""}jQuery.fn.extend({addClass:function(value){var classes,
elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,getClass(this)))});if(typeof value==="string"&&value){classes=value.match(rnotwhite)||[];while(elem=this[i++]){curValue=getClass(elem);cur=elem.nodeType===1&&(" "+curValue+" ").replace(rclass," ");if(cur){j=0;while(clazz=classes[j++])if(cur.indexOf(" "+clazz+" ")<0)cur+=clazz+" ";finalValue=jQuery.trim(cur);if(curValue!==finalValue)elem.setAttribute("class",finalValue)}}}return this},
removeClass:function(value){var classes,elem,cur,curValue,clazz,j,finalValue,i=0;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,getClass(this)))});if(!arguments.length)return this.attr("class","");if(typeof value==="string"&&value){classes=value.match(rnotwhite)||[];while(elem=this[i++]){curValue=getClass(elem);cur=elem.nodeType===1&&(" "+curValue+" ").replace(rclass," ");if(cur){j=0;while(clazz=classes[j++])while(cur.indexOf(" "+clazz+" ")>-1)cur=
cur.replace(" "+clazz+" "," ");finalValue=jQuery.trim(cur);if(curValue!==finalValue)elem.setAttribute("class",finalValue)}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string")return stateVal?this.addClass(value):this.removeClass(value);if(jQuery.isFunction(value))return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,getClass(this),stateVal),stateVal)});return this.each(function(){var className,i,self,classNames;
if(type==="string"){i=0;self=jQuery(this);classNames=value.match(rnotwhite)||[];while(className=classNames[i++])if(self.hasClass(className))self.removeClass(className);else self.addClass(className)}else if(value===undefined||type==="boolean"){className=getClass(this);if(className)dataPriv.set(this,"__className__",className);if(this.setAttribute)this.setAttribute("class",className||value===false?"":dataPriv.get(this,"__className__")||"")}})},hasClass:function(selector){var className,elem,i=0;className=
" "+selector+" ";while(elem=this[i++])if(elem.nodeType===1&&(" "+getClass(elem)+" ").replace(rclass," ").indexOf(className)>-1)return true;return false}});var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined)return ret;ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,
""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1)return;if(isFunction)val=value.call(this,i,jQuery(this).val());else val=value;if(val==null)val="";else if(typeof val==="number")val+="";else if(jQuery.isArray(val))val=jQuery.map(val,function(value){return value==null?"":value+""});hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined)this.value=
val})}});jQuery.extend({valHooks:{option:{get:function(elem){return jQuery.trim(elem.value)}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,
"optgroup"))){value=jQuery(option).val();if(one)return value;values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(option.selected=jQuery.inArray(jQuery.valHooks.option.get(option),values)>-1)optionSet=true}if(!optionSet)elem.selectedIndex=-1;return values}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value))return elem.checked=
jQuery.inArray(jQuery(elem).val(),value)>-1}};if(!support.checkOn)jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}});var rfocusMorph=/^(?:focusinfocus|focusoutblur)$/;jQuery.extend(jQuery.event,{trigger:function(event,data,elem,onlyHandlers){var i,cur,tmp,bubbleType,ontype,handle,special,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||
document;if(elem.nodeType===3||elem.nodeType===8)return;if(rfocusMorph.test(type+jQuery.event.triggered))return;if(type.indexOf(".")>-1){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.rnamespace=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
event.result=undefined;if(!event.target)event.target=elem;data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false)return;if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type))cur=cur.parentNode;for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document))eventPath.push(tmp.defaultView||
tmp.parentWindow||window)}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(dataPriv.get(cur,"events")||{})[event.type]&&dataPriv.get(cur,"handle");if(handle)handle.apply(cur,data);handle=ontype&&cur[ontype];if(handle&&handle.apply&&acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===false)event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented())if((!special._default||special._default.apply(eventPath.pop(),
data)===false)&&acceptData(elem))if(ontype&&jQuery.isFunction(elem[type])&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp)elem[ontype]=null;jQuery.event.triggered=type;elem[type]();jQuery.event.triggered=undefined;if(tmp)elem[ontype]=tmp}return event.result},simulate:function(type,elem,event){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true});jQuery.event.trigger(e,null,elem);if(e.isDefaultPrevented())event.preventDefault()}});jQuery.fn.extend({trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,
data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem)return jQuery.event.trigger(type,data,elem,true)}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,
fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});support.focusin="onfocusin"in window;if(!support.focusin)jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event))};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=dataPriv.access(doc,fix);if(!attaches)doc.addEventListener(orig,handler,true);dataPriv.access(doc,fix,(attaches||0)+1)},teardown:function(){var doc=
this.ownerDocument||this,attaches=dataPriv.access(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,true);dataPriv.remove(doc,fix)}else dataPriv.access(doc,fix,attaches)}}});var location=window.location;var nonce=jQuery.now();var rquery=/\?/;jQuery.parseJSON=function(data){return JSON.parse(data+"")};jQuery.parseXML=function(data){var xml;if(!data||typeof data!=="string")return null;try{xml=(new window.DOMParser).parseFromString(data,"text/xml")}catch(e){xml=undefined}if(!xml||xml.getElementsByTagName("parsererror").length)jQuery.error("Invalid XML: "+
data);return xml};var rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,prefilters={},transports={},allTypes="*/".concat("*"),originAnchor=document.createElement("a");originAnchor.href=location.href;function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression=
"*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func))while(dataType=dataTypes[i++])if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else(structure[dataType]=structure[dataType]||[]).push(func)}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=structure===transports;function inspect(dataType){var selected;inspected[dataType]=
true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else if(seekingTransport)return!(selected=dataTypeOrTransport)});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,
src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)if(src[key]!==undefined)(flatOptions[key]?target:deep||(deep={}))[key]=src[key];if(deep)jQuery.extend(true,target,deep);return target}function ajaxHandleResponses(s,jqXHR,responses){var ct,type,finalDataType,firstDataType,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined)ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}if(ct)for(type in contents)if(contents[type]&&
contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType)firstDataType=type}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0])dataTypes.unshift(finalDataType);return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters=
{},dataTypes=s.dataTypes.slice();if(dataTypes[1])for(conv in s.converters)converters[conv.toLowerCase()]=s.converters[conv];current=dataTypes.shift();while(current){if(s.responseFields[current])jqXHR[s.responseFields[current]]=response;if(!prev&&isSuccess&&s.dataFilter)response=s.dataFilter(response,s.dataType);prev=current;current=dataTypes.shift();if(current)if(current==="*")current=prev;else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv)for(conv2 in converters){tmp=
conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true)conv=converters[conv2];else if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}break}}}if(conv!==true)if(conv&&s["throws"])response=conv(response);else try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}return{state:"success",data:response}}jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:location.href,
type:"GET",isLocal:rlocalProtocol.test(location.protocol),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},
flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var transport,cacheURL,responseHeadersString,responseHeaders,timeoutTimer,urlAnchor,fireGlobals,i,s=jQuery.ajaxSetup({},
options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString))responseHeaders[match[1].toLowerCase()]=
match[2]}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state)s.mimeType=type;return this},statusCode:function(map){var code;if(map)if(state<2)for(code in map)statusCode[code]=[statusCode[code],
map[code]];else jqXHR.always(map[jqXHR.status]);return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport)transport.abort(finalText);done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||location.href)+"").replace(rhash,"").replace(rprotocol,location.protocol+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||
[""];if(s.crossDomain==null){urlAnchor=document.createElement("a");try{urlAnchor.href=s.url;urlAnchor.href=urlAnchor.href;s.crossDomain=originAnchor.protocol+"//"+originAnchor.host!==urlAnchor.protocol+"//"+urlAnchor.host}catch(e){s.crossDomain=true}}if(s.data&&s.processData&&typeof s.data!=="string")s.data=jQuery.param(s.data,s.traditional);inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2)return jqXHR;fireGlobals=jQuery.event&&s.global;if(fireGlobals&&jQuery.active++===0)jQuery.event.trigger("ajaxStart");
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=s.url+=(rquery.test(cacheURL)?"&":"?")+s.data;delete s.data}if(s.cache===false)s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}if(s.ifModified){if(jQuery.lastModified[cacheURL])jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL]);if(jQuery.etag[cacheURL])jqXHR.setRequestHeader("If-None-Match",
jQuery.etag[cacheURL])}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType)jqXHR.setRequestHeader("Content-Type",s.contentType);jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2))return jqXHR.abort();strAbort="abort";for(i in{success:1,
error:1,complete:1})jqXHR[i](s[i]);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport)done(-1,"No Transport");else{jqXHR.readyState=1;if(fireGlobals)globalEventContext.trigger("ajaxSend",[jqXHR,s]);if(state===2)return jqXHR;if(s.async&&s.timeout>0)timeoutTimer=window.setTimeout(function(){jqXHR.abort("timeout")},s.timeout);try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2)done(-1,e);else throw e;}}function done(status,nativeStatusText,responses,headers){var isSuccess,
success,error,response,modified,statusText=nativeStatusText;if(state===2)return;state=2;if(timeoutTimer)window.clearTimeout(timeoutTimer);transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses)response=ajaxHandleResponses(s,jqXHR,responses);response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified)jQuery.lastModified[cacheURL]=
modified;modified=jqXHR.getResponseHeader("etag");if(modified)jQuery.etag[cacheURL]=modified}if(status===204||s.type==="HEAD")statusText="nocontent";else if(status===304)statusText="notmodified";else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0)status=0}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess)deferred.resolveWith(callbackContext,[success,
statusText,jqXHR]);else deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals)globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error]);completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active)jQuery.event.trigger("ajaxStop")}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,
data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax(jQuery.extend({url:url,type:method,dataType:type,data:data,success:callback},jQuery.isPlainObject(url)&&url))}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,
global:false,"throws":true})};jQuery.fn.extend({wrapAll:function(html){var wrap;if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode)wrap.insertBefore(this[0]);wrap.map(function(){var elem=this;while(elem.firstElementChild)elem=elem.firstElementChild;return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapInner(html.call(this,
i))});return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length)contents.wrapAll(html);else self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body"))jQuery(this).replaceWith(this.childNodes)}).end()}});jQuery.expr.filters.hidden=function(elem){return!jQuery.expr.filters.visible(elem)};
jQuery.expr.filters.visible=function(elem){return elem.offsetWidth>0||elem.offsetHeight>0||elem.getClientRects().length>0};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix))add(prefix,v);else buildParams(prefix+"["+(typeof v==="object"&&v!=null?i:"")+
"]",v,traditional,add)});else if(!traditional&&jQuery.type(obj)==="object")for(name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add);else add(prefix,obj)}jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value==null?"":value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined)traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional;if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,
function(){add(this.name,this.value)});else for(prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&
(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(e){}};var xhrSuccessStatus={0:200,1223:204},xhrSupported=jQuery.ajaxSettings.xhr();support.cors=!!xhrSupported&&"withCredentials"in xhrSupported;
support.ajax=xhrSupported=!!xhrSupported;jQuery.ajaxTransport(function(options){var callback,errorCallback;if(support.cors||xhrSupported&&!options.crossDomain)return{send:function(headers,complete){var i,xhr=options.xhr();xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields)for(i in options.xhrFields)xhr[i]=options.xhrFields[i];if(options.mimeType&&xhr.overrideMimeType)xhr.overrideMimeType(options.mimeType);if(!options.crossDomain&&!headers["X-Requested-With"])headers["X-Requested-With"]=
"XMLHttpRequest";for(i in headers)xhr.setRequestHeader(i,headers[i]);callback=function(type){return function(){if(callback){callback=errorCallback=xhr.onload=xhr.onerror=xhr.onabort=xhr.onreadystatechange=null;if(type==="abort")xhr.abort();else if(type==="error")if(typeof xhr.status!=="number")complete(0,"error");else complete(xhr.status,xhr.statusText);else complete(xhrSuccessStatus[xhr.status]||xhr.status,xhr.statusText,(xhr.responseType||"text")!=="text"||typeof xhr.responseText!=="string"?{binary:xhr.response}:
{text:xhr.responseText},xhr.getAllResponseHeaders())}}};xhr.onload=callback();errorCallback=xhr.onerror=callback("error");if(xhr.onabort!==undefined)xhr.onabort=errorCallback;else xhr.onreadystatechange=function(){if(xhr.readyState===4)window.setTimeout(function(){if(callback)errorCallback()})};callback=callback("abort");try{xhr.send(options.hasContent&&options.data||null)}catch(e){if(callback)throw e;}},abort:function(){if(callback)callback()}}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, "+
"application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined)s.cache=false;if(s.crossDomain)s.type="GET"});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,callback;return{send:function(_,complete){script=jQuery("<script>").prop({charset:s.scriptCharset,src:s.url}).on("load error",callback=function(evt){script.remove();
callback=null;if(evt)complete(evt.type==="error"?404:200,evt.type)});document.head.appendChild(script[0])},abort:function(){if(callback)callback()}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||jQuery.expando+"_"+nonce++;this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?
"url":typeof s.data==="string"&&(s.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp)s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName);else if(s.jsonp!==false)s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName;s.converters["script json"]=function(){if(!responseContainer)jQuery.error(callbackName+
" was not called");return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){if(overwritten===undefined)jQuery(window).removeProp(callbackName);else window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten))overwritten(responseContainer[0]);responseContainer=overwritten=
undefined});return"script"}});support.createHTMLDocument=function(){var body=document.implementation.createHTMLDocument("").body;body.innerHTML="<form></form><form></form>";return body.childNodes.length===2}();jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string")return null;if(typeof context==="boolean"){keepScripts=context;context=false}context=context||(support.createHTMLDocument?document.implementation.createHTMLDocument(""):document);var parsed=rsingleTag.exec(data),
scripts=!keepScripts&&[];if(parsed)return[context.createElement(parsed[1])];parsed=buildFragment([data],context,scripts);if(scripts&&scripts.length)jQuery(scripts).remove();return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load)return _load.apply(this,arguments);var selector,type,response,self=this,off=url.indexOf(" ");if(off>-1){selector=jQuery.trim(url.slice(off));url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=
params;params=undefined}else if(params&&typeof params==="object")type="POST";if(self.length>0)jQuery.ajax({url:url,type:type||"GET",dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).always(callback&&function(jqXHR,status){self.each(function(){callback.apply(self,response||[jqXHR.responseText,status,jqXHR])})});return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete",
"ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView}jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=
jQuery(elem),props={};if(position==="static")elem.style.position="relative";curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&(curCSSTop+curCSSLeft).indexOf("auto")>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options))options=options.call(elem,
i,jQuery.extend({},curOffset));if(options.top!=null)props.top=options.top-curOffset.top+curTop;if(options.left!=null)props.left=options.left-curOffset.left+curLeft;if("using"in options)options.using.call(elem,props);else curElem.css(props)}};jQuery.fn.extend({offset:function(options){if(arguments.length)return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)});var docElem,win,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(!doc)return;docElem=
doc.documentElement;if(!jQuery.contains(docElem,elem))return box;box=elem.getBoundingClientRect();win=getWindow(doc);return{top:box.top+win.pageYOffset-docElem.clientTop,left:box.left+win.pageXOffset-docElem.clientLeft}},position:function(){if(!this[0])return;var offsetParent,offset,elem=this[0],parentOffset={top:0,left:0};if(jQuery.css(elem,"position")==="fixed")offset=elem.getBoundingClientRect();else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html"))parentOffset=
offsetParent.offset();parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent;while(offsetParent&&jQuery.css(offsetParent,"position")==="static")offsetParent=offsetParent.offsetParent;return offsetParent||
documentElement})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top="pageYOffset"===prop;jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined)return win?win[prop]:elem[method];if(win)win.scrollTo(!top?val:win.pageXOffset,top?val:win.pageYOffset);else elem[method]=val},method,val,arguments.length)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,
function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return access(this,
function(elem,type,value){var doc;if(jQuery.isWindow(elem))return elem.document.documentElement["client"+name];if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.extend({bind:function(types,data,fn){return this.on(types,null,data,
fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)},size:function(){return this.length}});jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof define==="function"&&define.amd)define("jquery",[],function(){return jQuery});var _jQuery=window.jQuery,_$=window.$;jQuery.noConflict=function(deep){if(window.$===
jQuery)window.$=_$;if(deep&&window.jQuery===jQuery)window.jQuery=_jQuery;return jQuery};if(!noGlobal)window.jQuery=window.$=jQuery;return jQuery});function atvImg(){var d=document,de=d.documentElement,bd=d.getElementsByTagName("body")[0],win=window,imgs=d.querySelectorAll(".atvImg"),totalImgs=imgs.length,supportsTouch="ontouchstart"in win||navigator.msMaxTouchPoints,thresholds=true,offsetThreshold=.6,angleThreshold=140;if(totalImgs<=0)return;for(var l=0;l<totalImgs;l++){var thisImg=imgs[l],layerElems=thisImg.querySelectorAll(".atvImg-layer"),totalLayerElems=layerElems.length;if(totalLayerElems<=0)continue;while(thisImg.firstChild)thisImg.removeChild(thisImg.firstChild);
var containerHTML=d.createElement("div"),shineHTML=d.createElement("div"),shadowHTML=d.createElement("div"),layersHTML=d.createElement("div"),layers=[];thisImg.id="atvImg__"+l;containerHTML.className="atvImg-container";shineHTML.className="atvImg-shine";shadowHTML.className="atvImg-shadow";layersHTML.className="atvImg-layers";for(var i=0;i<totalLayerElems;i++){var layer=d.createElement("div");if(layerElems[i].getAttribute("data-text")==="true"){var elSrc=layerElems[i].innerHTML;layer.innerHTML=elSrc}else{var imgSrc=
layerElems[i].getAttribute("data-img");layer.style.backgroundImage="url("+imgSrc+")"}layer.className="atvImg-rendered-layer";layer.setAttribute("data-layer",i);layersHTML.appendChild(layer);if(layerElems[i].classList.length>1)for(var k=0;k<layerElems[i].classList.length;k++)if(layerElems[i].classList[k]!=="atvImg-layer")layer.classList.add(layerElems[i].classList[k]);layers.push(layer)}containerHTML.appendChild(shadowHTML);containerHTML.appendChild(layersHTML);containerHTML.appendChild(shineHTML);
thisImg.appendChild(containerHTML);var w=thisImg.clientWidth||thisImg.offsetWidth||thisImg.scrollWidth;thisImg.style.webkitTransform="perspective("+w*3+"px)";thisImg.style.transform="perspective("+w*3+"px)";if(supportsTouch){win.preventScroll=false;(function(_thisImg,_layers,_totalLayers,_shine){thisImg.addEventListener("touchmove",function(e){if(win.preventScroll)e.preventDefault();processMovement(e,true,_thisImg,_layers,_totalLayers,_shine)});thisImg.addEventListener("touchstart",function(e){win.preventScroll=
false;for(var h=0;h<totalImgs;h++)imgs[h].firstChild.classList.remove("over");processEnter(e,_thisImg)});thisImg.addEventListener("touchend",function(e){win.preventScroll=false;processExit(e,_thisImg,_layers,_totalLayers,_shine)})})(thisImg,layers,totalLayerElems,shineHTML)}else(function(_thisImg,_layers,_totalLayers,_shine){thisImg.addEventListener("mousemove",function(e){processMovement(e,false,_thisImg,_layers,_totalLayers,_shine)});thisImg.addEventListener("mouseenter",function(e){processEnter(e,
_thisImg)});thisImg.addEventListener("mouseleave",function(e){processExit(e,_thisImg,_layers,_totalLayers,_shine)})})(thisImg,layers,totalLayerElems,shineHTML)}window.addEventListener("contextmenu",function(event){for(var l=0;l<totalImgs;l++)imgs[l].firstChild.classList.remove("over")},false);function getSign(number){return number>0?1:number===0?0:-1}function processMovement(e,touchEnabled,elem,layers,totalLayers,shine){var bdst=f_scrollTop(),bdsl=f_scrollLeft(),pageX=touchEnabled?e.touches[0].pageX:
e.pageX,pageY=touchEnabled?e.touches[0].pageY:e.pageY,offsets=elem.getBoundingClientRect(),w=elem.clientWidth||elem.offsetWidth||elem.scrollWidth,h=elem.clientHeight||elem.offsetHeight||elem.scrollHeight,wMultiple=160/w,offsetX=.52-(pageX-offsets.left-bdsl)/w,offsetY=.52-(pageY-offsets.top-bdst)/h,dy=pageY-offsets.top-bdst-h/2,dx=pageX-offsets.left-bdsl-w/2;if(thresholds){offsetX=Math.abs(offsetX)>offsetThreshold?offsetThreshold*getSign(offsetX):offsetX;offsetY=Math.abs(offsetY)>offsetThreshold?offsetThreshold*
getSign(offsetY):offsetY;dx=Math.abs(dx)>angleThreshold?angleThreshold*getSign(dx):dx;dy=Math.abs(dy)>angleThreshold?angleThreshold*getSign(dy):dy}var yRotate=(offsetX-dx)*(.07*wMultiple),xRotate=(dy-offsetY)*(.1*wMultiple),imgCSS="rotateX("+xRotate+"deg) rotateY("+yRotate+"deg) translateZ(20px)",arad=Math.atan2(dy,dx),angle=arad*180/Math.PI-90;if(angle<0)angle=angle+360;if(elem.firstChild.classList.contains("over"))imgCSS+=" scale3d(0.98, 0.98, 0.98)";elem.firstChild.style.webkitTransform=imgCSS;
elem.firstChild.style.transform=imgCSS;if(thresholds){var gradient=pageY-offsets.top-bdst,gradientThreshold=elem.offsetHeight*1.2;gradient=gradient>gradientThreshold?gradientThreshold:gradient;shine.style.background="linear-gradient("+angle+"deg, rgba(255,255,255,"+gradient/h*.24+") 0%,rgba(255,255,255,0) 80%)"}else shine.style.background="linear-gradient("+angle+"deg, rgba(255,255,255,"+(pageY-offsets.top-bdst)/h*.24+") 0%,rgba(255,255,255,0) 80%)";shine.style.webkitTransform="translateX("+offsetX*
totalLayers-.1+"px) translateY("+offsetY*totalLayers-.1+"px)";shine.style.transform="translateX("+offsetX*totalLayers-.1+"px) translateY("+offsetY*totalLayers-.1+"px)";var revNum=totalLayers;for(var ly=0;ly<totalLayers;ly++){layers[ly].style.webkitTransform="translateX("+offsetX*revNum*(ly*2.5/wMultiple)+"px) translateY("+offsetY*totalLayers*(ly*2.5/wMultiple)+"px)";layers[ly].style.transform="translateX("+offsetX*revNum*(ly*2.5/wMultiple)+"px) translateY("+offsetY*totalLayers*(ly*2.5/wMultiple)+
"px)";revNum--}}function refreshRandomClass(el){var type=Math.random();el=el.getElementsByClassName("bg")[0];el.classList.remove("fly");el.classList.remove("fade");if(type>0&&type<.5||type===0)el.classList.add("fly");else el.classList.add("fade")}function processEnter(e,elem){elem.firstChild.classList.add("over");refreshRandomClass(elem.firstChild)}function processExit(e,elem,layers,totalLayers,shine){var container=elem.firstChild;container.classList.remove("over");container.style.webkitTransform=
"";container.style.transform="";shine.style.cssText="";for(var ly=0;ly<totalLayers;ly++){layers[ly].style.webkitTransform="";layers[ly].style.transform=""}}};var THREE={REVISION:"77"};if(typeof define==="function"&&define.amd)define("three",THREE);else if("undefined"!==typeof exports&&"undefined"!==typeof module)module.exports=THREE;if(Number.EPSILON===undefined)Number.EPSILON=Math.pow(2,-52);if(Math.sign===undefined)Math.sign=function(x){return x<0?-1:x>0?1:+x};if(Function.prototype.name===undefined)Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]}});
if(Object.assign===undefined)(function(){Object.assign=function(target){if(target===undefined||target===null)throw new TypeError("Cannot convert undefined or null to object");var output=Object(target);for(var index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&source!==null)for(var nextKey in source)if(Object.prototype.hasOwnProperty.call(source,nextKey))output[nextKey]=source[nextKey]}return output}})();
Object.assign(THREE,{MOUSE:{LEFT:0,MIDDLE:1,RIGHT:2},CullFaceNone:0,CullFaceBack:1,CullFaceFront:2,CullFaceFrontBack:3,FrontFaceDirectionCW:0,FrontFaceDirectionCCW:1,BasicShadowMap:0,PCFShadowMap:1,PCFSoftShadowMap:2,FrontSide:0,BackSide:1,DoubleSide:2,FlatShading:1,SmoothShading:2,NoColors:0,FaceColors:1,VertexColors:2,NoBlending:0,NormalBlending:1,AdditiveBlending:2,SubtractiveBlending:3,MultiplyBlending:4,CustomBlending:5,AddEquation:100,SubtractEquation:101,ReverseSubtractEquation:102,MinEquation:103,
MaxEquation:104,ZeroFactor:200,OneFactor:201,SrcColorFactor:202,OneMinusSrcColorFactor:203,SrcAlphaFactor:204,OneMinusSrcAlphaFactor:205,DstAlphaFactor:206,OneMinusDstAlphaFactor:207,DstColorFactor:208,OneMinusDstColorFactor:209,SrcAlphaSaturateFactor:210,NeverDepth:0,AlwaysDepth:1,LessDepth:2,LessEqualDepth:3,EqualDepth:4,GreaterEqualDepth:5,GreaterDepth:6,NotEqualDepth:7,MultiplyOperation:0,MixOperation:1,AddOperation:2,NoToneMapping:0,LinearToneMapping:1,ReinhardToneMapping:2,Uncharted2ToneMapping:3,
CineonToneMapping:4,UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307,RepeatWrapping:1E3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002,NearestFilter:1003,NearestMipMapNearestFilter:1004,NearestMipMapLinearFilter:1005,LinearFilter:1006,LinearMipMapNearestFilter:1007,LinearMipMapLinearFilter:1008,UnsignedByteType:1009,
ByteType:1010,ShortType:1011,UnsignedShortType:1012,IntType:1013,UnsignedIntType:1014,FloatType:1015,HalfFloatType:1025,UnsignedShort4444Type:1016,UnsignedShort5551Type:1017,UnsignedShort565Type:1018,AlphaFormat:1019,RGBFormat:1020,RGBAFormat:1021,LuminanceFormat:1022,LuminanceAlphaFormat:1023,RGBEFormat:THREE.RGBAFormat,DepthFormat:1026,RGB_S3TC_DXT1_Format:2001,RGBA_S3TC_DXT1_Format:2002,RGBA_S3TC_DXT3_Format:2003,RGBA_S3TC_DXT5_Format:2004,RGB_PVRTC_4BPPV1_Format:2100,RGB_PVRTC_2BPPV1_Format:2101,
RGBA_PVRTC_4BPPV1_Format:2102,RGBA_PVRTC_2BPPV1_Format:2103,RGB_ETC1_Format:2151,LoopOnce:2200,LoopRepeat:2201,LoopPingPong:2202,InterpolateDiscrete:2300,InterpolateLinear:2301,InterpolateSmooth:2302,ZeroCurvatureEnding:2400,ZeroSlopeEnding:2401,WrapAroundEnding:2402,TrianglesDrawMode:0,TriangleStripDrawMode:1,TriangleFanDrawMode:2,LinearEncoding:3E3,sRGBEncoding:3001,GammaEncoding:3007,RGBEEncoding:3002,LogLuvEncoding:3003,RGBM7Encoding:3004,RGBM16Encoding:3005,RGBDEncoding:3006,BasicDepthPacking:3200,
RGBADepthPacking:3201});THREE.Color=function(r,g,b){if(g===undefined&&b===undefined)return this.set(r);return this.setRGB(r,g,b)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(value){if(value instanceof THREE.Color)this.copy(value);else if(typeof value==="number")this.setHex(value);else if(typeof value==="string")this.setStyle(value);return this},setScalar:function(scalar){this.r=scalar;this.g=scalar;this.b=scalar},setHex:function(hex){hex=Math.floor(hex);this.r=(hex>>16&255)/255;this.g=(hex>>8&255)/255;this.b=(hex&255)/255;return this},setRGB:function(r,g,b){this.r=r;this.g=g;this.b=b;return this},
setHSL:function(){function hue2rgb(p,q,t){if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*6*(2/3-t);return p}return function(h,s,l){h=THREE.Math.euclideanModulo(h,1);s=THREE.Math.clamp(s,0,1);l=THREE.Math.clamp(l,0,1);if(s===0)this.r=this.g=this.b=l;else{var p=l<=.5?l*(1+s):l+s-l*s;var q=2*l-p;this.r=hue2rgb(q,p,h+1/3);this.g=hue2rgb(q,p,h);this.b=hue2rgb(q,p,h-1/3)}return this}}(),setStyle:function(style){function handleAlpha(string){if(string===undefined)return;
if(parseFloat(string)<1)console.warn("THREE.Color: Alpha component of "+style+" will be ignored.")}var m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(style)){var color;var name=m[1];var components=m[2];switch(name){case "rgb":case "rgba":if(color=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components)){this.r=Math.min(255,parseInt(color[1],10))/255;this.g=Math.min(255,parseInt(color[2],10))/255;this.b=Math.min(255,parseInt(color[3],10))/255;handleAlpha(color[5]);return this}if(color=
/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components)){this.r=Math.min(100,parseInt(color[1],10))/100;this.g=Math.min(100,parseInt(color[2],10))/100;this.b=Math.min(100,parseInt(color[3],10))/100;handleAlpha(color[5]);return this}break;case "hsl":case "hsla":if(color=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(components)){var h=parseFloat(color[1])/360;var s=parseInt(color[2],10)/100;var l=parseInt(color[3],10)/100;handleAlpha(color[5]);
return this.setHSL(h,s,l)}break}}else if(m=/^\#([A-Fa-f0-9]+)$/.exec(style)){var hex=m[1];var size=hex.length;if(size===3){this.r=parseInt(hex.charAt(0)+hex.charAt(0),16)/255;this.g=parseInt(hex.charAt(1)+hex.charAt(1),16)/255;this.b=parseInt(hex.charAt(2)+hex.charAt(2),16)/255;return this}else if(size===6){this.r=parseInt(hex.charAt(0)+hex.charAt(1),16)/255;this.g=parseInt(hex.charAt(2)+hex.charAt(3),16)/255;this.b=parseInt(hex.charAt(4)+hex.charAt(5),16)/255;return this}}if(style&&style.length>
0){var hex=THREE.ColorKeywords[style];if(hex!==undefined)this.setHex(hex);else console.warn("THREE.Color: Unknown color "+style)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(color){this.r=color.r;this.g=color.g;this.b=color.b;return this},copyGammaToLinear:function(color,gammaFactor){if(gammaFactor===undefined)gammaFactor=2;this.r=Math.pow(color.r,gammaFactor);this.g=Math.pow(color.g,gammaFactor);this.b=Math.pow(color.b,gammaFactor);return this},copyLinearToGamma:function(color,
gammaFactor){if(gammaFactor===undefined)gammaFactor=2;var safeInverse=gammaFactor>0?1/gammaFactor:1;this.r=Math.pow(color.r,safeInverse);this.g=Math.pow(color.g,safeInverse);this.b=Math.pow(color.b,safeInverse);return this},convertGammaToLinear:function(){var r=this.r,g=this.g,b=this.b;this.r=r*r;this.g=g*g;this.b=b*b;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return this.r*255<<16^this.g*255<<
8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(optionalTarget){var hsl=optionalTarget||{h:0,s:0,l:0};var r=this.r,g=this.g,b=this.b;var max=Math.max(r,g,b);var min=Math.min(r,g,b);var hue,saturation;var lightness=(min+max)/2;if(min===max){hue=0;saturation=0}else{var delta=max-min;saturation=lightness<=.5?delta/(max+min):delta/(2-max-min);switch(max){case r:hue=(g-b)/delta+(g<b?6:0);break;case g:hue=(b-r)/delta+2;break;case b:hue=(r-
g)/delta+4;break}hue/=6}hsl.h=hue;hsl.s=saturation;hsl.l=lightness;return hsl},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(h,s,l){var hsl=this.getHSL();hsl.h+=h;hsl.s+=s;hsl.l+=l;this.setHSL(hsl.h,hsl.s,hsl.l);return this},add:function(color){this.r+=color.r;this.g+=color.g;this.b+=color.b;return this},addColors:function(color1,color2){this.r=color1.r+color2.r;this.g=color1.g+color2.g;this.b=color1.b+color2.b;return this},addScalar:function(s){this.r+=
s;this.g+=s;this.b+=s;return this},multiply:function(color){this.r*=color.r;this.g*=color.g;this.b*=color.b;return this},multiplyScalar:function(s){this.r*=s;this.g*=s;this.b*=s;return this},lerp:function(color,alpha){this.r+=(color.r-this.r)*alpha;this.g+=(color.g-this.g)*alpha;this.b+=(color.b-this.b)*alpha;return this},equals:function(c){return c.r===this.r&&c.g===this.g&&c.b===this.b},fromArray:function(array,offset){if(offset===undefined)offset=0;this.r=array[offset];this.g=array[offset+1];this.b=
array[offset+2];return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this.r;array[offset+1]=this.g;array[offset+2]=this.b;return array}};
THREE.ColorKeywords={"aliceblue":15792383,"antiquewhite":16444375,"aqua":65535,"aquamarine":8388564,"azure":15794175,"beige":16119260,"bisque":16770244,"black":0,"blanchedalmond":16772045,"blue":255,"blueviolet":9055202,"brown":10824234,"burlywood":14596231,"cadetblue":6266528,"chartreuse":8388352,"chocolate":13789470,"coral":16744272,"cornflowerblue":6591981,"cornsilk":16775388,"crimson":14423100,"cyan":65535,"darkblue":139,"darkcyan":35723,"darkgoldenrod":12092939,"darkgray":11119017,"darkgreen":25600,
"darkgrey":11119017,"darkkhaki":12433259,"darkmagenta":9109643,"darkolivegreen":5597999,"darkorange":16747520,"darkorchid":10040012,"darkred":9109504,"darksalmon":15308410,"darkseagreen":9419919,"darkslateblue":4734347,"darkslategray":3100495,"darkslategrey":3100495,"darkturquoise":52945,"darkviolet":9699539,"deeppink":16716947,"deepskyblue":49151,"dimgray":6908265,"dimgrey":6908265,"dodgerblue":2003199,"firebrick":11674146,"floralwhite":16775920,"forestgreen":2263842,"fuchsia":16711935,"gainsboro":14474460,
"ghostwhite":16316671,"gold":16766720,"goldenrod":14329120,"gray":8421504,"green":32768,"greenyellow":11403055,"grey":8421504,"honeydew":15794160,"hotpink":16738740,"indianred":13458524,"indigo":4915330,"ivory":16777200,"khaki":15787660,"lavender":15132410,"lavenderblush":16773365,"lawngreen":8190976,"lemonchiffon":16775885,"lightblue":11393254,"lightcoral":15761536,"lightcyan":14745599,"lightgoldenrodyellow":16448210,"lightgray":13882323,"lightgreen":9498256,"lightgrey":13882323,"lightpink":16758465,
"lightsalmon":16752762,"lightseagreen":2142890,"lightskyblue":8900346,"lightslategray":7833753,"lightslategrey":7833753,"lightsteelblue":11584734,"lightyellow":16777184,"lime":65280,"limegreen":3329330,"linen":16445670,"magenta":16711935,"maroon":8388608,"mediumaquamarine":6737322,"mediumblue":205,"mediumorchid":12211667,"mediumpurple":9662683,"mediumseagreen":3978097,"mediumslateblue":8087790,"mediumspringgreen":64154,"mediumturquoise":4772300,"mediumvioletred":13047173,"midnightblue":1644912,"mintcream":16121850,
"mistyrose":16770273,"moccasin":16770229,"navajowhite":16768685,"navy":128,"oldlace":16643558,"olive":8421376,"olivedrab":7048739,"orange":16753920,"orangered":16729344,"orchid":14315734,"palegoldenrod":15657130,"palegreen":10025880,"paleturquoise":11529966,"palevioletred":14381203,"papayawhip":16773077,"peachpuff":16767673,"peru":13468991,"pink":16761035,"plum":14524637,"powderblue":11591910,"purple":8388736,"red":16711680,"rosybrown":12357519,"royalblue":4286945,"saddlebrown":9127187,"salmon":16416882,
"sandybrown":16032864,"seagreen":3050327,"seashell":16774638,"sienna":10506797,"silver":12632256,"skyblue":8900331,"slateblue":6970061,"slategray":7372944,"slategrey":7372944,"snow":16775930,"springgreen":65407,"steelblue":4620980,"tan":13808780,"teal":32896,"thistle":14204888,"tomato":16737095,"turquoise":4251856,"violet":15631086,"wheat":16113331,"white":16777215,"whitesmoke":16119285,"yellow":16776960,"yellowgreen":10145074};
THREE.Quaternion=function(x,y,z,w){this._x=x||0;this._y=y||0;this._z=z||0;this._w=w!==undefined?w:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,get x(){return this._x},set x(value){this._x=value;this.onChangeCallback()},get y(){return this._y},set y(value){this._y=value;this.onChangeCallback()},get z(){return this._z},set z(value){this._z=value;this.onChangeCallback()},get w(){return this._w},set w(value){this._w=value;this.onChangeCallback()},set:function(x,y,z,w){this._x=x;this._y=y;this._z=z;this._w=w;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,
this._y,this._z,this._w)},copy:function(quaternion){this._x=quaternion.x;this._y=quaternion.y;this._z=quaternion.z;this._w=quaternion.w;this.onChangeCallback();return this},setFromEuler:function(euler,update){if(euler instanceof THREE.Euler===false)throw new Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c1=Math.cos(euler._x/2);var c2=Math.cos(euler._y/2);var c3=Math.cos(euler._z/2);var s1=Math.sin(euler._x/2);var s2=Math.sin(euler._y/
2);var s3=Math.sin(euler._z/2);var order=euler.order;if(order==="XYZ"){this._x=s1*c2*c3+c1*s2*s3;this._y=c1*s2*c3-s1*c2*s3;this._z=c1*c2*s3+s1*s2*c3;this._w=c1*c2*c3-s1*s2*s3}else if(order==="YXZ"){this._x=s1*c2*c3+c1*s2*s3;this._y=c1*s2*c3-s1*c2*s3;this._z=c1*c2*s3-s1*s2*c3;this._w=c1*c2*c3+s1*s2*s3}else if(order==="ZXY"){this._x=s1*c2*c3-c1*s2*s3;this._y=c1*s2*c3+s1*c2*s3;this._z=c1*c2*s3+s1*s2*c3;this._w=c1*c2*c3-s1*s2*s3}else if(order==="ZYX"){this._x=s1*c2*c3-c1*s2*s3;this._y=c1*s2*c3+s1*c2*
s3;this._z=c1*c2*s3-s1*s2*c3;this._w=c1*c2*c3+s1*s2*s3}else if(order==="YZX"){this._x=s1*c2*c3+c1*s2*s3;this._y=c1*s2*c3+s1*c2*s3;this._z=c1*c2*s3-s1*s2*c3;this._w=c1*c2*c3-s1*s2*s3}else if(order==="XZY"){this._x=s1*c2*c3-c1*s2*s3;this._y=c1*s2*c3-s1*c2*s3;this._z=c1*c2*s3+s1*s2*c3;this._w=c1*c2*c3+s1*s2*s3}if(update!==false)this.onChangeCallback();return this},setFromAxisAngle:function(axis,angle){var halfAngle=angle/2,s=Math.sin(halfAngle);this._x=axis.x*s;this._y=axis.y*s;this._z=axis.z*s;this._w=
Math.cos(halfAngle);this.onChangeCallback();return this},setFromRotationMatrix:function(m){var te=m.elements,m11=te[0],m12=te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10],trace=m11+m22+m33,s;if(trace>0){s=.5/Math.sqrt(trace+1);this._w=.25/s;this._x=(m32-m23)*s;this._y=(m13-m31)*s;this._z=(m21-m12)*s}else if(m11>m22&&m11>m33){s=2*Math.sqrt(1+m11-m22-m33);this._w=(m32-m23)/s;this._x=.25*s;this._y=(m12+m21)/s;this._z=(m13+m31)/s}else if(m22>m33){s=2*Math.sqrt(1+m22-m11-m33);
this._w=(m13-m31)/s;this._x=(m12+m21)/s;this._y=.25*s;this._z=(m23+m32)/s}else{s=2*Math.sqrt(1+m33-m11-m22);this._w=(m21-m12)/s;this._x=(m13+m31)/s;this._y=(m23+m32)/s;this._z=.25*s}this.onChangeCallback();return this},setFromUnitVectors:function(){var v1,r;var EPS=1E-6;return function(vFrom,vTo){if(v1===undefined)v1=new THREE.Vector3;r=vFrom.dot(vTo)+1;if(r<EPS){r=0;if(Math.abs(vFrom.x)>Math.abs(vFrom.z))v1.set(-vFrom.y,vFrom.x,0);else v1.set(0,-vFrom.z,vFrom.y)}else v1.crossVectors(vFrom,vTo);this._x=
v1.x;this._y=v1.y;this._z=v1.z;this._w=r;return this.normalize()}}(),inverse:function(){return this.conjugate().normalize()},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(v){return this._x*v._x+this._y*v._y+this._z*v._z+this._w*v._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var l=
this.length();if(l===0){this._x=0;this._y=0;this._z=0;this._w=1}else{l=1/l;this._x=this._x*l;this._y=this._y*l;this._z=this._z*l;this._w=this._w*l}this.onChangeCallback();return this},multiply:function(q,p){if(p!==undefined){console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(q,p)}return this.multiplyQuaternions(this,q)},premultiply:function(q){return this.multiplyQuaternions(q,this)},multiplyQuaternions:function(a,
b){var qax=a._x,qay=a._y,qaz=a._z,qaw=a._w;var qbx=b._x,qby=b._y,qbz=b._z,qbw=b._w;this._x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby;this._y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz;this._z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx;this._w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz;this.onChangeCallback();return this},slerp:function(qb,t){if(t===0)return this;if(t===1)return this.copy(qb);var x=this._x,y=this._y,z=this._z,w=this._w;var cosHalfTheta=w*qb._w+x*qb._x+y*qb._y+z*qb._z;if(cosHalfTheta<0){this._w=-qb._w;this._x=-qb._x;this._y=
-qb._y;this._z=-qb._z;cosHalfTheta=-cosHalfTheta}else this.copy(qb);if(cosHalfTheta>=1){this._w=w;this._x=x;this._y=y;this._z=z;return this}var sinHalfTheta=Math.sqrt(1-cosHalfTheta*cosHalfTheta);if(Math.abs(sinHalfTheta)<.001){this._w=.5*(w+this._w);this._x=.5*(x+this._x);this._y=.5*(y+this._y);this._z=.5*(z+this._z);return this}var halfTheta=Math.atan2(sinHalfTheta,cosHalfTheta);var ratioA=Math.sin((1-t)*halfTheta)/sinHalfTheta,ratioB=Math.sin(t*halfTheta)/sinHalfTheta;this._w=w*ratioA+this._w*
ratioB;this._x=x*ratioA+this._x*ratioB;this._y=y*ratioA+this._y*ratioB;this._z=z*ratioA+this._z*ratioB;this.onChangeCallback();return this},equals:function(quaternion){return quaternion._x===this._x&&quaternion._y===this._y&&quaternion._z===this._z&&quaternion._w===this._w},fromArray:function(array,offset){if(offset===undefined)offset=0;this._x=array[offset];this._y=array[offset+1];this._z=array[offset+2];this._w=array[offset+3];this.onChangeCallback();return this},toArray:function(array,offset){if(array===
undefined)array=[];if(offset===undefined)offset=0;array[offset]=this._x;array[offset+1]=this._y;array[offset+2]=this._z;array[offset+3]=this._w;return array},onChange:function(callback){this.onChangeCallback=callback;return this},onChangeCallback:function(){}};
Object.assign(THREE.Quaternion,{slerp:function(qa,qb,qm,t){return qm.copy(qa).slerp(qb,t)},slerpFlat:function(dst,dstOffset,src0,srcOffset0,src1,srcOffset1,t){var x0=src0[srcOffset0+0],y0=src0[srcOffset0+1],z0=src0[srcOffset0+2],w0=src0[srcOffset0+3],x1=src1[srcOffset1+0],y1=src1[srcOffset1+1],z1=src1[srcOffset1+2],w1=src1[srcOffset1+3];if(w0!==w1||x0!==x1||y0!==y1||z0!==z1){var s=1-t,cos=x0*x1+y0*y1+z0*z1+w0*w1,dir=cos>=0?1:-1,sqrSin=1-cos*cos;if(sqrSin>Number.EPSILON){var sin=Math.sqrt(sqrSin),
len=Math.atan2(sin,cos*dir);s=Math.sin(s*len)/sin;t=Math.sin(t*len)/sin}var tDir=t*dir;x0=x0*s+x1*tDir;y0=y0*s+y1*tDir;z0=z0*s+z1*tDir;w0=w0*s+w1*tDir;if(s===1-t){var f=1/Math.sqrt(x0*x0+y0*y0+z0*z0+w0*w0);x0*=f;y0*=f;z0*=f;w0*=f}}dst[dstOffset]=x0;dst[dstOffset+1]=y0;dst[dstOffset+2]=z0;dst[dstOffset+3]=w0}});THREE.Vector2=function(x,y){this.x=x||0;this.y=y||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,get width(){return this.x},set width(value){this.x=value},get height(){return this.y},set height(value){this.y=value},set:function(x,y){this.x=x;this.y=y;return this},setScalar:function(scalar){this.x=scalar;this.y=scalar;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;default:throw new Error("index is out of range: "+
index);}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+index);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(v){this.x=v.x;this.y=v.y;return this},add:function(v,w){if(w!==undefined){console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(v,w)}this.x+=v.x;this.y+=v.y;return this},addScalar:function(s){this.x+=
s;this.y+=s;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},addScaledVector:function(v,s){this.x+=v.x*s;this.y+=v.y*s;return this},sub:function(v,w){if(w!==undefined){console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(v,w)}this.x-=v.x;this.y-=v.y;return this},subScalar:function(s){this.x-=s;this.y-=s;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(v){this.x*=
v.x;this.y*=v.y;return this},multiplyScalar:function(scalar){if(isFinite(scalar)){this.x*=scalar;this.y*=scalar}else{this.x=0;this.y=0}return this},divide:function(v){this.x/=v.x;this.y/=v.y;return this},divideScalar:function(scalar){return this.multiplyScalar(1/scalar)},min:function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);return this},max:function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);return this},clamp:function(min,max){this.x=Math.max(min.x,Math.min(max.x,
this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));return this},clampScalar:function(){var min,max;return function clampScalar(minVal,maxVal){if(min===undefined){min=new THREE.Vector2;max=new THREE.Vector2}min.set(minVal,minVal);max.set(maxVal,maxVal);return this.clamp(min,max)}}(),clampLength:function(min,max){var length=this.length();return this.multiplyScalar(Math.max(min,Math.min(max,length))/length)},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=
Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(v){return this.x*v.x+this.y*v.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},
lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length())},angle:function(){var angle=Math.atan2(this.y,this.x);if(angle<0)angle+=2*Math.PI;return angle},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y;return dx*dx+dy*dy},setLength:function(length){return this.multiplyScalar(length/this.length())},lerp:function(v,alpha){this.x+=(v.x-this.x)*alpha;
this.y+=(v.y-this.y)*alpha;return this},lerpVectors:function(v1,v2,alpha){return this.subVectors(v2,v1).multiplyScalar(alpha).add(v1)},equals:function(v){return v.x===this.x&&v.y===this.y},fromArray:function(array,offset){if(offset===undefined)offset=0;this.x=array[offset];this.y=array[offset+1];return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this.x;array[offset+1]=this.y;return array},fromAttribute:function(attribute,index,offset){if(offset===
undefined)offset=0;index=index*attribute.itemSize+offset;this.x=attribute.array[index];this.y=attribute.array[index+1];return this},rotateAround:function(center,angle){var c=Math.cos(angle),s=Math.sin(angle);var x=this.x-center.x;var y=this.y-center.y;this.x=x*c-y*s+center.x;this.y=x*s+y*c+center.y;return this}};THREE.Vector3=function(x,y,z){this.x=x||0;this.y=y||0;this.z=z||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(x,y,z){this.x=x;this.y=y;this.z=z;return this},setScalar:function(scalar){this.x=scalar;this.y=scalar;this.z=scalar;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setZ:function(z){this.z=z;return this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;default:throw new Error("index is out of range: "+index);}},getComponent:function(index){switch(index){case 0:return this.x;
case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+index);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;return this},add:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(v,w)}this.x+=v.x;this.y+=v.y;this.z+=v.z;return this},addScalar:function(s){this.x+=s;this.y+=s;this.z+=s;return this},
addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},addScaledVector:function(v,s){this.x+=v.x*s;this.y+=v.y*s;this.z+=v.z*s;return this},sub:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(v,w)}this.x-=v.x;this.y-=v.y;this.z-=v.z;return this},subScalar:function(s){this.x-=s;this.y-=s;this.z-=s;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;
this.z=a.z-b.z;return this},multiply:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(v,w)}this.x*=v.x;this.y*=v.y;this.z*=v.z;return this},multiplyScalar:function(scalar){if(isFinite(scalar)){this.x*=scalar;this.y*=scalar;this.z*=scalar}else{this.x=0;this.y=0;this.z=0}return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var quaternion;
return function applyEuler(euler){if(euler instanceof THREE.Euler===false)console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order.");if(quaternion===undefined)quaternion=new THREE.Quaternion;return this.applyQuaternion(quaternion.setFromEuler(euler))}}(),applyAxisAngle:function(){var quaternion;return function applyAxisAngle(axis,angle){if(quaternion===undefined)quaternion=new THREE.Quaternion;return this.applyQuaternion(quaternion.setFromAxisAngle(axis,
angle))}}(),applyMatrix3:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[3]*y+e[6]*z;this.y=e[1]*x+e[4]*y+e[7]*z;this.z=e[2]*x+e[5]*y+e[8]*z;return this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+e[8]*z+e[12];this.y=e[1]*x+e[5]*y+e[9]*z+e[13];this.z=e[2]*x+e[6]*y+e[10]*z+e[14];return this},applyProjection:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;var d=1/(e[3]*x+e[7]*y+e[11]*z+e[15]);this.x=(e[0]*x+e[4]*
y+e[8]*z+e[12])*d;this.y=(e[1]*x+e[5]*y+e[9]*z+e[13])*d;this.z=(e[2]*x+e[6]*y+e[10]*z+e[14])*d;return this},applyQuaternion:function(q){var x=this.x,y=this.y,z=this.z;var qx=q.x,qy=q.y,qz=q.z,qw=q.w;var ix=qw*x+qy*z-qz*y;var iy=qw*y+qz*x-qx*z;var iz=qw*z+qx*y-qy*x;var iw=-qx*x-qy*y-qz*z;this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy;this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz;this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx;return this},project:function(){var matrix;return function project(camera){if(matrix===undefined)matrix=new THREE.Matrix4;
matrix.multiplyMatrices(camera.projectionMatrix,matrix.getInverse(camera.matrixWorld));return this.applyProjection(matrix)}}(),unproject:function(){var matrix;return function unproject(camera){if(matrix===undefined)matrix=new THREE.Matrix4;matrix.multiplyMatrices(camera.matrixWorld,matrix.getInverse(camera.projectionMatrix));return this.applyProjection(matrix)}}(),transformDirection:function(m){var x=this.x,y=this.y,z=this.z;var e=m.elements;this.x=e[0]*x+e[4]*y+e[8]*z;this.y=e[1]*x+e[5]*y+e[9]*z;
this.z=e[2]*x+e[6]*y+e[10]*z;return this.normalize()},divide:function(v){this.x/=v.x;this.y/=v.y;this.z/=v.z;return this},divideScalar:function(scalar){return this.multiplyScalar(1/scalar)},min:function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,v.y);this.z=Math.min(this.z,v.z);return this},max:function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);this.z=Math.max(this.z,v.z);return this},clamp:function(min,max){this.x=Math.max(min.x,Math.min(max.x,this.x));this.y=Math.max(min.y,
Math.min(max.y,this.y));this.z=Math.max(min.z,Math.min(max.z,this.z));return this},clampScalar:function(){var min,max;return function clampScalar(minVal,maxVal){if(min===undefined){min=new THREE.Vector3;max=new THREE.Vector3}min.set(minVal,minVal,minVal);max.set(maxVal,maxVal,maxVal);return this.clamp(min,max)}}(),clampLength:function(min,max){var length=this.length();return this.multiplyScalar(Math.max(min,Math.min(max,length))/length)},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);
this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=
-this.z;return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(length){return this.multiplyScalar(length/this.length())},lerp:function(v,alpha){this.x+=(v.x-this.x)*alpha;
this.y+=(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;return this},lerpVectors:function(v1,v2,alpha){return this.subVectors(v2,v1).multiplyScalar(alpha).add(v1)},cross:function(v,w){if(w!==undefined){console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(v,w)}var x=this.x,y=this.y,z=this.z;this.x=y*v.z-z*v.y;this.y=z*v.x-x*v.z;this.z=x*v.y-y*v.x;return this},crossVectors:function(a,b){var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=
b.y,bz=b.z;this.x=ay*bz-az*by;this.y=az*bx-ax*bz;this.z=ax*by-ay*bx;return this},projectOnVector:function(){var v1,dot;return function projectOnVector(vector){if(v1===undefined)v1=new THREE.Vector3;v1.copy(vector).normalize();dot=this.dot(v1);return this.copy(v1).multiplyScalar(dot)}}(),projectOnPlane:function(){var v1;return function projectOnPlane(planeNormal){if(v1===undefined)v1=new THREE.Vector3;v1.copy(this).projectOnVector(planeNormal);return this.sub(v1)}}(),reflect:function(){var v1;return function reflect(normal){if(v1===
undefined)v1=new THREE.Vector3;return this.sub(v1.copy(normal).multiplyScalar(2*this.dot(normal)))}}(),angleTo:function(v){var theta=this.dot(v)/Math.sqrt(this.lengthSq()*v.lengthSq());return Math.acos(THREE.Math.clamp(theta,-1,1))},distanceTo:function(v){return Math.sqrt(this.distanceToSquared(v))},distanceToSquared:function(v){var dx=this.x-v.x,dy=this.y-v.y,dz=this.z-v.z;return dx*dx+dy*dy+dz*dz},setFromSpherical:function(s){var sinPhiRadius=Math.sin(s.phi)*s.radius;this.x=sinPhiRadius*Math.sin(s.theta);
this.y=Math.cos(s.phi)*s.radius;this.z=sinPhiRadius*Math.cos(s.theta);return this},setFromMatrixPosition:function(m){return this.setFromMatrixColumn(m,3)},setFromMatrixScale:function(m){var sx=this.setFromMatrixColumn(m,0).length();var sy=this.setFromMatrixColumn(m,1).length();var sz=this.setFromMatrixColumn(m,2).length();this.x=sx;this.y=sy;this.z=sz;return this},setFromMatrixColumn:function(m,index){if(typeof m==="number"){console.warn("THREE.Vector3: setFromMatrixColumn now expects ( matrix, index ).");
var temp=m;m=index;index=temp}return this.fromArray(m.elements,index*4)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z},fromArray:function(array,offset){if(offset===undefined)offset=0;this.x=array[offset];this.y=array[offset+1];this.z=array[offset+2];return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this.x;array[offset+1]=this.y;array[offset+2]=this.z;return array},fromAttribute:function(attribute,index,offset){if(offset===
undefined)offset=0;index=index*attribute.itemSize+offset;this.x=attribute.array[index];this.y=attribute.array[index+1];this.z=attribute.array[index+2];return this}};THREE.Vector4=function(x,y,z,w){this.x=x||0;this.y=y||0;this.z=z||0;this.w=w!==undefined?w:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(x,y,z,w){this.x=x;this.y=y;this.z=z;this.w=w;return this},setScalar:function(scalar){this.x=scalar;this.y=scalar;this.z=scalar;this.w=scalar;return this},setX:function(x){this.x=x;return this},setY:function(y){this.y=y;return this},setZ:function(z){this.z=z;return this},setW:function(w){this.w=w;return this},setComponent:function(index,value){switch(index){case 0:this.x=value;break;case 1:this.y=value;break;case 2:this.z=value;break;
case 3:this.w=value;break;default:throw new Error("index is out of range: "+index);}},getComponent:function(index){switch(index){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+index);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(v){this.x=v.x;this.y=v.y;this.z=v.z;this.w=v.w!==undefined?v.w:1;return this},add:function(v,w){if(w!==undefined){console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead.");
return this.addVectors(v,w)}this.x+=v.x;this.y+=v.y;this.z+=v.z;this.w+=v.w;return this},addScalar:function(s){this.x+=s;this.y+=s;this.z+=s;this.w+=s;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},addScaledVector:function(v,s){this.x+=v.x*s;this.y+=v.y*s;this.z+=v.z*s;this.w+=v.w*s;return this},sub:function(v,w){if(w!==undefined){console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(v,
w)}this.x-=v.x;this.y-=v.y;this.z-=v.z;this.w-=v.w;return this},subScalar:function(s){this.x-=s;this.y-=s;this.z-=s;this.w-=s;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(scalar){if(isFinite(scalar)){this.x*=scalar;this.y*=scalar;this.z*=scalar;this.w*=scalar}else{this.x=0;this.y=0;this.z=0;this.w=0}return this},applyMatrix4:function(m){var x=this.x,y=this.y,z=this.z,w=this.w;var e=m.elements;this.x=e[0]*x+e[4]*
y+e[8]*z+e[12]*w;this.y=e[1]*x+e[5]*y+e[9]*z+e[13]*w;this.z=e[2]*x+e[6]*y+e[10]*z+e[14]*w;this.w=e[3]*x+e[7]*y+e[11]*z+e[15]*w;return this},divideScalar:function(scalar){return this.multiplyScalar(1/scalar)},setAxisAngleFromQuaternion:function(q){this.w=2*Math.acos(q.w);var s=Math.sqrt(1-q.w*q.w);if(s<1E-4){this.x=1;this.y=0;this.z=0}else{this.x=q.x/s;this.y=q.y/s;this.z=q.z/s}return this},setAxisAngleFromRotationMatrix:function(m){var angle,x,y,z,epsilon=.01,epsilon2=.1,te=m.elements,m11=te[0],m12=
te[4],m13=te[8],m21=te[1],m22=te[5],m23=te[9],m31=te[2],m32=te[6],m33=te[10];if(Math.abs(m12-m21)<epsilon&&Math.abs(m13-m31)<epsilon&&Math.abs(m23-m32)<epsilon){if(Math.abs(m12+m21)<epsilon2&&Math.abs(m13+m31)<epsilon2&&Math.abs(m23+m32)<epsilon2&&Math.abs(m11+m22+m33-3)<epsilon2){this.set(1,0,0,0);return this}angle=Math.PI;var xx=(m11+1)/2;var yy=(m22+1)/2;var zz=(m33+1)/2;var xy=(m12+m21)/4;var xz=(m13+m31)/4;var yz=(m23+m32)/4;if(xx>yy&&xx>zz)if(xx<epsilon){x=0;y=.707106781;z=.707106781}else{x=
Math.sqrt(xx);y=xy/x;z=xz/x}else if(yy>zz)if(yy<epsilon){x=.707106781;y=0;z=.707106781}else{y=Math.sqrt(yy);x=xy/y;z=yz/y}else if(zz<epsilon){x=.707106781;y=.707106781;z=0}else{z=Math.sqrt(zz);x=xz/z;y=yz/z}this.set(x,y,z,angle);return this}var s=Math.sqrt((m32-m23)*(m32-m23)+(m13-m31)*(m13-m31)+(m21-m12)*(m21-m12));if(Math.abs(s)<.001)s=1;this.x=(m32-m23)/s;this.y=(m13-m31)/s;this.z=(m21-m12)/s;this.w=Math.acos((m11+m22+m33-1)/2);return this},min:function(v){this.x=Math.min(this.x,v.x);this.y=Math.min(this.y,
v.y);this.z=Math.min(this.z,v.z);this.w=Math.min(this.w,v.w);return this},max:function(v){this.x=Math.max(this.x,v.x);this.y=Math.max(this.y,v.y);this.z=Math.max(this.z,v.z);this.w=Math.max(this.w,v.w);return this},clamp:function(min,max){this.x=Math.max(min.x,Math.min(max.x,this.x));this.y=Math.max(min.y,Math.min(max.y,this.y));this.z=Math.max(min.z,Math.min(max.z,this.z));this.w=Math.max(min.w,Math.min(max.w,this.w));return this},clampScalar:function(){var min,max;return function clampScalar(minVal,
maxVal){if(min===undefined){min=new THREE.Vector4;max=new THREE.Vector4}min.set(minVal,minVal,minVal,minVal);max.set(maxVal,maxVal,maxVal,maxVal);return this.clamp(min,max)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);
this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x);this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y);this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z);this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z+this.w*v.w},lengthSq:function(){return this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(length){return this.multiplyScalar(length/this.length())},lerp:function(v,alpha){this.x+=(v.x-this.x)*alpha;this.y+=(v.y-this.y)*alpha;this.z+=(v.z-this.z)*alpha;this.w+=(v.w-
this.w)*alpha;return this},lerpVectors:function(v1,v2,alpha){return this.subVectors(v2,v1).multiplyScalar(alpha).add(v1)},equals:function(v){return v.x===this.x&&v.y===this.y&&v.z===this.z&&v.w===this.w},fromArray:function(array,offset){if(offset===undefined)offset=0;this.x=array[offset];this.y=array[offset+1];this.z=array[offset+2];this.w=array[offset+3];return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this.x;array[offset+1]=this.y;
array[offset+2]=this.z;array[offset+3]=this.w;return array},fromAttribute:function(attribute,index,offset){if(offset===undefined)offset=0;index=index*attribute.itemSize+offset;this.x=attribute.array[index];this.y=attribute.array[index+1];this.z=attribute.array[index+2];this.w=attribute.array[index+3];return this}};THREE.Euler=function(x,y,z,order){this._x=x||0;this._y=y||0;this._z=z||0;this._order=order||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];
THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,get x(){return this._x},set x(value){this._x=value;this.onChangeCallback()},get y(){return this._y},set y(value){this._y=value;this.onChangeCallback()},get z(){return this._z},set z(value){this._z=value;this.onChangeCallback()},get order(){return this._order},set order(value){this._order=value;this.onChangeCallback()},set:function(x,y,z,order){this._x=x;this._y=y;this._z=z;this._order=order||this._order;this.onChangeCallback();return this},clone:function(){return new this.constructor(this._x,
this._y,this._z,this._order)},copy:function(euler){this._x=euler._x;this._y=euler._y;this._z=euler._z;this._order=euler._order;this.onChangeCallback();return this},setFromRotationMatrix:function(m,order,update){var clamp=THREE.Math.clamp;var te=m.elements;var m11=te[0],m12=te[4],m13=te[8];var m21=te[1],m22=te[5],m23=te[9];var m31=te[2],m32=te[6],m33=te[10];order=order||this._order;if(order==="XYZ"){this._y=Math.asin(clamp(m13,-1,1));if(Math.abs(m13)<.99999){this._x=Math.atan2(-m23,m33);this._z=Math.atan2(-m12,
m11)}else{this._x=Math.atan2(m32,m22);this._z=0}}else if(order==="YXZ"){this._x=Math.asin(-clamp(m23,-1,1));if(Math.abs(m23)<.99999){this._y=Math.atan2(m13,m33);this._z=Math.atan2(m21,m22)}else{this._y=Math.atan2(-m31,m11);this._z=0}}else if(order==="ZXY"){this._x=Math.asin(clamp(m32,-1,1));if(Math.abs(m32)<.99999){this._y=Math.atan2(-m31,m33);this._z=Math.atan2(-m12,m22)}else{this._y=0;this._z=Math.atan2(m21,m11)}}else if(order==="ZYX"){this._y=Math.asin(-clamp(m31,-1,1));if(Math.abs(m31)<.99999){this._x=
Math.atan2(m32,m33);this._z=Math.atan2(m21,m11)}else{this._x=0;this._z=Math.atan2(-m12,m22)}}else if(order==="YZX"){this._z=Math.asin(clamp(m21,-1,1));if(Math.abs(m21)<.99999){this._x=Math.atan2(-m23,m22);this._y=Math.atan2(-m31,m11)}else{this._x=0;this._y=Math.atan2(m13,m33)}}else if(order==="XZY"){this._z=Math.asin(-clamp(m12,-1,1));if(Math.abs(m12)<.99999){this._x=Math.atan2(m32,m22);this._y=Math.atan2(m13,m11)}else{this._x=Math.atan2(-m23,m33);this._y=0}}else console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+
order);this._order=order;if(update!==false)this.onChangeCallback();return this},setFromQuaternion:function(){var matrix;return function(q,order,update){if(matrix===undefined)matrix=new THREE.Matrix4;matrix.makeRotationFromQuaternion(q);return this.setFromRotationMatrix(matrix,order,update)}}(),setFromVector3:function(v,order){return this.set(v.x,v.y,v.z,order||this._order)},reorder:function(){var q=new THREE.Quaternion;return function(newOrder){q.setFromEuler(this);return this.setFromQuaternion(q,
newOrder)}}(),equals:function(euler){return euler._x===this._x&&euler._y===this._y&&euler._z===this._z&&euler._order===this._order},fromArray:function(array){this._x=array[0];this._y=array[1];this._z=array[2];if(array[3]!==undefined)this._order=array[3];this.onChangeCallback();return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;array[offset]=this._x;array[offset+1]=this._y;array[offset+2]=this._z;array[offset+3]=this._order;return array},toVector3:function(optionalResult){if(optionalResult)return optionalResult.set(this._x,
this._y,this._z);else return new THREE.Vector3(this._x,this._y,this._z)},onChange:function(callback){this.onChangeCallback=callback;return this},onChangeCallback:function(){}};THREE.Line3=function(start,end){this.start=start!==undefined?start:new THREE.Vector3;this.end=end!==undefined?end:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(start,end){this.start.copy(start);this.end.copy(end);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(line){this.start.copy(line.start);this.end.copy(line.end);return this},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.subVectors(this.end,
this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,optionalTarget){var result=optionalTarget||new THREE.Vector3;return this.delta(result).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var startP=new THREE.Vector3;var startEnd=new THREE.Vector3;return function(point,clampToLine){startP.subVectors(point,this.start);startEnd.subVectors(this.end,this.start);var startEnd2=
startEnd.dot(startEnd);var startEnd_startP=startEnd.dot(startP);var t=startEnd_startP/startEnd2;if(clampToLine)t=THREE.Math.clamp(t,0,1);return t}}(),closestPointToPoint:function(point,clampToLine,optionalTarget){var t=this.closestPointToPointParameter(point,clampToLine);var result=optionalTarget||new THREE.Vector3;return this.delta(result).multiplyScalar(t).add(this.start)},applyMatrix4:function(matrix){this.start.applyMatrix4(matrix);this.end.applyMatrix4(matrix);return this},equals:function(line){return line.start.equals(this.start)&&
line.end.equals(this.end)}};THREE.Box2=function(min,max){this.min=min!==undefined?min:new THREE.Vector2(+Infinity,+Infinity);this.max=max!==undefined?max:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(min,max){this.min.copy(min);this.max.copy(max);return this},setFromPoints:function(points){this.makeEmpty();for(var i=0,il=points.length;i<il;i++)this.expandByPoint(points[i]);return this},setFromCenterAndSize:function(){var v1=new THREE.Vector2;return function(center,size){var halfSize=v1.copy(size).multiplyScalar(.5);this.min.copy(center).sub(halfSize);this.max.copy(center).add(halfSize);return this}}(),clone:function(){return(new this.constructor).copy(this)},
copy:function(box){this.min.copy(box.min);this.max.copy(box.max);return this},makeEmpty:function(){this.min.x=this.min.y=+Infinity;this.max.x=this.max.y=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.addVectors(this.min,this.max).multiplyScalar(.5)},size:function(optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.subVectors(this.max,this.min)},
expandByPoint:function(point){this.min.min(point);this.max.max(point);return this},expandByVector:function(vector){this.min.sub(vector);this.max.add(vector);return this},expandByScalar:function(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this},containsPoint:function(point){if(point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y)return false;return true},containsBox:function(box){if(this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&
box.max.y<=this.max.y)return true;return false},getParameter:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(box){if(box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||box.min.y>this.max.y)return false;return true},clampPoint:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector2;return result.copy(point).clamp(this.min,
this.max)},distanceToPoint:function(){var v1=new THREE.Vector2;return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length()}}(),intersect:function(box){this.min.max(box.min);this.max.min(box.max);return this},union:function(box){this.min.min(box.min);this.max.max(box.max);return this},translate:function(offset){this.min.add(offset);this.max.add(offset);return this},equals:function(box){return box.min.equals(this.min)&&box.max.equals(this.max)}};
THREE.Box3=function(min,max){this.min=min!==undefined?min:new THREE.Vector3(+Infinity,+Infinity,+Infinity);this.max=max!==undefined?max:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(min,max){this.min.copy(min);this.max.copy(max);return this},setFromArray:function(array){var minX=+Infinity;var minY=+Infinity;var minZ=+Infinity;var maxX=-Infinity;var maxY=-Infinity;var maxZ=-Infinity;for(var i=0,l=array.length;i<l;i+=3){var x=array[i];var y=array[i+1];var z=array[i+2];if(x<minX)minX=x;if(y<minY)minY=y;if(z<minZ)minZ=z;if(x>maxX)maxX=x;if(y>maxY)maxY=y;if(z>maxZ)maxZ=z}this.min.set(minX,minY,minZ);this.max.set(maxX,maxY,
maxZ)},setFromPoints:function(points){this.makeEmpty();for(var i=0,il=points.length;i<il;i++)this.expandByPoint(points[i]);return this},setFromCenterAndSize:function(){var v1=new THREE.Vector3;return function(center,size){var halfSize=v1.copy(size).multiplyScalar(.5);this.min.copy(center).sub(halfSize);this.max.copy(center).add(halfSize);return this}}(),setFromObject:function(){var v1=new THREE.Vector3;return function(object){var scope=this;object.updateMatrixWorld(true);this.makeEmpty();object.traverse(function(node){var geometry=
node.geometry;if(geometry!==undefined)if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;for(var i=0,il=vertices.length;i<il;i++){v1.copy(vertices[i]);v1.applyMatrix4(node.matrixWorld);scope.expandByPoint(v1)}}else if(geometry instanceof THREE.BufferGeometry&&geometry.attributes["position"]!==undefined){var positions=geometry.attributes["position"].array;for(var i=0,il=positions.length;i<il;i+=3){v1.fromArray(positions,i);v1.applyMatrix4(node.matrixWorld);scope.expandByPoint(v1)}}});
return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(box){this.min.copy(box.min);this.max.copy(box.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=+Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.min,this.max).multiplyScalar(.5)},
size:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.subVectors(this.max,this.min)},expandByPoint:function(point){this.min.min(point);this.max.max(point);return this},expandByVector:function(vector){this.min.sub(vector);this.max.add(vector);return this},expandByScalar:function(scalar){this.min.addScalar(-scalar);this.max.addScalar(scalar);return this},containsPoint:function(point){if(point.x<this.min.x||point.x>this.max.x||point.y<this.min.y||point.y>this.max.y||
point.z<this.min.z||point.z>this.max.z)return false;return true},containsBox:function(box){if(this.min.x<=box.min.x&&box.max.x<=this.max.x&&this.min.y<=box.min.y&&box.max.y<=this.max.y&&this.min.z<=box.min.z&&box.max.z<=this.max.z)return true;return false},getParameter:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.set((point.x-this.min.x)/(this.max.x-this.min.x),(point.y-this.min.y)/(this.max.y-this.min.y),(point.z-this.min.z)/(this.max.z-this.min.z))},
intersectsBox:function(box){if(box.max.x<this.min.x||box.min.x>this.max.x||box.max.y<this.min.y||box.min.y>this.max.y||box.max.z<this.min.z||box.min.z>this.max.z)return false;return true},intersectsSphere:function(){var closestPoint;return function intersectsSphere(sphere){if(closestPoint===undefined)closestPoint=new THREE.Vector3;this.clampPoint(sphere.center,closestPoint);return closestPoint.distanceToSquared(sphere.center)<=sphere.radius*sphere.radius}}(),intersectsPlane:function(plane){var min,
max;if(plane.normal.x>0){min=plane.normal.x*this.min.x;max=plane.normal.x*this.max.x}else{min=plane.normal.x*this.max.x;max=plane.normal.x*this.min.x}if(plane.normal.y>0){min+=plane.normal.y*this.min.y;max+=plane.normal.y*this.max.y}else{min+=plane.normal.y*this.max.y;max+=plane.normal.y*this.min.y}if(plane.normal.z>0){min+=plane.normal.z*this.min.z;max+=plane.normal.z*this.max.z}else{min+=plane.normal.z*this.max.z;max+=plane.normal.z*this.min.z}return min<=plane.constant&&max>=plane.constant},clampPoint:function(point,
optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(point).clamp(this.min,this.max)},distanceToPoint:function(){var v1=new THREE.Vector3;return function(point){var clampedPoint=v1.copy(point).clamp(this.min,this.max);return clampedPoint.sub(point).length()}}(),getBoundingSphere:function(){var v1=new THREE.Vector3;return function(optionalTarget){var result=optionalTarget||new THREE.Sphere;result.center=this.center();result.radius=this.size(v1).length()*.5;return result}}(),
intersect:function(box){this.min.max(box.min);this.max.min(box.max);if(this.isEmpty())this.makeEmpty();return this},union:function(box){this.min.min(box.min);this.max.max(box.max);return this},applyMatrix4:function(){var points=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(matrix){if(this.isEmpty())return this;points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(matrix);points[1].set(this.min.x,
this.min.y,this.max.z).applyMatrix4(matrix);points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(matrix);points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(matrix);points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(matrix);points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(matrix);points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(matrix);points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(matrix);this.setFromPoints(points);return this}}(),
translate:function(offset){this.min.add(offset);this.max.add(offset);return this},equals:function(box){return box.min.equals(this.min)&&box.max.equals(this.max)}};THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);if(arguments.length>0)console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(n11,n12,n13,n21,n22,n23,n31,n32,n33){var te=this.elements;te[0]=n11;te[1]=n21;te[2]=n31;te[3]=n12;te[4]=n22;te[5]=n32;te[6]=n13;te[7]=n23;te[8]=n33;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(m){var me=m.elements;this.set(me[0],me[3],me[6],me[1],me[4],me[7],me[2],me[5],me[8]);return this},setFromMatrix4:function(m){var me=
m.elements;this.set(me[0],me[4],me[8],me[1],me[5],me[9],me[2],me[6],me[10]);return this},applyToVector3Array:function(){var v1;return function(array,offset,length){if(v1===undefined)v1=new THREE.Vector3;if(offset===undefined)offset=0;if(length===undefined)length=array.length;for(var i=0,j=offset;i<length;i+=3,j+=3){v1.fromArray(array,j);v1.applyMatrix3(this);v1.toArray(array,j)}return array}}(),applyToBuffer:function(){var v1;return function applyToBuffer(buffer,offset,length){if(v1===undefined)v1=
new THREE.Vector3;if(offset===undefined)offset=0;if(length===undefined)length=buffer.length/buffer.itemSize;for(var i=0,j=offset;i<length;i++,j++){v1.x=buffer.getX(j);v1.y=buffer.getY(j);v1.z=buffer.getZ(j);v1.applyMatrix3(this);buffer.setXYZ(v1.x,v1.y,v1.z)}return buffer}}(),multiplyScalar:function(s){var te=this.elements;te[0]*=s;te[3]*=s;te[6]*=s;te[1]*=s;te[4]*=s;te[7]*=s;te[2]*=s;te[5]*=s;te[8]*=s;return this},determinant:function(){var te=this.elements;var a=te[0],b=te[1],c=te[2],d=te[3],e=
te[4],f=te[5],g=te[6],h=te[7],i=te[8];return a*e*i-a*f*h-b*d*i+b*f*g+c*d*h-c*e*g},getInverse:function(matrix,throwOnDegenerate){if(matrix instanceof THREE.Matrix4)console.error("THREE.Matrix3.getInverse no longer takes a Matrix4 argument.");var me=matrix.elements,te=this.elements,n11=me[0],n21=me[1],n31=me[2],n12=me[3],n22=me[4],n32=me[5],n13=me[6],n23=me[7],n33=me[8],t11=n33*n22-n32*n23,t12=n32*n13-n33*n12,t13=n23*n12-n22*n13,det=n11*t11+n21*t12+n31*t13;if(det===0){var msg="THREE.Matrix3.getInverse(): can't invert matrix, determinant is 0";
if(throwOnDegenerate||false)throw new Error(msg);else console.warn(msg);return this.identity()}var detInv=1/det;te[0]=t11*detInv;te[1]=(n31*n23-n33*n21)*detInv;te[2]=(n32*n21-n31*n22)*detInv;te[3]=t12*detInv;te[4]=(n33*n11-n31*n13)*detInv;te[5]=(n31*n12-n32*n11)*detInv;te[6]=t13*detInv;te[7]=(n21*n13-n23*n11)*detInv;te[8]=(n22*n11-n21*n12)*detInv;return this},transpose:function(){var tmp,m=this.elements;tmp=m[1];m[1]=m[3];m[3]=tmp;tmp=m[2];m[2]=m[6];m[6]=tmp;tmp=m[5];m[5]=m[7];m[7]=tmp;return this},
flattenToArrayOffset:function(array,offset){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated "+"- just use .toArray instead.");return this.toArray(array,offset)},getNormalMatrix:function(matrix4){return this.setFromMatrix4(matrix4).getInverse(this).transpose()},transposeIntoArray:function(r){var m=this.elements;r[0]=m[0];r[1]=m[3];r[2]=m[6];r[3]=m[1];r[4]=m[4];r[5]=m[7];r[6]=m[2];r[7]=m[5];r[8]=m[8];return this},fromArray:function(array){this.elements.set(array);return this},toArray:function(array,
offset){if(array===undefined)array=[];if(offset===undefined)offset=0;var te=this.elements;array[offset]=te[0];array[offset+1]=te[1];array[offset+2]=te[2];array[offset+3]=te[3];array[offset+4]=te[4];array[offset+5]=te[5];array[offset+6]=te[6];array[offset+7]=te[7];array[offset+8]=te[8];return array}};THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);if(arguments.length>0)console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(n11,n12,n13,n14,n21,n22,n23,n24,n31,n32,n33,n34,n41,n42,n43,n44){var te=this.elements;te[0]=n11;te[4]=n12;te[8]=n13;te[12]=n14;te[1]=n21;te[5]=n22;te[9]=n23;te[13]=n24;te[2]=n31;te[6]=n32;te[10]=n33;te[14]=n34;te[3]=n41;te[7]=n42;te[11]=n43;te[15]=n44;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)},copy:function(m){this.elements.set(m.elements);
return this},copyPosition:function(m){var te=this.elements;var me=m.elements;te[12]=me[12];te[13]=me[13];te[14]=me[14];return this},extractBasis:function(xAxis,yAxis,zAxis){xAxis.setFromMatrixColumn(this,0);yAxis.setFromMatrixColumn(this,1);zAxis.setFromMatrixColumn(this,2);return this},makeBasis:function(xAxis,yAxis,zAxis){this.set(xAxis.x,yAxis.x,zAxis.x,0,xAxis.y,yAxis.y,zAxis.y,0,xAxis.z,yAxis.z,zAxis.z,0,0,0,0,1);return this},extractRotation:function(){var v1;return function(m){if(v1===undefined)v1=
new THREE.Vector3;var te=this.elements;var me=m.elements;var scaleX=1/v1.setFromMatrixColumn(m,0).length();var scaleY=1/v1.setFromMatrixColumn(m,1).length();var scaleZ=1/v1.setFromMatrixColumn(m,2).length();te[0]=me[0]*scaleX;te[1]=me[1]*scaleX;te[2]=me[2]*scaleX;te[4]=me[4]*scaleY;te[5]=me[5]*scaleY;te[6]=me[6]*scaleY;te[8]=me[8]*scaleZ;te[9]=me[9]*scaleZ;te[10]=me[10]*scaleZ;return this}}(),makeRotationFromEuler:function(euler){if(euler instanceof THREE.Euler===false)console.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
var te=this.elements;var x=euler.x,y=euler.y,z=euler.z;var a=Math.cos(x),b=Math.sin(x);var c=Math.cos(y),d=Math.sin(y);var e=Math.cos(z),f=Math.sin(z);if(euler.order==="XYZ"){var ae=a*e,af=a*f,be=b*e,bf=b*f;te[0]=c*e;te[4]=-c*f;te[8]=d;te[1]=af+be*d;te[5]=ae-bf*d;te[9]=-b*c;te[2]=bf-ae*d;te[6]=be+af*d;te[10]=a*c}else if(euler.order==="YXZ"){var ce=c*e,cf=c*f,de=d*e,df=d*f;te[0]=ce+df*b;te[4]=de*b-cf;te[8]=a*d;te[1]=a*f;te[5]=a*e;te[9]=-b;te[2]=cf*b-de;te[6]=df+ce*b;te[10]=a*c}else if(euler.order===
"ZXY"){var ce=c*e,cf=c*f,de=d*e,df=d*f;te[0]=ce-df*b;te[4]=-a*f;te[8]=de+cf*b;te[1]=cf+de*b;te[5]=a*e;te[9]=df-ce*b;te[2]=-a*d;te[6]=b;te[10]=a*c}else if(euler.order==="ZYX"){var ae=a*e,af=a*f,be=b*e,bf=b*f;te[0]=c*e;te[4]=be*d-af;te[8]=ae*d+bf;te[1]=c*f;te[5]=bf*d+ae;te[9]=af*d-be;te[2]=-d;te[6]=b*c;te[10]=a*c}else if(euler.order==="YZX"){var ac=a*c,ad=a*d,bc=b*c,bd=b*d;te[0]=c*e;te[4]=bd-ac*f;te[8]=bc*f+ad;te[1]=f;te[5]=a*e;te[9]=-b*e;te[2]=-d*e;te[6]=ad*f+bc;te[10]=ac-bd*f}else if(euler.order===
"XZY"){var ac=a*c,ad=a*d,bc=b*c,bd=b*d;te[0]=c*e;te[4]=-f;te[8]=d*e;te[1]=ac*f+bd;te[5]=a*e;te[9]=ad*f-bc;te[2]=bc*f-ad;te[6]=b*e;te[10]=bd*f+ac}te[3]=0;te[7]=0;te[11]=0;te[12]=0;te[13]=0;te[14]=0;te[15]=1;return this},makeRotationFromQuaternion:function(q){var te=this.elements;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x+x,y2=y+y,z2=z+z;var xx=x*x2,xy=x*y2,xz=x*z2;var yy=y*y2,yz=y*z2,zz=z*z2;var wx=w*x2,wy=w*y2,wz=w*z2;te[0]=1-(yy+zz);te[4]=xy-wz;te[8]=xz+wy;te[1]=xy+wz;te[5]=1-(xx+zz);te[9]=yz-wx;te[2]=
xz-wy;te[6]=yz+wx;te[10]=1-(xx+yy);te[3]=0;te[7]=0;te[11]=0;te[12]=0;te[13]=0;te[14]=0;te[15]=1;return this},lookAt:function(){var x,y,z;return function(eye,target,up){if(x===undefined){x=new THREE.Vector3;y=new THREE.Vector3;z=new THREE.Vector3}var te=this.elements;z.subVectors(eye,target).normalize();if(z.lengthSq()===0)z.z=1;x.crossVectors(up,z).normalize();if(x.lengthSq()===0){z.z+=1E-4;x.crossVectors(up,z).normalize()}y.crossVectors(z,x);te[0]=x.x;te[4]=y.x;te[8]=z.x;te[1]=x.y;te[5]=y.y;te[9]=
z.y;te[2]=x.z;te[6]=y.z;te[10]=z.z;return this}}(),multiply:function(m,n){if(n!==undefined){console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(m,n)}return this.multiplyMatrices(this,m)},premultiply:function(m){return this.multiplyMatrices(m,this)},multiplyMatrices:function(a,b){var ae=a.elements;var be=b.elements;var te=this.elements;var a11=ae[0],a12=ae[4],a13=ae[8],a14=ae[12];var a21=ae[1],a22=ae[5],a23=ae[9],
a24=ae[13];var a31=ae[2],a32=ae[6],a33=ae[10],a34=ae[14];var a41=ae[3],a42=ae[7],a43=ae[11],a44=ae[15];var b11=be[0],b12=be[4],b13=be[8],b14=be[12];var b21=be[1],b22=be[5],b23=be[9],b24=be[13];var b31=be[2],b32=be[6],b33=be[10],b34=be[14];var b41=be[3],b42=be[7],b43=be[11],b44=be[15];te[0]=a11*b11+a12*b21+a13*b31+a14*b41;te[4]=a11*b12+a12*b22+a13*b32+a14*b42;te[8]=a11*b13+a12*b23+a13*b33+a14*b43;te[12]=a11*b14+a12*b24+a13*b34+a14*b44;te[1]=a21*b11+a22*b21+a23*b31+a24*b41;te[5]=a21*b12+a22*b22+a23*
b32+a24*b42;te[9]=a21*b13+a22*b23+a23*b33+a24*b43;te[13]=a21*b14+a22*b24+a23*b34+a24*b44;te[2]=a31*b11+a32*b21+a33*b31+a34*b41;te[6]=a31*b12+a32*b22+a33*b32+a34*b42;te[10]=a31*b13+a32*b23+a33*b33+a34*b43;te[14]=a31*b14+a32*b24+a33*b34+a34*b44;te[3]=a41*b11+a42*b21+a43*b31+a44*b41;te[7]=a41*b12+a42*b22+a43*b32+a44*b42;te[11]=a41*b13+a42*b23+a43*b33+a44*b43;te[15]=a41*b14+a42*b24+a43*b34+a44*b44;return this},multiplyToArray:function(a,b,r){var te=this.elements;this.multiplyMatrices(a,b);r[0]=te[0];
r[1]=te[1];r[2]=te[2];r[3]=te[3];r[4]=te[4];r[5]=te[5];r[6]=te[6];r[7]=te[7];r[8]=te[8];r[9]=te[9];r[10]=te[10];r[11]=te[11];r[12]=te[12];r[13]=te[13];r[14]=te[14];r[15]=te[15];return this},multiplyScalar:function(s){var te=this.elements;te[0]*=s;te[4]*=s;te[8]*=s;te[12]*=s;te[1]*=s;te[5]*=s;te[9]*=s;te[13]*=s;te[2]*=s;te[6]*=s;te[10]*=s;te[14]*=s;te[3]*=s;te[7]*=s;te[11]*=s;te[15]*=s;return this},applyToVector3Array:function(){var v1;return function(array,offset,length){if(v1===undefined)v1=new THREE.Vector3;
if(offset===undefined)offset=0;if(length===undefined)length=array.length;for(var i=0,j=offset;i<length;i+=3,j+=3){v1.fromArray(array,j);v1.applyMatrix4(this);v1.toArray(array,j)}return array}}(),applyToBuffer:function(){var v1;return function applyToBuffer(buffer,offset,length){if(v1===undefined)v1=new THREE.Vector3;if(offset===undefined)offset=0;if(length===undefined)length=buffer.length/buffer.itemSize;for(var i=0,j=offset;i<length;i++,j++){v1.x=buffer.getX(j);v1.y=buffer.getY(j);v1.z=buffer.getZ(j);
v1.applyMatrix4(this);buffer.setXYZ(v1.x,v1.y,v1.z)}return buffer}}(),determinant:function(){var te=this.elements;var n11=te[0],n12=te[4],n13=te[8],n14=te[12];var n21=te[1],n22=te[5],n23=te[9],n24=te[13];var n31=te[2],n32=te[6],n33=te[10],n34=te[14];var n41=te[3],n42=te[7],n43=te[11],n44=te[15];return n41*(+n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34)+n42*(+n11*n23*n34-n11*n24*n33+n14*n21*n33-n13*n21*n34+n13*n24*n31-n14*n23*n31)+n43*(+n11*n24*n32-n11*n22*n34-n14*n21*n32+
n12*n21*n34+n14*n22*n31-n12*n24*n31)+n44*(-n13*n22*n31-n11*n23*n32+n11*n22*n33+n13*n21*n32-n12*n21*n33+n12*n23*n31)},transpose:function(){var te=this.elements;var tmp;tmp=te[1];te[1]=te[4];te[4]=tmp;tmp=te[2];te[2]=te[8];te[8]=tmp;tmp=te[6];te[6]=te[9];te[9]=tmp;tmp=te[3];te[3]=te[12];te[12]=tmp;tmp=te[7];te[7]=te[13];te[13]=tmp;tmp=te[11];te[11]=te[14];te[14]=tmp;return this},flattenToArrayOffset:function(array,offset){console.warn("THREE.Matrix3: .flattenToArrayOffset is deprecated "+"- just use .toArray instead.");
return this.toArray(array,offset)},getPosition:function(){var v1;return function(){if(v1===undefined)v1=new THREE.Vector3;console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");return v1.setFromMatrixColumn(this,3)}}(),setPosition:function(v){var te=this.elements;te[12]=v.x;te[13]=v.y;te[14]=v.z;return this},getInverse:function(m,throwOnDegenerate){var te=this.elements,me=m.elements,n11=me[0],n21=me[1],n31=me[2],n41=me[3],n12=me[4],n22=
me[5],n32=me[6],n42=me[7],n13=me[8],n23=me[9],n33=me[10],n43=me[11],n14=me[12],n24=me[13],n34=me[14],n44=me[15],t11=n23*n34*n42-n24*n33*n42+n24*n32*n43-n22*n34*n43-n23*n32*n44+n22*n33*n44,t12=n14*n33*n42-n13*n34*n42-n14*n32*n43+n12*n34*n43+n13*n32*n44-n12*n33*n44,t13=n13*n24*n42-n14*n23*n42+n14*n22*n43-n12*n24*n43-n13*n22*n44+n12*n23*n44,t14=n14*n23*n32-n13*n24*n32-n14*n22*n33+n12*n24*n33+n13*n22*n34-n12*n23*n34;var det=n11*t11+n21*t12+n31*t13+n41*t14;if(det===0){var msg="THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0";
if(throwOnDegenerate||false)throw new Error(msg);else console.warn(msg);return this.identity()}var detInv=1/det;te[0]=t11*detInv;te[1]=(n24*n33*n41-n23*n34*n41-n24*n31*n43+n21*n34*n43+n23*n31*n44-n21*n33*n44)*detInv;te[2]=(n22*n34*n41-n24*n32*n41+n24*n31*n42-n21*n34*n42-n22*n31*n44+n21*n32*n44)*detInv;te[3]=(n23*n32*n41-n22*n33*n41-n23*n31*n42+n21*n33*n42+n22*n31*n43-n21*n32*n43)*detInv;te[4]=t12*detInv;te[5]=(n13*n34*n41-n14*n33*n41+n14*n31*n43-n11*n34*n43-n13*n31*n44+n11*n33*n44)*detInv;te[6]=(n14*
n32*n41-n12*n34*n41-n14*n31*n42+n11*n34*n42+n12*n31*n44-n11*n32*n44)*detInv;te[7]=(n12*n33*n41-n13*n32*n41+n13*n31*n42-n11*n33*n42-n12*n31*n43+n11*n32*n43)*detInv;te[8]=t13*detInv;te[9]=(n14*n23*n41-n13*n24*n41-n14*n21*n43+n11*n24*n43+n13*n21*n44-n11*n23*n44)*detInv;te[10]=(n12*n24*n41-n14*n22*n41+n14*n21*n42-n11*n24*n42-n12*n21*n44+n11*n22*n44)*detInv;te[11]=(n13*n22*n41-n12*n23*n41-n13*n21*n42+n11*n23*n42+n12*n21*n43-n11*n22*n43)*detInv;te[12]=t14*detInv;te[13]=(n13*n24*n31-n14*n23*n31+n14*n21*
n33-n11*n24*n33-n13*n21*n34+n11*n23*n34)*detInv;te[14]=(n14*n22*n31-n12*n24*n31-n14*n21*n32+n11*n24*n32+n12*n21*n34-n11*n22*n34)*detInv;te[15]=(n12*n23*n31-n13*n22*n31+n13*n21*n32-n11*n23*n32-n12*n21*n33+n11*n22*n33)*detInv;return this},scale:function(v){var te=this.elements;var x=v.x,y=v.y,z=v.z;te[0]*=x;te[4]*=y;te[8]*=z;te[1]*=x;te[5]*=y;te[9]*=z;te[2]*=x;te[6]*=y;te[10]*=z;te[3]*=x;te[7]*=y;te[11]*=z;return this},getMaxScaleOnAxis:function(){var te=this.elements;var scaleXSq=te[0]*te[0]+te[1]*
te[1]+te[2]*te[2];var scaleYSq=te[4]*te[4]+te[5]*te[5]+te[6]*te[6];var scaleZSq=te[8]*te[8]+te[9]*te[9]+te[10]*te[10];return Math.sqrt(Math.max(scaleXSq,scaleYSq,scaleZSq))},makeTranslation:function(x,y,z){this.set(1,0,0,x,0,1,0,y,0,0,1,z,0,0,0,1);return this},makeRotationX:function(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(1,0,0,0,0,c,-s,0,0,s,c,0,0,0,0,1);return this},makeRotationY:function(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(c,0,s,0,0,1,0,0,-s,0,c,0,0,0,0,1);return this},
makeRotationZ:function(theta){var c=Math.cos(theta),s=Math.sin(theta);this.set(c,-s,0,0,s,c,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(axis,angle){var c=Math.cos(angle);var s=Math.sin(angle);var t=1-c;var x=axis.x,y=axis.y,z=axis.z;var tx=t*x,ty=t*y;this.set(tx*x+c,tx*y-s*z,tx*z+s*y,0,tx*y+s*z,ty*y+c,ty*z-s*x,0,tx*z-s*y,ty*z+s*x,t*z*z+c,0,0,0,0,1);return this},makeScale:function(x,y,z){this.set(x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1);return this},compose:function(position,quaternion,scale){this.makeRotationFromQuaternion(quaternion);
this.scale(scale);this.setPosition(position);return this},decompose:function(){var vector,matrix;return function(position,quaternion,scale){if(vector===undefined){vector=new THREE.Vector3;matrix=new THREE.Matrix4}var te=this.elements;var sx=vector.set(te[0],te[1],te[2]).length();var sy=vector.set(te[4],te[5],te[6]).length();var sz=vector.set(te[8],te[9],te[10]).length();var det=this.determinant();if(det<0)sx=-sx;position.x=te[12];position.y=te[13];position.z=te[14];matrix.elements.set(this.elements);
var invSX=1/sx;var invSY=1/sy;var invSZ=1/sz;matrix.elements[0]*=invSX;matrix.elements[1]*=invSX;matrix.elements[2]*=invSX;matrix.elements[4]*=invSY;matrix.elements[5]*=invSY;matrix.elements[6]*=invSY;matrix.elements[8]*=invSZ;matrix.elements[9]*=invSZ;matrix.elements[10]*=invSZ;quaternion.setFromRotationMatrix(matrix);scale.x=sx;scale.y=sy;scale.z=sz;return this}}(),makeFrustum:function(left,right,bottom,top,near,far){var te=this.elements;var x=2*near/(right-left);var y=2*near/(top-bottom);var a=
(right+left)/(right-left);var b=(top+bottom)/(top-bottom);var c=-(far+near)/(far-near);var d=-2*far*near/(far-near);te[0]=x;te[4]=0;te[8]=a;te[12]=0;te[1]=0;te[5]=y;te[9]=b;te[13]=0;te[2]=0;te[6]=0;te[10]=c;te[14]=d;te[3]=0;te[7]=0;te[11]=-1;te[15]=0;return this},makePerspective:function(fov,aspect,near,far){var ymax=near*Math.tan(THREE.Math.DEG2RAD*fov*.5);var ymin=-ymax;var xmin=ymin*aspect;var xmax=ymax*aspect;return this.makeFrustum(xmin,xmax,ymin,ymax,near,far)},makeOrthographic:function(left,
right,top,bottom,near,far){var te=this.elements;var w=1/(right-left);var h=1/(top-bottom);var p=1/(far-near);var x=(right+left)*w;var y=(top+bottom)*h;var z=(far+near)*p;te[0]=2*w;te[4]=0;te[8]=0;te[12]=-x;te[1]=0;te[5]=2*h;te[9]=0;te[13]=-y;te[2]=0;te[6]=0;te[10]=-2*p;te[14]=-z;te[3]=0;te[7]=0;te[11]=0;te[15]=1;return this},equals:function(matrix){var te=this.elements;var me=matrix.elements;for(var i=0;i<16;i++)if(te[i]!==me[i])return false;return true},fromArray:function(array){this.elements.set(array);
return this},toArray:function(array,offset){if(array===undefined)array=[];if(offset===undefined)offset=0;var te=this.elements;array[offset]=te[0];array[offset+1]=te[1];array[offset+2]=te[2];array[offset+3]=te[3];array[offset+4]=te[4];array[offset+5]=te[5];array[offset+6]=te[6];array[offset+7]=te[7];array[offset+8]=te[8];array[offset+9]=te[9];array[offset+10]=te[10];array[offset+11]=te[11];array[offset+12]=te[12];array[offset+13]=te[13];array[offset+14]=te[14];array[offset+15]=te[15];return array}};
THREE.Ray=function(origin,direction){this.origin=origin!==undefined?origin:new THREE.Vector3;this.direction=direction!==undefined?direction:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(origin,direction){this.origin.copy(origin);this.direction.copy(direction);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(ray){this.origin.copy(ray.origin);this.direction.copy(ray.direction);return this},at:function(t,optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(v){this.direction.copy(v).sub(this.origin).normalize();
return this},recast:function(){var v1=new THREE.Vector3;return function(t){this.origin.copy(this.at(t,v1));return this}}(),closestPointToPoint:function(point,optionalTarget){var result=optionalTarget||new THREE.Vector3;result.subVectors(point,this.origin);var directionDistance=result.dot(this.direction);if(directionDistance<0)return result.copy(this.origin);return result.copy(this.direction).multiplyScalar(directionDistance).add(this.origin)},distanceToPoint:function(point){return Math.sqrt(this.distanceSqToPoint(point))},
distanceSqToPoint:function(){var v1=new THREE.Vector3;return function(point){var directionDistance=v1.subVectors(point,this.origin).dot(this.direction);if(directionDistance<0)return this.origin.distanceToSquared(point);v1.copy(this.direction).multiplyScalar(directionDistance).add(this.origin);return v1.distanceToSquared(point)}}(),distanceSqToSegment:function(){var segCenter=new THREE.Vector3;var segDir=new THREE.Vector3;var diff=new THREE.Vector3;return function(v0,v1,optionalPointOnRay,optionalPointOnSegment){segCenter.copy(v0).add(v1).multiplyScalar(.5);
segDir.copy(v1).sub(v0).normalize();diff.copy(this.origin).sub(segCenter);var segExtent=v0.distanceTo(v1)*.5;var a01=-this.direction.dot(segDir);var b0=diff.dot(this.direction);var b1=-diff.dot(segDir);var c=diff.lengthSq();var det=Math.abs(1-a01*a01);var s0,s1,sqrDist,extDet;if(det>0){s0=a01*b1-b0;s1=a01*b0-b1;extDet=segExtent*det;if(s0>=0)if(s1>=-extDet)if(s1<=extDet){var invDet=1/det;s0*=invDet;s1*=invDet;sqrDist=s0*(s0+a01*s1+2*b0)+s1*(a01*s0+s1+2*b1)+c}else{s1=segExtent;s0=Math.max(0,-(a01*s1+
b0));sqrDist=-s0*s0+s1*(s1+2*b1)+c}else{s1=-segExtent;s0=Math.max(0,-(a01*s1+b0));sqrDist=-s0*s0+s1*(s1+2*b1)+c}else if(s1<=-extDet){s0=Math.max(0,-(-a01*segExtent+b0));s1=s0>0?-segExtent:Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist=-s0*s0+s1*(s1+2*b1)+c}else if(s1<=extDet){s0=0;s1=Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist=s1*(s1+2*b1)+c}else{s0=Math.max(0,-(a01*segExtent+b0));s1=s0>0?segExtent:Math.min(Math.max(-segExtent,-b1),segExtent);sqrDist=-s0*s0+s1*(s1+2*b1)+c}}else{s1=
a01>0?-segExtent:segExtent;s0=Math.max(0,-(a01*s1+b0));sqrDist=-s0*s0+s1*(s1+2*b1)+c}if(optionalPointOnRay)optionalPointOnRay.copy(this.direction).multiplyScalar(s0).add(this.origin);if(optionalPointOnSegment)optionalPointOnSegment.copy(segDir).multiplyScalar(s1).add(segCenter);return sqrDist}}(),intersectSphere:function(){var v1=new THREE.Vector3;return function(sphere,optionalTarget){v1.subVectors(sphere.center,this.origin);var tca=v1.dot(this.direction);var d2=v1.dot(v1)-tca*tca;var radius2=sphere.radius*
sphere.radius;if(d2>radius2)return null;var thc=Math.sqrt(radius2-d2);var t0=tca-thc;var t1=tca+thc;if(t0<0&&t1<0)return null;if(t0<0)return this.at(t1,optionalTarget);return this.at(t0,optionalTarget)}}(),intersectsSphere:function(sphere){return this.distanceToPoint(sphere.center)<=sphere.radius},distanceToPlane:function(plane){var denominator=plane.normal.dot(this.direction);if(denominator===0){if(plane.distanceToPoint(this.origin)===0)return 0;return null}var t=-(this.origin.dot(plane.normal)+
plane.constant)/denominator;return t>=0?t:null},intersectPlane:function(plane,optionalTarget){var t=this.distanceToPlane(plane);if(t===null)return null;return this.at(t,optionalTarget)},intersectsPlane:function(plane){var distToPoint=plane.distanceToPoint(this.origin);if(distToPoint===0)return true;var denominator=plane.normal.dot(this.direction);if(denominator*distToPoint<0)return true;return false},intersectBox:function(box,optionalTarget){var tmin,tmax,tymin,tymax,tzmin,tzmax;var invdirx=1/this.direction.x,
invdiry=1/this.direction.y,invdirz=1/this.direction.z;var origin=this.origin;if(invdirx>=0){tmin=(box.min.x-origin.x)*invdirx;tmax=(box.max.x-origin.x)*invdirx}else{tmin=(box.max.x-origin.x)*invdirx;tmax=(box.min.x-origin.x)*invdirx}if(invdiry>=0){tymin=(box.min.y-origin.y)*invdiry;tymax=(box.max.y-origin.y)*invdiry}else{tymin=(box.max.y-origin.y)*invdiry;tymax=(box.min.y-origin.y)*invdiry}if(tmin>tymax||tymin>tmax)return null;if(tymin>tmin||tmin!==tmin)tmin=tymin;if(tymax<tmax||tmax!==tmax)tmax=
tymax;if(invdirz>=0){tzmin=(box.min.z-origin.z)*invdirz;tzmax=(box.max.z-origin.z)*invdirz}else{tzmin=(box.max.z-origin.z)*invdirz;tzmax=(box.min.z-origin.z)*invdirz}if(tmin>tzmax||tzmin>tmax)return null;if(tzmin>tmin||tmin!==tmin)tmin=tzmin;if(tzmax<tmax||tmax!==tmax)tmax=tzmax;if(tmax<0)return null;return this.at(tmin>=0?tmin:tmax,optionalTarget)},intersectsBox:function(){var v=new THREE.Vector3;return function(box){return this.intersectBox(box,v)!==null}}(),intersectTriangle:function(){var diff=
new THREE.Vector3;var edge1=new THREE.Vector3;var edge2=new THREE.Vector3;var normal=new THREE.Vector3;return function(a,b,c,backfaceCulling,optionalTarget){edge1.subVectors(b,a);edge2.subVectors(c,a);normal.crossVectors(edge1,edge2);var DdN=this.direction.dot(normal);var sign;if(DdN>0){if(backfaceCulling)return null;sign=1}else if(DdN<0){sign=-1;DdN=-DdN}else return null;diff.subVectors(this.origin,a);var DdQxE2=sign*this.direction.dot(edge2.crossVectors(diff,edge2));if(DdQxE2<0)return null;var DdE1xQ=
sign*this.direction.dot(edge1.cross(diff));if(DdE1xQ<0)return null;if(DdQxE2+DdE1xQ>DdN)return null;var QdN=-sign*diff.dot(normal);if(QdN<0)return null;return this.at(QdN/DdN,optionalTarget)}}(),applyMatrix4:function(matrix4){this.direction.add(this.origin).applyMatrix4(matrix4);this.origin.applyMatrix4(matrix4);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(ray){return ray.origin.equals(this.origin)&&ray.direction.equals(this.direction)}};
THREE.Sphere=function(center,radius){this.center=center!==undefined?center:new THREE.Vector3;this.radius=radius!==undefined?radius:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(center,radius){this.center.copy(center);this.radius=radius;return this},setFromPoints:function(){var box=new THREE.Box3;return function(points,optionalCenter){var center=this.center;if(optionalCenter!==undefined)center.copy(optionalCenter);else box.setFromPoints(points).center(center);var maxRadiusSq=0;for(var i=0,il=points.length;i<il;i++)maxRadiusSq=Math.max(maxRadiusSq,center.distanceToSquared(points[i]));this.radius=Math.sqrt(maxRadiusSq);
return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(sphere){this.center.copy(sphere.center);this.radius=sphere.radius;return this},empty:function(){return this.radius<=0},containsPoint:function(point){return point.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(point){return point.distanceTo(this.center)-this.radius},intersectsSphere:function(sphere){var radiusSum=this.radius+sphere.radius;return sphere.center.distanceToSquared(this.center)<=
radiusSum*radiusSum},intersectsBox:function(box){return box.intersectsSphere(this)},intersectsPlane:function(plane){return Math.abs(this.center.dot(plane.normal)-plane.constant)<=this.radius},clampPoint:function(point,optionalTarget){var deltaLengthSq=this.center.distanceToSquared(point);var result=optionalTarget||new THREE.Vector3;result.copy(point);if(deltaLengthSq>this.radius*this.radius){result.sub(this.center).normalize();result.multiplyScalar(this.radius).add(this.center)}return result},getBoundingBox:function(optionalTarget){var box=
optionalTarget||new THREE.Box3;box.set(this.center,this.center);box.expandByScalar(this.radius);return box},applyMatrix4:function(matrix){this.center.applyMatrix4(matrix);this.radius=this.radius*matrix.getMaxScaleOnAxis();return this},translate:function(offset){this.center.add(offset);return this},equals:function(sphere){return sphere.center.equals(this.center)&&sphere.radius===this.radius}};
THREE.Frustum=function(p0,p1,p2,p3,p4,p5){this.planes=[p0!==undefined?p0:new THREE.Plane,p1!==undefined?p1:new THREE.Plane,p2!==undefined?p2:new THREE.Plane,p3!==undefined?p3:new THREE.Plane,p4!==undefined?p4:new THREE.Plane,p5!==undefined?p5:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(p0,p1,p2,p3,p4,p5){var planes=this.planes;planes[0].copy(p0);planes[1].copy(p1);planes[2].copy(p2);planes[3].copy(p3);planes[4].copy(p4);planes[5].copy(p5);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(frustum){var planes=this.planes;for(var i=0;i<6;i++)planes[i].copy(frustum.planes[i]);return this},setFromMatrix:function(m){var planes=this.planes;var me=m.elements;var me0=me[0],me1=me[1],me2=me[2],
me3=me[3];var me4=me[4],me5=me[5],me6=me[6],me7=me[7];var me8=me[8],me9=me[9],me10=me[10],me11=me[11];var me12=me[12],me13=me[13],me14=me[14],me15=me[15];planes[0].setComponents(me3-me0,me7-me4,me11-me8,me15-me12).normalize();planes[1].setComponents(me3+me0,me7+me4,me11+me8,me15+me12).normalize();planes[2].setComponents(me3+me1,me7+me5,me11+me9,me15+me13).normalize();planes[3].setComponents(me3-me1,me7-me5,me11-me9,me15-me13).normalize();planes[4].setComponents(me3-me2,me7-me6,me11-me10,me15-me14).normalize();
planes[5].setComponents(me3+me2,me7+me6,me11+me10,me15+me14).normalize();return this},intersectsObject:function(){var sphere=new THREE.Sphere;return function(object){var geometry=object.geometry;if(geometry.boundingSphere===null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere).applyMatrix4(object.matrixWorld);return this.intersectsSphere(sphere)}}(),intersectsSprite:function(){var sphere=new THREE.Sphere;return function(sprite){sphere.center.set(0,0,0);sphere.radius=.7071067811865476;
sphere.applyMatrix4(sprite.matrixWorld);return this.intersectsSphere(sphere)}}(),intersectsSphere:function(sphere){var planes=this.planes;var center=sphere.center;var negRadius=-sphere.radius;for(var i=0;i<6;i++){var distance=planes[i].distanceToPoint(center);if(distance<negRadius)return false}return true},intersectsBox:function(){var p1=new THREE.Vector3,p2=new THREE.Vector3;return function(box){var planes=this.planes;for(var i=0;i<6;i++){var plane=planes[i];p1.x=plane.normal.x>0?box.min.x:box.max.x;
p2.x=plane.normal.x>0?box.max.x:box.min.x;p1.y=plane.normal.y>0?box.min.y:box.max.y;p2.y=plane.normal.y>0?box.max.y:box.min.y;p1.z=plane.normal.z>0?box.min.z:box.max.z;p2.z=plane.normal.z>0?box.max.z:box.min.z;var d1=plane.distanceToPoint(p1);var d2=plane.distanceToPoint(p2);if(d1<0&&d2<0)return false}return true}}(),containsPoint:function(point){var planes=this.planes;for(var i=0;i<6;i++)if(planes[i].distanceToPoint(point)<0)return false;return true}};
THREE.Plane=function(normal,constant){this.normal=normal!==undefined?normal:new THREE.Vector3(1,0,0);this.constant=constant!==undefined?constant:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(normal,constant){this.normal.copy(normal);this.constant=constant;return this},setComponents:function(x,y,z,w){this.normal.set(x,y,z);this.constant=w;return this},setFromNormalAndCoplanarPoint:function(normal,point){this.normal.copy(normal);this.constant=-point.dot(this.normal);return this},setFromCoplanarPoints:function(){var v1=new THREE.Vector3;var v2=new THREE.Vector3;return function(a,b,c){var normal=v1.subVectors(c,b).cross(v2.subVectors(a,
b)).normalize();this.setFromNormalAndCoplanarPoint(normal,a);return this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(plane){this.normal.copy(plane.normal);this.constant=plane.constant;return this},normalize:function(){var inverseNormalLength=1/this.normal.length();this.normal.multiplyScalar(inverseNormalLength);this.constant*=inverseNormalLength;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(point){return this.normal.dot(point)+
this.constant},distanceToSphere:function(sphere){return this.distanceToPoint(sphere.center)-sphere.radius},projectPoint:function(point,optionalTarget){return this.orthoPoint(point,optionalTarget).sub(point).negate()},orthoPoint:function(point,optionalTarget){var perpendicularMagnitude=this.distanceToPoint(point);var result=optionalTarget||new THREE.Vector3;return result.copy(this.normal).multiplyScalar(perpendicularMagnitude)},intersectLine:function(){var v1=new THREE.Vector3;return function(line,
optionalTarget){var result=optionalTarget||new THREE.Vector3;var direction=line.delta(v1);var denominator=this.normal.dot(direction);if(denominator===0){if(this.distanceToPoint(line.start)===0)return result.copy(line.start);return undefined}var t=-(line.start.dot(this.normal)+this.constant)/denominator;if(t<0||t>1)return undefined;return result.copy(direction).multiplyScalar(t).add(line.start)}}(),intersectsLine:function(line){var startSign=this.distanceToPoint(line.start);var endSign=this.distanceToPoint(line.end);
return startSign<0&&endSign>0||endSign<0&&startSign>0},intersectsBox:function(box){return box.intersectsPlane(this)},intersectsSphere:function(sphere){return sphere.intersectsPlane(this)},coplanarPoint:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var v1=new THREE.Vector3;var m1=new THREE.Matrix3;return function(matrix,optionalNormalMatrix){var referencePoint=this.coplanarPoint(v1).applyMatrix4(matrix);
var normalMatrix=optionalNormalMatrix||m1.getNormalMatrix(matrix);var normal=this.normal.applyMatrix3(normalMatrix).normalize();this.constant=-referencePoint.dot(normal);return this}}(),translate:function(offset){this.constant=this.constant-offset.dot(this.normal);return this},equals:function(plane){return plane.normal.equals(this.normal)&&plane.constant===this.constant}};
THREE.Spherical=function(radius,phi,theta){this.radius=radius!==undefined?radius:1;this.phi=phi!==undefined?phi:0;this.theta=theta!==undefined?theta:0;return this};
THREE.Spherical.prototype={constructor:THREE.Spherical,set:function(radius,phi,theta){this.radius=radius;this.phi=phi;this.theta=theta;return this},clone:function(){return(new this.constructor).copy(this)},copy:function(other){this.radius.copy(other.radius);this.phi.copy(other.phi);this.theta.copy(other.theta);return this},makeSafe:function(){var EPS=1E-6;this.phi=Math.max(EPS,Math.min(Math.PI-EPS,this.phi));return this},setFromVector3:function(vec3){this.radius=vec3.length();if(this.radius===0){this.theta=
0;this.phi=0}else{this.theta=Math.atan2(vec3.x,vec3.z);this.phi=Math.acos(THREE.Math.clamp(vec3.y/this.radius,-1,1))}return this}};
THREE.Math={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var uuid=new Array(36);var rnd=0,r;return function(){for(var i=0;i<36;i++)if(i===8||i===13||i===18||i===23)uuid[i]="-";else if(i===14)uuid[i]="4";else{if(rnd<=2)rnd=33554432+Math.random()*16777216|0;r=rnd&15;rnd=rnd>>4;uuid[i]=chars[i===19?r&3|8:r]}return uuid.join("")}}(),clamp:function(value,min,max){return Math.max(min,Math.min(max,value))},
euclideanModulo:function(n,m){return(n%m+m)%m},mapLinear:function(x,a1,a2,b1,b2){return b1+(x-a1)*(b2-b1)/(a2-a1)},smoothstep:function(x,min,max){if(x<=min)return 0;if(x>=max)return 1;x=(x-min)/(max-min);return x*x*(3-2*x)},smootherstep:function(x,min,max){if(x<=min)return 0;if(x>=max)return 1;x=(x-min)/(max-min);return x*x*x*(x*(x*6-15)+10)},random16:function(){console.warn("THREE.Math.random16() has been deprecated. Use Math.random() instead.");return Math.random()},randInt:function(low,high){return low+
Math.floor(Math.random()*(high-low+1))},randFloat:function(low,high){return low+Math.random()*(high-low)},randFloatSpread:function(range){return range*(.5-Math.random())},degToRad:function(degrees){return degrees*THREE.Math.DEG2RAD},radToDeg:function(radians){return radians*THREE.Math.RAD2DEG},isPowerOfTwo:function(value){return(value&value-1)===0&&value!==0},nearestPowerOfTwo:function(value){return Math.pow(2,Math.round(Math.log(value)/Math.LN2))},nextPowerOfTwo:function(value){value--;value|=value>>
1;value|=value>>2;value|=value>>4;value|=value>>8;value|=value>>16;value++;return value}};
THREE.Spline=function(points){this.points=points;var c=[],v3={x:0,y:0,z:0},point,intPoint,weight,w2,w3,pa,pb,pc,pd;this.initFromArray=function(a){this.points=[];for(var i=0;i<a.length;i++)this.points[i]={x:a[i][0],y:a[i][1],z:a[i][2]}};this.getPoint=function(k){point=(this.points.length-1)*k;intPoint=Math.floor(point);weight=point-intPoint;c[0]=intPoint===0?intPoint:intPoint-1;c[1]=intPoint;c[2]=intPoint>this.points.length-2?this.points.length-1:intPoint+1;c[3]=intPoint>this.points.length-3?this.points.length-
1:intPoint+2;pa=this.points[c[0]];pb=this.points[c[1]];pc=this.points[c[2]];pd=this.points[c[3]];w2=weight*weight;w3=weight*w2;v3.x=interpolate(pa.x,pb.x,pc.x,pd.x,weight,w2,w3);v3.y=interpolate(pa.y,pb.y,pc.y,pd.y,weight,w2,w3);v3.z=interpolate(pa.z,pb.z,pc.z,pd.z,weight,w2,w3);return v3};this.getControlPointsArray=function(){var i,p,l=this.points.length,coords=[];for(i=0;i<l;i++){p=this.points[i];coords[i]=[p.x,p.y,p.z]}return coords};this.getLength=function(nSubDivisions){var i,index,nSamples,
position,point=0,intPoint=0,oldIntPoint=0,oldPosition=new THREE.Vector3,tmpVec=new THREE.Vector3,chunkLengths=[],totalLength=0;chunkLengths[0]=0;if(!nSubDivisions)nSubDivisions=100;nSamples=this.points.length*nSubDivisions;oldPosition.copy(this.points[0]);for(i=1;i<nSamples;i++){index=i/nSamples;position=this.getPoint(index);tmpVec.copy(position);totalLength+=tmpVec.distanceTo(oldPosition);oldPosition.copy(position);point=(this.points.length-1)*index;intPoint=Math.floor(point);if(intPoint!==oldIntPoint){chunkLengths[intPoint]=
totalLength;oldIntPoint=intPoint}}chunkLengths[chunkLengths.length]=totalLength;return{chunks:chunkLengths,total:totalLength}};this.reparametrizeByArcLength=function(samplingCoef){var i,j,index,indexCurrent,indexNext,realDistance,sampling,position,newpoints=[],tmpVec=new THREE.Vector3,sl=this.getLength();newpoints.push(tmpVec.copy(this.points[0]).clone());for(i=1;i<this.points.length;i++){realDistance=sl.chunks[i]-sl.chunks[i-1];sampling=Math.ceil(samplingCoef*realDistance/sl.total);indexCurrent=
(i-1)/(this.points.length-1);indexNext=i/(this.points.length-1);for(j=1;j<sampling-1;j++){index=indexCurrent+j*(1/sampling)*(indexNext-indexCurrent);position=this.getPoint(index);newpoints.push(tmpVec.copy(position).clone())}newpoints.push(tmpVec.copy(this.points[i]).clone())}this.points=newpoints};function interpolate(p0,p1,p2,p3,t,t2,t3){var v0=(p2-p0)*.5,v1=(p3-p1)*.5;return(2*(p1-p2)+v0+v1)*t3+(-3*(p1-p2)-2*v0-v1)*t2+v0*t+p1}};
THREE.Triangle=function(a,b,c){this.a=a!==undefined?a:new THREE.Vector3;this.b=b!==undefined?b:new THREE.Vector3;this.c=c!==undefined?c:new THREE.Vector3};THREE.Triangle.normal=function(){var v0=new THREE.Vector3;return function(a,b,c,optionalTarget){var result=optionalTarget||new THREE.Vector3;result.subVectors(c,b);v0.subVectors(a,b);result.cross(v0);var resultLengthSq=result.lengthSq();if(resultLengthSq>0)return result.multiplyScalar(1/Math.sqrt(resultLengthSq));return result.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var v0=new THREE.Vector3;var v1=new THREE.Vector3;var v2=new THREE.Vector3;return function(point,a,b,c,optionalTarget){v0.subVectors(c,a);v1.subVectors(b,a);v2.subVectors(point,a);var dot00=v0.dot(v0);var dot01=v0.dot(v1);var dot02=v0.dot(v2);var dot11=v1.dot(v1);var dot12=v1.dot(v2);var denom=dot00*dot11-dot01*dot01;var result=optionalTarget||new THREE.Vector3;if(denom===0)return result.set(-2,-1,-1);var invDenom=1/denom;var u=(dot11*dot02-dot01*dot12)*
invDenom;var v=(dot00*dot12-dot01*dot02)*invDenom;return result.set(1-u-v,v,u)}}();THREE.Triangle.containsPoint=function(){var v1=new THREE.Vector3;return function(point,a,b,c){var result=THREE.Triangle.barycoordFromPoint(point,a,b,c,v1);return result.x>=0&&result.y>=0&&result.x+result.y<=1}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(points,i0,i1,i2){this.a.copy(points[i0]);this.b.copy(points[i1]);this.c.copy(points[i2]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(triangle){this.a.copy(triangle.a);this.b.copy(triangle.b);this.c.copy(triangle.c);return this},area:function(){var v0=new THREE.Vector3;var v1=new THREE.Vector3;return function(){v0.subVectors(this.c,
this.b);v1.subVectors(this.a,this.b);return v0.cross(v1).length()*.5}}(),midpoint:function(optionalTarget){var result=optionalTarget||new THREE.Vector3;return result.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(optionalTarget){return THREE.Triangle.normal(this.a,this.b,this.c,optionalTarget)},plane:function(optionalTarget){var result=optionalTarget||new THREE.Plane;return result.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(point,optionalTarget){return THREE.Triangle.barycoordFromPoint(point,
this.a,this.b,this.c,optionalTarget)},containsPoint:function(point){return THREE.Triangle.containsPoint(point,this.a,this.b,this.c)},closestPointToPoint:function(){var plane,edgeList,projectedPoint,closestPoint;return function closestPointToPoint(point,optionalTarget){if(plane===undefined){plane=new THREE.Plane;edgeList=[new THREE.Line3,new THREE.Line3,new THREE.Line3];projectedPoint=new THREE.Vector3;closestPoint=new THREE.Vector3}var result=optionalTarget||new THREE.Vector3;var minDistance=Infinity;
plane.setFromCoplanarPoints(this.a,this.b,this.c);plane.projectPoint(point,projectedPoint);if(this.containsPoint(projectedPoint)===true)result.copy(projectedPoint);else{edgeList[0].set(this.a,this.b);edgeList[1].set(this.b,this.c);edgeList[2].set(this.c,this.a);for(var i=0;i<edgeList.length;i++){edgeList[i].closestPointToPoint(projectedPoint,true,closestPoint);var distance=projectedPoint.distanceToSquared(closestPoint);if(distance<minDistance){minDistance=distance;result.copy(closestPoint)}}}return result}}(),
equals:function(triangle){return triangle.a.equals(this.a)&&triangle.b.equals(this.b)&&triangle.c.equals(this.c)}};THREE.Interpolant=function(parameterPositions,sampleValues,sampleSize,resultBuffer){this.parameterPositions=parameterPositions;this._cachedIndex=0;this.resultBuffer=resultBuffer!==undefined?resultBuffer:new sampleValues.constructor(sampleSize);this.sampleValues=sampleValues;this.valueSize=sampleSize};
THREE.Interpolant.prototype={constructor:THREE.Interpolant,evaluate:function(t){var pp=this.parameterPositions,i1=this._cachedIndex,t1=pp[i1],t0=pp[i1-1];validate_interval:{seek:{var right;linear_scan:{forward_scan:if(!(t<t1)){for(var giveUpAt=i1+2;;){if(t1===undefined){if(t<t0)break forward_scan;i1=pp.length;this._cachedIndex=i1;return this.afterEnd_(i1-1,t,t0)}if(i1===giveUpAt)break;t0=t1;t1=pp[++i1];if(t<t1)break seek}right=pp.length;break linear_scan}if(!(t>=t0)){var t1global=pp[1];if(t<t1global){i1=
2;t0=t1global}for(var giveUpAt=i1-2;;){if(t0===undefined){this._cachedIndex=0;return this.beforeStart_(0,t,t1)}if(i1===giveUpAt)break;t1=t0;t0=pp[--i1-1];if(t>=t0)break seek}right=i1;i1=0;break linear_scan}break validate_interval}while(i1<right){var mid=i1+right>>>1;if(t<pp[mid])right=mid;else i1=mid+1}t1=pp[i1];t0=pp[i1-1];if(t0===undefined){this._cachedIndex=0;return this.beforeStart_(0,t,t1)}if(t1===undefined){i1=pp.length;this._cachedIndex=i1;return this.afterEnd_(i1-1,t0,t)}}this._cachedIndex=
i1;this.intervalChanged_(i1,t0,t1)}return this.interpolate_(i1,t0,t,t1)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(index){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize,offset=index*stride;for(var i=0;i!==stride;++i)result[i]=values[offset+i];return result},interpolate_:function(i1,t0,t,t1){throw new Error("call to abstract method");},intervalChanged_:function(i1,t0,t1){}};
Object.assign(THREE.Interpolant.prototype,{beforeStart_:THREE.Interpolant.prototype.copySampleValue_,afterEnd_:THREE.Interpolant.prototype.copySampleValue_});THREE.CubicInterpolant=function(parameterPositions,sampleValues,sampleSize,resultBuffer){THREE.Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer);this._weightPrev=-0;this._offsetPrev=-0;this._weightNext=-0;this._offsetNext=-0};
THREE.CubicInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.CubicInterpolant,DefaultSettings_:{endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding},intervalChanged_:function(i1,t0,t1){var pp=this.parameterPositions,iPrev=i1-2,iNext=i1+1,tPrev=pp[iPrev],tNext=pp[iNext];if(tPrev===undefined)switch(this.getSettings_().endingStart){case THREE.ZeroSlopeEnding:iPrev=i1;tPrev=2*t0-t1;break;case THREE.WrapAroundEnding:iPrev=pp.length-
2;tPrev=t0+pp[iPrev]-pp[iPrev+1];break;default:iPrev=i1;tPrev=t1}if(tNext===undefined)switch(this.getSettings_().endingEnd){case THREE.ZeroSlopeEnding:iNext=i1;tNext=2*t1-t0;break;case THREE.WrapAroundEnding:iNext=1;tNext=t1+pp[1]-pp[0];break;default:iNext=i1-1;tNext=t0}var halfDt=(t1-t0)*.5,stride=this.valueSize;this._weightPrev=halfDt/(t0-tPrev);this._weightNext=halfDt/(tNext-t1);this._offsetPrev=iPrev*stride;this._offsetNext=iNext*stride},interpolate_:function(i1,t0,t,t1){var result=this.resultBuffer,
values=this.sampleValues,stride=this.valueSize,o1=i1*stride,o0=o1-stride,oP=this._offsetPrev,oN=this._offsetNext,wP=this._weightPrev,wN=this._weightNext,p=(t-t0)/(t1-t0),pp=p*p,ppp=pp*p;var sP=-wP*ppp+2*wP*pp-wP*p;var s0=(1+wP)*ppp+(-1.5-2*wP)*pp+(-.5+wP)*p+1;var s1=(-1-wN)*ppp+(1.5+wN)*pp+.5*p;var sN=wN*ppp-wN*pp;for(var i=0;i!==stride;++i)result[i]=sP*values[oP+i]+s0*values[o0+i]+s1*values[o1+i]+sN*values[oN+i];return result}});
THREE.DiscreteInterpolant=function(parameterPositions,sampleValues,sampleSize,resultBuffer){THREE.Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)};THREE.DiscreteInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.DiscreteInterpolant,interpolate_:function(i1,t0,t,t1){return this.copySampleValue_(i1-1)}});
THREE.LinearInterpolant=function(parameterPositions,sampleValues,sampleSize,resultBuffer){THREE.Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)};
THREE.LinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.LinearInterpolant,interpolate_:function(i1,t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize,offset1=i1*stride,offset0=offset1-stride,weight1=(t-t0)/(t1-t0),weight0=1-weight1;for(var i=0;i!==stride;++i)result[i]=values[offset0+i]*weight0+values[offset1+i]*weight1;return result}});
THREE.QuaternionLinearInterpolant=function(parameterPositions,sampleValues,sampleSize,resultBuffer){THREE.Interpolant.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer)};
THREE.QuaternionLinearInterpolant.prototype=Object.assign(Object.create(THREE.Interpolant.prototype),{constructor:THREE.QuaternionLinearInterpolant,interpolate_:function(i1,t0,t,t1){var result=this.resultBuffer,values=this.sampleValues,stride=this.valueSize,offset=i1*stride,alpha=(t-t0)/(t1-t0);for(var end=offset+stride;offset!==end;offset+=4)THREE.Quaternion.slerpFlat(result,0,values,offset-stride,values,offset,alpha);return result}});
THREE.Clock=function(autoStart){this.autoStart=autoStart!==undefined?autoStart:true;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=(performance||Date).now();this.oldTime=this.startTime;this.running=true},stop:function(){this.getElapsedTime();this.running=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var diff=0;if(this.autoStart&&!this.running)this.start();if(this.running){var newTime=(performance||Date).now();diff=(newTime-this.oldTime)/1E3;this.oldTime=newTime;this.elapsedTime+=diff}return diff}};
THREE.EventDispatcher=function(){};
Object.assign(THREE.EventDispatcher.prototype,{addEventListener:function(type,listener){if(this._listeners===undefined)this._listeners={};var listeners=this._listeners;if(listeners[type]===undefined)listeners[type]=[];if(listeners[type].indexOf(listener)===-1)listeners[type].push(listener)},hasEventListener:function(type,listener){if(this._listeners===undefined)return false;var listeners=this._listeners;if(listeners[type]!==undefined&&listeners[type].indexOf(listener)!==-1)return true;return false},
removeEventListener:function(type,listener){if(this._listeners===undefined)return;var listeners=this._listeners;var listenerArray=listeners[type];if(listenerArray!==undefined){var index=listenerArray.indexOf(listener);if(index!==-1)listenerArray.splice(index,1)}},dispatchEvent:function(event){if(this._listeners===undefined)return;var listeners=this._listeners;var listenerArray=listeners[event.type];if(listenerArray!==undefined){event.target=this;var array=[],i=0;var length=listenerArray.length;for(i=
0;i<length;i++)array[i]=listenerArray[i];for(i=0;i<length;i++)array[i].call(this,event)}}});THREE.Layers=function(){this.mask=1};THREE.Layers.prototype={constructor:THREE.Layers,set:function(channel){this.mask=1<<channel},enable:function(channel){this.mask|=1<<channel},toggle:function(channel){this.mask^=1<<channel},disable:function(channel){this.mask&=~(1<<channel)},test:function(layers){return(this.mask&layers.mask)!==0}};
(function(THREE){THREE.Raycaster=function(origin,direction,near,far){this.ray=new THREE.Ray(origin,direction);this.near=near||0;this.far=far||Infinity;this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}};Object.defineProperties(this.params,{PointCloud:{get:function(){console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points.");return this.Points}}})};function ascSort(a,b){return a.distance-b.distance}function intersectObject(object,raycaster,intersects,recursive){if(object.visible===
false)return;object.raycast(raycaster,intersects);if(recursive===true){var children=object.children;for(var i=0,l=children.length;i<l;i++)intersectObject(children[i],raycaster,intersects,true)}}THREE.Raycaster.prototype={constructor:THREE.Raycaster,linePrecision:1,set:function(origin,direction){this.ray.set(origin,direction)},setFromCamera:function(coords,camera){if(camera instanceof THREE.PerspectiveCamera){this.ray.origin.setFromMatrixPosition(camera.matrixWorld);this.ray.direction.set(coords.x,
coords.y,.5).unproject(camera).sub(this.ray.origin).normalize()}else if(camera instanceof THREE.OrthographicCamera){this.ray.origin.set(coords.x,coords.y,-1).unproject(camera);this.ray.direction.set(0,0,-1).transformDirection(camera.matrixWorld)}else console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(object,recursive){var intersects=[];intersectObject(object,this,intersects,recursive);intersects.sort(ascSort);return intersects},intersectObjects:function(objects,recursive){var intersects=
[];if(Array.isArray(objects)===false){console.warn("THREE.Raycaster.intersectObjects: objects is not an Array.");return intersects}for(var i=0,l=objects.length;i<l;i++)intersectObject(objects[i],this,intersects,recursive);intersects.sort(ascSort);return intersects}}})(THREE);
THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Object3D";this.parent=null;this.children=[];this.up=THREE.Object3D.DefaultUp.clone();var position=new THREE.Vector3;var rotation=new THREE.Euler;var quaternion=new THREE.Quaternion;var scale=new THREE.Vector3(1,1,1);function onRotationChange(){quaternion.setFromEuler(rotation,false)}function onQuaternionChange(){rotation.setFromQuaternion(quaternion,
undefined,false)}rotation.onChange(onRotationChange);quaternion.onChange(onQuaternionChange);Object.defineProperties(this,{position:{enumerable:true,value:position},rotation:{enumerable:true,value:rotation},quaternion:{enumerable:true,value:quaternion},scale:{enumerable:true,value:scale},modelViewMatrix:{value:new THREE.Matrix4},normalMatrix:{value:new THREE.Matrix3}});this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=THREE.Object3D.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=
false;this.layers=new THREE.Layers;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.renderOrder=0;this.userData={}};THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);THREE.Object3D.DefaultMatrixAutoUpdate=true;
Object.assign(THREE.Object3D.prototype,THREE.EventDispatcher.prototype,{applyMatrix:function(matrix){this.matrix.multiplyMatrices(matrix,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(axis,angle){this.quaternion.setFromAxisAngle(axis,angle)},setRotationFromEuler:function(euler){this.quaternion.setFromEuler(euler,true)},setRotationFromMatrix:function(m){this.quaternion.setFromRotationMatrix(m)},setRotationFromQuaternion:function(q){this.quaternion.copy(q)},
rotateOnAxis:function(){var q1=new THREE.Quaternion;return function(axis,angle){q1.setFromAxisAngle(axis,angle);this.quaternion.multiply(q1);return this}}(),rotateX:function(){var v1=new THREE.Vector3(1,0,0);return function(angle){return this.rotateOnAxis(v1,angle)}}(),rotateY:function(){var v1=new THREE.Vector3(0,1,0);return function(angle){return this.rotateOnAxis(v1,angle)}}(),rotateZ:function(){var v1=new THREE.Vector3(0,0,1);return function(angle){return this.rotateOnAxis(v1,angle)}}(),translateOnAxis:function(){var v1=
new THREE.Vector3;return function(axis,distance){v1.copy(axis).applyQuaternion(this.quaternion);this.position.add(v1.multiplyScalar(distance));return this}}(),translateX:function(){var v1=new THREE.Vector3(1,0,0);return function(distance){return this.translateOnAxis(v1,distance)}}(),translateY:function(){var v1=new THREE.Vector3(0,1,0);return function(distance){return this.translateOnAxis(v1,distance)}}(),translateZ:function(){var v1=new THREE.Vector3(0,0,1);return function(distance){return this.translateOnAxis(v1,
distance)}}(),localToWorld:function(vector){return vector.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var m1=new THREE.Matrix4;return function(vector){return vector.applyMatrix4(m1.getInverse(this.matrixWorld))}}(),lookAt:function(){var m1=new THREE.Matrix4;return function(vector){m1.lookAt(vector,this.position,this.up);this.quaternion.setFromRotationMatrix(m1)}}(),add:function(object){if(arguments.length>1){for(var i=0;i<arguments.length;i++)this.add(arguments[i]);return this}if(object===
this){console.error("THREE.Object3D.add: object can't be added as a child of itself.",object);return this}if(object instanceof THREE.Object3D){if(object.parent!==null)object.parent.remove(object);object.parent=this;object.dispatchEvent({type:"added"});this.children.push(object)}else console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",object);return this},remove:function(object){if(arguments.length>1)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);var index=this.children.indexOf(object);
if(index!==-1){object.parent=null;object.dispatchEvent({type:"removed"});this.children.splice(index,1)}},getObjectById:function(id){return this.getObjectByProperty("id",id)},getObjectByName:function(name){return this.getObjectByProperty("name",name)},getObjectByProperty:function(name,value){if(this[name]===value)return this;for(var i=0,l=this.children.length;i<l;i++){var child=this.children[i];var object=child.getObjectByProperty(name,value);if(object!==undefined)return object}return undefined},getWorldPosition:function(optionalTarget){var result=
optionalTarget||new THREE.Vector3;this.updateMatrixWorld(true);return result.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var position=new THREE.Vector3;var scale=new THREE.Vector3;return function(optionalTarget){var result=optionalTarget||new THREE.Quaternion;this.updateMatrixWorld(true);this.matrixWorld.decompose(position,result,scale);return result}}(),getWorldRotation:function(){var quaternion=new THREE.Quaternion;return function(optionalTarget){var result=optionalTarget||
new THREE.Euler;this.getWorldQuaternion(quaternion);return result.setFromQuaternion(quaternion,this.rotation.order,false)}}(),getWorldScale:function(){var position=new THREE.Vector3;var quaternion=new THREE.Quaternion;return function(optionalTarget){var result=optionalTarget||new THREE.Vector3;this.updateMatrixWorld(true);this.matrixWorld.decompose(position,quaternion,result);return result}}(),getWorldDirection:function(){var quaternion=new THREE.Quaternion;return function(optionalTarget){var result=
optionalTarget||new THREE.Vector3;this.getWorldQuaternion(quaternion);return result.set(0,0,1).applyQuaternion(quaternion)}}(),raycast:function(){},traverse:function(callback){callback(this);var children=this.children;for(var i=0,l=children.length;i<l;i++)children[i].traverse(callback)},traverseVisible:function(callback){if(this.visible===false)return;callback(this);var children=this.children;for(var i=0,l=children.length;i<l;i++)children[i].traverseVisible(callback)},traverseAncestors:function(callback){var parent=
this.parent;if(parent!==null){callback(parent);parent.traverseAncestors(callback)}},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(force){if(this.matrixAutoUpdate===true)this.updateMatrix();if(this.matrixWorldNeedsUpdate===true||force===true){if(this.parent===null)this.matrixWorld.copy(this.matrix);else this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorldNeedsUpdate=
false;force=true}for(var i=0,l=this.children.length;i<l;i++)this.children[i].updateMatrixWorld(force)},toJSON:function(meta){var isRootObject=meta===undefined||meta==="";var output={};if(isRootObject){meta={geometries:{},materials:{},textures:{},images:{}};output.metadata={version:4.4,type:"Object",generator:"Object3D.toJSON"}}var object={};object.uuid=this.uuid;object.type=this.type;if(this.name!=="")object.name=this.name;if(JSON.stringify(this.userData)!=="{}")object.userData=this.userData;if(this.castShadow===
true)object.castShadow=true;if(this.receiveShadow===true)object.receiveShadow=true;if(this.visible===false)object.visible=false;object.matrix=this.matrix.toArray();if(this.geometry!==undefined){if(meta.geometries[this.geometry.uuid]===undefined)meta.geometries[this.geometry.uuid]=this.geometry.toJSON(meta);object.geometry=this.geometry.uuid}if(this.material!==undefined){if(meta.materials[this.material.uuid]===undefined)meta.materials[this.material.uuid]=this.material.toJSON(meta);object.material=
this.material.uuid}if(this.children.length>0){object.children=[];for(var i=0;i<this.children.length;i++)object.children.push(this.children[i].toJSON(meta).object)}if(isRootObject){var geometries=extractFromCache(meta.geometries);var materials=extractFromCache(meta.materials);var textures=extractFromCache(meta.textures);var images=extractFromCache(meta.images);if(geometries.length>0)output.geometries=geometries;if(materials.length>0)output.materials=materials;if(textures.length>0)output.textures=textures;
if(images.length>0)output.images=images}output.object=object;return output;function extractFromCache(cache){var values=[];for(var key in cache){var data=cache[key];delete data.metadata;values.push(data)}return values}},clone:function(recursive){return(new this.constructor).copy(this,recursive)},copy:function(source,recursive){if(recursive===undefined)recursive=true;this.name=source.name;this.up.copy(source.up);this.position.copy(source.position);this.quaternion.copy(source.quaternion);this.scale.copy(source.scale);
this.matrix.copy(source.matrix);this.matrixWorld.copy(source.matrixWorld);this.matrixAutoUpdate=source.matrixAutoUpdate;this.matrixWorldNeedsUpdate=source.matrixWorldNeedsUpdate;this.visible=source.visible;this.castShadow=source.castShadow;this.receiveShadow=source.receiveShadow;this.frustumCulled=source.frustumCulled;this.renderOrder=source.renderOrder;this.userData=JSON.parse(JSON.stringify(source.userData));if(recursive===true)for(var i=0;i<source.children.length;i++){var child=source.children[i];
this.add(child.clone())}return this}});THREE.Object3DIdCount=0;THREE.Face3=function(a,b,c,normal,color,materialIndex){this.a=a;this.b=b;this.c=c;this.normal=normal instanceof THREE.Vector3?normal:new THREE.Vector3;this.vertexNormals=Array.isArray(normal)?normal:[];this.color=color instanceof THREE.Color?color:new THREE.Color;this.vertexColors=Array.isArray(color)?color:[];this.materialIndex=materialIndex!==undefined?materialIndex:0};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.a=source.a;this.b=source.b;this.c=source.c;this.normal.copy(source.normal);this.color.copy(source.color);this.materialIndex=source.materialIndex;for(var i=0,il=source.vertexNormals.length;i<il;i++)this.vertexNormals[i]=source.vertexNormals[i].clone();for(var i=0,il=source.vertexColors.length;i<il;i++)this.vertexColors[i]=source.vertexColors[i].clone();return this}};
THREE.BufferAttribute=function(array,itemSize,normalized){this.uuid=THREE.Math.generateUUID();this.array=array;this.itemSize=itemSize;this.dynamic=false;this.updateRange={offset:0,count:-1};this.version=0;this.normalized=normalized===true};
THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get count(){return this.array.length/this.itemSize},set needsUpdate(value){if(value===true)this.version++},setDynamic:function(value){this.dynamic=value;return this},copy:function(source){this.array=new source.array.constructor(source.array);this.itemSize=source.itemSize;this.dynamic=source.dynamic;return this},copyAt:function(index1,attribute,index2){index1*=this.itemSize;index2*=attribute.itemSize;for(var i=0,l=this.itemSize;i<l;i++)this.array[index1+
i]=attribute.array[index2+i];return this},copyArray:function(array){this.array.set(array);return this},copyColorsArray:function(colors){var array=this.array,offset=0;for(var i=0,l=colors.length;i<l;i++){var color=colors[i];if(color===undefined){console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i);color=new THREE.Color}array[offset++]=color.r;array[offset++]=color.g;array[offset++]=color.b}return this},copyIndicesArray:function(indices){var array=this.array,offset=0;for(var i=
0,l=indices.length;i<l;i++){var index=indices[i];array[offset++]=index.a;array[offset++]=index.b;array[offset++]=index.c}return this},copyVector2sArray:function(vectors){var array=this.array,offset=0;for(var i=0,l=vectors.length;i<l;i++){var vector=vectors[i];if(vector===undefined){console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i);vector=new THREE.Vector2}array[offset++]=vector.x;array[offset++]=vector.y}return this},copyVector3sArray:function(vectors){var array=this.array,
offset=0;for(var i=0,l=vectors.length;i<l;i++){var vector=vectors[i];if(vector===undefined){console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i);vector=new THREE.Vector3}array[offset++]=vector.x;array[offset++]=vector.y;array[offset++]=vector.z}return this},copyVector4sArray:function(vectors){var array=this.array,offset=0;for(var i=0,l=vectors.length;i<l;i++){var vector=vectors[i];if(vector===undefined){console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",
i);vector=new THREE.Vector4}array[offset++]=vector.x;array[offset++]=vector.y;array[offset++]=vector.z;array[offset++]=vector.w}return this},set:function(value,offset){if(offset===undefined)offset=0;this.array.set(value,offset);return this},getX:function(index){return this.array[index*this.itemSize]},setX:function(index,x){this.array[index*this.itemSize]=x;return this},getY:function(index){return this.array[index*this.itemSize+1]},setY:function(index,y){this.array[index*this.itemSize+1]=y;return this},
getZ:function(index){return this.array[index*this.itemSize+2]},setZ:function(index,z){this.array[index*this.itemSize+2]=z;return this},getW:function(index){return this.array[index*this.itemSize+3]},setW:function(index,w){this.array[index*this.itemSize+3]=w;return this},setXY:function(index,x,y){index*=this.itemSize;this.array[index+0]=x;this.array[index+1]=y;return this},setXYZ:function(index,x,y,z){index*=this.itemSize;this.array[index+0]=x;this.array[index+1]=y;this.array[index+2]=z;return this},
setXYZW:function(index,x,y,z,w){index*=this.itemSize;this.array[index+0]=x;this.array[index+1]=y;this.array[index+2]=z;this.array[index+3]=w;return this},clone:function(){return(new this.constructor).copy(this)}};THREE.Int8Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Int8Array(array),itemSize)};THREE.Uint8Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Uint8Array(array),itemSize)};
THREE.Uint8ClampedAttribute=function(array,itemSize){return new THREE.BufferAttribute(new Uint8ClampedArray(array),itemSize)};THREE.Int16Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Int16Array(array),itemSize)};THREE.Uint16Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Uint16Array(array),itemSize)};THREE.Int32Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Int32Array(array),itemSize)};
THREE.Uint32Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Uint32Array(array),itemSize)};THREE.Float32Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Float32Array(array),itemSize)};THREE.Float64Attribute=function(array,itemSize){return new THREE.BufferAttribute(new Float64Array(array),itemSize)};
THREE.DynamicBufferAttribute=function(array,itemSize){console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead.");return(new THREE.BufferAttribute(array,itemSize)).setDynamic(true)};THREE.InstancedBufferAttribute=function(array,itemSize,meshPerAttribute){THREE.BufferAttribute.call(this,array,itemSize);this.meshPerAttribute=meshPerAttribute||1};THREE.InstancedBufferAttribute.prototype=Object.create(THREE.BufferAttribute.prototype);
THREE.InstancedBufferAttribute.prototype.constructor=THREE.InstancedBufferAttribute;THREE.InstancedBufferAttribute.prototype.copy=function(source){THREE.BufferAttribute.prototype.copy.call(this,source);this.meshPerAttribute=source.meshPerAttribute;return this};THREE.InterleavedBuffer=function(array,stride){this.uuid=THREE.Math.generateUUID();this.array=array;this.stride=stride;this.dynamic=false;this.updateRange={offset:0,count:-1};this.version=0};
THREE.InterleavedBuffer.prototype={constructor:THREE.InterleavedBuffer,get length(){return this.array.length},get count(){return this.array.length/this.stride},set needsUpdate(value){if(value===true)this.version++},setDynamic:function(value){this.dynamic=value;return this},copy:function(source){this.array=new source.array.constructor(source.array);this.stride=source.stride;this.dynamic=source.dynamic;return this},copyAt:function(index1,attribute,index2){index1*=this.stride;index2*=attribute.stride;
for(var i=0,l=this.stride;i<l;i++)this.array[index1+i]=attribute.array[index2+i];return this},set:function(value,offset){if(offset===undefined)offset=0;this.array.set(value,offset);return this},clone:function(){return(new this.constructor).copy(this)}};THREE.InstancedInterleavedBuffer=function(array,stride,meshPerAttribute){THREE.InterleavedBuffer.call(this,array,stride);this.meshPerAttribute=meshPerAttribute||1};THREE.InstancedInterleavedBuffer.prototype=Object.create(THREE.InterleavedBuffer.prototype);
THREE.InstancedInterleavedBuffer.prototype.constructor=THREE.InstancedInterleavedBuffer;THREE.InstancedInterleavedBuffer.prototype.copy=function(source){THREE.InterleavedBuffer.prototype.copy.call(this,source);this.meshPerAttribute=source.meshPerAttribute;return this};THREE.InterleavedBufferAttribute=function(interleavedBuffer,itemSize,offset){this.uuid=THREE.Math.generateUUID();this.data=interleavedBuffer;this.itemSize=itemSize;this.offset=offset};
THREE.InterleavedBufferAttribute.prototype={constructor:THREE.InterleavedBufferAttribute,get length(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length},get count(){return this.data.count},setX:function(index,x){this.data.array[index*this.data.stride+this.offset]=x;return this},setY:function(index,y){this.data.array[index*this.data.stride+this.offset+1]=y;return this},setZ:function(index,z){this.data.array[index*this.data.stride+this.offset+
2]=z;return this},setW:function(index,w){this.data.array[index*this.data.stride+this.offset+3]=w;return this},getX:function(index){return this.data.array[index*this.data.stride+this.offset]},getY:function(index){return this.data.array[index*this.data.stride+this.offset+1]},getZ:function(index){return this.data.array[index*this.data.stride+this.offset+2]},getW:function(index){return this.data.array[index*this.data.stride+this.offset+3]},setXY:function(index,x,y){index=index*this.data.stride+this.offset;
this.data.array[index+0]=x;this.data.array[index+1]=y;return this},setXYZ:function(index,x,y,z){index=index*this.data.stride+this.offset;this.data.array[index+0]=x;this.data.array[index+1]=y;this.data.array[index+2]=z;return this},setXYZW:function(index,x,y,z,w){index=index*this.data.stride+this.offset;this.data.array[index+0]=x;this.data.array[index+1]=y;this.data.array[index+2]=z;this.data.array[index+3]=w;return this}};
THREE.Geometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Geometry";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.verticesNeedUpdate=false;this.elementsNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=
false;this.lineDistancesNeedUpdate=false;this.groupsNeedUpdate=false};
Object.assign(THREE.Geometry.prototype,THREE.EventDispatcher.prototype,{applyMatrix:function(matrix){var normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix);for(var i=0,il=this.vertices.length;i<il;i++){var vertex=this.vertices[i];vertex.applyMatrix4(matrix)}for(var i=0,il=this.faces.length;i<il;i++){var face=this.faces[i];face.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=face.vertexNormals.length;j<jl;j++)face.vertexNormals[j].applyMatrix3(normalMatrix).normalize()}if(this.boundingBox!==null)this.computeBoundingBox();
if(this.boundingSphere!==null)this.computeBoundingSphere();this.verticesNeedUpdate=true;this.normalsNeedUpdate=true;return this},rotateX:function(){var m1;return function rotateX(angle){if(m1===undefined)m1=new THREE.Matrix4;m1.makeRotationX(angle);this.applyMatrix(m1);return this}}(),rotateY:function(){var m1;return function rotateY(angle){if(m1===undefined)m1=new THREE.Matrix4;m1.makeRotationY(angle);this.applyMatrix(m1);return this}}(),rotateZ:function(){var m1;return function rotateZ(angle){if(m1===
undefined)m1=new THREE.Matrix4;m1.makeRotationZ(angle);this.applyMatrix(m1);return this}}(),translate:function(){var m1;return function translate(x,y,z){if(m1===undefined)m1=new THREE.Matrix4;m1.makeTranslation(x,y,z);this.applyMatrix(m1);return this}}(),scale:function(){var m1;return function scale(x,y,z){if(m1===undefined)m1=new THREE.Matrix4;m1.makeScale(x,y,z);this.applyMatrix(m1);return this}}(),lookAt:function(){var obj;return function lookAt(vector){if(obj===undefined)obj=new THREE.Object3D;
obj.lookAt(vector);obj.updateMatrix();this.applyMatrix(obj.matrix)}}(),fromBufferGeometry:function(geometry){var scope=this;var indices=geometry.index!==null?geometry.index.array:undefined;var attributes=geometry.attributes;var positions=attributes.position.array;var normals=attributes.normal!==undefined?attributes.normal.array:undefined;var colors=attributes.color!==undefined?attributes.color.array:undefined;var uvs=attributes.uv!==undefined?attributes.uv.array:undefined;var uvs2=attributes.uv2!==
undefined?attributes.uv2.array:undefined;if(uvs2!==undefined)this.faceVertexUvs[1]=[];var tempNormals=[];var tempUVs=[];var tempUVs2=[];for(var i=0,j=0;i<positions.length;i+=3,j+=2){scope.vertices.push(new THREE.Vector3(positions[i],positions[i+1],positions[i+2]));if(normals!==undefined)tempNormals.push(new THREE.Vector3(normals[i],normals[i+1],normals[i+2]));if(colors!==undefined)scope.colors.push(new THREE.Color(colors[i],colors[i+1],colors[i+2]));if(uvs!==undefined)tempUVs.push(new THREE.Vector2(uvs[j],
uvs[j+1]));if(uvs2!==undefined)tempUVs2.push(new THREE.Vector2(uvs2[j],uvs2[j+1]))}function addFace(a,b,c,materialIndex){var vertexNormals=normals!==undefined?[tempNormals[a].clone(),tempNormals[b].clone(),tempNormals[c].clone()]:[];var vertexColors=colors!==undefined?[scope.colors[a].clone(),scope.colors[b].clone(),scope.colors[c].clone()]:[];var face=new THREE.Face3(a,b,c,vertexNormals,vertexColors,materialIndex);scope.faces.push(face);if(uvs!==undefined)scope.faceVertexUvs[0].push([tempUVs[a].clone(),
tempUVs[b].clone(),tempUVs[c].clone()]);if(uvs2!==undefined)scope.faceVertexUvs[1].push([tempUVs2[a].clone(),tempUVs2[b].clone(),tempUVs2[c].clone()])}if(indices!==undefined){var groups=geometry.groups;if(groups.length>0)for(var i=0;i<groups.length;i++){var group=groups[i];var start=group.start;var count=group.count;for(var j=start,jl=start+count;j<jl;j+=3)addFace(indices[j],indices[j+1],indices[j+2],group.materialIndex)}else for(var i=0;i<indices.length;i+=3)addFace(indices[i],indices[i+1],indices[i+
2])}else for(var i=0;i<positions.length/3;i+=3)addFace(i,i+1,i+2);this.computeFaceNormals();if(geometry.boundingBox!==null)this.boundingBox=geometry.boundingBox.clone();if(geometry.boundingSphere!==null)this.boundingSphere=geometry.boundingSphere.clone();return this},center:function(){this.computeBoundingBox();var offset=this.boundingBox.center().negate();this.translate(offset.x,offset.y,offset.z);return offset},normalize:function(){this.computeBoundingSphere();var center=this.boundingSphere.center;
var radius=this.boundingSphere.radius;var s=radius===0?1:1/radius;var matrix=new THREE.Matrix4;matrix.set(s,0,0,-s*center.x,0,s,0,-s*center.y,0,0,s,-s*center.z,0,0,0,1);this.applyMatrix(matrix);return this},computeFaceNormals:function(){var cb=new THREE.Vector3,ab=new THREE.Vector3;for(var f=0,fl=this.faces.length;f<fl;f++){var face=this.faces[f];var vA=this.vertices[face.a];var vB=this.vertices[face.b];var vC=this.vertices[face.c];cb.subVectors(vC,vB);ab.subVectors(vA,vB);cb.cross(ab);cb.normalize();
face.normal.copy(cb)}},computeVertexNormals:function(areaWeighted){if(areaWeighted===undefined)areaWeighted=true;var v,vl,f,fl,face,vertices;vertices=new Array(this.vertices.length);for(v=0,vl=this.vertices.length;v<vl;v++)vertices[v]=new THREE.Vector3;if(areaWeighted){var vA,vB,vC;var cb=new THREE.Vector3,ab=new THREE.Vector3;for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];vA=this.vertices[face.a];vB=this.vertices[face.b];vC=this.vertices[face.c];cb.subVectors(vC,vB);ab.subVectors(vA,vB);
cb.cross(ab);vertices[face.a].add(cb);vertices[face.b].add(cb);vertices[face.c].add(cb)}}else for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];vertices[face.a].add(face.normal);vertices[face.b].add(face.normal);vertices[face.c].add(face.normal)}for(v=0,vl=this.vertices.length;v<vl;v++)vertices[v].normalize();for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];var vertexNormals=face.vertexNormals;if(vertexNormals.length===3){vertexNormals[0].copy(vertices[face.a]);vertexNormals[1].copy(vertices[face.b]);
vertexNormals[2].copy(vertices[face.c])}else{vertexNormals[0]=vertices[face.a].clone();vertexNormals[1]=vertices[face.b].clone();vertexNormals[2]=vertices[face.c].clone()}}if(this.faces.length>0)this.normalsNeedUpdate=true},computeMorphNormals:function(){var i,il,f,fl,face;for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];if(!face.__originalFaceNormal)face.__originalFaceNormal=face.normal.clone();else face.__originalFaceNormal.copy(face.normal);if(!face.__originalVertexNormals)face.__originalVertexNormals=
[];for(i=0,il=face.vertexNormals.length;i<il;i++)if(!face.__originalVertexNormals[i])face.__originalVertexNormals[i]=face.vertexNormals[i].clone();else face.__originalVertexNormals[i].copy(face.vertexNormals[i])}var tmpGeo=new THREE.Geometry;tmpGeo.faces=this.faces;for(i=0,il=this.morphTargets.length;i<il;i++){if(!this.morphNormals[i]){this.morphNormals[i]={};this.morphNormals[i].faceNormals=[];this.morphNormals[i].vertexNormals=[];var dstNormalsFace=this.morphNormals[i].faceNormals;var dstNormalsVertex=
this.morphNormals[i].vertexNormals;var faceNormal,vertexNormals;for(f=0,fl=this.faces.length;f<fl;f++){faceNormal=new THREE.Vector3;vertexNormals={a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3};dstNormalsFace.push(faceNormal);dstNormalsVertex.push(vertexNormals)}}var morphNormals=this.morphNormals[i];tmpGeo.vertices=this.morphTargets[i].vertices;tmpGeo.computeFaceNormals();tmpGeo.computeVertexNormals();var faceNormal,vertexNormals;for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];
faceNormal=morphNormals.faceNormals[f];vertexNormals=morphNormals.vertexNormals[f];faceNormal.copy(face.normal);vertexNormals.a.copy(face.vertexNormals[0]);vertexNormals.b.copy(face.vertexNormals[1]);vertexNormals.c.copy(face.vertexNormals[2])}}for(f=0,fl=this.faces.length;f<fl;f++){face=this.faces[f];face.normal=face.__originalFaceNormal;face.vertexNormals=face.__originalVertexNormals}},computeTangents:function(){console.warn("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){var d=
0;var vertices=this.vertices;for(var i=0,il=vertices.length;i<il;i++){if(i>0)d+=vertices[i].distanceTo(vertices[i-1]);this.lineDistances[i]=d}},computeBoundingBox:function(){if(this.boundingBox===null)this.boundingBox=new THREE.Box3;this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(this.boundingSphere===null)this.boundingSphere=new THREE.Sphere;this.boundingSphere.setFromPoints(this.vertices)},merge:function(geometry,matrix,materialIndexOffset){if(geometry instanceof
THREE.Geometry===false){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",geometry);return}var normalMatrix,vertexOffset=this.vertices.length,vertices1=this.vertices,vertices2=geometry.vertices,faces1=this.faces,faces2=geometry.faces,uvs1=this.faceVertexUvs[0],uvs2=geometry.faceVertexUvs[0];if(materialIndexOffset===undefined)materialIndexOffset=0;if(matrix!==undefined)normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix);for(var i=0,il=vertices2.length;i<il;i++){var vertex=
vertices2[i];var vertexCopy=vertex.clone();if(matrix!==undefined)vertexCopy.applyMatrix4(matrix);vertices1.push(vertexCopy)}for(i=0,il=faces2.length;i<il;i++){var face=faces2[i],faceCopy,normal,color,faceVertexNormals=face.vertexNormals,faceVertexColors=face.vertexColors;faceCopy=new THREE.Face3(face.a+vertexOffset,face.b+vertexOffset,face.c+vertexOffset);faceCopy.normal.copy(face.normal);if(normalMatrix!==undefined)faceCopy.normal.applyMatrix3(normalMatrix).normalize();for(var j=0,jl=faceVertexNormals.length;j<
jl;j++){normal=faceVertexNormals[j].clone();if(normalMatrix!==undefined)normal.applyMatrix3(normalMatrix).normalize();faceCopy.vertexNormals.push(normal)}faceCopy.color.copy(face.color);for(var j=0,jl=faceVertexColors.length;j<jl;j++){color=faceVertexColors[j];faceCopy.vertexColors.push(color.clone())}faceCopy.materialIndex=face.materialIndex+materialIndexOffset;faces1.push(faceCopy)}for(i=0,il=uvs2.length;i<il;i++){var uv=uvs2[i],uvCopy=[];if(uv===undefined)continue;for(var j=0,jl=uv.length;j<jl;j++)uvCopy.push(uv[j].clone());
uvs1.push(uvCopy)}},mergeMesh:function(mesh){if(mesh instanceof THREE.Mesh===false){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",mesh);return}mesh.matrixAutoUpdate&&mesh.updateMatrix();this.merge(mesh.geometry,mesh.matrix)},mergeVertices:function(){var verticesMap={};var unique=[],changes=[];var v,key;var precisionPoints=4;var precision=Math.pow(10,precisionPoints);var i,il,face;var indices,j,jl;for(i=0,il=this.vertices.length;i<il;i++){v=this.vertices[i];key=Math.round(v.x*
precision)+"_"+Math.round(v.y*precision)+"_"+Math.round(v.z*precision);if(verticesMap[key]===undefined){verticesMap[key]=i;unique.push(this.vertices[i]);changes[i]=unique.length-1}else changes[i]=changes[verticesMap[key]]}var faceIndicesToRemove=[];for(i=0,il=this.faces.length;i<il;i++){face=this.faces[i];face.a=changes[face.a];face.b=changes[face.b];face.c=changes[face.c];indices=[face.a,face.b,face.c];var dupIndex=-1;for(var n=0;n<3;n++)if(indices[n]===indices[(n+1)%3]){dupIndex=n;faceIndicesToRemove.push(i);
break}}for(i=faceIndicesToRemove.length-1;i>=0;i--){var idx=faceIndicesToRemove[i];this.faces.splice(idx,1);for(j=0,jl=this.faceVertexUvs.length;j<jl;j++)this.faceVertexUvs[j].splice(idx,1)}var diff=this.vertices.length-unique.length;this.vertices=unique;return diff},sortFacesByMaterialIndex:function(){var faces=this.faces;var length=faces.length;for(var i=0;i<length;i++)faces[i]._id=i;function materialIndexSort(a,b){return a.materialIndex-b.materialIndex}faces.sort(materialIndexSort);var uvs1=this.faceVertexUvs[0];
var uvs2=this.faceVertexUvs[1];var newUvs1,newUvs2;if(uvs1&&uvs1.length===length)newUvs1=[];if(uvs2&&uvs2.length===length)newUvs2=[];for(var i=0;i<length;i++){var id=faces[i]._id;if(newUvs1)newUvs1.push(uvs1[id]);if(newUvs2)newUvs2.push(uvs2[id])}if(newUvs1)this.faceVertexUvs[0]=newUvs1;if(newUvs2)this.faceVertexUvs[1]=newUvs2},toJSON:function(){var data={metadata:{version:4.4,type:"Geometry",generator:"Geometry.toJSON"}};data.uuid=this.uuid;data.type=this.type;if(this.name!=="")data.name=this.name;
if(this.parameters!==undefined){var parameters=this.parameters;for(var key in parameters)if(parameters[key]!==undefined)data[key]=parameters[key];return data}var vertices=[];for(var i=0;i<this.vertices.length;i++){var vertex=this.vertices[i];vertices.push(vertex.x,vertex.y,vertex.z)}var faces=[];var normals=[];var normalsHash={};var colors=[];var colorsHash={};var uvs=[];var uvsHash={};for(var i=0;i<this.faces.length;i++){var face=this.faces[i];var hasMaterial=true;var hasFaceUv=false;var hasFaceVertexUv=
this.faceVertexUvs[0][i]!==undefined;var hasFaceNormal=face.normal.length()>0;var hasFaceVertexNormal=face.vertexNormals.length>0;var hasFaceColor=face.color.r!==1||face.color.g!==1||face.color.b!==1;var hasFaceVertexColor=face.vertexColors.length>0;var faceType=0;faceType=setBit(faceType,0,0);faceType=setBit(faceType,1,hasMaterial);faceType=setBit(faceType,2,hasFaceUv);faceType=setBit(faceType,3,hasFaceVertexUv);faceType=setBit(faceType,4,hasFaceNormal);faceType=setBit(faceType,5,hasFaceVertexNormal);
faceType=setBit(faceType,6,hasFaceColor);faceType=setBit(faceType,7,hasFaceVertexColor);faces.push(faceType);faces.push(face.a,face.b,face.c);faces.push(face.materialIndex);if(hasFaceVertexUv){var faceVertexUvs=this.faceVertexUvs[0][i];faces.push(getUvIndex(faceVertexUvs[0]),getUvIndex(faceVertexUvs[1]),getUvIndex(faceVertexUvs[2]))}if(hasFaceNormal)faces.push(getNormalIndex(face.normal));if(hasFaceVertexNormal){var vertexNormals=face.vertexNormals;faces.push(getNormalIndex(vertexNormals[0]),getNormalIndex(vertexNormals[1]),
getNormalIndex(vertexNormals[2]))}if(hasFaceColor)faces.push(getColorIndex(face.color));if(hasFaceVertexColor){var vertexColors=face.vertexColors;faces.push(getColorIndex(vertexColors[0]),getColorIndex(vertexColors[1]),getColorIndex(vertexColors[2]))}}function setBit(value,position,enabled){return enabled?value|1<<position:value&~(1<<position)}function getNormalIndex(normal){var hash=normal.x.toString()+normal.y.toString()+normal.z.toString();if(normalsHash[hash]!==undefined)return normalsHash[hash];
normalsHash[hash]=normals.length/3;normals.push(normal.x,normal.y,normal.z);return normalsHash[hash]}function getColorIndex(color){var hash=color.r.toString()+color.g.toString()+color.b.toString();if(colorsHash[hash]!==undefined)return colorsHash[hash];colorsHash[hash]=colors.length;colors.push(color.getHex());return colorsHash[hash]}function getUvIndex(uv){var hash=uv.x.toString()+uv.y.toString();if(uvsHash[hash]!==undefined)return uvsHash[hash];uvsHash[hash]=uvs.length/2;uvs.push(uv.x,uv.y);return uvsHash[hash]}
data.data={};data.data.vertices=vertices;data.data.normals=normals;if(colors.length>0)data.data.colors=colors;if(uvs.length>0)data.data.uvs=[uvs];data.data.faces=faces;return data},clone:function(){return(new THREE.Geometry).copy(this)},copy:function(source){this.vertices=[];this.faces=[];this.faceVertexUvs=[[]];var vertices=source.vertices;for(var i=0,il=vertices.length;i<il;i++)this.vertices.push(vertices[i].clone());var faces=source.faces;for(var i=0,il=faces.length;i<il;i++)this.faces.push(faces[i].clone());
for(var i=0,il=source.faceVertexUvs.length;i<il;i++){var faceVertexUvs=source.faceVertexUvs[i];if(this.faceVertexUvs[i]===undefined)this.faceVertexUvs[i]=[];for(var j=0,jl=faceVertexUvs.length;j<jl;j++){var uvs=faceVertexUvs[j],uvsCopy=[];for(var k=0,kl=uvs.length;k<kl;k++){var uv=uvs[k];uvsCopy.push(uv.clone())}this.faceVertexUvs[i].push(uvsCopy)}}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});THREE.GeometryIdCount=0;
THREE.DirectGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="DirectGeometry";this.indices=[];this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingBox=null;this.boundingSphere=null;this.verticesNeedUpdate=false;this.normalsNeedUpdate=false;this.colorsNeedUpdate=false;this.uvsNeedUpdate=false;this.groupsNeedUpdate=
false};
Object.assign(THREE.DirectGeometry.prototype,THREE.EventDispatcher.prototype,{computeBoundingBox:THREE.Geometry.prototype.computeBoundingBox,computeBoundingSphere:THREE.Geometry.prototype.computeBoundingSphere,computeFaceNormals:function(){console.warn("THREE.DirectGeometry: computeFaceNormals() is not a method of this type of geometry.")},computeVertexNormals:function(){console.warn("THREE.DirectGeometry: computeVertexNormals() is not a method of this type of geometry.")},computeGroups:function(geometry){var group;var groups=
[];var materialIndex;var faces=geometry.faces;for(var i=0;i<faces.length;i++){var face=faces[i];if(face.materialIndex!==materialIndex){materialIndex=face.materialIndex;if(group!==undefined){group.count=i*3-group.start;groups.push(group)}group={start:i*3,materialIndex:materialIndex}}}if(group!==undefined){group.count=i*3-group.start;groups.push(group)}this.groups=groups},fromGeometry:function(geometry){var faces=geometry.faces;var vertices=geometry.vertices;var faceVertexUvs=geometry.faceVertexUvs;
var hasFaceVertexUv=faceVertexUvs[0]&&faceVertexUvs[0].length>0;var hasFaceVertexUv2=faceVertexUvs[1]&&faceVertexUvs[1].length>0;var morphTargets=geometry.morphTargets;var morphTargetsLength=morphTargets.length;var morphTargetsPosition;if(morphTargetsLength>0){morphTargetsPosition=[];for(var i=0;i<morphTargetsLength;i++)morphTargetsPosition[i]=[];this.morphTargets.position=morphTargetsPosition}var morphNormals=geometry.morphNormals;var morphNormalsLength=morphNormals.length;var morphTargetsNormal;
if(morphNormalsLength>0){morphTargetsNormal=[];for(var i=0;i<morphNormalsLength;i++)morphTargetsNormal[i]=[];this.morphTargets.normal=morphTargetsNormal}var skinIndices=geometry.skinIndices;var skinWeights=geometry.skinWeights;var hasSkinIndices=skinIndices.length===vertices.length;var hasSkinWeights=skinWeights.length===vertices.length;for(var i=0;i<faces.length;i++){var face=faces[i];this.vertices.push(vertices[face.a],vertices[face.b],vertices[face.c]);var vertexNormals=face.vertexNormals;if(vertexNormals.length===
3)this.normals.push(vertexNormals[0],vertexNormals[1],vertexNormals[2]);else{var normal=face.normal;this.normals.push(normal,normal,normal)}var vertexColors=face.vertexColors;if(vertexColors.length===3)this.colors.push(vertexColors[0],vertexColors[1],vertexColors[2]);else{var color=face.color;this.colors.push(color,color,color)}if(hasFaceVertexUv===true){var vertexUvs=faceVertexUvs[0][i];if(vertexUvs!==undefined)this.uvs.push(vertexUvs[0],vertexUvs[1],vertexUvs[2]);else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",
i);this.uvs.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)}}if(hasFaceVertexUv2===true){var vertexUvs=faceVertexUvs[1][i];if(vertexUvs!==undefined)this.uvs2.push(vertexUvs[0],vertexUvs[1],vertexUvs[2]);else{console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",i);this.uvs2.push(new THREE.Vector2,new THREE.Vector2,new THREE.Vector2)}}for(var j=0;j<morphTargetsLength;j++){var morphTarget=morphTargets[j].vertices;morphTargetsPosition[j].push(morphTarget[face.a],morphTarget[face.b],
morphTarget[face.c])}for(var j=0;j<morphNormalsLength;j++){var morphNormal=morphNormals[j].vertexNormals[i];morphTargetsNormal[j].push(morphNormal.a,morphNormal.b,morphNormal.c)}if(hasSkinIndices)this.skinIndices.push(skinIndices[face.a],skinIndices[face.b],skinIndices[face.c]);if(hasSkinWeights)this.skinWeights.push(skinWeights[face.a],skinWeights[face.b],skinWeights[face.c])}this.computeGroups(geometry);this.verticesNeedUpdate=geometry.verticesNeedUpdate;this.normalsNeedUpdate=geometry.normalsNeedUpdate;
this.colorsNeedUpdate=geometry.colorsNeedUpdate;this.uvsNeedUpdate=geometry.uvsNeedUpdate;this.groupsNeedUpdate=geometry.groupsNeedUpdate;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});
THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="BufferGeometry";this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingBox=null;this.boundingSphere=null;this.drawRange={start:0,count:Infinity}};
Object.assign(THREE.BufferGeometry.prototype,THREE.EventDispatcher.prototype,{getIndex:function(){return this.index},setIndex:function(index){this.index=index},addAttribute:function(name,attribute){if(attribute instanceof THREE.BufferAttribute===false&&attribute instanceof THREE.InterleavedBufferAttribute===false){console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute ).");this.addAttribute(name,new THREE.BufferAttribute(arguments[1],arguments[2]));return}if(name==="index"){console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute.");
this.setIndex(attribute);return}this.attributes[name]=attribute;return this},getAttribute:function(name){return this.attributes[name]},removeAttribute:function(name){delete this.attributes[name];return this},addGroup:function(start,count,materialIndex){this.groups.push({start:start,count:count,materialIndex:materialIndex!==undefined?materialIndex:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(start,count){this.drawRange.start=start;this.drawRange.count=count},applyMatrix:function(matrix){var position=
this.attributes.position;if(position!==undefined){matrix.applyToVector3Array(position.array);position.needsUpdate=true}var normal=this.attributes.normal;if(normal!==undefined){var normalMatrix=(new THREE.Matrix3).getNormalMatrix(matrix);normalMatrix.applyToVector3Array(normal.array);normal.needsUpdate=true}if(this.boundingBox!==null)this.computeBoundingBox();if(this.boundingSphere!==null)this.computeBoundingSphere();return this},rotateX:function(){var m1;return function rotateX(angle){if(m1===undefined)m1=
new THREE.Matrix4;m1.makeRotationX(angle);this.applyMatrix(m1);return this}}(),rotateY:function(){var m1;return function rotateY(angle){if(m1===undefined)m1=new THREE.Matrix4;m1.makeRotationY(angle);this.applyMatrix(m1);return this}}(),rotateZ:function(){var m1;return function rotateZ(angle){if(m1===undefined)m1=new THREE.Matrix4;m1.makeRotationZ(angle);this.applyMatrix(m1);return this}}(),translate:function(){var m1;return function translate(x,y,z){if(m1===undefined)m1=new THREE.Matrix4;m1.makeTranslation(x,
y,z);this.applyMatrix(m1);return this}}(),scale:function(){var m1;return function scale(x,y,z){if(m1===undefined)m1=new THREE.Matrix4;m1.makeScale(x,y,z);this.applyMatrix(m1);return this}}(),lookAt:function(){var obj;return function lookAt(vector){if(obj===undefined)obj=new THREE.Object3D;obj.lookAt(vector);obj.updateMatrix();this.applyMatrix(obj.matrix)}}(),center:function(){this.computeBoundingBox();var offset=this.boundingBox.center().negate();this.translate(offset.x,offset.y,offset.z);return offset},
setFromObject:function(object){var geometry=object.geometry;if(object instanceof THREE.Points||object instanceof THREE.Line){var positions=new THREE.Float32Attribute(geometry.vertices.length*3,3);var colors=new THREE.Float32Attribute(geometry.colors.length*3,3);this.addAttribute("position",positions.copyVector3sArray(geometry.vertices));this.addAttribute("color",colors.copyColorsArray(geometry.colors));if(geometry.lineDistances&&geometry.lineDistances.length===geometry.vertices.length){var lineDistances=
new THREE.Float32Attribute(geometry.lineDistances.length,1);this.addAttribute("lineDistance",lineDistances.copyArray(geometry.lineDistances))}if(geometry.boundingSphere!==null)this.boundingSphere=geometry.boundingSphere.clone();if(geometry.boundingBox!==null)this.boundingBox=geometry.boundingBox.clone()}else if(object instanceof THREE.Mesh)if(geometry instanceof THREE.Geometry)this.fromGeometry(geometry);return this},updateFromObject:function(object){var geometry=object.geometry;if(object instanceof
THREE.Mesh){var direct=geometry.__directGeometry;if(direct===undefined)return this.fromGeometry(geometry);direct.verticesNeedUpdate=geometry.verticesNeedUpdate;direct.normalsNeedUpdate=geometry.normalsNeedUpdate;direct.colorsNeedUpdate=geometry.colorsNeedUpdate;direct.uvsNeedUpdate=geometry.uvsNeedUpdate;direct.groupsNeedUpdate=geometry.groupsNeedUpdate;geometry.verticesNeedUpdate=false;geometry.normalsNeedUpdate=false;geometry.colorsNeedUpdate=false;geometry.uvsNeedUpdate=false;geometry.groupsNeedUpdate=
false;geometry=direct}if(geometry.verticesNeedUpdate===true){var attribute=this.attributes.position;if(attribute!==undefined){attribute.copyVector3sArray(geometry.vertices);attribute.needsUpdate=true}geometry.verticesNeedUpdate=false}if(geometry.normalsNeedUpdate===true){var attribute=this.attributes.normal;if(attribute!==undefined){attribute.copyVector3sArray(geometry.normals);attribute.needsUpdate=true}geometry.normalsNeedUpdate=false}if(geometry.colorsNeedUpdate===true){var attribute=this.attributes.color;
if(attribute!==undefined){attribute.copyColorsArray(geometry.colors);attribute.needsUpdate=true}geometry.colorsNeedUpdate=false}if(geometry.uvsNeedUpdate){var attribute=this.attributes.uv;if(attribute!==undefined){attribute.copyVector2sArray(geometry.uvs);attribute.needsUpdate=true}geometry.uvsNeedUpdate=false}if(geometry.lineDistancesNeedUpdate){var attribute=this.attributes.lineDistance;if(attribute!==undefined){attribute.copyArray(geometry.lineDistances);attribute.needsUpdate=true}geometry.lineDistancesNeedUpdate=
false}if(geometry.groupsNeedUpdate){geometry.computeGroups(object.geometry);this.groups=geometry.groups;geometry.groupsNeedUpdate=false}return this},fromGeometry:function(geometry){geometry.__directGeometry=(new THREE.DirectGeometry).fromGeometry(geometry);return this.fromDirectGeometry(geometry.__directGeometry)},fromDirectGeometry:function(geometry){var positions=new Float32Array(geometry.vertices.length*3);this.addAttribute("position",(new THREE.BufferAttribute(positions,3)).copyVector3sArray(geometry.vertices));
if(geometry.normals.length>0){var normals=new Float32Array(geometry.normals.length*3);this.addAttribute("normal",(new THREE.BufferAttribute(normals,3)).copyVector3sArray(geometry.normals))}if(geometry.colors.length>0){var colors=new Float32Array(geometry.colors.length*3);this.addAttribute("color",(new THREE.BufferAttribute(colors,3)).copyColorsArray(geometry.colors))}if(geometry.uvs.length>0){var uvs=new Float32Array(geometry.uvs.length*2);this.addAttribute("uv",(new THREE.BufferAttribute(uvs,2)).copyVector2sArray(geometry.uvs))}if(geometry.uvs2.length>
0){var uvs2=new Float32Array(geometry.uvs2.length*2);this.addAttribute("uv2",(new THREE.BufferAttribute(uvs2,2)).copyVector2sArray(geometry.uvs2))}if(geometry.indices.length>0){var TypeArray=geometry.vertices.length>65535?Uint32Array:Uint16Array;var indices=new TypeArray(geometry.indices.length*3);this.setIndex((new THREE.BufferAttribute(indices,1)).copyIndicesArray(geometry.indices))}this.groups=geometry.groups;for(var name in geometry.morphTargets){var array=[];var morphTargets=geometry.morphTargets[name];
for(var i=0,l=morphTargets.length;i<l;i++){var morphTarget=morphTargets[i];var attribute=new THREE.Float32Attribute(morphTarget.length*3,3);array.push(attribute.copyVector3sArray(morphTarget))}this.morphAttributes[name]=array}if(geometry.skinIndices.length>0){var skinIndices=new THREE.Float32Attribute(geometry.skinIndices.length*4,4);this.addAttribute("skinIndex",skinIndices.copyVector4sArray(geometry.skinIndices))}if(geometry.skinWeights.length>0){var skinWeights=new THREE.Float32Attribute(geometry.skinWeights.length*
4,4);this.addAttribute("skinWeight",skinWeights.copyVector4sArray(geometry.skinWeights))}if(geometry.boundingSphere!==null)this.boundingSphere=geometry.boundingSphere.clone();if(geometry.boundingBox!==null)this.boundingBox=geometry.boundingBox.clone();return this},computeBoundingBox:function(){if(this.boundingBox===null)this.boundingBox=new THREE.Box3;var positions=this.attributes.position.array;if(positions!==undefined)this.boundingBox.setFromArray(positions);else this.boundingBox.makeEmpty();if(isNaN(this.boundingBox.min.x)||
isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var box=new THREE.Box3;var vector=new THREE.Vector3;return function computeBoundingSphere(){if(this.boundingSphere===null)this.boundingSphere=new THREE.Sphere;var positions=this.attributes.position.array;if(positions){var center=this.boundingSphere.center;
box.setFromArray(positions);box.center(center);var maxRadiusSq=0;for(var i=0,il=positions.length;i<il;i+=3){vector.fromArray(positions,i);maxRadiusSq=Math.max(maxRadiusSq,center.distanceToSquared(vector))}this.boundingSphere.radius=Math.sqrt(maxRadiusSq);if(isNaN(this.boundingSphere.radius))console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var index=
this.index;var attributes=this.attributes;var groups=this.groups;if(attributes.position){var positions=attributes.position.array;if(attributes.normal===undefined)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(positions.length),3));else{var array=attributes.normal.array;for(var i=0,il=array.length;i<il;i++)array[i]=0}var normals=attributes.normal.array;var vA,vB,vC,pA=new THREE.Vector3,pB=new THREE.Vector3,pC=new THREE.Vector3,cb=new THREE.Vector3,ab=new THREE.Vector3;if(index){var indices=
index.array;if(groups.length===0)this.addGroup(0,indices.length);for(var j=0,jl=groups.length;j<jl;++j){var group=groups[j];var start=group.start;var count=group.count;for(var i=start,il=start+count;i<il;i+=3){vA=indices[i+0]*3;vB=indices[i+1]*3;vC=indices[i+2]*3;pA.fromArray(positions,vA);pB.fromArray(positions,vB);pC.fromArray(positions,vC);cb.subVectors(pC,pB);ab.subVectors(pA,pB);cb.cross(ab);normals[vA]+=cb.x;normals[vA+1]+=cb.y;normals[vA+2]+=cb.z;normals[vB]+=cb.x;normals[vB+1]+=cb.y;normals[vB+
2]+=cb.z;normals[vC]+=cb.x;normals[vC+1]+=cb.y;normals[vC+2]+=cb.z}}}else for(var i=0,il=positions.length;i<il;i+=9){pA.fromArray(positions,i);pB.fromArray(positions,i+3);pC.fromArray(positions,i+6);cb.subVectors(pC,pB);ab.subVectors(pA,pB);cb.cross(ab);normals[i]=cb.x;normals[i+1]=cb.y;normals[i+2]=cb.z;normals[i+3]=cb.x;normals[i+4]=cb.y;normals[i+5]=cb.z;normals[i+6]=cb.x;normals[i+7]=cb.y;normals[i+8]=cb.z}this.normalizeNormals();attributes.normal.needsUpdate=true}},merge:function(geometry,offset){if(geometry instanceof
THREE.BufferGeometry===false){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",geometry);return}if(offset===undefined)offset=0;var attributes=this.attributes;for(var key in attributes){if(geometry.attributes[key]===undefined)continue;var attribute1=attributes[key];var attributeArray1=attribute1.array;var attribute2=geometry.attributes[key];var attributeArray2=attribute2.array;var attributeSize=attribute2.itemSize;for(var i=0,j=attributeSize*offset;i<
attributeArray2.length;i++,j++)attributeArray1[j]=attributeArray2[i]}return this},normalizeNormals:function(){var normals=this.attributes.normal.array;var x,y,z,n;for(var i=0,il=normals.length;i<il;i+=3){x=normals[i];y=normals[i+1];z=normals[i+2];n=1/Math.sqrt(x*x+y*y+z*z);normals[i]*=n;normals[i+1]*=n;normals[i+2]*=n}},toNonIndexed:function(){if(this.index===null){console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed.");return this}var geometry2=new THREE.BufferGeometry;
var indices=this.index.array;var attributes=this.attributes;for(var name in attributes){var attribute=attributes[name];var array=attribute.array;var itemSize=attribute.itemSize;var array2=new array.constructor(indices.length*itemSize);var index=0,index2=0;for(var i=0,l=indices.length;i<l;i++){index=indices[i]*itemSize;for(var j=0;j<itemSize;j++)array2[index2++]=array[index++]}geometry2.addAttribute(name,new THREE.BufferAttribute(array2,itemSize))}return geometry2},toJSON:function(){var data={metadata:{version:4.4,
type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};data.uuid=this.uuid;data.type=this.type;if(this.name!=="")data.name=this.name;if(this.parameters!==undefined){var parameters=this.parameters;for(var key in parameters)if(parameters[key]!==undefined)data[key]=parameters[key];return data}data.data={attributes:{}};var index=this.index;if(index!==null){var array=Array.prototype.slice.call(index.array);data.data.index={type:index.array.constructor.name,array:array}}var attributes=this.attributes;
for(var key in attributes){var attribute=attributes[key];var array=Array.prototype.slice.call(attribute.array);data.data.attributes[key]={itemSize:attribute.itemSize,type:attribute.array.constructor.name,array:array,normalized:attribute.normalized}}var groups=this.groups;if(groups.length>0)data.data.groups=JSON.parse(JSON.stringify(groups));var boundingSphere=this.boundingSphere;if(boundingSphere!==null)data.data.boundingSphere={center:boundingSphere.center.toArray(),radius:boundingSphere.radius};
return data},clone:function(){return(new THREE.BufferGeometry).copy(this)},copy:function(source){var index=source.index;if(index!==null)this.setIndex(index.clone());var attributes=source.attributes;for(var name in attributes){var attribute=attributes[name];this.addAttribute(name,attribute.clone())}var groups=source.groups;for(var i=0,l=groups.length;i<l;i++){var group=groups[i];this.addGroup(group.start,group.count,group.materialIndex)}return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});
THREE.BufferGeometry.MaxIndex=65535;THREE.InstancedBufferGeometry=function(){THREE.BufferGeometry.call(this);this.type="InstancedBufferGeometry";this.maxInstancedCount=undefined};THREE.InstancedBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.InstancedBufferGeometry.prototype.constructor=THREE.InstancedBufferGeometry;THREE.InstancedBufferGeometry.prototype.addGroup=function(start,count,instances){this.groups.push({start:start,count:count,instances:instances})};
THREE.InstancedBufferGeometry.prototype.copy=function(source){var index=source.index;if(index!==null)this.setIndex(index.clone());var attributes=source.attributes;for(var name in attributes){var attribute=attributes[name];this.addAttribute(name,attribute.clone())}var groups=source.groups;for(var i=0,l=groups.length;i<l;i++){var group=groups[i];this.addGroup(group.start,group.count,group.instances)}return this};
THREE.Uniform=function(value){if(typeof value==="string"){console.warn("THREE.Uniform: Type parameter is no longer needed.");value=arguments[1]}this.value=value;this.dynamic=false};THREE.Uniform.prototype={constructor:THREE.Uniform,onUpdate:function(callback){this.dynamic=true;this.onUpdateCallback=callback;return this}};THREE.AnimationAction=function(){throw new Error("THREE.AnimationAction: "+"Use mixer.clipAction for construction.");};
THREE.AnimationAction._new=function AnimationAction(mixer,clip,localRoot){this._mixer=mixer;this._clip=clip;this._localRoot=localRoot||null;var tracks=clip.tracks,nTracks=tracks.length,interpolants=new Array(nTracks);var interpolantSettings={endingStart:THREE.ZeroCurvatureEnding,endingEnd:THREE.ZeroCurvatureEnding};for(var i=0;i!==nTracks;++i){var interpolant=tracks[i].createInterpolant(null);interpolants[i]=interpolant;interpolant.settings=interpolantSettings}this._interpolantSettings=interpolantSettings;
this._interpolants=interpolants;this._propertyBindings=new Array(nTracks);this._cacheIndex=null;this._byClipCacheIndex=null;this._timeScaleInterpolant=null;this._weightInterpolant=null;this.loop=THREE.LoopRepeat;this._loopCount=-1;this._startTime=null;this.time=0;this.timeScale=1;this._effectiveTimeScale=1;this.weight=1;this._effectiveWeight=1;this.repetitions=Infinity;this.paused=false;this.enabled=true;this.clampWhenFinished=false;this.zeroSlopeAtStart=true;this.zeroSlopeAtEnd=true};
THREE.AnimationAction._new.prototype={constructor:THREE.AnimationAction._new,play:function(){this._mixer._activateAction(this);return this},stop:function(){this._mixer._deactivateAction(this);return this.reset()},reset:function(){this.paused=false;this.enabled=true;this.time=0;this._loopCount=-1;this._startTime=null;return this.stopFading().stopWarping()},isRunning:function(){var start=this._startTime;return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},
isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(time){this._startTime=time;return this},setLoop:function(mode,repetitions){this.loop=mode;this.repetitions=repetitions;return this},setEffectiveWeight:function(weight){this.weight=weight;this._effectiveWeight=this.enabled?weight:0;return this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(duration){return this._scheduleFading(duration,0,1)},fadeOut:function(duration){return this._scheduleFading(duration,
1,0)},crossFadeFrom:function(fadeOutAction,duration,warp){var mixer=this._mixer;fadeOutAction.fadeOut(duration);this.fadeIn(duration);if(warp){var fadeInDuration=this._clip.duration,fadeOutDuration=fadeOutAction._clip.duration,startEndRatio=fadeOutDuration/fadeInDuration,endStartRatio=fadeInDuration/fadeOutDuration;fadeOutAction.warp(1,startEndRatio,duration);this.warp(endStartRatio,1,duration)}return this},crossFadeTo:function(fadeInAction,duration,warp){return fadeInAction.crossFadeFrom(this,duration,
warp)},stopFading:function(){var weightInterpolant=this._weightInterpolant;if(weightInterpolant!==null){this._weightInterpolant=null;this._mixer._takeBackControlInterpolant(weightInterpolant)}return this},setEffectiveTimeScale:function(timeScale){this.timeScale=timeScale;this._effectiveTimeScale=this.paused?0:timeScale;return this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(duration){this.timeScale=this._clip.duration/duration;return this.stopWarping()},
syncWith:function(action){this.time=action.time;this.timeScale=action.timeScale;return this.stopWarping()},halt:function(duration){return this.warp(this._effectiveTimeScale,0,duration)},warp:function(startTimeScale,endTimeScale,duration){var mixer=this._mixer,now=mixer.time,interpolant=this._timeScaleInterpolant,timeScale=this.timeScale;if(interpolant===null)interpolant=mixer._lendControlInterpolant(),this._timeScaleInterpolant=interpolant;var times=interpolant.parameterPositions,values=interpolant.sampleValues;
times[0]=now;times[1]=now+duration;values[0]=startTimeScale/timeScale;values[1]=endTimeScale/timeScale;return this},stopWarping:function(){var timeScaleInterpolant=this._timeScaleInterpolant;if(timeScaleInterpolant!==null){this._timeScaleInterpolant=null;this._mixer._takeBackControlInterpolant(timeScaleInterpolant)}return this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(time,deltaTime,
timeDirection,accuIndex){var startTime=this._startTime;if(startTime!==null){var timeRunning=(time-startTime)*timeDirection;if(timeRunning<0||timeDirection===0)return;this._startTime=null;deltaTime=timeDirection*timeRunning}deltaTime*=this._updateTimeScale(time);var clipTime=this._updateTime(deltaTime);var weight=this._updateWeight(time);if(weight>0){var interpolants=this._interpolants;var propertyMixers=this._propertyBindings;for(var j=0,m=interpolants.length;j!==m;++j){interpolants[j].evaluate(clipTime);
propertyMixers[j].accumulate(accuIndex,weight)}}},_updateWeight:function(time){var weight=0;if(this.enabled){weight=this.weight;var interpolant=this._weightInterpolant;if(interpolant!==null){var interpolantValue=interpolant.evaluate(time)[0];weight*=interpolantValue;if(time>interpolant.parameterPositions[1]){this.stopFading();if(interpolantValue===0)this.enabled=false}}}this._effectiveWeight=weight;return weight},_updateTimeScale:function(time){var timeScale=0;if(!this.paused){timeScale=this.timeScale;
var interpolant=this._timeScaleInterpolant;if(interpolant!==null){var interpolantValue=interpolant.evaluate(time)[0];timeScale*=interpolantValue;if(time>interpolant.parameterPositions[1]){this.stopWarping();if(timeScale===0)this.paused=true;else this.timeScale=timeScale}}}this._effectiveTimeScale=timeScale;return timeScale},_updateTime:function(deltaTime){var time=this.time+deltaTime;if(deltaTime===0)return time;var duration=this._clip.duration,loop=this.loop,loopCount=this._loopCount;if(loop===THREE.LoopOnce){if(loopCount===
-1){this.loopCount=0;this._setEndings(true,true,false)}handle_stop:{if(time>=duration)time=duration;else if(time<0)time=0;else break handle_stop;if(this.clampWhenFinished)this.paused=true;else this.enabled=false;this._mixer.dispatchEvent({type:"finished",action:this,direction:deltaTime<0?-1:1})}}else{var pingPong=loop===THREE.LoopPingPong;if(loopCount===-1)if(deltaTime>=0){loopCount=0;this._setEndings(true,this.repetitions===0,pingPong)}else this._setEndings(this.repetitions===0,true,pingPong);if(time>=
duration||time<0){var loopDelta=Math.floor(time/duration);time-=duration*loopDelta;loopCount+=Math.abs(loopDelta);var pending=this.repetitions-loopCount;if(pending<0){if(this.clampWhenFinished)this.paused=true;else this.enabled=false;time=deltaTime>0?duration:0;this._mixer.dispatchEvent({type:"finished",action:this,direction:deltaTime>0?1:-1})}else{if(pending===0){var atStart=deltaTime<0;this._setEndings(atStart,!atStart,pingPong)}else this._setEndings(false,false,pingPong);this._loopCount=loopCount;
this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:loopDelta})}}if(pingPong&&(loopCount&1)===1){this.time=time;return duration-time}}this.time=time;return time},_setEndings:function(atStart,atEnd,pingPong){var settings=this._interpolantSettings;if(pingPong){settings.endingStart=THREE.ZeroSlopeEnding;settings.endingEnd=THREE.ZeroSlopeEnding}else{if(atStart)settings.endingStart=this.zeroSlopeAtStart?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding;else settings.endingStart=THREE.WrapAroundEnding;
if(atEnd)settings.endingEnd=this.zeroSlopeAtEnd?THREE.ZeroSlopeEnding:THREE.ZeroCurvatureEnding;else settings.endingEnd=THREE.WrapAroundEnding}},_scheduleFading:function(duration,weightNow,weightThen){var mixer=this._mixer,now=mixer.time,interpolant=this._weightInterpolant;if(interpolant===null)interpolant=mixer._lendControlInterpolant(),this._weightInterpolant=interpolant;var times=interpolant.parameterPositions,values=interpolant.sampleValues;times[0]=now;values[0]=weightNow;times[1]=now+duration;
values[1]=weightThen;return this}};THREE.AnimationClip=function(name,duration,tracks){this.name=name;this.tracks=tracks;this.duration=duration!==undefined?duration:-1;this.uuid=THREE.Math.generateUUID();if(this.duration<0)this.resetDuration();this.trim();this.optimize()};
THREE.AnimationClip.prototype={constructor:THREE.AnimationClip,resetDuration:function(){var tracks=this.tracks,duration=0;for(var i=0,n=tracks.length;i!==n;++i){var track=this.tracks[i];duration=Math.max(duration,track.times[track.times.length-1])}this.duration=duration},trim:function(){for(var i=0;i<this.tracks.length;i++)this.tracks[i].trim(0,this.duration);return this},optimize:function(){for(var i=0;i<this.tracks.length;i++)this.tracks[i].optimize();return this}};
Object.assign(THREE.AnimationClip,{parse:function(json){var tracks=[],jsonTracks=json.tracks,frameTime=1/(json.fps||1);for(var i=0,n=jsonTracks.length;i!==n;++i)tracks.push(THREE.KeyframeTrack.parse(jsonTracks[i]).scale(frameTime));return new THREE.AnimationClip(json.name,json.duration,tracks)},toJSON:function(clip){var tracks=[],clipTracks=clip.tracks;var json={"name":clip.name,"duration":clip.duration,"tracks":tracks};for(var i=0,n=clipTracks.length;i!==n;++i)tracks.push(THREE.KeyframeTrack.toJSON(clipTracks[i]));
return json},CreateFromMorphTargetSequence:function(name,morphTargetSequence,fps,noLoop){var numMorphTargets=morphTargetSequence.length;var tracks=[];for(var i=0;i<numMorphTargets;i++){var times=[];var values=[];times.push((i+numMorphTargets-1)%numMorphTargets,i,(i+1)%numMorphTargets);values.push(0,1,0);var order=THREE.AnimationUtils.getKeyframeOrder(times);times=THREE.AnimationUtils.sortedArray(times,1,order);values=THREE.AnimationUtils.sortedArray(values,1,order);if(!noLoop&&times[0]===0){times.push(numMorphTargets);
values.push(values[0])}tracks.push((new THREE.NumberKeyframeTrack(".morphTargetInfluences["+morphTargetSequence[i].name+"]",times,values)).scale(1/fps))}return new THREE.AnimationClip(name,-1,tracks)},findByName:function(objectOrClipArray,name){var clipArray=objectOrClipArray;if(!Array.isArray(objectOrClipArray)){var o=objectOrClipArray;clipArray=o.geometry&&o.geometry.animations||o.animations}for(var i=0;i<clipArray.length;i++)if(clipArray[i].name===name)return clipArray[i];return null},CreateClipsFromMorphTargetSequences:function(morphTargets,
fps,noLoop){var animationToMorphTargets={};var pattern=/^([\w-]*?)([\d]+)$/;for(var i=0,il=morphTargets.length;i<il;i++){var morphTarget=morphTargets[i];var parts=morphTarget.name.match(pattern);if(parts&&parts.length>1){var name=parts[1];var animationMorphTargets=animationToMorphTargets[name];if(!animationMorphTargets)animationToMorphTargets[name]=animationMorphTargets=[];animationMorphTargets.push(morphTarget)}}var clips=[];for(var name in animationToMorphTargets)clips.push(THREE.AnimationClip.CreateFromMorphTargetSequence(name,
animationToMorphTargets[name],fps,noLoop));return clips},parseAnimation:function(animation,bones,nodeName){if(!animation){console.error("  no animation in JSONLoader data");return null}var addNonemptyTrack=function(trackType,trackName,animationKeys,propertyName,destTracks){if(animationKeys.length!==0){var times=[];var values=[];THREE.AnimationUtils.flattenJSON(animationKeys,times,values,propertyName);if(times.length!==0)destTracks.push(new trackType(trackName,times,values))}};var tracks=[];var clipName=
animation.name||"default";var duration=animation.length||-1;var fps=animation.fps||30;var hierarchyTracks=animation.hierarchy||[];for(var h=0;h<hierarchyTracks.length;h++){var animationKeys=hierarchyTracks[h].keys;if(!animationKeys||animationKeys.length===0)continue;if(animationKeys[0].morphTargets){var morphTargetNames={};for(var k=0;k<animationKeys.length;k++)if(animationKeys[k].morphTargets)for(var m=0;m<animationKeys[k].morphTargets.length;m++)morphTargetNames[animationKeys[k].morphTargets[m]]=
-1;for(var morphTargetName in morphTargetNames){var times=[];var values=[];for(var m=0;m!==animationKeys[k].morphTargets.length;++m){var animationKey=animationKeys[k];times.push(animationKey.time);values.push(animationKey.morphTarget===morphTargetName?1:0)}tracks.push(new THREE.NumberKeyframeTrack(".morphTargetInfluence["+morphTargetName+"]",times,values))}duration=morphTargetNames.length*(fps||1)}else{var boneName=".bones["+bones[h].name+"]";addNonemptyTrack(THREE.VectorKeyframeTrack,boneName+".position",
animationKeys,"pos",tracks);addNonemptyTrack(THREE.QuaternionKeyframeTrack,boneName+".quaternion",animationKeys,"rot",tracks);addNonemptyTrack(THREE.VectorKeyframeTrack,boneName+".scale",animationKeys,"scl",tracks)}}if(tracks.length===0)return null;var clip=new THREE.AnimationClip(clipName,duration,tracks);return clip}});THREE.AnimationMixer=function(root){this._root=root;this._initMemoryManager();this._accuIndex=0;this.time=0;this.timeScale=1};
Object.assign(THREE.AnimationMixer.prototype,THREE.EventDispatcher.prototype,{clipAction:function(clip,optionalRoot){var root=optionalRoot||this._root,rootUuid=root.uuid,clipObject=typeof clip==="string"?THREE.AnimationClip.findByName(root,clip):clip,clipUuid=clipObject!==null?clipObject.uuid:clip,actionsForClip=this._actionsByClip[clipUuid],prototypeAction=null;if(actionsForClip!==undefined){var existingAction=actionsForClip.actionByRoot[rootUuid];if(existingAction!==undefined)return existingAction;
prototypeAction=actionsForClip.knownActions[0];if(clipObject===null)clipObject=prototypeAction._clip}if(clipObject===null)return null;var newAction=new THREE.AnimationMixer._Action(this,clipObject,optionalRoot);this._bindAction(newAction,prototypeAction);this._addInactiveAction(newAction,clipUuid,rootUuid);return newAction},existingAction:function(clip,optionalRoot){var root=optionalRoot||this._root,rootUuid=root.uuid,clipObject=typeof clip==="string"?THREE.AnimationClip.findByName(root,clip):clip,
clipUuid=clipObject?clipObject.uuid:clip,actionsForClip=this._actionsByClip[clipUuid];if(actionsForClip!==undefined)return actionsForClip.actionByRoot[rootUuid]||null;return null},stopAllAction:function(){var actions=this._actions,nActions=this._nActiveActions,bindings=this._bindings,nBindings=this._nActiveBindings;this._nActiveActions=0;this._nActiveBindings=0;for(var i=0;i!==nActions;++i)actions[i].reset();for(var i=0;i!==nBindings;++i)bindings[i].useCount=0;return this},update:function(deltaTime){deltaTime*=
this.timeScale;var actions=this._actions,nActions=this._nActiveActions,time=this.time+=deltaTime,timeDirection=Math.sign(deltaTime),accuIndex=this._accuIndex^=1;for(var i=0;i!==nActions;++i){var action=actions[i];if(action.enabled)action._update(time,deltaTime,timeDirection,accuIndex)}var bindings=this._bindings,nBindings=this._nActiveBindings;for(var i=0;i!==nBindings;++i)bindings[i].apply(accuIndex);return this},getRoot:function(){return this._root},uncacheClip:function(clip){var actions=this._actions,
clipUuid=clip.uuid,actionsByClip=this._actionsByClip,actionsForClip=actionsByClip[clipUuid];if(actionsForClip!==undefined){var actionsToRemove=actionsForClip.knownActions;for(var i=0,n=actionsToRemove.length;i!==n;++i){var action=actionsToRemove[i];this._deactivateAction(action);var cacheIndex=action._cacheIndex,lastInactiveAction=actions[actions.length-1];action._cacheIndex=null;action._byClipCacheIndex=null;lastInactiveAction._cacheIndex=cacheIndex;actions[cacheIndex]=lastInactiveAction;actions.pop();
this._removeInactiveBindingsForAction(action)}delete actionsByClip[clipUuid]}},uncacheRoot:function(root){var rootUuid=root.uuid,actionsByClip=this._actionsByClip;for(var clipUuid in actionsByClip){var actionByRoot=actionsByClip[clipUuid].actionByRoot,action=actionByRoot[rootUuid];if(action!==undefined){this._deactivateAction(action);this._removeInactiveAction(action)}}var bindingsByRoot=this._bindingsByRootAndName,bindingByName=bindingsByRoot[rootUuid];if(bindingByName!==undefined)for(var trackName in bindingByName){var binding=
bindingByName[trackName];binding.restoreOriginalState();this._removeInactiveBinding(binding)}},uncacheAction:function(clip,optionalRoot){var action=this.existingAction(clip,optionalRoot);if(action!==null){this._deactivateAction(action);this._removeInactiveAction(action)}}});THREE.AnimationMixer._Action=THREE.AnimationAction._new;
Object.assign(THREE.AnimationMixer.prototype,{_bindAction:function(action,prototypeAction){var root=action._localRoot||this._root,tracks=action._clip.tracks,nTracks=tracks.length,bindings=action._propertyBindings,interpolants=action._interpolants,rootUuid=root.uuid,bindingsByRoot=this._bindingsByRootAndName,bindingsByName=bindingsByRoot[rootUuid];if(bindingsByName===undefined){bindingsByName={};bindingsByRoot[rootUuid]=bindingsByName}for(var i=0;i!==nTracks;++i){var track=tracks[i],trackName=track.name,
binding=bindingsByName[trackName];if(binding!==undefined)bindings[i]=binding;else{binding=bindings[i];if(binding!==undefined){if(binding._cacheIndex===null){++binding.referenceCount;this._addInactiveBinding(binding,rootUuid,trackName)}continue}var path=prototypeAction&&prototypeAction._propertyBindings[i].binding.parsedPath;binding=new THREE.PropertyMixer(THREE.PropertyBinding.create(root,trackName,path),track.ValueTypeName,track.getValueSize());++binding.referenceCount;this._addInactiveBinding(binding,
rootUuid,trackName);bindings[i]=binding}interpolants[i].resultBuffer=binding.buffer}},_activateAction:function(action){if(!this._isActiveAction(action)){if(action._cacheIndex===null){var rootUuid=(action._localRoot||this._root).uuid,clipUuid=action._clip.uuid,actionsForClip=this._actionsByClip[clipUuid];this._bindAction(action,actionsForClip&&actionsForClip.knownActions[0]);this._addInactiveAction(action,clipUuid,rootUuid)}var bindings=action._propertyBindings;for(var i=0,n=bindings.length;i!==n;++i){var binding=
bindings[i];if(binding.useCount++===0){this._lendBinding(binding);binding.saveOriginalState()}}this._lendAction(action)}},_deactivateAction:function(action){if(this._isActiveAction(action)){var bindings=action._propertyBindings;for(var i=0,n=bindings.length;i!==n;++i){var binding=bindings[i];if(--binding.useCount===0){binding.restoreOriginalState();this._takeBackBinding(binding)}}this._takeBackAction(action)}},_initMemoryManager:function(){this._actions=[];this._nActiveActions=0;this._actionsByClip=
{};this._bindings=[];this._nActiveBindings=0;this._bindingsByRootAndName={};this._controlInterpolants=[];this._nActiveControlInterpolants=0;var scope=this;this.stats={actions:{get total(){return scope._actions.length},get inUse(){return scope._nActiveActions}},bindings:{get total(){return scope._bindings.length},get inUse(){return scope._nActiveBindings}},controlInterpolants:{get total(){return scope._controlInterpolants.length},get inUse(){return scope._nActiveControlInterpolants}}}},_isActiveAction:function(action){var index=
action._cacheIndex;return index!==null&&index<this._nActiveActions},_addInactiveAction:function(action,clipUuid,rootUuid){var actions=this._actions,actionsByClip=this._actionsByClip,actionsForClip=actionsByClip[clipUuid];if(actionsForClip===undefined){actionsForClip={knownActions:[action],actionByRoot:{}};action._byClipCacheIndex=0;actionsByClip[clipUuid]=actionsForClip}else{var knownActions=actionsForClip.knownActions;action._byClipCacheIndex=knownActions.length;knownActions.push(action)}action._cacheIndex=
actions.length;actions.push(action);actionsForClip.actionByRoot[rootUuid]=action},_removeInactiveAction:function(action){var actions=this._actions,lastInactiveAction=actions[actions.length-1],cacheIndex=action._cacheIndex;lastInactiveAction._cacheIndex=cacheIndex;actions[cacheIndex]=lastInactiveAction;actions.pop();action._cacheIndex=null;var clipUuid=action._clip.uuid,actionsByClip=this._actionsByClip,actionsForClip=actionsByClip[clipUuid],knownActionsForClip=actionsForClip.knownActions,lastKnownAction=
knownActionsForClip[knownActionsForClip.length-1],byClipCacheIndex=action._byClipCacheIndex;lastKnownAction._byClipCacheIndex=byClipCacheIndex;knownActionsForClip[byClipCacheIndex]=lastKnownAction;knownActionsForClip.pop();action._byClipCacheIndex=null;var actionByRoot=actionsForClip.actionByRoot,rootUuid=(actions._localRoot||this._root).uuid;delete actionByRoot[rootUuid];if(knownActionsForClip.length===0)delete actionsByClip[clipUuid];this._removeInactiveBindingsForAction(action)},_removeInactiveBindingsForAction:function(action){var bindings=
action._propertyBindings;for(var i=0,n=bindings.length;i!==n;++i){var binding=bindings[i];if(--binding.referenceCount===0)this._removeInactiveBinding(binding)}},_lendAction:function(action){var actions=this._actions,prevIndex=action._cacheIndex,lastActiveIndex=this._nActiveActions++,firstInactiveAction=actions[lastActiveIndex];action._cacheIndex=lastActiveIndex;actions[lastActiveIndex]=action;firstInactiveAction._cacheIndex=prevIndex;actions[prevIndex]=firstInactiveAction},_takeBackAction:function(action){var actions=
this._actions,prevIndex=action._cacheIndex,firstInactiveIndex=--this._nActiveActions,lastActiveAction=actions[firstInactiveIndex];action._cacheIndex=firstInactiveIndex;actions[firstInactiveIndex]=action;lastActiveAction._cacheIndex=prevIndex;actions[prevIndex]=lastActiveAction},_addInactiveBinding:function(binding,rootUuid,trackName){var bindingsByRoot=this._bindingsByRootAndName,bindingByName=bindingsByRoot[rootUuid],bindings=this._bindings;if(bindingByName===undefined){bindingByName={};bindingsByRoot[rootUuid]=
bindingByName}bindingByName[trackName]=binding;binding._cacheIndex=bindings.length;bindings.push(binding)},_removeInactiveBinding:function(binding){var bindings=this._bindings,propBinding=binding.binding,rootUuid=propBinding.rootNode.uuid,trackName=propBinding.path,bindingsByRoot=this._bindingsByRootAndName,bindingByName=bindingsByRoot[rootUuid],lastInactiveBinding=bindings[bindings.length-1],cacheIndex=binding._cacheIndex;lastInactiveBinding._cacheIndex=cacheIndex;bindings[cacheIndex]=lastInactiveBinding;
bindings.pop();delete bindingByName[trackName];remove_empty_map:{for(var _ in bindingByName)break remove_empty_map;delete bindingsByRoot[rootUuid]}},_lendBinding:function(binding){var bindings=this._bindings,prevIndex=binding._cacheIndex,lastActiveIndex=this._nActiveBindings++,firstInactiveBinding=bindings[lastActiveIndex];binding._cacheIndex=lastActiveIndex;bindings[lastActiveIndex]=binding;firstInactiveBinding._cacheIndex=prevIndex;bindings[prevIndex]=firstInactiveBinding},_takeBackBinding:function(binding){var bindings=
this._bindings,prevIndex=binding._cacheIndex,firstInactiveIndex=--this._nActiveBindings,lastActiveBinding=bindings[firstInactiveIndex];binding._cacheIndex=firstInactiveIndex;bindings[firstInactiveIndex]=binding;lastActiveBinding._cacheIndex=prevIndex;bindings[prevIndex]=lastActiveBinding},_lendControlInterpolant:function(){var interpolants=this._controlInterpolants,lastActiveIndex=this._nActiveControlInterpolants++,interpolant=interpolants[lastActiveIndex];if(interpolant===undefined){interpolant=
new THREE.LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer);interpolant.__cacheIndex=lastActiveIndex;interpolants[lastActiveIndex]=interpolant}return interpolant},_takeBackControlInterpolant:function(interpolant){var interpolants=this._controlInterpolants,prevIndex=interpolant.__cacheIndex,firstInactiveIndex=--this._nActiveControlInterpolants,lastActiveInterpolant=interpolants[firstInactiveIndex];interpolant.__cacheIndex=firstInactiveIndex;interpolants[firstInactiveIndex]=
interpolant;lastActiveInterpolant.__cacheIndex=prevIndex;interpolants[prevIndex]=lastActiveInterpolant},_controlInterpolantsResultBuffer:new Float32Array(1)});
THREE.AnimationObjectGroup=function(var_args){this.uuid=THREE.Math.generateUUID();this._objects=Array.prototype.slice.call(arguments);this.nCachedObjects_=0;var indices={};this._indicesByUUID=indices;for(var i=0,n=arguments.length;i!==n;++i)indices[arguments[i].uuid]=i;this._paths=[];this._parsedPaths=[];this._bindings=[];this._bindingsIndicesByPath={};var scope=this;this.stats={objects:{get total(){return scope._objects.length},get inUse(){return this.total-scope.nCachedObjects_}},get bindingsPerObject(){return scope._bindings.length}}};
THREE.AnimationObjectGroup.prototype={constructor:THREE.AnimationObjectGroup,add:function(var_args){var objects=this._objects,nObjects=objects.length,nCachedObjects=this.nCachedObjects_,indicesByUUID=this._indicesByUUID,paths=this._paths,parsedPaths=this._parsedPaths,bindings=this._bindings,nBindings=bindings.length;for(var i=0,n=arguments.length;i!==n;++i){var object=arguments[i],uuid=object.uuid,index=indicesByUUID[uuid];if(index===undefined){index=nObjects++;indicesByUUID[uuid]=index;objects.push(object);
for(var j=0,m=nBindings;j!==m;++j)bindings[j].push(new THREE.PropertyBinding(object,paths[j],parsedPaths[j]))}else if(index<nCachedObjects){var knownObject=objects[index];var firstActiveIndex=--nCachedObjects,lastCachedObject=objects[firstActiveIndex];indicesByUUID[lastCachedObject.uuid]=index;objects[index]=lastCachedObject;indicesByUUID[uuid]=firstActiveIndex;objects[firstActiveIndex]=object;for(var j=0,m=nBindings;j!==m;++j){var bindingsForPath=bindings[j],lastCached=bindingsForPath[firstActiveIndex],
binding=bindingsForPath[index];bindingsForPath[index]=lastCached;if(binding===undefined)binding=new THREE.PropertyBinding(object,paths[j],parsedPaths[j]);bindingsForPath[firstActiveIndex]=binding}}else if(objects[index]!==knownObject)console.error("Different objects with the same UUID "+"detected. Clean the caches or recreate your "+"infrastructure when reloading scenes...")}this.nCachedObjects_=nCachedObjects},remove:function(var_args){var objects=this._objects,nObjects=objects.length,nCachedObjects=
this.nCachedObjects_,indicesByUUID=this._indicesByUUID,bindings=this._bindings,nBindings=bindings.length;for(var i=0,n=arguments.length;i!==n;++i){var object=arguments[i],uuid=object.uuid,index=indicesByUUID[uuid];if(index!==undefined&&index>=nCachedObjects){var lastCachedIndex=nCachedObjects++,firstActiveObject=objects[lastCachedIndex];indicesByUUID[firstActiveObject.uuid]=index;objects[index]=firstActiveObject;indicesByUUID[uuid]=lastCachedIndex;objects[lastCachedIndex]=object;for(var j=0,m=nBindings;j!==
m;++j){var bindingsForPath=bindings[j],firstActive=bindingsForPath[lastCachedIndex],binding=bindingsForPath[index];bindingsForPath[index]=firstActive;bindingsForPath[lastCachedIndex]=binding}}}this.nCachedObjects_=nCachedObjects},uncache:function(var_args){var objects=this._objects,nObjects=objects.length,nCachedObjects=this.nCachedObjects_,indicesByUUID=this._indicesByUUID,bindings=this._bindings,nBindings=bindings.length;for(var i=0,n=arguments.length;i!==n;++i){var object=arguments[i],uuid=object.uuid,
index=indicesByUUID[uuid];if(index!==undefined){delete indicesByUUID[uuid];if(index<nCachedObjects){var firstActiveIndex=--nCachedObjects,lastCachedObject=objects[firstActiveIndex],lastIndex=--nObjects,lastObject=objects[lastIndex];indicesByUUID[lastCachedObject.uuid]=index;objects[index]=lastCachedObject;indicesByUUID[lastObject.uuid]=firstActiveIndex;objects[firstActiveIndex]=lastObject;objects.pop();for(var j=0,m=nBindings;j!==m;++j){var bindingsForPath=bindings[j],lastCached=bindingsForPath[firstActiveIndex],
last=bindingsForPath[lastIndex];bindingsForPath[index]=lastCached;bindingsForPath[firstActiveIndex]=last;bindingsForPath.pop()}}else{var lastIndex=--nObjects,lastObject=objects[lastIndex];indicesByUUID[lastObject.uuid]=index;objects[index]=lastObject;objects.pop();for(var j=0,m=nBindings;j!==m;++j){var bindingsForPath=bindings[j];bindingsForPath[index]=bindingsForPath[lastIndex];bindingsForPath.pop()}}}}this.nCachedObjects_=nCachedObjects},subscribe_:function(path,parsedPath){var indicesByPath=this._bindingsIndicesByPath,
index=indicesByPath[path],bindings=this._bindings;if(index!==undefined)return bindings[index];var paths=this._paths,parsedPaths=this._parsedPaths,objects=this._objects,nObjects=objects.length,nCachedObjects=this.nCachedObjects_,bindingsForPath=new Array(nObjects);index=bindings.length;indicesByPath[path]=index;paths.push(path);parsedPaths.push(parsedPath);bindings.push(bindingsForPath);for(var i=nCachedObjects,n=objects.length;i!==n;++i){var object=objects[i];bindingsForPath[i]=new THREE.PropertyBinding(object,
path,parsedPath)}return bindingsForPath},unsubscribe_:function(path){var indicesByPath=this._bindingsIndicesByPath,index=indicesByPath[path];if(index!==undefined){var paths=this._paths,parsedPaths=this._parsedPaths,bindings=this._bindings,lastBindingsIndex=bindings.length-1,lastBindings=bindings[lastBindingsIndex],lastBindingsPath=path[lastBindingsIndex];indicesByPath[lastBindingsPath]=index;bindings[index]=lastBindings;bindings.pop();parsedPaths[index]=parsedPaths[lastBindingsIndex];parsedPaths.pop();
paths[index]=paths[lastBindingsIndex];paths.pop()}}};
THREE.AnimationUtils={arraySlice:function(array,from,to){if(THREE.AnimationUtils.isTypedArray(array))return new array.constructor(array.subarray(from,to));return array.slice(from,to)},convertArray:function(array,type,forceClone){if(!array||!forceClone&&array.constructor===type)return array;if(typeof type.BYTES_PER_ELEMENT==="number")return new type(array);return Array.prototype.slice.call(array)},isTypedArray:function(object){return ArrayBuffer.isView(object)&&!(object instanceof DataView)},getKeyframeOrder:function(times){function compareTime(i,
j){return times[i]-times[j]}var n=times.length;var result=new Array(n);for(var i=0;i!==n;++i)result[i]=i;result.sort(compareTime);return result},sortedArray:function(values,stride,order){var nValues=values.length;var result=new values.constructor(nValues);for(var i=0,dstOffset=0;dstOffset!==nValues;++i){var srcOffset=order[i]*stride;for(var j=0;j!==stride;++j)result[dstOffset++]=values[srcOffset+j]}return result},flattenJSON:function(jsonKeys,times,values,valuePropertyName){var i=1,key=jsonKeys[0];
while(key!==undefined&&key[valuePropertyName]===undefined)key=jsonKeys[i++];if(key===undefined)return;var value=key[valuePropertyName];if(value===undefined)return;if(Array.isArray(value)){do{value=key[valuePropertyName];if(value!==undefined){times.push(key.time);values.push.apply(values,value)}key=jsonKeys[i++]}while(key!==undefined)}else if(value.toArray!==undefined){do{value=key[valuePropertyName];if(value!==undefined){times.push(key.time);value.toArray(values,values.length)}key=jsonKeys[i++]}while(key!==
undefined)}else{do{value=key[valuePropertyName];if(value!==undefined){times.push(key.time);values.push(value)}key=jsonKeys[i++]}while(key!==undefined)}}};
THREE.KeyframeTrack=function(name,times,values,interpolation){if(name===undefined)throw new Error("track name is undefined");if(times===undefined||times.length===0)throw new Error("no keyframes in track named "+name);this.name=name;this.times=THREE.AnimationUtils.convertArray(times,this.TimeBufferType);this.values=THREE.AnimationUtils.convertArray(values,this.ValueBufferType);this.setInterpolation(interpolation||this.DefaultInterpolation);this.validate();this.optimize()};
THREE.KeyframeTrack.prototype={constructor:THREE.KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodDiscrete:function(result){return new THREE.DiscreteInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodLinear:function(result){return new THREE.LinearInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodSmooth:function(result){return new THREE.CubicInterpolant(this.times,
this.values,this.getValueSize(),result)},setInterpolation:function(interpolation){var factoryMethod;switch(interpolation){case THREE.InterpolateDiscrete:factoryMethod=this.InterpolantFactoryMethodDiscrete;break;case THREE.InterpolateLinear:factoryMethod=this.InterpolantFactoryMethodLinear;break;case THREE.InterpolateSmooth:factoryMethod=this.InterpolantFactoryMethodSmooth;break}if(factoryMethod===undefined){var message="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;
if(this.createInterpolant===undefined)if(interpolation!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(message);console.warn(message);return}this.createInterpolant=factoryMethod},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return THREE.InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return THREE.InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return THREE.InterpolateSmooth}},
getValueSize:function(){return this.values.length/this.times.length},shift:function(timeOffset){if(timeOffset!==0){var times=this.times;for(var i=0,n=times.length;i!==n;++i)times[i]+=timeOffset}return this},scale:function(timeScale){if(timeScale!==1){var times=this.times;for(var i=0,n=times.length;i!==n;++i)times[i]*=timeScale}return this},trim:function(startTime,endTime){var times=this.times,nKeys=times.length,from=0,to=nKeys-1;while(from!==nKeys&&times[from]<startTime)++from;while(to!==-1&&times[to]>
endTime)--to;++to;if(from!==0||to!==nKeys){if(from>=to)to=Math.max(to,1),from=to-1;var stride=this.getValueSize();this.times=THREE.AnimationUtils.arraySlice(times,from,to);this.values=THREE.AnimationUtils.arraySlice(this.values,from*stride,to*stride)}return this},validate:function(){var valid=true;var valueSize=this.getValueSize();if(valueSize-Math.floor(valueSize)!==0){console.error("invalid value size in track",this);valid=false}var times=this.times,values=this.values,nKeys=times.length;if(nKeys===
0){console.error("track is empty",this);valid=false}var prevTime=null;for(var i=0;i!==nKeys;i++){var currTime=times[i];if(typeof currTime==="number"&&isNaN(currTime)){console.error("time is not a valid number",this,i,currTime);valid=false;break}if(prevTime!==null&&prevTime>currTime){console.error("out of order keys",this,i,currTime,prevTime);valid=false;break}prevTime=currTime}if(values!==undefined)if(THREE.AnimationUtils.isTypedArray(values))for(var i=0,n=values.length;i!==n;++i){var value=values[i];
if(isNaN(value)){console.error("value is not a valid number",this,i,value);valid=false;break}}return valid},optimize:function(){var times=this.times,values=this.values,stride=this.getValueSize(),writeIndex=1;for(var i=1,n=times.length-1;i<=n;++i){var keep=false;var time=times[i];var timeNext=times[i+1];if(time!==timeNext&&(i!==1||time!==time[0])){var offset=i*stride,offsetP=offset-stride,offsetN=offset+stride;for(var j=0;j!==stride;++j){var value=values[offset+j];if(value!==values[offsetP+j]||value!==
values[offsetN+j]){keep=true;break}}}if(keep){if(i!==writeIndex){times[writeIndex]=times[i];var readOffset=i*stride,writeOffset=writeIndex*stride;for(var j=0;j!==stride;++j)values[writeOffset+j]=values[readOffset+j]}++writeIndex}}if(writeIndex!==times.length){this.times=THREE.AnimationUtils.arraySlice(times,0,writeIndex);this.values=THREE.AnimationUtils.arraySlice(values,0,writeIndex*stride)}return this}};
Object.assign(THREE.KeyframeTrack,{parse:function(json){if(json.type===undefined)throw new Error("track type undefined, can not parse");var trackType=THREE.KeyframeTrack._getTrackTypeForValueTypeName(json.type);if(json.times===undefined){var times=[],values=[];THREE.AnimationUtils.flattenJSON(json.keys,times,values,"value");json.times=times;json.values=values}if(trackType.parse!==undefined)return trackType.parse(json);else return new trackType(json.name,json.times,json.values,json.interpolation)},
toJSON:function(track){var trackType=track.constructor;var json;if(trackType.toJSON!==undefined)json=trackType.toJSON(track);else{json={"name":track.name,"times":THREE.AnimationUtils.convertArray(track.times,Array),"values":THREE.AnimationUtils.convertArray(track.values,Array)};var interpolation=track.getInterpolation();if(interpolation!==track.DefaultInterpolation)json.interpolation=interpolation}json.type=track.ValueTypeName;return json},_getTrackTypeForValueTypeName:function(typeName){switch(typeName.toLowerCase()){case "scalar":case "double":case "float":case "number":case "integer":return THREE.NumberKeyframeTrack;
case "vector":case "vector2":case "vector3":case "vector4":return THREE.VectorKeyframeTrack;case "color":return THREE.ColorKeyframeTrack;case "quaternion":return THREE.QuaternionKeyframeTrack;case "bool":case "boolean":return THREE.BooleanKeyframeTrack;case "string":return THREE.StringKeyframeTrack}throw new Error("Unsupported typeName: "+typeName);}});
THREE.PropertyBinding=function(rootNode,path,parsedPath){this.path=path;this.parsedPath=parsedPath||THREE.PropertyBinding.parseTrackName(path);this.node=THREE.PropertyBinding.findNode(rootNode,this.parsedPath.nodeName)||rootNode;this.rootNode=rootNode};
THREE.PropertyBinding.prototype={constructor:THREE.PropertyBinding,getValue:function getValue_unbound(targetArray,offset){this.bind();this.getValue(targetArray,offset)},setValue:function getValue_unbound(sourceArray,offset){this.bind();this.setValue(sourceArray,offset)},bind:function(){var targetObject=this.node,parsedPath=this.parsedPath,objectName=parsedPath.objectName,propertyName=parsedPath.propertyName,propertyIndex=parsedPath.propertyIndex;if(!targetObject){targetObject=THREE.PropertyBinding.findNode(this.rootNode,
parsedPath.nodeName)||this.rootNode;this.node=targetObject}this.getValue=this._getValue_unavailable;this.setValue=this._setValue_unavailable;if(!targetObject){console.error("  trying to update node for track: "+this.path+" but it wasn't found.");return}if(objectName){var objectIndex=parsedPath.objectIndex;switch(objectName){case "materials":if(!targetObject.material){console.error("  can not bind to material as node does not have a material",this);return}if(!targetObject.material.materials){console.error("  can not bind to material.materials as node.material does not have a materials array",
this);return}targetObject=targetObject.material.materials;break;case "bones":if(!targetObject.skeleton){console.error("  can not bind to bones as node does not have a skeleton",this);return}targetObject=targetObject.skeleton.bones;for(var i=0;i<targetObject.length;i++)if(targetObject[i].name===objectIndex){objectIndex=i;break}break;default:if(targetObject[objectName]===undefined){console.error("  can not bind to objectName of node, undefined",this);return}targetObject=targetObject[objectName]}if(objectIndex!==
undefined){if(targetObject[objectIndex]===undefined){console.error("  trying to bind to objectIndex of objectName, but is undefined:",this,targetObject);return}targetObject=targetObject[objectIndex]}}var nodeProperty=targetObject[propertyName];if(!nodeProperty){var nodeName=parsedPath.nodeName;console.error("  trying to update property for track: "+nodeName+"."+propertyName+" but it wasn't found.",targetObject);return}var versioning=this.Versioning.None;if(targetObject.needsUpdate!==undefined){versioning=
this.Versioning.NeedsUpdate;this.targetObject=targetObject}else if(targetObject.matrixWorldNeedsUpdate!==undefined){versioning=this.Versioning.MatrixWorldNeedsUpdate;this.targetObject=targetObject}var bindingType=this.BindingType.Direct;if(propertyIndex!==undefined){if(propertyName==="morphTargetInfluences"){if(!targetObject.geometry){console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry",this);return}if(!targetObject.geometry.morphTargets){console.error("  can not bind to morphTargetInfluences becasuse node does not have a geometry.morphTargets",
this);return}for(var i=0;i<this.node.geometry.morphTargets.length;i++)if(targetObject.geometry.morphTargets[i].name===propertyIndex){propertyIndex=i;break}}bindingType=this.BindingType.ArrayElement;this.resolvedProperty=nodeProperty;this.propertyIndex=propertyIndex}else if(nodeProperty.fromArray!==undefined&&nodeProperty.toArray!==undefined){bindingType=this.BindingType.HasFromToArray;this.resolvedProperty=nodeProperty}else if(nodeProperty.length!==undefined){bindingType=this.BindingType.EntireArray;
this.resolvedProperty=nodeProperty}else this.propertyName=propertyName;this.getValue=this.GetterByBindingType[bindingType];this.setValue=this.SetterByBindingTypeAndVersioning[bindingType][versioning]},unbind:function(){this.node=null;this.getValue=this._getValue_unbound;this.setValue=this._setValue_unbound}};
Object.assign(THREE.PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},_getValue_unbound:THREE.PropertyBinding.prototype.getValue,_setValue_unbound:THREE.PropertyBinding.prototype.setValue,BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function getValue_direct(buffer,offset){buffer[offset]=this.node[this.propertyName]},function getValue_array(buffer,offset){var source=
this.resolvedProperty;for(var i=0,n=source.length;i!==n;++i)buffer[offset++]=source[i]},function getValue_arrayElement(buffer,offset){buffer[offset]=this.resolvedProperty[this.propertyIndex]},function getValue_toArray(buffer,offset){this.resolvedProperty.toArray(buffer,offset)}],SetterByBindingTypeAndVersioning:[[function setValue_direct(buffer,offset){this.node[this.propertyName]=buffer[offset]},function setValue_direct_setNeedsUpdate(buffer,offset){this.node[this.propertyName]=buffer[offset];this.targetObject.needsUpdate=
true},function setValue_direct_setMatrixWorldNeedsUpdate(buffer,offset){this.node[this.propertyName]=buffer[offset];this.targetObject.matrixWorldNeedsUpdate=true}],[function setValue_array(buffer,offset){var dest=this.resolvedProperty;for(var i=0,n=dest.length;i!==n;++i)dest[i]=buffer[offset++]},function setValue_array_setNeedsUpdate(buffer,offset){var dest=this.resolvedProperty;for(var i=0,n=dest.length;i!==n;++i)dest[i]=buffer[offset++];this.targetObject.needsUpdate=true},function setValue_array_setMatrixWorldNeedsUpdate(buffer,
offset){var dest=this.resolvedProperty;for(var i=0,n=dest.length;i!==n;++i)dest[i]=buffer[offset++];this.targetObject.matrixWorldNeedsUpdate=true}],[function setValue_arrayElement(buffer,offset){this.resolvedProperty[this.propertyIndex]=buffer[offset]},function setValue_arrayElement_setNeedsUpdate(buffer,offset){this.resolvedProperty[this.propertyIndex]=buffer[offset];this.targetObject.needsUpdate=true},function setValue_arrayElement_setMatrixWorldNeedsUpdate(buffer,offset){this.resolvedProperty[this.propertyIndex]=
buffer[offset];this.targetObject.matrixWorldNeedsUpdate=true}],[function setValue_fromArray(buffer,offset){this.resolvedProperty.fromArray(buffer,offset)},function setValue_fromArray_setNeedsUpdate(buffer,offset){this.resolvedProperty.fromArray(buffer,offset);this.targetObject.needsUpdate=true},function setValue_fromArray_setMatrixWorldNeedsUpdate(buffer,offset){this.resolvedProperty.fromArray(buffer,offset);this.targetObject.matrixWorldNeedsUpdate=true}]]});
THREE.PropertyBinding.Composite=function(targetGroup,path,optionalParsedPath){var parsedPath=optionalParsedPath||THREE.PropertyBinding.parseTrackName(path);this._targetGroup=targetGroup;this._bindings=targetGroup.subscribe_(path,parsedPath)};
THREE.PropertyBinding.Composite.prototype={constructor:THREE.PropertyBinding.Composite,getValue:function(array,offset){this.bind();var firstValidIndex=this._targetGroup.nCachedObjects_,binding=this._bindings[firstValidIndex];if(binding!==undefined)binding.getValue(array,offset)},setValue:function(array,offset){var bindings=this._bindings;for(var i=this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].setValue(array,offset)},bind:function(){var bindings=this._bindings;for(var i=
this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].bind()},unbind:function(){var bindings=this._bindings;for(var i=this._targetGroup.nCachedObjects_,n=bindings.length;i!==n;++i)bindings[i].unbind()}};THREE.PropertyBinding.create=function(root,path,parsedPath){if(!(root instanceof THREE.AnimationObjectGroup))return new THREE.PropertyBinding(root,path,parsedPath);else return new THREE.PropertyBinding.Composite(root,path,parsedPath)};
THREE.PropertyBinding.parseTrackName=function(trackName){var re=/^(([\w]+\/)*)([\w-\d]+)?(\.([\w]+)(\[([\w\d\[\]\_.:\- ]+)\])?)?(\.([\w.]+)(\[([\w\d\[\]\_. ]+)\])?)$/;var matches=re.exec(trackName);if(!matches)throw new Error("cannot parse trackName at all: "+trackName);if(matches.index===re.lastIndex)re.lastIndex++;var results={nodeName:matches[3],objectName:matches[5],objectIndex:matches[7],propertyName:matches[9],propertyIndex:matches[11]};if(results.propertyName===null||results.propertyName.length===
0)throw new Error("can not parse propertyName from trackName: "+trackName);return results};
THREE.PropertyBinding.findNode=function(root,nodeName){if(!nodeName||nodeName===""||nodeName==="root"||nodeName==="."||nodeName===-1||nodeName===root.name||nodeName===root.uuid)return root;if(root.skeleton){var searchSkeleton=function(skeleton){for(var i=0;i<skeleton.bones.length;i++){var bone=skeleton.bones[i];if(bone.name===nodeName)return bone}return null};var bone=searchSkeleton(root.skeleton);if(bone)return bone}if(root.children){var searchNodeSubtree=function(children){for(var i=0;i<children.length;i++){var childNode=
children[i];if(childNode.name===nodeName||childNode.uuid===nodeName)return childNode;var result=searchNodeSubtree(childNode.children);if(result)return result}return null};var subTreeNode=searchNodeSubtree(root.children);if(subTreeNode)return subTreeNode}return null};
THREE.PropertyMixer=function(binding,typeName,valueSize){this.binding=binding;this.valueSize=valueSize;var bufferType=Float64Array,mixFunction;switch(typeName){case "quaternion":mixFunction=this._slerp;break;case "string":case "bool":bufferType=Array,mixFunction=this._select;break;default:mixFunction=this._lerp}this.buffer=new bufferType(valueSize*4);this._mixBufferRegion=mixFunction;this.cumulativeWeight=0;this.useCount=0;this.referenceCount=0};
THREE.PropertyMixer.prototype={constructor:THREE.PropertyMixer,accumulate:function(accuIndex,weight){var buffer=this.buffer,stride=this.valueSize,offset=accuIndex*stride+stride,currentWeight=this.cumulativeWeight;if(currentWeight===0){for(var i=0;i!==stride;++i)buffer[offset+i]=buffer[i];currentWeight=weight}else{currentWeight+=weight;var mix=weight/currentWeight;this._mixBufferRegion(buffer,offset,0,mix,stride)}this.cumulativeWeight=currentWeight},apply:function(accuIndex){var stride=this.valueSize,
buffer=this.buffer,offset=accuIndex*stride+stride,weight=this.cumulativeWeight,binding=this.binding;this.cumulativeWeight=0;if(weight<1){var originalValueOffset=stride*3;this._mixBufferRegion(buffer,offset,originalValueOffset,1-weight,stride)}for(var i=stride,e=stride+stride;i!==e;++i)if(buffer[i]!==buffer[i+stride]){binding.setValue(buffer,offset);break}},saveOriginalState:function(){var binding=this.binding;var buffer=this.buffer,stride=this.valueSize,originalValueOffset=stride*3;binding.getValue(buffer,
originalValueOffset);for(var i=stride,e=originalValueOffset;i!==e;++i)buffer[i]=buffer[originalValueOffset+i%stride];this.cumulativeWeight=0},restoreOriginalState:function(){var originalValueOffset=this.valueSize*3;this.binding.setValue(this.buffer,originalValueOffset)},_select:function(buffer,dstOffset,srcOffset,t,stride){if(t>=.5)for(var i=0;i!==stride;++i)buffer[dstOffset+i]=buffer[srcOffset+i]},_slerp:function(buffer,dstOffset,srcOffset,t,stride){THREE.Quaternion.slerpFlat(buffer,dstOffset,buffer,
dstOffset,buffer,srcOffset,t)},_lerp:function(buffer,dstOffset,srcOffset,t,stride){var s=1-t;for(var i=0;i!==stride;++i){var j=dstOffset+i;buffer[j]=buffer[j]*s+buffer[srcOffset+i]*t}}};THREE.BooleanKeyframeTrack=function(name,times,values){THREE.KeyframeTrack.call(this,name,times,values)};
THREE.BooleanKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:THREE.InterpolateDiscrete,InterpolantFactoryMethodLinear:undefined,InterpolantFactoryMethodSmooth:undefined});THREE.ColorKeyframeTrack=function(name,times,values,interpolation){THREE.KeyframeTrack.call(this,name,times,values,interpolation)};
THREE.ColorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.ColorKeyframeTrack,ValueTypeName:"color"});THREE.NumberKeyframeTrack=function(name,times,values,interpolation){THREE.KeyframeTrack.call(this,name,times,values,interpolation)};THREE.NumberKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.NumberKeyframeTrack,ValueTypeName:"number"});
THREE.QuaternionKeyframeTrack=function(name,times,values,interpolation){THREE.KeyframeTrack.call(this,name,times,values,interpolation)};THREE.QuaternionKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:THREE.InterpolateLinear,InterpolantFactoryMethodLinear:function(result){return new THREE.QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),result)},InterpolantFactoryMethodSmooth:undefined});
THREE.StringKeyframeTrack=function(name,times,values,interpolation){THREE.KeyframeTrack.call(this,name,times,values,interpolation)};THREE.StringKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:THREE.InterpolateDiscrete,InterpolantFactoryMethodLinear:undefined,InterpolantFactoryMethodSmooth:undefined});
THREE.VectorKeyframeTrack=function(name,times,values,interpolation){THREE.KeyframeTrack.call(this,name,times,values,interpolation)};THREE.VectorKeyframeTrack.prototype=Object.assign(Object.create(THREE.KeyframeTrack.prototype),{constructor:THREE.VectorKeyframeTrack,ValueTypeName:"vector"});
THREE.Audio=function(listener){THREE.Object3D.call(this);this.type="Audio";this.context=listener.context;this.source=this.context.createBufferSource();this.source.onended=this.onEnded.bind(this);this.gain=this.context.createGain();this.gain.connect(listener.getInput());this.autoplay=false;this.startTime=0;this.playbackRate=1;this.isPlaying=false;this.hasPlaybackControl=true;this.sourceType="empty";this.filters=[]};
THREE.Audio.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Audio,getOutput:function(){return this.gain},setNodeSource:function(audioNode){this.hasPlaybackControl=false;this.sourceType="audioNode";this.source=audioNode;this.connect();return this},setBuffer:function(audioBuffer){this.source.buffer=audioBuffer;this.sourceType="buffer";if(this.autoplay)this.play();return this},play:function(){if(this.isPlaying===true){console.warn("THREE.Audio: Audio is already playing.");
return}if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}var source=this.context.createBufferSource();source.buffer=this.source.buffer;source.loop=this.source.loop;source.onended=this.source.onended;source.start(0,this.startTime);source.playbackRate.value=this.playbackRate;this.isPlaying=true;this.source=source;return this.connect()},pause:function(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");
return}this.source.stop();this.startTime=this.context.currentTime;return this},stop:function(){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.source.stop();this.startTime=0;return this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var i=1,l=this.filters.length;i<l;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());
return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var i=1,l=this.filters.length;i<l;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(value){if(!value)value=[];if(this.isPlaying===true){this.disconnect();this.filters=value;this.connect()}else this.filters=value;
return this},getFilter:function(){return this.getFilters()[0]},setFilter:function(filter){return this.setFilters(filter?[filter]:[])},setPlaybackRate:function(value){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.playbackRate=value;if(this.isPlaying===true)this.source.playbackRate.value=this.playbackRate;return this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=false},getLoop:function(){if(this.hasPlaybackControl===
false){console.warn("THREE.Audio: this Audio has no playback control.");return false}return this.source.loop},setLoop:function(value){if(this.hasPlaybackControl===false){console.warn("THREE.Audio: this Audio has no playback control.");return}this.source.loop=value},getVolume:function(){return this.gain.gain.value},setVolume:function(value){this.gain.gain.value=value;return this}});
THREE.AudioAnalyser=function(audio,fftSize){this.analyser=audio.context.createAnalyser();this.analyser.fftSize=fftSize!==undefined?fftSize:2048;this.data=new Uint8Array(this.analyser.frequencyBinCount);audio.getOutput().connect(this.analyser)};
Object.assign(THREE.AudioAnalyser.prototype,{getFrequencyData:function(){this.analyser.getByteFrequencyData(this.data);return this.data},getAverageFrequency:function(){var value=0,data=this.getFrequencyData();for(var i=0;i<data.length;i++)value+=data[i];return value/data.length}});Object.defineProperty(THREE,"AudioContext",{get:function(){var context;return function(){if(context===undefined)context=new (window.AudioContext||window.webkitAudioContext);return context}}()});
THREE.PositionalAudio=function(listener){THREE.Audio.call(this,listener);this.panner=this.context.createPanner();this.panner.connect(this.gain)};
THREE.PositionalAudio.prototype=Object.assign(Object.create(THREE.Audio.prototype),{constructor:THREE.PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(value){this.panner.refDistance=value},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(value){this.panner.rolloffFactor=value},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(value){this.panner.distanceModel=
value},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(value){this.panner.maxDistance=value},updateMatrixWorld:function(){var position=new THREE.Vector3;return function updateMatrixWorld(force){THREE.Object3D.prototype.updateMatrixWorld.call(this,force);position.setFromMatrixPosition(this.matrixWorld);this.panner.setPosition(position.x,position.y,position.z)}}()});
THREE.AudioListener=function(){THREE.Object3D.call(this);this.type="AudioListener";this.context=THREE.AudioContext;this.gain=this.context.createGain();this.gain.connect(this.context.destination);this.filter=null};
THREE.AudioListener.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.AudioListener,getInput:function(){return this.gain},removeFilter:function(){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination);this.gain.connect(this.context.destination);this.filter=null}},getFilter:function(){return this.filter},setFilter:function(value){if(this.filter!==null){this.gain.disconnect(this.filter);this.filter.disconnect(this.context.destination)}else this.gain.disconnect(this.context.destination);
this.filter=value;this.gain.connect(this.filter);this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(value){this.gain.gain.value=value},updateMatrixWorld:function(){var position=new THREE.Vector3;var quaternion=new THREE.Quaternion;var scale=new THREE.Vector3;var orientation=new THREE.Vector3;return function updateMatrixWorld(force){THREE.Object3D.prototype.updateMatrixWorld.call(this,force);var listener=this.context.listener;
var up=this.up;this.matrixWorld.decompose(position,quaternion,scale);orientation.set(0,0,-1).applyQuaternion(quaternion);listener.setPosition(position.x,position.y,position.z);listener.setOrientation(orientation.x,orientation.y,orientation.z,up.x,up.y,up.z)}}()});THREE.Camera=function(){THREE.Object3D.call(this);this.type="Camera";this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);
THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.getWorldDirection=function(){var quaternion=new THREE.Quaternion;return function(optionalTarget){var result=optionalTarget||new THREE.Vector3;this.getWorldQuaternion(quaternion);return result.set(0,0,-1).applyQuaternion(quaternion)}}();THREE.Camera.prototype.lookAt=function(){var m1=new THREE.Matrix4;return function(vector){m1.lookAt(this.position,vector,this.up);this.quaternion.setFromRotationMatrix(m1)}}();
THREE.Camera.prototype.clone=function(){return(new this.constructor).copy(this)};THREE.Camera.prototype.copy=function(source){THREE.Object3D.prototype.copy.call(this,source);this.matrixWorldInverse.copy(source.matrixWorldInverse);this.projectionMatrix.copy(source.projectionMatrix);return this};
THREE.CubeCamera=function(near,far,cubeResolution){THREE.Object3D.call(this);this.type="CubeCamera";var fov=90,aspect=1;var cameraPX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPX.up.set(0,-1,0);cameraPX.lookAt(new THREE.Vector3(1,0,0));this.add(cameraPX);var cameraNX=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNX.up.set(0,-1,0);cameraNX.lookAt(new THREE.Vector3(-1,0,0));this.add(cameraNX);var cameraPY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPY.up.set(0,0,1);cameraPY.lookAt(new THREE.Vector3(0,
1,0));this.add(cameraPY);var cameraNY=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNY.up.set(0,0,-1);cameraNY.lookAt(new THREE.Vector3(0,-1,0));this.add(cameraNY);var cameraPZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraPZ.up.set(0,-1,0);cameraPZ.lookAt(new THREE.Vector3(0,0,1));this.add(cameraPZ);var cameraNZ=new THREE.PerspectiveCamera(fov,aspect,near,far);cameraNZ.up.set(0,-1,0);cameraNZ.lookAt(new THREE.Vector3(0,0,-1));this.add(cameraNZ);var options={format:THREE.RGBFormat,
magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter};this.renderTarget=new THREE.WebGLRenderTargetCube(cubeResolution,cubeResolution,options);this.updateCubeMap=function(renderer,scene){if(this.parent===null)this.updateMatrixWorld();var renderTarget=this.renderTarget;var generateMipmaps=renderTarget.texture.generateMipmaps;renderTarget.texture.generateMipmaps=false;renderTarget.activeCubeFace=0;renderer.render(scene,cameraPX,renderTarget);renderTarget.activeCubeFace=1;renderer.render(scene,
cameraNX,renderTarget);renderTarget.activeCubeFace=2;renderer.render(scene,cameraPY,renderTarget);renderTarget.activeCubeFace=3;renderer.render(scene,cameraNY,renderTarget);renderTarget.activeCubeFace=4;renderer.render(scene,cameraPZ,renderTarget);renderTarget.texture.generateMipmaps=generateMipmaps;renderTarget.activeCubeFace=5;renderer.render(scene,cameraNZ,renderTarget);renderer.setRenderTarget(null)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);
THREE.CubeCamera.prototype.constructor=THREE.CubeCamera;THREE.OrthographicCamera=function(left,right,top,bottom,near,far){THREE.Camera.call(this);this.type="OrthographicCamera";this.zoom=1;this.left=left;this.right=right;this.top=top;this.bottom=bottom;this.near=near!==undefined?near:.1;this.far=far!==undefined?far:2E3;this.updateProjectionMatrix()};
THREE.OrthographicCamera.prototype=Object.assign(Object.create(THREE.Camera.prototype),{constructor:THREE.OrthographicCamera,copy:function(source){THREE.Camera.prototype.copy.call(this,source);this.left=source.left;this.right=source.right;this.top=source.top;this.bottom=source.bottom;this.near=source.near;this.far=source.far;this.zoom=source.zoom;return this},updateProjectionMatrix:function(){var dx=(this.right-this.left)/(2*this.zoom);var dy=(this.top-this.bottom)/(2*this.zoom);var cx=(this.right+
this.left)/2;var cy=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(cx-dx,cx+dx,cy+dy,cy-dy,this.near,this.far)},toJSON:function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.zoom=this.zoom;data.object.left=this.left;data.object.right=this.right;data.object.top=this.top;data.object.bottom=this.bottom;data.object.near=this.near;data.object.far=this.far;return data}});
THREE.PerspectiveCamera=function(fov,aspect,near,far){THREE.Camera.call(this);this.type="PerspectiveCamera";this.fov=fov!==undefined?fov:50;this.zoom=1;this.near=near!==undefined?near:.1;this.far=far!==undefined?far:2E3;this.focus=10;this.aspect=aspect!==undefined?aspect:1;this.view=null;this.filmGauge=35;this.filmOffset=0;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype=Object.assign(Object.create(THREE.Camera.prototype),{constructor:THREE.PerspectiveCamera,copy:function(source){THREE.Camera.prototype.copy.call(this,source);this.fov=source.fov;this.zoom=source.zoom;this.near=source.near;this.far=source.far;this.focus=source.focus;this.aspect=source.aspect;this.view=source.view===null?null:Object.assign({},source.view);this.filmGauge=source.filmGauge;this.filmOffset=source.filmOffset;return this},setFocalLength:function(focalLength){var vExtentSlope=
.5*this.getFilmHeight()/focalLength;this.fov=THREE.Math.RAD2DEG*2*Math.atan(vExtentSlope);this.updateProjectionMatrix()},getFocalLength:function(){var vExtentSlope=Math.tan(THREE.Math.DEG2RAD*.5*this.fov);return.5*this.getFilmHeight()/vExtentSlope},getEffectiveFOV:function(){return THREE.Math.RAD2DEG*2*Math.atan(Math.tan(THREE.Math.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,
1)},setViewOffset:function(fullWidth,fullHeight,x,y,width,height){this.aspect=fullWidth/fullHeight;this.view={fullWidth:fullWidth,fullHeight:fullHeight,offsetX:x,offsetY:y,width:width,height:height};this.updateProjectionMatrix()},clearViewOffset:function(){this.view=null;this.updateProjectionMatrix()},updateProjectionMatrix:function(){var near=this.near,top=near*Math.tan(THREE.Math.DEG2RAD*.5*this.fov)/this.zoom,height=2*top,width=this.aspect*height,left=-.5*width,view=this.view;if(view!==null){var fullWidth=
view.fullWidth,fullHeight=view.fullHeight;left+=view.offsetX*width/fullWidth;top-=view.offsetY*height/fullHeight;width*=view.width/fullWidth;height*=view.height/fullHeight}var skew=this.filmOffset;if(skew!==0)left+=near*skew/this.getFilmWidth();this.projectionMatrix.makeFrustum(left,left+width,top-height,top,near,this.far)},toJSON:function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.fov=this.fov;data.object.zoom=this.zoom;data.object.near=this.near;data.object.far=this.far;
data.object.focus=this.focus;data.object.aspect=this.aspect;if(this.view!==null)data.object.view=Object.assign({},this.view);data.object.filmGauge=this.filmGauge;data.object.filmOffset=this.filmOffset;return data}});THREE.StereoCamera=function(){this.type="StereoCamera";this.aspect=1;this.cameraL=new THREE.PerspectiveCamera;this.cameraL.layers.enable(1);this.cameraL.matrixAutoUpdate=false;this.cameraR=new THREE.PerspectiveCamera;this.cameraR.layers.enable(2);this.cameraR.matrixAutoUpdate=false};
Object.assign(THREE.StereoCamera.prototype,{update:function(){var focus,fov,aspect,near,far;var eyeRight=new THREE.Matrix4;var eyeLeft=new THREE.Matrix4;return function update(camera){var needsUpdate=focus!==camera.focus||fov!==camera.fov||aspect!==camera.aspect*this.aspect||near!==camera.near||far!==camera.far;if(needsUpdate){focus=camera.focus;fov=camera.fov;aspect=camera.aspect*this.aspect;near=camera.near;far=camera.far;var projectionMatrix=camera.projectionMatrix.clone();var eyeSep=.064/2;var eyeSepOnProjection=
eyeSep*near/focus;var ymax=near*Math.tan(THREE.Math.DEG2RAD*fov*.5);var xmin,xmax;eyeLeft.elements[12]=-eyeSep;eyeRight.elements[12]=eyeSep;xmin=-ymax*aspect+eyeSepOnProjection;xmax=ymax*aspect+eyeSepOnProjection;projectionMatrix.elements[0]=2*near/(xmax-xmin);projectionMatrix.elements[8]=(xmax+xmin)/(xmax-xmin);this.cameraL.projectionMatrix.copy(projectionMatrix);xmin=-ymax*aspect-eyeSepOnProjection;xmax=ymax*aspect-eyeSepOnProjection;projectionMatrix.elements[0]=2*near/(xmax-xmin);projectionMatrix.elements[8]=
(xmax+xmin)/(xmax-xmin);this.cameraR.projectionMatrix.copy(projectionMatrix)}this.cameraL.matrixWorld.copy(camera.matrixWorld).multiply(eyeLeft);this.cameraR.matrixWorld.copy(camera.matrixWorld).multiply(eyeRight)}}()});THREE.Light=function(color,intensity){THREE.Object3D.call(this);this.type="Light";this.color=new THREE.Color(color);this.intensity=intensity!==undefined?intensity:1;this.receiveShadow=undefined};
THREE.Light.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Light,copy:function(source){THREE.Object3D.prototype.copy.call(this,source);this.color.copy(source.color);this.intensity=source.intensity;return this},toJSON:function(meta){var data=THREE.Object3D.prototype.toJSON.call(this,meta);data.object.color=this.color.getHex();data.object.intensity=this.intensity;if(this.groundColor!==undefined)data.object.groundColor=this.groundColor.getHex();if(this.distance!==
undefined)data.object.distance=this.distance;if(this.angle!==undefined)data.object.angle=this.angle;if(this.decay!==undefined)data.object.decay=this.decay;if(this.penumbra!==undefined)data.object.penumbra=this.penumbra;return data}});THREE.LightShadow=function(camera){this.camera=camera;this.bias=0;this.radius=1;this.mapSize=new THREE.Vector2(512,512);this.map=null;this.matrix=new THREE.Matrix4};
Object.assign(THREE.LightShadow.prototype,{copy:function(source){this.camera=source.camera.clone();this.bias=source.bias;this.radius=source.radius;this.mapSize.copy(source.mapSize);return this},clone:function(){return(new this.constructor).copy(this)}});THREE.AmbientLight=function(color,intensity){THREE.Light.call(this,color,intensity);this.type="AmbientLight";this.castShadow=undefined};THREE.AmbientLight.prototype=Object.assign(Object.create(THREE.Light.prototype),{constructor:THREE.AmbientLight});
THREE.DirectionalLight=function(color,intensity){THREE.Light.call(this,color,intensity);this.type="DirectionalLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;this.shadow=new THREE.DirectionalLightShadow};THREE.DirectionalLight.prototype=Object.assign(Object.create(THREE.Light.prototype),{constructor:THREE.DirectionalLight,copy:function(source){THREE.Light.prototype.copy.call(this,source);this.target=source.target.clone();this.shadow=source.shadow.clone();return this}});
THREE.DirectionalLightShadow=function(light){THREE.LightShadow.call(this,new THREE.OrthographicCamera(-5,5,5,-5,.5,500))};THREE.DirectionalLightShadow.prototype=Object.assign(Object.create(THREE.LightShadow.prototype),{constructor:THREE.DirectionalLightShadow});THREE.HemisphereLight=function(skyColor,groundColor,intensity){THREE.Light.call(this,skyColor,intensity);this.type="HemisphereLight";this.castShadow=undefined;this.position.set(0,1,0);this.updateMatrix();this.groundColor=new THREE.Color(groundColor)};
THREE.HemisphereLight.prototype=Object.assign(Object.create(THREE.Light.prototype),{constructor:THREE.HemisphereLight,copy:function(source){THREE.Light.prototype.copy.call(this,source);this.groundColor.copy(source.groundColor);return this}});
THREE.PointLight=function(color,intensity,distance,decay){THREE.Light.call(this,color,intensity);this.type="PointLight";Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(power){this.intensity=power/(4*Math.PI)}});this.distance=distance!==undefined?distance:0;this.decay=decay!==undefined?decay:1;this.shadow=new THREE.LightShadow(new THREE.PerspectiveCamera(90,1,.5,500))};
THREE.PointLight.prototype=Object.assign(Object.create(THREE.Light.prototype),{constructor:THREE.PointLight,copy:function(source){THREE.Light.prototype.copy.call(this,source);this.distance=source.distance;this.decay=source.decay;this.shadow=source.shadow.clone();return this}});
THREE.SpotLight=function(color,intensity,distance,angle,penumbra,decay){THREE.Light.call(this,color,intensity);this.type="SpotLight";this.position.set(0,1,0);this.updateMatrix();this.target=new THREE.Object3D;Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(power){this.intensity=power/Math.PI}});this.distance=distance!==undefined?distance:0;this.angle=angle!==undefined?angle:Math.PI/3;this.penumbra=penumbra!==undefined?penumbra:0;this.decay=decay!==undefined?
decay:1;this.shadow=new THREE.SpotLightShadow};THREE.SpotLight.prototype=Object.assign(Object.create(THREE.Light.prototype),{constructor:THREE.SpotLight,copy:function(source){THREE.Light.prototype.copy.call(this,source);this.distance=source.distance;this.angle=source.angle;this.penumbra=source.penumbra;this.decay=source.decay;this.target=source.target.clone();this.shadow=source.shadow.clone();return this}});
THREE.SpotLightShadow=function(){THREE.LightShadow.call(this,new THREE.PerspectiveCamera(50,1,.5,500))};
THREE.SpotLightShadow.prototype=Object.assign(Object.create(THREE.LightShadow.prototype),{constructor:THREE.SpotLightShadow,update:function(light){var fov=THREE.Math.RAD2DEG*2*light.angle;var aspect=this.mapSize.width/this.mapSize.height;var far=light.distance||500;var camera=this.camera;if(fov!==camera.fov||aspect!==camera.aspect||far!==camera.far){camera.fov=fov;camera.aspect=aspect;camera.far=far;camera.updateProjectionMatrix()}}});
THREE.AudioLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};THREE.AudioLoader.prototype={constructor:THREE.AudioLoader,load:function(url,onLoad,onProgress,onError){var loader=new THREE.XHRLoader(this.manager);loader.setResponseType("arraybuffer");loader.load(url,function(buffer){var context=THREE.AudioContext;context.decodeAudioData(buffer,function(audioBuffer){onLoad(audioBuffer)})},onProgress,onError)}};
THREE.Cache={enabled:false,files:{},add:function(key,file){if(this.enabled===false)return;this.files[key]=file},get:function(key){if(this.enabled===false)return;return this.files[key]},remove:function(key){delete this.files[key]},clear:function(){this.files={}}};THREE.Loader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:undefined,extractUrlBase:function(url){var parts=url.split("/");if(parts.length===1)return"./";parts.pop();return parts.join("/")+"/"},initMaterials:function(materials,texturePath,crossOrigin){var array=[];for(var i=0;i<materials.length;++i)array[i]=this.createMaterial(materials[i],texturePath,crossOrigin);return array},createMaterial:function(){var color,textureLoader,materialLoader;return function(m,texturePath,crossOrigin){if(color===
undefined)color=new THREE.Color;if(textureLoader===undefined)textureLoader=new THREE.TextureLoader;if(materialLoader===undefined)materialLoader=new THREE.MaterialLoader;var textures={};function loadTexture(path,repeat,offset,wrap,anisotropy){var fullPath=texturePath+path;var loader=THREE.Loader.Handlers.get(fullPath);var texture;if(loader!==null)texture=loader.load(fullPath);else{textureLoader.setCrossOrigin(crossOrigin);texture=textureLoader.load(fullPath)}if(repeat!==undefined){texture.repeat.fromArray(repeat);
if(repeat[0]!==1)texture.wrapS=THREE.RepeatWrapping;if(repeat[1]!==1)texture.wrapT=THREE.RepeatWrapping}if(offset!==undefined)texture.offset.fromArray(offset);if(wrap!==undefined){if(wrap[0]==="repeat")texture.wrapS=THREE.RepeatWrapping;if(wrap[0]==="mirror")texture.wrapS=THREE.MirroredRepeatWrapping;if(wrap[1]==="repeat")texture.wrapT=THREE.RepeatWrapping;if(wrap[1]==="mirror")texture.wrapT=THREE.MirroredRepeatWrapping}if(anisotropy!==undefined)texture.anisotropy=anisotropy;var uuid=THREE.Math.generateUUID();
textures[uuid]=texture;return uuid}var json={uuid:THREE.Math.generateUUID(),type:"MeshLambertMaterial"};for(var name in m){var value=m[name];switch(name){case "DbgColor":case "DbgIndex":case "opticalDensity":case "illumination":break;case "DbgName":json.name=value;break;case "blending":json.blending=THREE[value];break;case "colorAmbient":case "mapAmbient":console.warn("THREE.Loader.createMaterial:",name,"is no longer supported.");break;case "colorDiffuse":json.color=color.fromArray(value).getHex();
break;case "colorSpecular":json.specular=color.fromArray(value).getHex();break;case "colorEmissive":json.emissive=color.fromArray(value).getHex();break;case "specularCoef":json.shininess=value;break;case "shading":if(value.toLowerCase()==="basic")json.type="MeshBasicMaterial";if(value.toLowerCase()==="phong")json.type="MeshPhongMaterial";break;case "mapDiffuse":json.map=loadTexture(value,m.mapDiffuseRepeat,m.mapDiffuseOffset,m.mapDiffuseWrap,m.mapDiffuseAnisotropy);break;case "mapDiffuseRepeat":case "mapDiffuseOffset":case "mapDiffuseWrap":case "mapDiffuseAnisotropy":break;
case "mapLight":json.lightMap=loadTexture(value,m.mapLightRepeat,m.mapLightOffset,m.mapLightWrap,m.mapLightAnisotropy);break;case "mapLightRepeat":case "mapLightOffset":case "mapLightWrap":case "mapLightAnisotropy":break;case "mapAO":json.aoMap=loadTexture(value,m.mapAORepeat,m.mapAOOffset,m.mapAOWrap,m.mapAOAnisotropy);break;case "mapAORepeat":case "mapAOOffset":case "mapAOWrap":case "mapAOAnisotropy":break;case "mapBump":json.bumpMap=loadTexture(value,m.mapBumpRepeat,m.mapBumpOffset,m.mapBumpWrap,
m.mapBumpAnisotropy);break;case "mapBumpScale":json.bumpScale=value;break;case "mapBumpRepeat":case "mapBumpOffset":case "mapBumpWrap":case "mapBumpAnisotropy":break;case "mapNormal":json.normalMap=loadTexture(value,m.mapNormalRepeat,m.mapNormalOffset,m.mapNormalWrap,m.mapNormalAnisotropy);break;case "mapNormalFactor":json.normalScale=[value,value];break;case "mapNormalRepeat":case "mapNormalOffset":case "mapNormalWrap":case "mapNormalAnisotropy":break;case "mapSpecular":json.specularMap=loadTexture(value,
m.mapSpecularRepeat,m.mapSpecularOffset,m.mapSpecularWrap,m.mapSpecularAnisotropy);break;case "mapSpecularRepeat":case "mapSpecularOffset":case "mapSpecularWrap":case "mapSpecularAnisotropy":break;case "mapAlpha":json.alphaMap=loadTexture(value,m.mapAlphaRepeat,m.mapAlphaOffset,m.mapAlphaWrap,m.mapAlphaAnisotropy);break;case "mapAlphaRepeat":case "mapAlphaOffset":case "mapAlphaWrap":case "mapAlphaAnisotropy":break;case "flipSided":json.side=THREE.BackSide;break;case "doubleSided":json.side=THREE.DoubleSide;
break;case "transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity");json.opacity=value;break;case "depthTest":case "depthWrite":case "colorWrite":case "opacity":case "reflectivity":case "transparent":case "visible":case "wireframe":json[name]=value;break;case "vertexColors":if(value===true)json.vertexColors=THREE.VertexColors;if(value==="face")json.vertexColors=THREE.FaceColors;break;default:console.error("THREE.Loader.createMaterial: Unsupported",name,
value);break}}if(json.type==="MeshBasicMaterial")delete json.emissive;if(json.type!=="MeshPhongMaterial")delete json.specular;if(json.opacity<1)json.transparent=true;materialLoader.setTextures(textures);return materialLoader.parse(json)}}()};THREE.Loader.Handlers={handlers:[],add:function(regex,loader){this.handlers.push(regex,loader)},get:function(file){var handlers=this.handlers;for(var i=0,l=handlers.length;i<l;i+=2){var regex=handlers[i];var loader=handlers[i+1];if(regex.test(file))return loader}return null}};
THREE.XHRLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(url,onLoad,onProgress,onError){if(this.path!==undefined)url=this.path+url;var scope=this;var cached=THREE.Cache.get(url);if(cached!==undefined){if(onLoad)setTimeout(function(){onLoad(cached)},0);return cached}var request=new XMLHttpRequest;request.overrideMimeType("text/plain");request.open("GET",url,true);request.addEventListener("load",function(event){var response=event.target.response;THREE.Cache.add(url,response);if(this.status===
200){if(onLoad)onLoad(response);scope.manager.itemEnd(url)}else if(this.status===0){console.warn("THREE.XHRLoader: HTTP Status 0 received.");if(onLoad)onLoad(response);scope.manager.itemEnd(url)}else{if(onError)onError(event);scope.manager.itemError(url)}},false);if(onProgress!==undefined)request.addEventListener("progress",function(event){onProgress(event)},false);request.addEventListener("error",function(event){if(onError)onError(event);scope.manager.itemError(url)},false);if(this.responseType!==
undefined)request.responseType=this.responseType;if(this.withCredentials!==undefined)request.withCredentials=this.withCredentials;request.send(null);scope.manager.itemStart(url);return request},setPath:function(value){this.path=value},setResponseType:function(value){this.responseType=value},setWithCredentials:function(value){this.withCredentials=value}};THREE.FontLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.FontLoader.prototype={constructor:THREE.FontLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.XHRLoader(this.manager);loader.load(url,function(text){var json;try{json=JSON.parse(text)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead.");json=JSON.parse(text.substring(65,text.length-2))}var font=scope.parse(json);if(onLoad)onLoad(font)},onProgress,onError)},parse:function(json){return new THREE.Font(json)}};
THREE.ImageLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(url,onLoad,onProgress,onError){if(this.path!==undefined)url=this.path+url;var scope=this;var cached=THREE.Cache.get(url);if(cached!==undefined){scope.manager.itemStart(url);if(onLoad)setTimeout(function(){onLoad(cached);scope.manager.itemEnd(url)},0);else scope.manager.itemEnd(url);return cached}var image=document.createElement("img");image.addEventListener("load",function(event){THREE.Cache.add(url,this);if(onLoad)onLoad(this);
scope.manager.itemEnd(url)},false);if(onProgress!==undefined)image.addEventListener("progress",function(event){onProgress(event)},false);image.addEventListener("error",function(event){if(onError)onError(event);scope.manager.itemError(url)},false);if(this.crossOrigin!==undefined)image.crossOrigin=this.crossOrigin;scope.manager.itemStart(url);image.src=url;return image},setCrossOrigin:function(value){this.crossOrigin=value},setPath:function(value){this.path=value}};
THREE.JSONLoader=function(manager){if(typeof manager==="boolean"){console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor.");manager=undefined}this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager;this.withCredentials=false};
THREE.JSONLoader.prototype={constructor:THREE.JSONLoader,get statusDomElement(){if(this._statusDomElement===undefined)this._statusDomElement=document.createElement("div");console.warn("THREE.JSONLoader: .statusDomElement has been removed.");return this._statusDomElement},load:function(url,onLoad,onProgress,onError){var scope=this;var texturePath=this.texturePath&&typeof this.texturePath==="string"?this.texturePath:THREE.Loader.prototype.extractUrlBase(url);var loader=new THREE.XHRLoader(this.manager);
loader.setWithCredentials(this.withCredentials);loader.load(url,function(text){var json=JSON.parse(text);var metadata=json.metadata;if(metadata!==undefined){var type=metadata.type;if(type!==undefined){if(type.toLowerCase()==="object"){console.error("THREE.JSONLoader: "+url+" should be loaded with THREE.ObjectLoader instead.");return}if(type.toLowerCase()==="scene"){console.error("THREE.JSONLoader: "+url+" should be loaded with THREE.SceneLoader instead.");return}}}var object=scope.parse(json,texturePath);
onLoad(object.geometry,object.materials)},onProgress,onError)},setTexturePath:function(value){this.texturePath=value},parse:function(json,texturePath){var geometry=new THREE.Geometry,scale=json.scale!==undefined?1/json.scale:1;parseModel(scale);parseSkin();parseMorphing(scale);parseAnimations();geometry.computeFaceNormals();geometry.computeBoundingSphere();function parseModel(scale){function isBitSet(value,position){return value&1<<position}var i,j,fi,offset,zLength,colorIndex,normalIndex,uvIndex,
materialIndex,type,isQuad,hasMaterial,hasFaceVertexUv,hasFaceNormal,hasFaceVertexNormal,hasFaceColor,hasFaceVertexColor,vertex,face,faceA,faceB,hex,normal,uvLayer,uv,u,v,faces=json.faces,vertices=json.vertices,normals=json.normals,colors=json.colors,nUvLayers=0;if(json.uvs!==undefined){for(i=0;i<json.uvs.length;i++)if(json.uvs[i].length)nUvLayers++;for(i=0;i<nUvLayers;i++)geometry.faceVertexUvs[i]=[]}offset=0;zLength=vertices.length;while(offset<zLength){vertex=new THREE.Vector3;vertex.x=vertices[offset++]*
scale;vertex.y=vertices[offset++]*scale;vertex.z=vertices[offset++]*scale;geometry.vertices.push(vertex)}offset=0;zLength=faces.length;while(offset<zLength){type=faces[offset++];isQuad=isBitSet(type,0);hasMaterial=isBitSet(type,1);hasFaceVertexUv=isBitSet(type,3);hasFaceNormal=isBitSet(type,4);hasFaceVertexNormal=isBitSet(type,5);hasFaceColor=isBitSet(type,6);hasFaceVertexColor=isBitSet(type,7);if(isQuad){faceA=new THREE.Face3;faceA.a=faces[offset];faceA.b=faces[offset+1];faceA.c=faces[offset+3];
faceB=new THREE.Face3;faceB.a=faces[offset+1];faceB.b=faces[offset+2];faceB.c=faces[offset+3];offset+=4;if(hasMaterial){materialIndex=faces[offset++];faceA.materialIndex=materialIndex;faceB.materialIndex=materialIndex}fi=geometry.faces.length;if(hasFaceVertexUv)for(i=0;i<nUvLayers;i++){uvLayer=json.uvs[i];geometry.faceVertexUvs[i][fi]=[];geometry.faceVertexUvs[i][fi+1]=[];for(j=0;j<4;j++){uvIndex=faces[offset++];u=uvLayer[uvIndex*2];v=uvLayer[uvIndex*2+1];uv=new THREE.Vector2(u,v);if(j!==2)geometry.faceVertexUvs[i][fi].push(uv);
if(j!==0)geometry.faceVertexUvs[i][fi+1].push(uv)}}if(hasFaceNormal){normalIndex=faces[offset++]*3;faceA.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);faceB.normal.copy(faceA.normal)}if(hasFaceVertexNormal)for(i=0;i<4;i++){normalIndex=faces[offset++]*3;normal=new THREE.Vector3(normals[normalIndex++],normals[normalIndex++],normals[normalIndex]);if(i!==2)faceA.vertexNormals.push(normal);if(i!==0)faceB.vertexNormals.push(normal)}if(hasFaceColor){colorIndex=faces[offset++];
hex=colors[colorIndex];faceA.color.setHex(hex);faceB.color.setHex(hex)}if(hasFaceVertexColor)for(i=0;i<4;i++){colorIndex=faces[offset++];hex=colors[colorIndex];if(i!==2)faceA.vertexColors.push(new THREE.Color(hex));if(i!==0)faceB.vertexColors.push(new THREE.Color(hex))}geometry.faces.push(faceA);geometry.faces.push(faceB)}else{face=new THREE.Face3;face.a=faces[offset++];face.b=faces[offset++];face.c=faces[offset++];if(hasMaterial){materialIndex=faces[offset++];face.materialIndex=materialIndex}fi=
geometry.faces.length;if(hasFaceVertexUv)for(i=0;i<nUvLayers;i++){uvLayer=json.uvs[i];geometry.faceVertexUvs[i][fi]=[];for(j=0;j<3;j++){uvIndex=faces[offset++];u=uvLayer[uvIndex*2];v=uvLayer[uvIndex*2+1];uv=new THREE.Vector2(u,v);geometry.faceVertexUvs[i][fi].push(uv)}}if(hasFaceNormal){normalIndex=faces[offset++]*3;face.normal.set(normals[normalIndex++],normals[normalIndex++],normals[normalIndex])}if(hasFaceVertexNormal)for(i=0;i<3;i++){normalIndex=faces[offset++]*3;normal=new THREE.Vector3(normals[normalIndex++],
normals[normalIndex++],normals[normalIndex]);face.vertexNormals.push(normal)}if(hasFaceColor){colorIndex=faces[offset++];face.color.setHex(colors[colorIndex])}if(hasFaceVertexColor)for(i=0;i<3;i++){colorIndex=faces[offset++];face.vertexColors.push(new THREE.Color(colors[colorIndex]))}geometry.faces.push(face)}}}function parseSkin(){var influencesPerVertex=json.influencesPerVertex!==undefined?json.influencesPerVertex:2;if(json.skinWeights)for(var i=0,l=json.skinWeights.length;i<l;i+=influencesPerVertex){var x=
json.skinWeights[i];var y=influencesPerVertex>1?json.skinWeights[i+1]:0;var z=influencesPerVertex>2?json.skinWeights[i+2]:0;var w=influencesPerVertex>3?json.skinWeights[i+3]:0;geometry.skinWeights.push(new THREE.Vector4(x,y,z,w))}if(json.skinIndices)for(var i=0,l=json.skinIndices.length;i<l;i+=influencesPerVertex){var a=json.skinIndices[i];var b=influencesPerVertex>1?json.skinIndices[i+1]:0;var c=influencesPerVertex>2?json.skinIndices[i+2]:0;var d=influencesPerVertex>3?json.skinIndices[i+3]:0;geometry.skinIndices.push(new THREE.Vector4(a,
b,c,d))}geometry.bones=json.bones;if(geometry.bones&&geometry.bones.length>0&&(geometry.skinWeights.length!==geometry.skinIndices.length||geometry.skinIndices.length!==geometry.vertices.length))console.warn("When skinning, number of vertices ("+geometry.vertices.length+"), skinIndices ("+geometry.skinIndices.length+"), and skinWeights ("+geometry.skinWeights.length+") should match.")}function parseMorphing(scale){if(json.morphTargets!==undefined)for(var i=0,l=json.morphTargets.length;i<l;i++){geometry.morphTargets[i]=
{};geometry.morphTargets[i].name=json.morphTargets[i].name;geometry.morphTargets[i].vertices=[];var dstVertices=geometry.morphTargets[i].vertices;var srcVertices=json.morphTargets[i].vertices;for(var v=0,vl=srcVertices.length;v<vl;v+=3){var vertex=new THREE.Vector3;vertex.x=srcVertices[v]*scale;vertex.y=srcVertices[v+1]*scale;vertex.z=srcVertices[v+2]*scale;dstVertices.push(vertex)}}if(json.morphColors!==undefined&&json.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');
var faces=geometry.faces;var morphColors=json.morphColors[0].colors;for(var i=0,l=faces.length;i<l;i++)faces[i].color.fromArray(morphColors,i*3)}}function parseAnimations(){var outputAnimations=[];var animations=[];if(json.animation!==undefined)animations.push(json.animation);if(json.animations!==undefined)if(json.animations.length)animations=animations.concat(json.animations);else animations.push(json.animations);for(var i=0;i<animations.length;i++){var clip=THREE.AnimationClip.parseAnimation(animations[i],
geometry.bones);if(clip)outputAnimations.push(clip)}if(geometry.morphTargets){var morphAnimationClips=THREE.AnimationClip.CreateClipsFromMorphTargetSequences(geometry.morphTargets,10);outputAnimations=outputAnimations.concat(morphAnimationClips)}if(outputAnimations.length>0)geometry.animations=outputAnimations}if(json.materials===undefined||json.materials.length===0)return{geometry:geometry};else{var materials=THREE.Loader.prototype.initMaterials(json.materials,texturePath,this.crossOrigin);return{geometry:geometry,
materials:materials}}}};
THREE.LoadingManager=function(onLoad,onProgress,onError){var scope=this;var isLoading=false,itemsLoaded=0,itemsTotal=0;this.onStart=undefined;this.onLoad=onLoad;this.onProgress=onProgress;this.onError=onError;this.itemStart=function(url){itemsTotal++;if(isLoading===false)if(scope.onStart!==undefined)scope.onStart(url,itemsLoaded,itemsTotal);isLoading=true};this.itemEnd=function(url){itemsLoaded++;if(scope.onProgress!==undefined)scope.onProgress(url,itemsLoaded,itemsTotal);if(itemsLoaded===itemsTotal){isLoading=
false;if(scope.onLoad!==undefined)scope.onLoad()}};this.itemError=function(url){if(scope.onError!==undefined)scope.onError(url)}};THREE.DefaultLoadingManager=new THREE.LoadingManager;THREE.BufferGeometryLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)))},onProgress,onError)},parse:function(json){var geometry=new THREE.BufferGeometry;var index=json.data.index;var TYPED_ARRAYS={"Int8Array":Int8Array,"Uint8Array":Uint8Array,"Uint8ClampedArray":Uint8ClampedArray,"Int16Array":Int16Array,"Uint16Array":Uint16Array,
"Int32Array":Int32Array,"Uint32Array":Uint32Array,"Float32Array":Float32Array,"Float64Array":Float64Array};if(index!==undefined){var typedArray=new TYPED_ARRAYS[index.type](index.array);geometry.setIndex(new THREE.BufferAttribute(typedArray,1))}var attributes=json.data.attributes;for(var key in attributes){var attribute=attributes[key];var typedArray=new TYPED_ARRAYS[attribute.type](attribute.array);geometry.addAttribute(key,new THREE.BufferAttribute(typedArray,attribute.itemSize,attribute.normalized))}var groups=
json.data.groups||json.data.drawcalls||json.data.offsets;if(groups!==undefined)for(var i=0,n=groups.length;i!==n;++i){var group=groups[i];geometry.addGroup(group.start,group.count,group.materialIndex)}var boundingSphere=json.data.boundingSphere;if(boundingSphere!==undefined){var center=new THREE.Vector3;if(boundingSphere.center!==undefined)center.fromArray(boundingSphere.center);geometry.boundingSphere=new THREE.Sphere(center,boundingSphere.radius)}return geometry}};
THREE.MaterialLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager;this.textures={}};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.load(url,function(text){onLoad(scope.parse(JSON.parse(text)))},onProgress,onError)},setTextures:function(value){this.textures=value},getTexture:function(name){var textures=this.textures;if(textures[name]===undefined)console.warn("THREE.MaterialLoader: Undefined texture",name);return textures[name]},parse:function(json){var material=
new THREE[json.type];if(json.uuid!==undefined)material.uuid=json.uuid;if(json.name!==undefined)material.name=json.name;if(json.color!==undefined)material.color.setHex(json.color);if(json.roughness!==undefined)material.roughness=json.roughness;if(json.metalness!==undefined)material.metalness=json.metalness;if(json.emissive!==undefined)material.emissive.setHex(json.emissive);if(json.specular!==undefined)material.specular.setHex(json.specular);if(json.shininess!==undefined)material.shininess=json.shininess;
if(json.uniforms!==undefined)material.uniforms=json.uniforms;if(json.vertexShader!==undefined)material.vertexShader=json.vertexShader;if(json.fragmentShader!==undefined)material.fragmentShader=json.fragmentShader;if(json.vertexColors!==undefined)material.vertexColors=json.vertexColors;if(json.shading!==undefined)material.shading=json.shading;if(json.blending!==undefined)material.blending=json.blending;if(json.side!==undefined)material.side=json.side;if(json.opacity!==undefined)material.opacity=json.opacity;
if(json.transparent!==undefined)material.transparent=json.transparent;if(json.alphaTest!==undefined)material.alphaTest=json.alphaTest;if(json.depthTest!==undefined)material.depthTest=json.depthTest;if(json.depthWrite!==undefined)material.depthWrite=json.depthWrite;if(json.colorWrite!==undefined)material.colorWrite=json.colorWrite;if(json.wireframe!==undefined)material.wireframe=json.wireframe;if(json.wireframeLinewidth!==undefined)material.wireframeLinewidth=json.wireframeLinewidth;if(json.size!==
undefined)material.size=json.size;if(json.sizeAttenuation!==undefined)material.sizeAttenuation=json.sizeAttenuation;if(json.map!==undefined)material.map=this.getTexture(json.map);if(json.alphaMap!==undefined){material.alphaMap=this.getTexture(json.alphaMap);material.transparent=true}if(json.bumpMap!==undefined)material.bumpMap=this.getTexture(json.bumpMap);if(json.bumpScale!==undefined)material.bumpScale=json.bumpScale;if(json.normalMap!==undefined)material.normalMap=this.getTexture(json.normalMap);
if(json.normalScale!==undefined){var normalScale=json.normalScale;if(Array.isArray(normalScale)===false)normalScale=[normalScale,normalScale];material.normalScale=(new THREE.Vector2).fromArray(normalScale)}if(json.displacementMap!==undefined)material.displacementMap=this.getTexture(json.displacementMap);if(json.displacementScale!==undefined)material.displacementScale=json.displacementScale;if(json.displacementBias!==undefined)material.displacementBias=json.displacementBias;if(json.roughnessMap!==
undefined)material.roughnessMap=this.getTexture(json.roughnessMap);if(json.metalnessMap!==undefined)material.metalnessMap=this.getTexture(json.metalnessMap);if(json.emissiveMap!==undefined)material.emissiveMap=this.getTexture(json.emissiveMap);if(json.emissiveIntensity!==undefined)material.emissiveIntensity=json.emissiveIntensity;if(json.specularMap!==undefined)material.specularMap=this.getTexture(json.specularMap);if(json.envMap!==undefined){material.envMap=this.getTexture(json.envMap);material.combine=
THREE.MultiplyOperation}if(json.reflectivity)material.reflectivity=json.reflectivity;if(json.lightMap!==undefined)material.lightMap=this.getTexture(json.lightMap);if(json.lightMapIntensity!==undefined)material.lightMapIntensity=json.lightMapIntensity;if(json.aoMap!==undefined)material.aoMap=this.getTexture(json.aoMap);if(json.aoMapIntensity!==undefined)material.aoMapIntensity=json.aoMapIntensity;if(json.materials!==undefined)for(var i=0,l=json.materials.length;i<l;i++)material.materials.push(this.parse(json.materials[i]));
return material}};THREE.ObjectLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager;this.texturePath=""};
THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(url,onLoad,onProgress,onError){if(this.texturePath==="")this.texturePath=url.substring(0,url.lastIndexOf("/")+1);var scope=this;var loader=new THREE.XHRLoader(scope.manager);loader.load(url,function(text){scope.parse(JSON.parse(text),onLoad)},onProgress,onError)},setTexturePath:function(value){this.texturePath=value},setCrossOrigin:function(value){this.crossOrigin=value},parse:function(json,onLoad){var geometries=this.parseGeometries(json.geometries);
var images=this.parseImages(json.images,function(){if(onLoad!==undefined)onLoad(object)});var textures=this.parseTextures(json.textures,images);var materials=this.parseMaterials(json.materials,textures);var object=this.parseObject(json.object,geometries,materials);if(json.animations)object.animations=this.parseAnimations(json.animations);if(json.images===undefined||json.images.length===0)if(onLoad!==undefined)onLoad(object);return object},parseGeometries:function(json){var geometries={};if(json!==
undefined){var geometryLoader=new THREE.JSONLoader;var bufferGeometryLoader=new THREE.BufferGeometryLoader;for(var i=0,l=json.length;i<l;i++){var geometry;var data=json[i];switch(data.type){case "PlaneGeometry":case "PlaneBufferGeometry":geometry=new THREE[data.type](data.width,data.height,data.widthSegments,data.heightSegments);break;case "BoxGeometry":case "BoxBufferGeometry":case "CubeGeometry":geometry=new THREE[data.type](data.width,data.height,data.depth,data.widthSegments,data.heightSegments,
data.depthSegments);break;case "CircleGeometry":case "CircleBufferGeometry":geometry=new THREE[data.type](data.radius,data.segments,data.thetaStart,data.thetaLength);break;case "CylinderGeometry":case "CylinderBufferGeometry":geometry=new THREE[data.type](data.radiusTop,data.radiusBottom,data.height,data.radialSegments,data.heightSegments,data.openEnded,data.thetaStart,data.thetaLength);break;case "ConeGeometry":case "ConeBufferGeometry":geometry=new THREE[data.type](data.radius,data.height,data.radialSegments,
data.heightSegments,data.openEnded,data.thetaStart,data.thetaLength);break;case "SphereGeometry":case "SphereBufferGeometry":geometry=new THREE[data.type](data.radius,data.widthSegments,data.heightSegments,data.phiStart,data.phiLength,data.thetaStart,data.thetaLength);break;case "DodecahedronGeometry":case "IcosahedronGeometry":case "OctahedronGeometry":case "TetrahedronGeometry":geometry=new THREE[data.type](data.radius,data.detail);break;case "RingGeometry":case "RingBufferGeometry":geometry=new THREE[data.type](data.innerRadius,
data.outerRadius,data.thetaSegments,data.phiSegments,data.thetaStart,data.thetaLength);break;case "TorusGeometry":case "TorusBufferGeometry":geometry=new THREE[data.type](data.radius,data.tube,data.radialSegments,data.tubularSegments,data.arc);break;case "TorusKnotGeometry":case "TorusKnotBufferGeometry":geometry=new THREE[data.type](data.radius,data.tube,data.tubularSegments,data.radialSegments,data.p,data.q);break;case "LatheGeometry":case "LatheBufferGeometry":geometry=new THREE[data.type](data.points,
data.segments,data.phiStart,data.phiLength);break;case "BufferGeometry":geometry=bufferGeometryLoader.parse(data);break;case "Geometry":geometry=geometryLoader.parse(data.data,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+data.type+'"');continue}geometry.uuid=data.uuid;if(data.name!==undefined)geometry.name=data.name;geometries[data.uuid]=geometry}}return geometries},parseMaterials:function(json,textures){var materials={};if(json!==undefined){var loader=
new THREE.MaterialLoader;loader.setTextures(textures);for(var i=0,l=json.length;i<l;i++){var material=loader.parse(json[i]);materials[material.uuid]=material}}return materials},parseAnimations:function(json){var animations=[];for(var i=0;i<json.length;i++){var clip=THREE.AnimationClip.parse(json[i]);animations.push(clip)}return animations},parseImages:function(json,onLoad){var scope=this;var images={};function loadImage(url){scope.manager.itemStart(url);return loader.load(url,function(){scope.manager.itemEnd(url)})}
if(json!==undefined&&json.length>0){var manager=new THREE.LoadingManager(onLoad);var loader=new THREE.ImageLoader(manager);loader.setCrossOrigin(this.crossOrigin);for(var i=0,l=json.length;i<l;i++){var image=json[i];var path=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(image.url)?image.url:scope.texturePath+image.url;images[image.uuid]=loadImage(path)}}return images},parseTextures:function(json,images){function parseConstant(value){if(typeof value==="number")return value;console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",
value);return THREE[value]}var textures={};if(json!==undefined)for(var i=0,l=json.length;i<l;i++){var data=json[i];if(data.image===undefined)console.warn('THREE.ObjectLoader: No "image" specified for',data.uuid);if(images[data.image]===undefined)console.warn("THREE.ObjectLoader: Undefined image",data.image);var texture=new THREE.Texture(images[data.image]);texture.needsUpdate=true;texture.uuid=data.uuid;if(data.name!==undefined)texture.name=data.name;if(data.mapping!==undefined)texture.mapping=parseConstant(data.mapping);
if(data.offset!==undefined)texture.offset=new THREE.Vector2(data.offset[0],data.offset[1]);if(data.repeat!==undefined)texture.repeat=new THREE.Vector2(data.repeat[0],data.repeat[1]);if(data.minFilter!==undefined)texture.minFilter=parseConstant(data.minFilter);if(data.magFilter!==undefined)texture.magFilter=parseConstant(data.magFilter);if(data.anisotropy!==undefined)texture.anisotropy=data.anisotropy;if(Array.isArray(data.wrap)){texture.wrapS=parseConstant(data.wrap[0]);texture.wrapT=parseConstant(data.wrap[1])}textures[data.uuid]=
texture}return textures},parseObject:function(){var matrix=new THREE.Matrix4;return function(data,geometries,materials){var object;function getGeometry(name){if(geometries[name]===undefined)console.warn("THREE.ObjectLoader: Undefined geometry",name);return geometries[name]}function getMaterial(name){if(name===undefined)return undefined;if(materials[name]===undefined)console.warn("THREE.ObjectLoader: Undefined material",name);return materials[name]}switch(data.type){case "Scene":object=new THREE.Scene;
break;case "PerspectiveCamera":object=new THREE.PerspectiveCamera(data.fov,data.aspect,data.near,data.far);if(data.focus!==undefined)object.focus=data.focus;if(data.zoom!==undefined)object.zoom=data.zoom;if(data.filmGauge!==undefined)object.filmGauge=data.filmGauge;if(data.filmOffset!==undefined)object.filmOffset=data.filmOffset;if(data.view!==undefined)object.view=Object.assign({},data.view);break;case "OrthographicCamera":object=new THREE.OrthographicCamera(data.left,data.right,data.top,data.bottom,
data.near,data.far);break;case "AmbientLight":object=new THREE.AmbientLight(data.color,data.intensity);break;case "DirectionalLight":object=new THREE.DirectionalLight(data.color,data.intensity);break;case "PointLight":object=new THREE.PointLight(data.color,data.intensity,data.distance,data.decay);break;case "SpotLight":object=new THREE.SpotLight(data.color,data.intensity,data.distance,data.angle,data.penumbra,data.decay);break;case "HemisphereLight":object=new THREE.HemisphereLight(data.color,data.groundColor,
data.intensity);break;case "Mesh":var geometry=getGeometry(data.geometry);var material=getMaterial(data.material);if(geometry.bones&&geometry.bones.length>0)object=new THREE.SkinnedMesh(geometry,material);else object=new THREE.Mesh(geometry,material);break;case "LOD":object=new THREE.LOD;break;case "Line":object=new THREE.Line(getGeometry(data.geometry),getMaterial(data.material),data.mode);break;case "PointCloud":case "Points":object=new THREE.Points(getGeometry(data.geometry),getMaterial(data.material));
break;case "Sprite":object=new THREE.Sprite(getMaterial(data.material));break;case "Group":object=new THREE.Group;break;default:object=new THREE.Object3D}object.uuid=data.uuid;if(data.name!==undefined)object.name=data.name;if(data.matrix!==undefined){matrix.fromArray(data.matrix);matrix.decompose(object.position,object.quaternion,object.scale)}else{if(data.position!==undefined)object.position.fromArray(data.position);if(data.rotation!==undefined)object.rotation.fromArray(data.rotation);if(data.scale!==
undefined)object.scale.fromArray(data.scale)}if(data.castShadow!==undefined)object.castShadow=data.castShadow;if(data.receiveShadow!==undefined)object.receiveShadow=data.receiveShadow;if(data.visible!==undefined)object.visible=data.visible;if(data.userData!==undefined)object.userData=data.userData;if(data.children!==undefined)for(var child in data.children)object.add(this.parseObject(data.children[child],geometries,materials));if(data.type==="LOD"){var levels=data.levels;for(var l=0;l<levels.length;l++){var level=
levels[l];var child=object.getObjectByProperty("uuid",level.object);if(child!==undefined)object.addLevel(child,level.distance)}}return object}}()};THREE.TextureLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(url,onLoad,onProgress,onError){var texture=new THREE.Texture;var loader=new THREE.ImageLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setPath(this.path);loader.load(url,function(image){texture.image=image;texture.needsUpdate=true;if(onLoad!==undefined)onLoad(texture)},onProgress,onError);return texture},setCrossOrigin:function(value){this.crossOrigin=value},setPath:function(value){this.path=value}};
THREE.CubeTextureLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager};
THREE.CubeTextureLoader.prototype={constructor:THREE.CubeTextureLoader,load:function(urls,onLoad,onProgress,onError){var texture=new THREE.CubeTexture;var loader=new THREE.ImageLoader(this.manager);loader.setCrossOrigin(this.crossOrigin);loader.setPath(this.path);var loaded=0;function loadTexture(i){loader.load(urls[i],function(image){texture.images[i]=image;loaded++;if(loaded===6){texture.needsUpdate=true;if(onLoad)onLoad(texture)}},undefined,onError)}for(var i=0;i<urls.length;++i)loadTexture(i);
return texture},setCrossOrigin:function(value){this.crossOrigin=value},setPath:function(value){this.path=value}};THREE.DataTextureLoader=THREE.BinaryTextureLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager;this._parser=null};
THREE.BinaryTextureLoader.prototype={constructor:THREE.BinaryTextureLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var texture=new THREE.DataTexture;var loader=new THREE.XHRLoader(this.manager);loader.setResponseType("arraybuffer");loader.load(url,function(buffer){var texData=scope._parser(buffer);if(!texData)return;if(undefined!==texData.image)texture.image=texData.image;else if(undefined!==texData.data){texture.image.width=texData.width;texture.image.height=texData.height;texture.image.data=
texData.data}texture.wrapS=undefined!==texData.wrapS?texData.wrapS:THREE.ClampToEdgeWrapping;texture.wrapT=undefined!==texData.wrapT?texData.wrapT:THREE.ClampToEdgeWrapping;texture.magFilter=undefined!==texData.magFilter?texData.magFilter:THREE.LinearFilter;texture.minFilter=undefined!==texData.minFilter?texData.minFilter:THREE.LinearMipMapLinearFilter;texture.anisotropy=undefined!==texData.anisotropy?texData.anisotropy:1;if(undefined!==texData.format)texture.format=texData.format;if(undefined!==
texData.type)texture.type=texData.type;if(undefined!==texData.mipmaps)texture.mipmaps=texData.mipmaps;if(1===texData.mipmapCount)texture.minFilter=THREE.LinearFilter;texture.needsUpdate=true;if(onLoad)onLoad(texture,texData)},onProgress,onError);return texture}};THREE.CompressedTextureLoader=function(manager){this.manager=manager!==undefined?manager:THREE.DefaultLoadingManager;this._parser=null};
THREE.CompressedTextureLoader.prototype={constructor:THREE.CompressedTextureLoader,load:function(url,onLoad,onProgress,onError){var scope=this;var images=[];var texture=new THREE.CompressedTexture;texture.image=images;var loader=new THREE.XHRLoader(this.manager);loader.setPath(this.path);loader.setResponseType("arraybuffer");function loadTexture(i){loader.load(url[i],function(buffer){var texDatas=scope._parser(buffer,true);images[i]={width:texDatas.width,height:texDatas.height,format:texDatas.format,
mipmaps:texDatas.mipmaps};loaded+=1;if(loaded===6){if(texDatas.mipmapCount===1)texture.minFilter=THREE.LinearFilter;texture.format=texDatas.format;texture.needsUpdate=true;if(onLoad)onLoad(texture)}},onProgress,onError)}if(Array.isArray(url)){var loaded=0;for(var i=0,il=url.length;i<il;++i)loadTexture(i)}else loader.load(url,function(buffer){var texDatas=scope._parser(buffer,true);if(texDatas.isCubemap){var faces=texDatas.mipmaps.length/texDatas.mipmapCount;for(var f=0;f<faces;f++){images[f]={mipmaps:[]};
for(var i=0;i<texDatas.mipmapCount;i++){images[f].mipmaps.push(texDatas.mipmaps[f*texDatas.mipmapCount+i]);images[f].format=texDatas.format;images[f].width=texDatas.width;images[f].height=texDatas.height}}}else{texture.image.width=texDatas.width;texture.image.height=texDatas.height;texture.mipmaps=texDatas.mipmaps}if(texDatas.mipmapCount===1)texture.minFilter=THREE.LinearFilter;texture.format=texDatas.format;texture.needsUpdate=true;if(onLoad)onLoad(texture)},onProgress,onError);return texture},setPath:function(value){this.path=
value}};
THREE.Material=function(){Object.defineProperty(this,"id",{value:THREE.MaterialIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.type="Material";this.fog=true;this.lights=true;this.blending=THREE.NormalBlending;this.side=THREE.FrontSide;this.shading=THREE.SmoothShading;this.vertexColors=THREE.NoColors;this.opacity=1;this.transparent=false;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.blendSrcAlpha=null;this.blendDstAlpha=
null;this.blendEquationAlpha=null;this.depthFunc=THREE.LessEqualDepth;this.depthTest=true;this.depthWrite=true;this.clippingPlanes=null;this.clipShadows=false;this.colorWrite=true;this.precision=null;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.alphaTest=0;this.premultipliedAlpha=false;this.overdraw=0;this.visible=true;this._needsUpdate=true};
THREE.Material.prototype={constructor:THREE.Material,get needsUpdate(){return this._needsUpdate},set needsUpdate(value){if(value===true)this.update();this._needsUpdate=value},setValues:function(values){if(values===undefined)return;for(var key in values){var newValue=values[key];if(newValue===undefined){console.warn("THREE.Material: '"+key+"' parameter is undefined.");continue}var currentValue=this[key];if(currentValue===undefined){console.warn("THREE."+this.type+": '"+key+"' is not a property of this material.");
continue}if(currentValue instanceof THREE.Color)currentValue.set(newValue);else if(currentValue instanceof THREE.Vector3&&newValue instanceof THREE.Vector3)currentValue.copy(newValue);else if(key==="overdraw")this[key]=Number(newValue);else this[key]=newValue}},toJSON:function(meta){var isRoot=meta===undefined;if(isRoot)meta={textures:{},images:{}};var data={metadata:{version:4.4,type:"Material",generator:"Material.toJSON"}};data.uuid=this.uuid;data.type=this.type;if(this.name!=="")data.name=this.name;
if(this.color instanceof THREE.Color)data.color=this.color.getHex();if(this.roughness!==.5)data.roughness=this.roughness;if(this.metalness!==.5)data.metalness=this.metalness;if(this.emissive instanceof THREE.Color)data.emissive=this.emissive.getHex();if(this.specular instanceof THREE.Color)data.specular=this.specular.getHex();if(this.shininess!==undefined)data.shininess=this.shininess;if(this.map instanceof THREE.Texture)data.map=this.map.toJSON(meta).uuid;if(this.alphaMap instanceof THREE.Texture)data.alphaMap=
this.alphaMap.toJSON(meta).uuid;if(this.lightMap instanceof THREE.Texture)data.lightMap=this.lightMap.toJSON(meta).uuid;if(this.bumpMap instanceof THREE.Texture){data.bumpMap=this.bumpMap.toJSON(meta).uuid;data.bumpScale=this.bumpScale}if(this.normalMap instanceof THREE.Texture){data.normalMap=this.normalMap.toJSON(meta).uuid;data.normalScale=this.normalScale.toArray()}if(this.displacementMap instanceof THREE.Texture){data.displacementMap=this.displacementMap.toJSON(meta).uuid;data.displacementScale=
this.displacementScale;data.displacementBias=this.displacementBias}if(this.roughnessMap instanceof THREE.Texture)data.roughnessMap=this.roughnessMap.toJSON(meta).uuid;if(this.metalnessMap instanceof THREE.Texture)data.metalnessMap=this.metalnessMap.toJSON(meta).uuid;if(this.emissiveMap instanceof THREE.Texture)data.emissiveMap=this.emissiveMap.toJSON(meta).uuid;if(this.specularMap instanceof THREE.Texture)data.specularMap=this.specularMap.toJSON(meta).uuid;if(this.envMap instanceof THREE.Texture){data.envMap=
this.envMap.toJSON(meta).uuid;data.reflectivity=this.reflectivity}if(this.size!==undefined)data.size=this.size;if(this.sizeAttenuation!==undefined)data.sizeAttenuation=this.sizeAttenuation;if(this.blending!==THREE.NormalBlending)data.blending=this.blending;if(this.shading!==THREE.SmoothShading)data.shading=this.shading;if(this.side!==THREE.FrontSide)data.side=this.side;if(this.vertexColors!==THREE.NoColors)data.vertexColors=this.vertexColors;if(this.opacity<1)data.opacity=this.opacity;if(this.transparent===
true)data.transparent=this.transparent;if(this.alphaTest>0)data.alphaTest=this.alphaTest;if(this.premultipliedAlpha===true)data.premultipliedAlpha=this.premultipliedAlpha;if(this.wireframe===true)data.wireframe=this.wireframe;if(this.wireframeLinewidth>1)data.wireframeLinewidth=this.wireframeLinewidth;function extractFromCache(cache){var values=[];for(var key in cache){var data=cache[key];delete data.metadata;values.push(data)}return values}if(isRoot){var textures=extractFromCache(meta.textures);
var images=extractFromCache(meta.images);if(textures.length>0)data.textures=textures;if(images.length>0)data.images=images}return data},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.name=source.name;this.fog=source.fog;this.lights=source.lights;this.blending=source.blending;this.side=source.side;this.vertexColors=source.vertexColors;this.opacity=source.opacity;this.transparent=source.transparent;this.blendSrc=source.blendSrc;this.blendDst=source.blendDst;this.blendEquation=
source.blendEquation;this.blendSrcAlpha=source.blendSrcAlpha;this.blendDstAlpha=source.blendDstAlpha;this.blendEquationAlpha=source.blendEquationAlpha;this.depthFunc=source.depthFunc;this.depthTest=source.depthTest;this.depthWrite=source.depthWrite;this.colorWrite=source.colorWrite;this.precision=source.precision;this.polygonOffset=source.polygonOffset;this.polygonOffsetFactor=source.polygonOffsetFactor;this.polygonOffsetUnits=source.polygonOffsetUnits;this.alphaTest=source.alphaTest;this.premultipliedAlpha=
source.premultipliedAlpha;this.overdraw=source.overdraw;this.visible=source.visible;this.clipShadows=source.clipShadows;var srcPlanes=source.clippingPlanes,dstPlanes=null;if(srcPlanes!==null){var n=srcPlanes.length;dstPlanes=new Array(n);for(var i=0;i!==n;++i)dstPlanes[i]=srcPlanes[i].clone()}this.clippingPlanes=dstPlanes;return this},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})}};Object.assign(THREE.Material.prototype,THREE.EventDispatcher.prototype);
THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(parameters){THREE.Material.call(this);this.type="LineBasicMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.lights=false;this.setValues(parameters)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.constructor=THREE.LineBasicMaterial;
THREE.LineBasicMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.linewidth=source.linewidth;this.linecap=source.linecap;this.linejoin=source.linejoin;return this};THREE.LineDashedMaterial=function(parameters){THREE.Material.call(this);this.type="LineDashedMaterial";this.color=new THREE.Color(16777215);this.linewidth=1;this.scale=1;this.dashSize=3;this.gapSize=1;this.lights=false;this.setValues(parameters)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.constructor=THREE.LineDashedMaterial;THREE.LineDashedMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.linewidth=source.linewidth;this.scale=source.scale;this.dashSize=source.dashSize;this.gapSize=source.gapSize;return this};
THREE.MeshBasicMaterial=function(parameters){THREE.Material.call(this);this.type="MeshBasicMaterial";this.color=new THREE.Color(16777215);this.map=null;this.aoMap=null;this.aoMapIntensity=1;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.lights=false;this.setValues(parameters)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.constructor=THREE.MeshBasicMaterial;
THREE.MeshBasicMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;
this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;return this};
THREE.MeshDepthMaterial=function(parameters){THREE.Material.call(this);this.type="MeshDepthMaterial";this.depthPacking=THREE.BasicDepthPacking;this.skinning=false;this.morphTargets=false;this.map=null;this.alphaMap=null;this.displacementMap=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.setValues(parameters)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshDepthMaterial.prototype.constructor=THREE.MeshDepthMaterial;
THREE.MeshDepthMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.depthPacking=source.depthPacking;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.map=source.map;this.alphaMap=source.alphaMap;this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;return this};
THREE.MeshLambertMaterial=function(parameters){THREE.Material.call(this);this.type="MeshLambertMaterial";this.color=new THREE.Color(16777215);this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=
1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(parameters)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.constructor=THREE.MeshLambertMaterial;
THREE.MeshLambertMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;
this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};
THREE.MeshNormalMaterial=function(parameters){THREE.Material.call(this,parameters);this.type="MeshNormalMaterial";this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.morphTargets=false;this.setValues(parameters)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.constructor=THREE.MeshNormalMaterial;
THREE.MeshNormalMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;return this};
THREE.MeshPhongMaterial=function(parameters){THREE.Material.call(this);this.type="MeshPhongMaterial";this.color=new THREE.Color(16777215);this.specular=new THREE.Color(1118481);this.shininess=30;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.displacementMap=null;this.displacementScale=
1;this.displacementBias=0;this.specularMap=null;this.alphaMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(parameters)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.constructor=THREE.MeshPhongMaterial;
THREE.MeshPhongMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.specular.copy(source.specular);this.shininess=source.shininess;this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;this.bumpMap=source.bumpMap;
this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.specularMap=source.specularMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.combine=source.combine;this.reflectivity=source.reflectivity;this.refractionRatio=source.refractionRatio;this.wireframe=source.wireframe;this.wireframeLinewidth=
source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};
THREE.MeshStandardMaterial=function(parameters){THREE.Material.call(this);this.defines={"STANDARD":""};this.type="MeshStandardMaterial";this.color=new THREE.Color(16777215);this.roughness=.5;this.metalness=.5;this.map=null;this.lightMap=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.emissive=new THREE.Color(0);this.emissiveIntensity=1;this.emissiveMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.displacementMap=
null;this.displacementScale=1;this.displacementBias=0;this.roughnessMap=null;this.metalnessMap=null;this.alphaMap=null;this.envMap=null;this.envMapIntensity=1;this.refractionRatio=.98;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(parameters)};THREE.MeshStandardMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshStandardMaterial.prototype.constructor=THREE.MeshStandardMaterial;
THREE.MeshStandardMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.defines={"STANDARD":""};this.color.copy(source.color);this.roughness=source.roughness;this.metalness=source.metalness;this.map=source.map;this.lightMap=source.lightMap;this.lightMapIntensity=source.lightMapIntensity;this.aoMap=source.aoMap;this.aoMapIntensity=source.aoMapIntensity;this.emissive.copy(source.emissive);this.emissiveMap=source.emissiveMap;this.emissiveIntensity=source.emissiveIntensity;
this.bumpMap=source.bumpMap;this.bumpScale=source.bumpScale;this.normalMap=source.normalMap;this.normalScale.copy(source.normalScale);this.displacementMap=source.displacementMap;this.displacementScale=source.displacementScale;this.displacementBias=source.displacementBias;this.roughnessMap=source.roughnessMap;this.metalnessMap=source.metalnessMap;this.alphaMap=source.alphaMap;this.envMap=source.envMap;this.envMapIntensity=source.envMapIntensity;this.refractionRatio=source.refractionRatio;this.wireframe=
source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.wireframeLinecap=source.wireframeLinecap;this.wireframeLinejoin=source.wireframeLinejoin;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;return this};THREE.MeshPhysicalMaterial=function(parameters){THREE.MeshStandardMaterial.call(this);this.defines={"PHYSICAL":""};this.type="MeshPhysicalMaterial";this.reflectivity=.5;this.setValues(parameters)};
THREE.MeshPhysicalMaterial.prototype=Object.create(THREE.MeshStandardMaterial.prototype);THREE.MeshPhysicalMaterial.prototype.constructor=THREE.MeshPhysicalMaterial;THREE.MeshPhysicalMaterial.prototype.copy=function(source){THREE.MeshStandardMaterial.prototype.copy.call(this,source);this.defines={"PHYSICAL":""};this.reflectivity=source.reflectivity;return this};
THREE.MultiMaterial=function(materials){this.uuid=THREE.Math.generateUUID();this.type="MultiMaterial";this.materials=materials instanceof Array?materials:[];this.visible=true};
THREE.MultiMaterial.prototype={constructor:THREE.MultiMaterial,toJSON:function(meta){var output={metadata:{version:4.2,type:"material",generator:"MaterialExporter"},uuid:this.uuid,type:this.type,materials:[]};var materials=this.materials;for(var i=0,l=materials.length;i<l;i++){var material=materials[i].toJSON(meta);delete material.metadata;output.materials.push(material)}output.visible=this.visible;return output},clone:function(){var material=new this.constructor;for(var i=0;i<this.materials.length;i++)material.materials.push(this.materials[i].clone());
material.visible=this.visible;return material}};THREE.PointsMaterial=function(parameters){THREE.Material.call(this);this.type="PointsMaterial";this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.lights=false;this.setValues(parameters)};THREE.PointsMaterial.prototype=Object.create(THREE.Material.prototype);THREE.PointsMaterial.prototype.constructor=THREE.PointsMaterial;
THREE.PointsMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.size=source.size;this.sizeAttenuation=source.sizeAttenuation;return this};
THREE.ShaderMaterial=function(parameters){THREE.Material.call(this);this.type="ShaderMaterial";this.defines={};this.uniforms={};this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.clipping=false;this.skinning=false;this.morphTargets=false;this.morphNormals=
false;this.extensions={derivatives:false,fragDepth:false,drawBuffers:false,shaderTextureLOD:false};this.defaultAttributeValues={"color":[1,1,1],"uv":[0,0],"uv2":[0,0]};this.index0AttributeName=undefined;if(parameters!==undefined){if(parameters.attributes!==undefined)console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.");this.setValues(parameters)}};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.constructor=THREE.ShaderMaterial;
THREE.ShaderMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.fragmentShader=source.fragmentShader;this.vertexShader=source.vertexShader;this.uniforms=THREE.UniformsUtils.clone(source.uniforms);this.defines=source.defines;this.wireframe=source.wireframe;this.wireframeLinewidth=source.wireframeLinewidth;this.lights=source.lights;this.clipping=source.clipping;this.skinning=source.skinning;this.morphTargets=source.morphTargets;this.morphNormals=source.morphNormals;
this.extensions=source.extensions;return this};THREE.ShaderMaterial.prototype.toJSON=function(meta){var data=THREE.Material.prototype.toJSON.call(this,meta);data.uniforms=this.uniforms;data.vertexShader=this.vertexShader;data.fragmentShader=this.fragmentShader;return data};THREE.RawShaderMaterial=function(parameters){THREE.ShaderMaterial.call(this,parameters);this.type="RawShaderMaterial"};THREE.RawShaderMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);
THREE.RawShaderMaterial.prototype.constructor=THREE.RawShaderMaterial;THREE.SpriteMaterial=function(parameters){THREE.Material.call(this);this.type="SpriteMaterial";this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=false;this.lights=false;this.setValues(parameters)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.constructor=THREE.SpriteMaterial;
THREE.SpriteMaterial.prototype.copy=function(source){THREE.Material.prototype.copy.call(this,source);this.color.copy(source.color);this.map=source.map;this.rotation=source.rotation;return this};
THREE.ShadowMaterial=function(){THREE.ShaderMaterial.call(this,{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["lights"],{opacity:{value:1}}]),vertexShader:THREE.ShaderChunk["shadow_vert"],fragmentShader:THREE.ShaderChunk["shadow_frag"]});this.lights=true;this.transparent=true;Object.defineProperties(this,{opacity:{enumerable:true,get:function(){return this.uniforms.opacity.value},set:function(value){this.uniforms.opacity.value=value}}})};THREE.ShadowMaterial.prototype=Object.create(THREE.ShaderMaterial.prototype);
THREE.ShadowMaterial.prototype.constructor=THREE.ShadowMaterial;
THREE.Texture=function(image,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding){Object.defineProperty(this,"id",{value:THREE.TextureIdCount++});this.uuid=THREE.Math.generateUUID();this.name="";this.sourceFile="";this.image=image!==undefined?image:THREE.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=mapping!==undefined?mapping:THREE.Texture.DEFAULT_MAPPING;this.wrapS=wrapS!==undefined?wrapS:THREE.ClampToEdgeWrapping;this.wrapT=wrapT!==undefined?wrapT:THREE.ClampToEdgeWrapping;
this.magFilter=magFilter!==undefined?magFilter:THREE.LinearFilter;this.minFilter=minFilter!==undefined?minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=anisotropy!==undefined?anisotropy:1;this.format=format!==undefined?format:THREE.RGBAFormat;this.type=type!==undefined?type:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.encoding=encoding!==undefined?
encoding:THREE.LinearEncoding;this.version=0;this.onUpdate=null};THREE.Texture.DEFAULT_IMAGE=undefined;THREE.Texture.DEFAULT_MAPPING=THREE.UVMapping;
THREE.Texture.prototype={constructor:THREE.Texture,set needsUpdate(value){if(value===true)this.version++},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.image=source.image;this.mipmaps=source.mipmaps.slice(0);this.mapping=source.mapping;this.wrapS=source.wrapS;this.wrapT=source.wrapT;this.magFilter=source.magFilter;this.minFilter=source.minFilter;this.anisotropy=source.anisotropy;this.format=source.format;this.type=source.type;this.offset.copy(source.offset);
this.repeat.copy(source.repeat);this.generateMipmaps=source.generateMipmaps;this.premultiplyAlpha=source.premultiplyAlpha;this.flipY=source.flipY;this.unpackAlignment=source.unpackAlignment;this.encoding=source.encoding;return this},toJSON:function(meta){if(meta.textures[this.uuid]!==undefined)return meta.textures[this.uuid];function getDataURL(image){var canvas;if(image.toDataURL!==undefined)canvas=image;else{canvas=document.createElement("canvas");canvas.width=image.width;canvas.height=image.height;
canvas.getContext("2d").drawImage(image,0,0,image.width,image.height)}if(canvas.width>2048||canvas.height>2048)return canvas.toDataURL("image/jpeg",.6);else return canvas.toDataURL("image/png")}var output={metadata:{version:4.4,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy};
if(this.image!==undefined){var image=this.image;if(image.uuid===undefined)image.uuid=THREE.Math.generateUUID();if(meta.images[image.uuid]===undefined)meta.images[image.uuid]={uuid:image.uuid,url:getDataURL(image)};output.image=image.uuid}meta.textures[this.uuid]=output;return output},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(uv){if(this.mapping!==THREE.UVMapping)return;uv.multiply(this.repeat);uv.add(this.offset);if(uv.x<0||uv.x>1)switch(this.wrapS){case THREE.RepeatWrapping:uv.x=
uv.x-Math.floor(uv.x);break;case THREE.ClampToEdgeWrapping:uv.x=uv.x<0?0:1;break;case THREE.MirroredRepeatWrapping:if(Math.abs(Math.floor(uv.x)%2)===1)uv.x=Math.ceil(uv.x)-uv.x;else uv.x=uv.x-Math.floor(uv.x);break}if(uv.y<0||uv.y>1)switch(this.wrapT){case THREE.RepeatWrapping:uv.y=uv.y-Math.floor(uv.y);break;case THREE.ClampToEdgeWrapping:uv.y=uv.y<0?0:1;break;case THREE.MirroredRepeatWrapping:if(Math.abs(Math.floor(uv.y)%2)===1)uv.y=Math.ceil(uv.y)-uv.y;else uv.y=uv.y-Math.floor(uv.y);break}if(this.flipY)uv.y=
1-uv.y}};Object.assign(THREE.Texture.prototype,THREE.EventDispatcher.prototype);THREE.TextureIdCount=0;
THREE.DepthTexture=function(width,height,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,THREE.DepthFormat,type,anisotropy);this.image={width:width,height:height};this.type=type!==undefined?type:THREE.UnsignedShortType;this.magFilter=magFilter!==undefined?magFilter:THREE.NearestFilter;this.minFilter=minFilter!==undefined?minFilter:THREE.NearestFilter;this.flipY=false;this.generateMipmaps=false};
THREE.DepthTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DepthTexture.prototype.constructor=THREE.DepthTexture;THREE.CanvasTexture=function(canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){THREE.Texture.call(this,canvas,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.needsUpdate=true};THREE.CanvasTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CanvasTexture.prototype.constructor=THREE.CanvasTexture;
THREE.CubeTexture=function(images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding){images=images!==undefined?images:[];mapping=mapping!==undefined?mapping:THREE.CubeReflectionMapping;THREE.Texture.call(this,images,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding);this.flipY=false};THREE.CubeTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CubeTexture.prototype.constructor=THREE.CubeTexture;
Object.defineProperty(THREE.CubeTexture.prototype,"images",{get:function(){return this.image},set:function(value){this.image=value}});THREE.CompressedTexture=function(mipmaps,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy,encoding){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding);this.image={width:width,height:height};this.mipmaps=mipmaps;this.flipY=false;this.generateMipmaps=false};
THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.constructor=THREE.CompressedTexture;
THREE.DataTexture=function(data,width,height,format,type,mapping,wrapS,wrapT,magFilter,minFilter,anisotropy,encoding){THREE.Texture.call(this,null,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy,encoding);this.image={data:data,width:width,height:height};this.magFilter=magFilter!==undefined?magFilter:THREE.NearestFilter;this.minFilter=minFilter!==undefined?minFilter:THREE.NearestFilter;this.flipY=false;this.generateMipmaps=false};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.DataTexture.prototype.constructor=THREE.DataTexture;THREE.VideoTexture=function(video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy){THREE.Texture.call(this,video,mapping,wrapS,wrapT,magFilter,minFilter,format,type,anisotropy);this.generateMipmaps=false;var scope=this;function update(){requestAnimationFrame(update);if(video.readyState>=video.HAVE_CURRENT_DATA)scope.needsUpdate=true}update()};THREE.VideoTexture.prototype=Object.create(THREE.Texture.prototype);
THREE.VideoTexture.prototype.constructor=THREE.VideoTexture;THREE.Group=function(){THREE.Object3D.call(this);this.type="Group"};THREE.Group.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Group});THREE.Points=function(geometry,material){THREE.Object3D.call(this);this.type="Points";this.geometry=geometry!==undefined?geometry:new THREE.BufferGeometry;this.material=material!==undefined?material:new THREE.PointsMaterial({color:Math.random()*16777215})};
THREE.Points.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Points,raycast:function(){var inverseMatrix=new THREE.Matrix4;var ray=new THREE.Ray;var sphere=new THREE.Sphere;return function raycast(raycaster,intersects){var object=this;var geometry=this.geometry;var matrixWorld=this.matrixWorld;var threshold=raycaster.params.Points.threshold;if(geometry.boundingSphere===null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere);sphere.applyMatrix4(matrixWorld);
if(raycaster.ray.intersectsSphere(sphere)===false)return;inverseMatrix.getInverse(matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);var localThreshold=threshold/((this.scale.x+this.scale.y+this.scale.z)/3);var localThresholdSq=localThreshold*localThreshold;var position=new THREE.Vector3;function testPoint(point,index){var rayPointDistanceSq=ray.distanceSqToPoint(point);if(rayPointDistanceSq<localThresholdSq){var intersectPoint=ray.closestPointToPoint(point);intersectPoint.applyMatrix4(matrixWorld);
var distance=raycaster.ray.origin.distanceTo(intersectPoint);if(distance<raycaster.near||distance>raycaster.far)return;intersects.push({distance:distance,distanceToRay:Math.sqrt(rayPointDistanceSq),point:intersectPoint.clone(),index:index,face:null,object:object})}}if(geometry instanceof THREE.BufferGeometry){var index=geometry.index;var attributes=geometry.attributes;var positions=attributes.position.array;if(index!==null){var indices=index.array;for(var i=0,il=indices.length;i<il;i++){var a=indices[i];
position.fromArray(positions,a*3);testPoint(position,a)}}else for(var i=0,l=positions.length/3;i<l;i++){position.fromArray(positions,i*3);testPoint(position,i)}}else{var vertices=geometry.vertices;for(var i=0,l=vertices.length;i<l;i++)testPoint(vertices[i],i)}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});
THREE.Line=function(geometry,material,mode){if(mode===1){console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead.");return new THREE.LineSegments(geometry,material)}THREE.Object3D.call(this);this.type="Line";this.geometry=geometry!==undefined?geometry:new THREE.BufferGeometry;this.material=material!==undefined?material:new THREE.LineBasicMaterial({color:Math.random()*16777215})};
THREE.Line.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Line,raycast:function(){var inverseMatrix=new THREE.Matrix4;var ray=new THREE.Ray;var sphere=new THREE.Sphere;return function raycast(raycaster,intersects){var precision=raycaster.linePrecision;var precisionSq=precision*precision;var geometry=this.geometry;var matrixWorld=this.matrixWorld;if(geometry.boundingSphere===null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere);sphere.applyMatrix4(matrixWorld);
if(raycaster.ray.intersectsSphere(sphere)===false)return;inverseMatrix.getInverse(matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);var vStart=new THREE.Vector3;var vEnd=new THREE.Vector3;var interSegment=new THREE.Vector3;var interRay=new THREE.Vector3;var step=this instanceof THREE.LineSegments?2:1;if(geometry instanceof THREE.BufferGeometry){var index=geometry.index;var attributes=geometry.attributes;var positions=attributes.position.array;if(index!==null){var indices=index.array;
for(var i=0,l=indices.length-1;i<l;i+=step){var a=indices[i];var b=indices[i+1];vStart.fromArray(positions,a*3);vEnd.fromArray(positions,b*3);var distSq=ray.distanceSqToSegment(vStart,vEnd,interRay,interSegment);if(distSq>precisionSq)continue;interRay.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(interRay);if(distance<raycaster.near||distance>raycaster.far)continue;intersects.push({distance:distance,point:interSegment.clone().applyMatrix4(this.matrixWorld),index:i,face:null,
faceIndex:null,object:this})}}else for(var i=0,l=positions.length/3-1;i<l;i+=step){vStart.fromArray(positions,3*i);vEnd.fromArray(positions,3*i+3);var distSq=ray.distanceSqToSegment(vStart,vEnd,interRay,interSegment);if(distSq>precisionSq)continue;interRay.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(interRay);if(distance<raycaster.near||distance>raycaster.far)continue;intersects.push({distance:distance,point:interSegment.clone().applyMatrix4(this.matrixWorld),index:i,
face:null,faceIndex:null,object:this})}}else if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;var nbVertices=vertices.length;for(var i=0;i<nbVertices-1;i+=step){var distSq=ray.distanceSqToSegment(vertices[i],vertices[i+1],interRay,interSegment);if(distSq>precisionSq)continue;interRay.applyMatrix4(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(interRay);if(distance<raycaster.near||distance>raycaster.far)continue;intersects.push({distance:distance,point:interSegment.clone().applyMatrix4(this.matrixWorld),
index:i,face:null,faceIndex:null,object:this})}}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});THREE.LineSegments=function(geometry,material){THREE.Line.call(this,geometry,material);this.type="LineSegments"};THREE.LineSegments.prototype=Object.assign(Object.create(THREE.Line.prototype),{constructor:THREE.LineSegments});
THREE.Mesh=function(geometry,material){THREE.Object3D.call(this);this.type="Mesh";this.geometry=geometry!==undefined?geometry:new THREE.BufferGeometry;this.material=material!==undefined?material:new THREE.MeshBasicMaterial({color:Math.random()*16777215});this.drawMode=THREE.TrianglesDrawMode;this.updateMorphTargets()};
THREE.Mesh.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Mesh,setDrawMode:function(value){this.drawMode=value},updateMorphTargets:function(){if(this.geometry.morphTargets!==undefined&&this.geometry.morphTargets.length>0){this.morphTargetBase=-1;this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var m=0,ml=this.geometry.morphTargets.length;m<ml;m++){this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[m].name]=m}}},
getMorphTargetIndexByName:function(name){if(this.morphTargetDictionary[name]!==undefined)return this.morphTargetDictionary[name];console.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+name+" does not exist. Returning 0.");return 0},raycast:function(){var inverseMatrix=new THREE.Matrix4;var ray=new THREE.Ray;var sphere=new THREE.Sphere;var vA=new THREE.Vector3;var vB=new THREE.Vector3;var vC=new THREE.Vector3;var tempA=new THREE.Vector3;var tempB=new THREE.Vector3;var tempC=new THREE.Vector3;
var uvA=new THREE.Vector2;var uvB=new THREE.Vector2;var uvC=new THREE.Vector2;var barycoord=new THREE.Vector3;var intersectionPoint=new THREE.Vector3;var intersectionPointWorld=new THREE.Vector3;function uvIntersection(point,p1,p2,p3,uv1,uv2,uv3){THREE.Triangle.barycoordFromPoint(point,p1,p2,p3,barycoord);uv1.multiplyScalar(barycoord.x);uv2.multiplyScalar(barycoord.y);uv3.multiplyScalar(barycoord.z);uv1.add(uv2).add(uv3);return uv1.clone()}function checkIntersection(object,raycaster,ray,pA,pB,pC,
point){var intersect;var material=object.material;if(material.side===THREE.BackSide)intersect=ray.intersectTriangle(pC,pB,pA,true,point);else intersect=ray.intersectTriangle(pA,pB,pC,material.side!==THREE.DoubleSide,point);if(intersect===null)return null;intersectionPointWorld.copy(point);intersectionPointWorld.applyMatrix4(object.matrixWorld);var distance=raycaster.ray.origin.distanceTo(intersectionPointWorld);if(distance<raycaster.near||distance>raycaster.far)return null;return{distance:distance,
point:intersectionPointWorld.clone(),object:object}}function checkBufferGeometryIntersection(object,raycaster,ray,positions,uvs,a,b,c){vA.fromArray(positions,a*3);vB.fromArray(positions,b*3);vC.fromArray(positions,c*3);var intersection=checkIntersection(object,raycaster,ray,vA,vB,vC,intersectionPoint);if(intersection){if(uvs){uvA.fromArray(uvs,a*2);uvB.fromArray(uvs,b*2);uvC.fromArray(uvs,c*2);intersection.uv=uvIntersection(intersectionPoint,vA,vB,vC,uvA,uvB,uvC)}intersection.face=new THREE.Face3(a,
b,c,THREE.Triangle.normal(vA,vB,vC));intersection.faceIndex=a}return intersection}return function raycast(raycaster,intersects){var geometry=this.geometry;var material=this.material;var matrixWorld=this.matrixWorld;if(material===undefined)return;if(geometry.boundingSphere===null)geometry.computeBoundingSphere();sphere.copy(geometry.boundingSphere);sphere.applyMatrix4(matrixWorld);if(raycaster.ray.intersectsSphere(sphere)===false)return;inverseMatrix.getInverse(matrixWorld);ray.copy(raycaster.ray).applyMatrix4(inverseMatrix);
if(geometry.boundingBox!==null)if(ray.intersectsBox(geometry.boundingBox)===false)return;var uvs,intersection;if(geometry instanceof THREE.BufferGeometry){var a,b,c;var index=geometry.index;var attributes=geometry.attributes;var positions=attributes.position.array;if(attributes.uv!==undefined)uvs=attributes.uv.array;if(index!==null){var indices=index.array;for(var i=0,l=indices.length;i<l;i+=3){a=indices[i];b=indices[i+1];c=indices[i+2];intersection=checkBufferGeometryIntersection(this,raycaster,
ray,positions,uvs,a,b,c);if(intersection){intersection.faceIndex=Math.floor(i/3);intersects.push(intersection)}}}else for(var i=0,l=positions.length;i<l;i+=9){a=i/3;b=a+1;c=a+2;intersection=checkBufferGeometryIntersection(this,raycaster,ray,positions,uvs,a,b,c);if(intersection){intersection.index=a;intersects.push(intersection)}}}else if(geometry instanceof THREE.Geometry){var fvA,fvB,fvC;var isFaceMaterial=material instanceof THREE.MultiMaterial;var materials=isFaceMaterial===true?material.materials:
null;var vertices=geometry.vertices;var faces=geometry.faces;var faceVertexUvs=geometry.faceVertexUvs[0];if(faceVertexUvs.length>0)uvs=faceVertexUvs;for(var f=0,fl=faces.length;f<fl;f++){var face=faces[f];var faceMaterial=isFaceMaterial===true?materials[face.materialIndex]:material;if(faceMaterial===undefined)continue;fvA=vertices[face.a];fvB=vertices[face.b];fvC=vertices[face.c];if(faceMaterial.morphTargets===true){var morphTargets=geometry.morphTargets;var morphInfluences=this.morphTargetInfluences;
vA.set(0,0,0);vB.set(0,0,0);vC.set(0,0,0);for(var t=0,tl=morphTargets.length;t<tl;t++){var influence=morphInfluences[t];if(influence===0)continue;var targets=morphTargets[t].vertices;vA.addScaledVector(tempA.subVectors(targets[face.a],fvA),influence);vB.addScaledVector(tempB.subVectors(targets[face.b],fvB),influence);vC.addScaledVector(tempC.subVectors(targets[face.c],fvC),influence)}vA.add(fvA);vB.add(fvB);vC.add(fvC);fvA=vA;fvB=vB;fvC=vC}intersection=checkIntersection(this,raycaster,ray,fvA,fvB,
fvC,intersectionPoint);if(intersection){if(uvs){var uvs_f=uvs[f];uvA.copy(uvs_f[0]);uvB.copy(uvs_f[1]);uvC.copy(uvs_f[2]);intersection.uv=uvIntersection(intersectionPoint,fvA,fvB,fvC,uvA,uvB,uvC)}intersection.face=face;intersection.faceIndex=f;intersects.push(intersection)}}}}}(),clone:function(){return(new this.constructor(this.geometry,this.material)).copy(this)}});THREE.Bone=function(skin){THREE.Object3D.call(this);this.type="Bone";this.skin=skin};
THREE.Bone.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Bone,copy:function(source){THREE.Object3D.prototype.copy.call(this,source);this.skin=source.skin;return this}});
THREE.Skeleton=function(bones,boneInverses,useVertexTexture){this.useVertexTexture=useVertexTexture!==undefined?useVertexTexture:true;this.identityMatrix=new THREE.Matrix4;bones=bones||[];this.bones=bones.slice(0);if(this.useVertexTexture){var size=Math.sqrt(this.bones.length*4);size=THREE.Math.nextPowerOfTwo(Math.ceil(size));size=Math.max(size,4);this.boneTextureWidth=size;this.boneTextureHeight=size;this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4);this.boneTexture=
new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType)}else this.boneMatrices=new Float32Array(16*this.bones.length);if(boneInverses===undefined)this.calculateInverses();else if(this.bones.length===boneInverses.length)this.boneInverses=boneInverses.slice(0);else{console.warn("THREE.Skeleton bonInverses is the wrong length.");this.boneInverses=[];for(var b=0,bl=this.bones.length;b<bl;b++)this.boneInverses.push(new THREE.Matrix4)}};
Object.assign(THREE.Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var b=0,bl=this.bones.length;b<bl;b++){var inverse=new THREE.Matrix4;if(this.bones[b])inverse.getInverse(this.bones[b].matrixWorld);this.boneInverses.push(inverse)}},pose:function(){var bone;for(var b=0,bl=this.bones.length;b<bl;b++){bone=this.bones[b];if(bone)bone.matrixWorld.getInverse(this.boneInverses[b])}for(var b=0,bl=this.bones.length;b<bl;b++){bone=this.bones[b];if(bone){if(bone.parent){bone.matrix.getInverse(bone.parent.matrixWorld);
bone.matrix.multiply(bone.matrixWorld)}else bone.matrix.copy(bone.matrixWorld);bone.matrix.decompose(bone.position,bone.quaternion,bone.scale)}}},update:function(){var offsetMatrix=new THREE.Matrix4;return function update(){for(var b=0,bl=this.bones.length;b<bl;b++){var matrix=this.bones[b]?this.bones[b].matrixWorld:this.identityMatrix;offsetMatrix.multiplyMatrices(matrix,this.boneInverses[b]);offsetMatrix.toArray(this.boneMatrices,b*16)}if(this.useVertexTexture)this.boneTexture.needsUpdate=true}}(),
clone:function(){return new THREE.Skeleton(this.bones,this.boneInverses,this.useVertexTexture)}});
THREE.SkinnedMesh=function(geometry,material,useVertexTexture){THREE.Mesh.call(this,geometry,material);this.type="SkinnedMesh";this.bindMode="attached";this.bindMatrix=new THREE.Matrix4;this.bindMatrixInverse=new THREE.Matrix4;var bones=[];if(this.geometry&&this.geometry.bones!==undefined){var bone,gbone;for(var b=0,bl=this.geometry.bones.length;b<bl;++b){gbone=this.geometry.bones[b];bone=new THREE.Bone(this);bones.push(bone);bone.name=gbone.name;bone.position.fromArray(gbone.pos);bone.quaternion.fromArray(gbone.rotq);
if(gbone.scl!==undefined)bone.scale.fromArray(gbone.scl)}for(var b=0,bl=this.geometry.bones.length;b<bl;++b){gbone=this.geometry.bones[b];if(gbone.parent!==-1&&gbone.parent!==null&&bones[gbone.parent]!==undefined)bones[gbone.parent].add(bones[b]);else this.add(bones[b])}}this.normalizeSkinWeights();this.updateMatrixWorld(true);this.bind(new THREE.Skeleton(bones,undefined,useVertexTexture),this.matrixWorld)};
THREE.SkinnedMesh.prototype=Object.assign(Object.create(THREE.Mesh.prototype),{constructor:THREE.SkinnedMesh,bind:function(skeleton,bindMatrix){this.skeleton=skeleton;if(bindMatrix===undefined){this.updateMatrixWorld(true);this.skeleton.calculateInverses();bindMatrix=this.matrixWorld}this.bindMatrix.copy(bindMatrix);this.bindMatrixInverse.getInverse(bindMatrix)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){if(this.geometry instanceof THREE.Geometry)for(var i=0;i<this.geometry.skinWeights.length;i++){var sw=
this.geometry.skinWeights[i];var scale=1/sw.lengthManhattan();if(scale!==Infinity)sw.multiplyScalar(scale);else sw.set(1,0,0,0)}else if(this.geometry instanceof THREE.BufferGeometry){var vec=new THREE.Vector4;var skinWeight=this.geometry.attributes.skinWeight;for(var i=0;i<skinWeight.count;i++){vec.x=skinWeight.getX(i);vec.y=skinWeight.getY(i);vec.z=skinWeight.getZ(i);vec.w=skinWeight.getW(i);var scale=1/vec.lengthManhattan();if(scale!==Infinity)vec.multiplyScalar(scale);else vec.set(1,0,0,0);skinWeight.setXYZW(i,
vec.x,vec.y,vec.z,vec.w)}}},updateMatrixWorld:function(force){THREE.Mesh.prototype.updateMatrixWorld.call(this,true);if(this.bindMode==="attached")this.bindMatrixInverse.getInverse(this.matrixWorld);else if(this.bindMode==="detached")this.bindMatrixInverse.getInverse(this.bindMatrix);else console.warn("THREE.SkinnedMesh unrecognized bindMode: "+this.bindMode)},clone:function(){return(new this.constructor(this.geometry,this.material,this.useVertexTexture)).copy(this)}});
THREE.LOD=function(){THREE.Object3D.call(this);this.type="LOD";Object.defineProperties(this,{levels:{enumerable:true,value:[]}})};
THREE.LOD.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.LOD,copy:function(source){THREE.Object3D.prototype.copy.call(this,source,false);var levels=source.levels;for(var i=0,l=levels.length;i<l;i++){var level=levels[i];this.addLevel(level.object.clone(),level.distance)}return this},addLevel:function(object,distance){if(distance===undefined)distance=0;distance=Math.abs(distance);var levels=this.levels;for(var l=0;l<levels.length;l++)if(distance<levels[l].distance)break;
levels.splice(l,0,{distance:distance,object:object});this.add(object)},getObjectForDistance:function(distance){var levels=this.levels;for(var i=1,l=levels.length;i<l;i++)if(distance<levels[i].distance)break;return levels[i-1].object},raycast:function(){var matrixPosition=new THREE.Vector3;return function raycast(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distance=raycaster.ray.origin.distanceTo(matrixPosition);this.getObjectForDistance(distance).raycast(raycaster,
intersects)}}(),update:function(){var v1=new THREE.Vector3;var v2=new THREE.Vector3;return function update(camera){var levels=this.levels;if(levels.length>1){v1.setFromMatrixPosition(camera.matrixWorld);v2.setFromMatrixPosition(this.matrixWorld);var distance=v1.distanceTo(v2);levels[0].object.visible=true;for(var i=1,l=levels.length;i<l;i++)if(distance>=levels[i].distance){levels[i-1].object.visible=false;levels[i].object.visible=true}else break;for(;i<l;i++)levels[i].object.visible=false}}}(),toJSON:function(meta){var data=
THREE.Object3D.prototype.toJSON.call(this,meta);data.object.levels=[];var levels=this.levels;for(var i=0,l=levels.length;i<l;i++){var level=levels[i];data.object.levels.push({object:level.object.uuid,distance:level.distance})}return data}});THREE.Sprite=function(material){THREE.Object3D.call(this);this.type="Sprite";this.material=material!==undefined?material:new THREE.SpriteMaterial};
THREE.Sprite.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.Sprite,raycast:function(){var matrixPosition=new THREE.Vector3;return function raycast(raycaster,intersects){matrixPosition.setFromMatrixPosition(this.matrixWorld);var distanceSq=raycaster.ray.distanceSqToPoint(matrixPosition);var guessSizeSq=this.scale.x*this.scale.y/4;if(distanceSq>guessSizeSq)return;intersects.push({distance:Math.sqrt(distanceSq),point:this.position,face:null,object:this})}}(),clone:function(){return(new this.constructor(this.material)).copy(this)}});
THREE.LensFlare=function(texture,size,distance,blending,color){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=undefined;if(texture!==undefined)this.add(texture,size,distance,blending,color)};
THREE.LensFlare.prototype=Object.assign(Object.create(THREE.Object3D.prototype),{constructor:THREE.LensFlare,copy:function(source){THREE.Object3D.prototype.copy.call(this,source);this.positionScreen.copy(source.positionScreen);this.customUpdateCallback=source.customUpdateCallback;for(var i=0,l=source.lensFlares.length;i<l;i++)this.lensFlares.push(source.lensFlares[i]);return this},add:function(texture,size,distance,blending,color,opacity){if(size===undefined)size=-1;if(distance===undefined)distance=
0;if(opacity===undefined)opacity=1;if(color===undefined)color=new THREE.Color(16777215);if(blending===undefined)blending=THREE.NormalBlending;distance=Math.min(distance,Math.max(0,distance));this.lensFlares.push({texture:texture,size:size,distance:distance,x:0,y:0,z:0,scale:1,rotation:0,opacity:opacity,color:color,blending:blending})},updateLensFlares:function(){var f,fl=this.lensFlares.length;var flare;var vecX=-this.positionScreen.x*2;var vecY=-this.positionScreen.y*2;for(f=0;f<fl;f++){flare=this.lensFlares[f];
flare.x=this.positionScreen.x+vecX*flare.distance;flare.y=this.positionScreen.y+vecY*flare.distance;flare.wantedRotation=flare.x*Math.PI*.25;flare.rotation+=(flare.wantedRotation-flare.rotation)*.25}}});THREE.Scene=function(){THREE.Object3D.call(this);this.type="Scene";this.fog=null;this.overrideMaterial=null;this.autoUpdate=true};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.constructor=THREE.Scene;
THREE.Scene.prototype.copy=function(source,recursive){THREE.Object3D.prototype.copy.call(this,source,recursive);if(source.fog!==null)this.fog=source.fog.clone();if(source.overrideMaterial!==null)this.overrideMaterial=source.overrideMaterial.clone();this.autoUpdate=source.autoUpdate;this.matrixAutoUpdate=source.matrixAutoUpdate;return this};THREE.Fog=function(color,near,far){this.name="";this.color=new THREE.Color(color);this.near=near!==undefined?near:1;this.far=far!==undefined?far:1E3};
THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(color,density){this.name="";this.color=new THREE.Color(color);this.density=density!==undefined?density:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.ShaderChunk={};THREE.ShaderChunk["alphamap_fragment"]="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n";
THREE.ShaderChunk["alphamap_pars_fragment"]="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n";THREE.ShaderChunk["alphatest_fragment"]="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n";THREE.ShaderChunk["aomap_fragment"]="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n";
THREE.ShaderChunk["aomap_pars_fragment"]="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif";THREE.ShaderChunk["begin_vertex"]="\nvec3 transformed = vec3( position );\n";THREE.ShaderChunk["beginnormal_vertex"]="\nvec3 objectNormal = vec3( normal );\n";THREE.ShaderChunk["bsdfs"]="bool testLightInRange( const in float lightDistance, const in float cutoffDistance ) {\n\treturn any( bvec2( cutoffDistance == 0.0, lightDistance < cutoffDistance ) );\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t\t}\n\t\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n";
THREE.ShaderChunk["bumpmap_pars_fragment"]="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n";
THREE.ShaderChunk["clipping_planes_fragment"]="#if NUM_CLIPPING_PLANES > 0\n\tfor ( int i = 0; i < NUM_CLIPPING_PLANES; ++ i ) {\n\t\tvec4 plane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n#endif\n";THREE.ShaderChunk["clipping_planes_pars_fragment"]="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n";
THREE.ShaderChunk["clipping_planes_pars_vertex"]="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n";THREE.ShaderChunk["clipping_planes_vertex"]="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n";THREE.ShaderChunk["color_fragment"]="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif";THREE.ShaderChunk["color_pars_fragment"]="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n";
THREE.ShaderChunk["color_pars_vertex"]="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif";THREE.ShaderChunk["color_vertex"]="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif";THREE.ShaderChunk["common"]="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\n";
THREE.ShaderChunk["cube_uv_reflection_fragment"]="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ?  0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n";
THREE.ShaderChunk["defaultnormal_vertex"]="#ifdef FLIP_SIDED\n\tobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;\n";THREE.ShaderChunk["displacementmap_vertex"]="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normal * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n";THREE.ShaderChunk["displacementmap_pars_vertex"]="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n";
THREE.ShaderChunk["emissivemap_fragment"]="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n";THREE.ShaderChunk["emissivemap_pars_fragment"]="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n";THREE.ShaderChunk["encodings_pars_fragment"]="\nvec4 LinearToLinear( in vec4 value ) {\n  return value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n  return vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n  return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n  return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n  return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n  float maxComponent = max( max( value.r, value.g ), value.b );\n  float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n  return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n  return vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n  float maxRGB = max( value.x, max( value.g, value.b ) );\n  float M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n  M            = ceil( M * 255.0 ) / 255.0;\n  return vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n    return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n    float maxRGB = max( value.x, max( value.g, value.b ) );\n    float D      = max( maxRange / maxRGB, 1.0 );\n    D            = min( floor( D ) / 255.0, 1.0 );\n    return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n  vec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n  Xp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n  vec4 vResult;\n  vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n  float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n  vResult.w = fract(Le);\n  vResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n  return vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n  float Le = value.z * 255.0 + value.w;\n  vec3 Xp_Y_XYZp;\n  Xp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n  Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n  Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n  vec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n  return vec4( max(vRGB, 0.0), 1.0 );\n}\n";
THREE.ShaderChunk["encodings_fragment"]="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n";THREE.ShaderChunk["envmap_fragment"]="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#else\n\t\tfloat flipNormal = 1.0;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n";
THREE.ShaderChunk["envmap_pars_fragment"]="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntenstiy;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n";
THREE.ShaderChunk["envmap_pars_vertex"]="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n";THREE.ShaderChunk["envmap_vertex"]="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n";
THREE.ShaderChunk["fog_fragment"]="#ifdef USE_FOG\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * depth * depth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n";
THREE.ShaderChunk["fog_pars_fragment"]="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif";THREE.ShaderChunk["lightmap_fragment"]="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n";THREE.ShaderChunk["lightmap_pars_fragment"]="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif";
THREE.ShaderChunk["lights_lambert_vertex"]="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n";
THREE.ShaderChunk["lights_pars"]="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tif ( testLightInRange( lightDistance, pointLight.distance ) ) {\n\t\t\tdirectLight.color = pointLight.color;\n\t\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( all( bvec2( angleCos > spotLight.coneCos, testLightInRange( lightDistance, spotLight.distance ) ) ) ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = flipNormal * vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar - 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tfloat flipNormal = ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#else\n\t\t\tfloat flipNormal = 1.0;\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = saturate( flipNormal * reflectVec.y * 0.5 + 0.5 );\n\t\t\tsampleUV.x = atan( flipNormal * reflectVec.z, flipNormal * reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = flipNormal * normalize((viewMatrix * vec4( reflectVec, 0.0 )).xyz + vec3(0.0,0.0,1.0));\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n";
THREE.ShaderChunk["lights_phong_fragment"]="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n";THREE.ShaderChunk["lights_phong_pars_fragment"]="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n";
THREE.ShaderChunk["lights_physical_fragment"]="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.16 * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#endif\n";THREE.ShaderChunk["lights_physical_pars_fragment"]="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t#endif\n};\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectSpecular += radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n";
THREE.ShaderChunk["lights_template"]="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t \tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\tRE_IndirectSpecular( radiance, geometry, material, reflectedLight );\n#endif\n";
THREE.ShaderChunk["logdepthbuf_fragment"]="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n#endif";THREE.ShaderChunk["logdepthbuf_pars_fragment"]="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n";THREE.ShaderChunk["logdepthbuf_pars_vertex"]="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif";
THREE.ShaderChunk["logdepthbuf_vertex"]="#ifdef USE_LOGDEPTHBUF\n\tgl_Position.z = log2(max( EPSILON, gl_Position.w + 1.0 )) * logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\t#endif\n#endif\n";THREE.ShaderChunk["map_fragment"]="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n";
THREE.ShaderChunk["map_pars_fragment"]="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n";THREE.ShaderChunk["map_particle_fragment"]="#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) * offsetRepeat.zw + offsetRepeat.xy );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n";THREE.ShaderChunk["map_particle_pars_fragment"]="#ifdef USE_MAP\n\tuniform vec4 offsetRepeat;\n\tuniform sampler2D map;\n#endif\n";
THREE.ShaderChunk["metalnessmap_fragment"]="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.r;\n#endif\n";THREE.ShaderChunk["metalnessmap_pars_fragment"]="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif";THREE.ShaderChunk["morphnormal_vertex"]="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n";
THREE.ShaderChunk["morphtarget_pars_vertex"]="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif";THREE.ShaderChunk["morphtarget_vertex"]="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n";
THREE.ShaderChunk["normal_fragment"]="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n";
THREE.ShaderChunk["normalmap_pars_fragment"]="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n";
THREE.ShaderChunk["packing"]="vec3 packNormalToRGB( const in vec3 normal ) {\n  return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n  return 1.0 - 2.0 * rgb.xyz;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthoDepth( const in float viewZ, const in float near, const in float far ) {\n  return ( viewZ + near ) / ( near - far );\n}\nfloat OrthoDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n  return linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n  return (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n  return ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n";
THREE.ShaderChunk["premultiplied_alpha_fragment"]="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n";THREE.ShaderChunk["project_vertex"]="#ifdef USE_SKINNING\n\tvec4 mvPosition = modelViewMatrix * skinned;\n#else\n\tvec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;\n";THREE.ShaderChunk["roughnessmap_fragment"]="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.r;\n#endif\n";
THREE.ShaderChunk["roughnessmap_pars_fragment"]="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif";THREE.ShaderChunk["shadowmap_pars_fragment"]="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\treturn (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn 1.0;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\tfloat dp = ( length( lightToPosition ) - shadowBias ) / 1000.0;\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n";
THREE.ShaderChunk["shadowmap_pars_vertex"]="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n";
THREE.ShaderChunk["shadowmap_vertex"]="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n";
THREE.ShaderChunk["shadowmask_pars_fragment"]="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n";
THREE.ShaderChunk["skinbase_vertex"]="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif";THREE.ShaderChunk["skinning_pars_vertex"]="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n";
THREE.ShaderChunk["skinning_vertex"]="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n#endif\n";THREE.ShaderChunk["skinnormal_vertex"]="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n";
THREE.ShaderChunk["specularmap_fragment"]="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif";THREE.ShaderChunk["specularmap_pars_fragment"]="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif";THREE.ShaderChunk["tonemapping_fragment"]="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n";
THREE.ShaderChunk["tonemapping_pars_fragment"]="#define saturate(a) clamp( a, 0.0, 1.0 )\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n  return toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n  color *= toneMappingExposure;\n  color = max( vec3( 0.0 ), color - 0.004 );\n  return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n";
THREE.ShaderChunk["uv2_pars_fragment"]="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif";THREE.ShaderChunk["uv2_pars_vertex"]="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif";THREE.ShaderChunk["uv2_vertex"]="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif";THREE.ShaderChunk["uv_pars_fragment"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif";
THREE.ShaderChunk["uv_pars_vertex"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n#endif\n";THREE.ShaderChunk["uv_vertex"]="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif";
THREE.ShaderChunk["worldpos_vertex"]="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( PHYSICAL ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\t#ifdef USE_SKINNING\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\t#else\n\t\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n\t#endif\n#endif\n";
THREE.UniformsUtils={merge:function(uniforms){var merged={};for(var u=0;u<uniforms.length;u++){var tmp=this.clone(uniforms[u]);for(var p in tmp)merged[p]=tmp[p]}return merged},clone:function(uniforms_src){var uniforms_dst={};for(var u in uniforms_src){uniforms_dst[u]={};for(var p in uniforms_src[u]){var parameter_src=uniforms_src[u][p];if(parameter_src instanceof THREE.Color||parameter_src instanceof THREE.Vector2||parameter_src instanceof THREE.Vector3||parameter_src instanceof THREE.Vector4||parameter_src instanceof
THREE.Matrix3||parameter_src instanceof THREE.Matrix4||parameter_src instanceof THREE.Texture)uniforms_dst[u][p]=parameter_src.clone();else if(Array.isArray(parameter_src))uniforms_dst[u][p]=parameter_src.slice();else uniforms_dst[u][p]=parameter_src}}return uniforms_dst}};
THREE.UniformsLib={common:{"diffuse":{type:"c",value:new THREE.Color(15658734)},"opacity":{type:"1f",value:1},"map":{type:"t",value:null},"offsetRepeat":{type:"v4",value:new THREE.Vector4(0,0,1,1)},"specularMap":{type:"t",value:null},"alphaMap":{type:"t",value:null},"envMap":{type:"t",value:null},"flipEnvMap":{type:"1f",value:-1},"reflectivity":{type:"1f",value:1},"refractionRatio":{type:"1f",value:.98}},aomap:{"aoMap":{type:"t",value:null},"aoMapIntensity":{type:"1f",value:1}},lightmap:{"lightMap":{type:"t",
value:null},"lightMapIntensity":{type:"1f",value:1}},emissivemap:{"emissiveMap":{type:"t",value:null}},bumpmap:{"bumpMap":{type:"t",value:null},"bumpScale":{type:"1f",value:1}},normalmap:{"normalMap":{type:"t",value:null},"normalScale":{type:"v2",value:new THREE.Vector2(1,1)}},displacementmap:{"displacementMap":{type:"t",value:null},"displacementScale":{type:"1f",value:1},"displacementBias":{type:"1f",value:0}},roughnessmap:{"roughnessMap":{type:"t",value:null}},metalnessmap:{"metalnessMap":{type:"t",
value:null}},fog:{"fogDensity":{type:"1f",value:2.5E-4},"fogNear":{type:"1f",value:1},"fogFar":{type:"1f",value:2E3},"fogColor":{type:"c",value:new THREE.Color(16777215)}},lights:{"ambientLightColor":{type:"3fv",value:[]},"directionalLights":{type:"sa",value:[],properties:{"direction":{type:"v3"},"color":{type:"c"},"shadow":{type:"1i"},"shadowBias":{type:"1f"},"shadowRadius":{type:"1f"},"shadowMapSize":{type:"v2"}}},"directionalShadowMap":{type:"tv",value:[]},"directionalShadowMatrix":{type:"m4v",
value:[]},"spotLights":{type:"sa",value:[],properties:{"color":{type:"c"},"position":{type:"v3"},"direction":{type:"v3"},"distance":{type:"1f"},"coneCos":{type:"1f"},"penumbraCos":{type:"1f"},"decay":{type:"1f"},"shadow":{type:"1i"},"shadowBias":{type:"1f"},"shadowRadius":{type:"1f"},"shadowMapSize":{type:"v2"}}},"spotShadowMap":{type:"tv",value:[]},"spotShadowMatrix":{type:"m4v",value:[]},"pointLights":{type:"sa",value:[],properties:{"color":{type:"c"},"position":{type:"v3"},"decay":{type:"1f"},
"distance":{type:"1f"},"shadow":{type:"1i"},"shadowBias":{type:"1f"},"shadowRadius":{type:"1f"},"shadowMapSize":{type:"v2"}}},"pointShadowMap":{type:"tv",value:[]},"pointShadowMatrix":{type:"m4v",value:[]},"hemisphereLights":{type:"sa",value:[],properties:{"direction":{type:"v3"},"skyColor":{type:"c"},"groundColor":{type:"c"}}}},points:{"diffuse":{type:"c",value:new THREE.Color(15658734)},"opacity":{type:"1f",value:1},"size":{type:"1f",value:1},"scale":{type:"1f",value:1},"map":{type:"t",value:null},
"offsetRepeat":{type:"v4",value:new THREE.Vector4(0,0,1,1)}}};THREE.ShaderChunk["cube_frag"]="uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\t#include <logdepthbuf_fragment>\n}\n";THREE.ShaderChunk["cube_vert"]="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
THREE.ShaderChunk["depth_frag"]="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n";
THREE.ShaderChunk["depth_vert"]="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
THREE.ShaderChunk["distanceRGBA_frag"]="uniform vec3 lightPos;\nvarying vec4 vWorldPosition;\n#include <common>\n#include <packing>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = packDepthToRGBA( length( vWorldPosition.xyz - lightPos.xyz ) / 1000.0 );\n}\n";THREE.ShaderChunk["distanceRGBA_vert"]="varying vec4 vWorldPosition;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <skinbase_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition;\n}\n";
THREE.ShaderChunk["equirect_frag"]="uniform sampler2D tEquirect;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = saturate( tFlip * direction.y * -0.5 + 0.5 );\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <logdepthbuf_fragment>\n}\n";
THREE.ShaderChunk["equirect_vert"]="varying vec3 vWorldPosition;\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";THREE.ShaderChunk["linedashed_frag"]="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["linedashed_vert"]="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
THREE.ShaderChunk["meshbasic_frag"]="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight;\n\treflectedLight.directDiffuse = vec3( 0.0 );\n\treflectedLight.directSpecular = vec3( 0.0 );\n\treflectedLight.indirectDiffuse = diffuseColor.rgb;\n\treflectedLight.indirectSpecular = vec3( 0.0 );\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["meshbasic_vert"]="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n}\n";
THREE.ShaderChunk["meshlambert_frag"]="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["meshlambert_vert"]="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n}\n";
THREE.ShaderChunk["meshphong_frag"]="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["meshphong_vert"]="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n}\n";
THREE.ShaderChunk["meshphysical_frag"]="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\nuniform float envMapIntensity;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["meshphysical_vert"]="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <displacementmap_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n";
THREE.ShaderChunk["normal_frag"]="uniform float opacity;\nvarying vec3 vNormal;\n#include <common>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( vNormal ), opacity );\n\t#include <logdepthbuf_fragment>\n}\n";THREE.ShaderChunk["normal_vert"]="varying vec3 vNormal;\n#include <common>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvNormal = normalize( normalMatrix * normal );\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n";
THREE.ShaderChunk["points_frag"]="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n";
THREE.ShaderChunk["points_vert"]="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n";
THREE.ShaderChunk["shadow_frag"]="uniform float opacity;\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( 0.0, 0.0, 0.0, opacity * ( 1.0  - getShadowMask() ) );\n}\n";THREE.ShaderChunk["shadow_vert"]="#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n}\n";
THREE.ShaderLib={"basic":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["aomap"],THREE.UniformsLib["fog"]]),vertexShader:THREE.ShaderChunk["meshbasic_vert"],fragmentShader:THREE.ShaderChunk["meshbasic_frag"]},"lambert":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["aomap"],THREE.UniformsLib["lightmap"],THREE.UniformsLib["emissivemap"],THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],{"emissive":{type:"c",value:new THREE.Color(0)}}]),
vertexShader:THREE.ShaderChunk["meshlambert_vert"],fragmentShader:THREE.ShaderChunk["meshlambert_frag"]},"phong":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["aomap"],THREE.UniformsLib["lightmap"],THREE.UniformsLib["emissivemap"],THREE.UniformsLib["bumpmap"],THREE.UniformsLib["normalmap"],THREE.UniformsLib["displacementmap"],THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],{"emissive":{type:"c",value:new THREE.Color(0)},"specular":{type:"c",value:new THREE.Color(1118481)},
"shininess":{type:"1f",value:30}}]),vertexShader:THREE.ShaderChunk["meshphong_vert"],fragmentShader:THREE.ShaderChunk["meshphong_frag"]},"standard":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["aomap"],THREE.UniformsLib["lightmap"],THREE.UniformsLib["emissivemap"],THREE.UniformsLib["bumpmap"],THREE.UniformsLib["normalmap"],THREE.UniformsLib["displacementmap"],THREE.UniformsLib["roughnessmap"],THREE.UniformsLib["metalnessmap"],THREE.UniformsLib["fog"],THREE.UniformsLib["lights"],
{"emissive":{type:"c",value:new THREE.Color(0)},"roughness":{type:"1f",value:.5},"metalness":{type:"1f",value:0},"envMapIntensity":{type:"1f",value:1}}]),vertexShader:THREE.ShaderChunk["meshphysical_vert"],fragmentShader:THREE.ShaderChunk["meshphysical_frag"]},"points":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["points"],THREE.UniformsLib["fog"]]),vertexShader:THREE.ShaderChunk["points_vert"],fragmentShader:THREE.ShaderChunk["points_frag"]},"dashed":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],
THREE.UniformsLib["fog"],{"scale":{type:"1f",value:1},"dashSize":{type:"1f",value:1},"totalSize":{type:"1f",value:2}}]),vertexShader:THREE.ShaderChunk["linedashed_vert"],fragmentShader:THREE.ShaderChunk["linedashed_frag"]},"depth":{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib["common"],THREE.UniformsLib["displacementmap"]]),vertexShader:THREE.ShaderChunk["depth_vert"],fragmentShader:THREE.ShaderChunk["depth_frag"]},"normal":{uniforms:{"opacity":{type:"1f",value:1}},vertexShader:THREE.ShaderChunk["normal_vert"],
fragmentShader:THREE.ShaderChunk["normal_frag"]},"cube":{uniforms:{"tCube":{type:"t",value:null},"tFlip":{type:"1f",value:-1}},vertexShader:THREE.ShaderChunk["cube_vert"],fragmentShader:THREE.ShaderChunk["cube_frag"]},"equirect":{uniforms:{"tEquirect":{type:"t",value:null},"tFlip":{type:"1f",value:-1}},vertexShader:THREE.ShaderChunk["equirect_vert"],fragmentShader:THREE.ShaderChunk["equirect_frag"]},"distanceRGBA":{uniforms:{"lightPos":{type:"v3",value:new THREE.Vector3}},vertexShader:THREE.ShaderChunk["distanceRGBA_vert"],
fragmentShader:THREE.ShaderChunk["distanceRGBA_frag"]}};THREE.ShaderLib["physical"]={uniforms:THREE.UniformsUtils.merge([THREE.ShaderLib["standard"].uniforms,{}]),vertexShader:THREE.ShaderChunk["meshphysical_vert"],fragmentShader:THREE.ShaderChunk["meshphysical_frag"]};
THREE.WebGLRenderer=function(parameters){console.log("THREE.WebGLRenderer",THREE.REVISION);parameters=parameters||{};var _canvas=parameters.canvas!==undefined?parameters.canvas:document.createElement("canvas"),_context=parameters.context!==undefined?parameters.context:null,_alpha=parameters.alpha!==undefined?parameters.alpha:false,_depth=parameters.depth!==undefined?parameters.depth:true,_stencil=parameters.stencil!==undefined?parameters.stencil:true,_antialias=parameters.antialias!==undefined?parameters.antialias:
false,_premultipliedAlpha=parameters.premultipliedAlpha!==undefined?parameters.premultipliedAlpha:true,_preserveDrawingBuffer=parameters.preserveDrawingBuffer!==undefined?parameters.preserveDrawingBuffer:false;var lights=[];var opaqueObjects=[];var opaqueObjectsLastIndex=-1;var transparentObjects=[];var transparentObjectsLastIndex=-1;var morphInfluences=new Float32Array(8);var sprites=[];var lensFlares=[];this.domElement=_canvas;this.context=null;this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=
true;this.autoClearStencil=true;this.sortObjects=true;this.clippingPlanes=[];this.localClippingEnabled=false;this.gammaFactor=2;this.gammaInput=false;this.gammaOutput=false;this.physicallyCorrectLights=false;this.toneMapping=THREE.LinearToneMapping;this.toneMappingExposure=1;this.toneMappingWhitePoint=1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=true;var _this=this,_currentProgram=null,_currentRenderTarget=null,_currentFramebuffer=null,_currentMaterialId=-1,_currentGeometryProgram=
"",_currentCamera=null,_currentScissor=new THREE.Vector4,_currentScissorTest=null,_currentViewport=new THREE.Vector4,_usedTextureUnits=0,_clearColor=new THREE.Color(0),_clearAlpha=0,_width=_canvas.width,_height=_canvas.height,_pixelRatio=1,_scissor=new THREE.Vector4(0,0,_width,_height),_scissorTest=false,_viewport=new THREE.Vector4(0,0,_width,_height),_frustum=new THREE.Frustum,_clipping=new THREE.WebGLClipping,_clippingEnabled=false,_localClippingEnabled=false,_sphere=new THREE.Sphere,_projScreenMatrix=
new THREE.Matrix4,_vector3=new THREE.Vector3,_lights={hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],shadows:[]},_infoMemory={geometries:0,textures:0},_infoRender={calls:0,vertices:0,faces:0,points:0};this.info={render:_infoRender,memory:_infoMemory,programs:null};var _gl;try{var attributes={alpha:_alpha,depth:_depth,stencil:_stencil,antialias:_antialias,
premultipliedAlpha:_premultipliedAlpha,preserveDrawingBuffer:_preserveDrawingBuffer};_gl=_context||_canvas.getContext("webgl",attributes)||_canvas.getContext("experimental-webgl",attributes);if(_gl===null)if(_canvas.getContext("webgl")!==null)throw"Error creating WebGL context with your selected attributes.";else throw"Error creating WebGL context.";if(_gl.getShaderPrecisionFormat===undefined)_gl.getShaderPrecisionFormat=function(){return{"rangeMin":1,"rangeMax":1,"precision":1}};_canvas.addEventListener("webglcontextlost",
onContextLost,false)}catch(error){console.error("THREE.WebGLRenderer: "+error)}var _isWebGL2=typeof WebGL2RenderingContext!=="undefined"&&_gl instanceof WebGL2RenderingContext;var extensions=new THREE.WebGLExtensions(_gl);extensions.get("WEBGL_depth_texture");extensions.get("OES_texture_float");extensions.get("OES_texture_float_linear");extensions.get("OES_texture_half_float");extensions.get("OES_texture_half_float_linear");extensions.get("OES_standard_derivatives");extensions.get("ANGLE_instanced_arrays");
if(extensions.get("OES_element_index_uint"))THREE.BufferGeometry.MaxIndex=4294967296;var capabilities=new THREE.WebGLCapabilities(_gl,extensions,parameters);var state=new THREE.WebGLState(_gl,extensions,paramThreeToGL);var properties=new THREE.WebGLProperties;var objects=new THREE.WebGLObjects(_gl,properties,this.info);var programCache=new THREE.WebGLPrograms(this,capabilities);var lightCache=new THREE.WebGLLights;this.info.programs=programCache.programs;var bufferRenderer=new THREE.WebGLBufferRenderer(_gl,
extensions,_infoRender);var indexedBufferRenderer=new THREE.WebGLIndexedBufferRenderer(_gl,extensions,_infoRender);function getTargetPixelRatio(){return _currentRenderTarget===null?_pixelRatio:1}function glClearColor(r,g,b,a){if(_premultipliedAlpha===true){r*=a;g*=a;b*=a}state.clearColor(r,g,b,a)}function setDefaultGLState(){state.init();state.scissor(_currentScissor.copy(_scissor).multiplyScalar(_pixelRatio));state.viewport(_currentViewport.copy(_viewport).multiplyScalar(_pixelRatio));glClearColor(_clearColor.r,
_clearColor.g,_clearColor.b,_clearAlpha)}function resetGLState(){_currentProgram=null;_currentCamera=null;_currentGeometryProgram="";_currentMaterialId=-1;state.reset()}setDefaultGLState();this.context=_gl;this.capabilities=capabilities;this.extensions=extensions;this.properties=properties;this.state=state;var shadowMap=new THREE.WebGLShadowMap(this,_lights,objects);this.shadowMap=shadowMap;var spritePlugin=new THREE.SpritePlugin(this,sprites);var lensFlarePlugin=new THREE.LensFlarePlugin(this,lensFlares);
this.getContext=function(){return _gl};this.getContextAttributes=function(){return _gl.getContextAttributes()};this.forceContextLoss=function(){extensions.get("WEBGL_lose_context").loseContext()};this.getMaxAnisotropy=function(){var value;return function getMaxAnisotropy(){if(value!==undefined)return value;var extension=extensions.get("EXT_texture_filter_anisotropic");if(extension!==null)value=_gl.getParameter(extension.MAX_TEXTURE_MAX_ANISOTROPY_EXT);else value=0;return value}}();this.getPrecision=
function(){return capabilities.precision};this.getPixelRatio=function(){return _pixelRatio};this.setPixelRatio=function(value){if(value===undefined)return;_pixelRatio=value;this.setSize(_viewport.z,_viewport.w,false)};this.getSize=function(){return{width:_width,height:_height}};this.setSize=function(width,height,updateStyle){_width=width;_height=height;_canvas.width=width*_pixelRatio;_canvas.height=height*_pixelRatio;if(updateStyle!==false){_canvas.style.width=width+"px";_canvas.style.height=height+
"px"}this.setViewport(0,0,width,height)};this.setViewport=function(x,y,width,height){state.viewport(_viewport.set(x,y,width,height))};this.setScissor=function(x,y,width,height){state.scissor(_scissor.set(x,y,width,height))};this.setScissorTest=function(boolean){state.setScissorTest(_scissorTest=boolean)};this.getClearColor=function(){return _clearColor};this.setClearColor=function(color,alpha){_clearColor.set(color);_clearAlpha=alpha!==undefined?alpha:1;glClearColor(_clearColor.r,_clearColor.g,_clearColor.b,
_clearAlpha)};this.getClearAlpha=function(){return _clearAlpha};this.setClearAlpha=function(alpha){_clearAlpha=alpha;glClearColor(_clearColor.r,_clearColor.g,_clearColor.b,_clearAlpha)};this.clear=function(color,depth,stencil){var bits=0;if(color===undefined||color)bits|=_gl.COLOR_BUFFER_BIT;if(depth===undefined||depth)bits|=_gl.DEPTH_BUFFER_BIT;if(stencil===undefined||stencil)bits|=_gl.STENCIL_BUFFER_BIT;_gl.clear(bits)};this.clearColor=function(){this.clear(true,false,false)};this.clearDepth=function(){this.clear(false,
true,false)};this.clearStencil=function(){this.clear(false,false,true)};this.clearTarget=function(renderTarget,color,depth,stencil){this.setRenderTarget(renderTarget);this.clear(color,depth,stencil)};this.resetGLState=resetGLState;this.dispose=function(){_canvas.removeEventListener("webglcontextlost",onContextLost,false)};function onContextLost(event){event.preventDefault();resetGLState();setDefaultGLState();properties.clear()}function onTextureDispose(event){var texture=event.target;texture.removeEventListener("dispose",
onTextureDispose);deallocateTexture(texture);_infoMemory.textures--}function onRenderTargetDispose(event){var renderTarget=event.target;renderTarget.removeEventListener("dispose",onRenderTargetDispose);deallocateRenderTarget(renderTarget);_infoMemory.textures--}function onMaterialDispose(event){var material=event.target;material.removeEventListener("dispose",onMaterialDispose);deallocateMaterial(material)}function deallocateTexture(texture){var textureProperties=properties.get(texture);if(texture.image&&
textureProperties.__image__webglTextureCube)_gl.deleteTexture(textureProperties.__image__webglTextureCube);else{if(textureProperties.__webglInit===undefined)return;_gl.deleteTexture(textureProperties.__webglTexture)}properties["delete"](texture)}function deallocateRenderTarget(renderTarget){var renderTargetProperties=properties.get(renderTarget);var textureProperties=properties.get(renderTarget.texture);if(!renderTarget)return;if(textureProperties.__webglTexture!==undefined)_gl.deleteTexture(textureProperties.__webglTexture);
if(renderTarget.depthTexture)renderTarget.depthTexture.dispose();if(renderTarget instanceof THREE.WebGLRenderTargetCube)for(var i=0;i<6;i++){_gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer[i]);if(renderTargetProperties.__webglDepthbuffer)_gl.deleteRenderbuffer(renderTargetProperties.__webglDepthbuffer[i])}else{_gl.deleteFramebuffer(renderTargetProperties.__webglFramebuffer);if(renderTargetProperties.__webglDepthbuffer)_gl.deleteRenderbuffer(renderTargetProperties.__webglDepthbuffer)}properties["delete"](renderTarget.texture);
properties["delete"](renderTarget)}function deallocateMaterial(material){releaseMaterialProgramReference(material);properties["delete"](material)}function releaseMaterialProgramReference(material){var programInfo=properties.get(material).program;material.program=undefined;if(programInfo!==undefined)programCache.releaseProgram(programInfo)}this.renderBufferImmediate=function(object,program,material){state.initAttributes();var buffers=properties.get(object);if(object.hasPositions&&!buffers.position)buffers.position=
_gl.createBuffer();if(object.hasNormals&&!buffers.normal)buffers.normal=_gl.createBuffer();if(object.hasUvs&&!buffers.uv)buffers.uv=_gl.createBuffer();if(object.hasColors&&!buffers.color)buffers.color=_gl.createBuffer();var attributes=program.getAttributes();if(object.hasPositions){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.position);_gl.bufferData(_gl.ARRAY_BUFFER,object.positionArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.position);_gl.vertexAttribPointer(attributes.position,3,_gl.FLOAT,
false,0,0)}if(object.hasNormals){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.normal);if(material.type!=="MeshPhongMaterial"&&material.type!=="MeshStandardMaterial"&&material.type!=="MeshPhysicalMaterial"&&material.shading===THREE.FlatShading)for(var i=0,l=object.count*3;i<l;i+=9){var array=object.normalArray;var nx=(array[i+0]+array[i+3]+array[i+6])/3;var ny=(array[i+1]+array[i+4]+array[i+7])/3;var nz=(array[i+2]+array[i+5]+array[i+8])/3;array[i+0]=nx;array[i+1]=ny;array[i+2]=nz;array[i+3]=nx;array[i+
4]=ny;array[i+5]=nz;array[i+6]=nx;array[i+7]=ny;array[i+8]=nz}_gl.bufferData(_gl.ARRAY_BUFFER,object.normalArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.normal);_gl.vertexAttribPointer(attributes.normal,3,_gl.FLOAT,false,0,0)}if(object.hasUvs&&material.map){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.uv);_gl.bufferData(_gl.ARRAY_BUFFER,object.uvArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.uv);_gl.vertexAttribPointer(attributes.uv,2,_gl.FLOAT,false,0,0)}if(object.hasColors&&material.vertexColors!==
THREE.NoColors){_gl.bindBuffer(_gl.ARRAY_BUFFER,buffers.color);_gl.bufferData(_gl.ARRAY_BUFFER,object.colorArray,_gl.DYNAMIC_DRAW);state.enableAttribute(attributes.color);_gl.vertexAttribPointer(attributes.color,3,_gl.FLOAT,false,0,0)}state.disableUnusedAttributes();_gl.drawArrays(_gl.TRIANGLES,0,object.count);object.count=0};this.renderBufferDirect=function(camera,fog,geometry,material,object,group){setMaterial(material);var program=setProgram(camera,fog,material,object);var updateBuffers=false;
var geometryProgram=geometry.id+"_"+program.id+"_"+material.wireframe;if(geometryProgram!==_currentGeometryProgram){_currentGeometryProgram=geometryProgram;updateBuffers=true}var morphTargetInfluences=object.morphTargetInfluences;if(morphTargetInfluences!==undefined){var activeInfluences=[];for(var i=0,l=morphTargetInfluences.length;i<l;i++){var influence=morphTargetInfluences[i];activeInfluences.push([influence,i])}activeInfluences.sort(absNumericalSort);if(activeInfluences.length>8)activeInfluences.length=
8;var morphAttributes=geometry.morphAttributes;for(var i=0,l=activeInfluences.length;i<l;i++){var influence=activeInfluences[i];morphInfluences[i]=influence[0];if(influence[0]!==0){var index=influence[1];if(material.morphTargets===true&&morphAttributes.position)geometry.addAttribute("morphTarget"+i,morphAttributes.position[index]);if(material.morphNormals===true&&morphAttributes.normal)geometry.addAttribute("morphNormal"+i,morphAttributes.normal[index])}else{if(material.morphTargets===true)geometry.removeAttribute("morphTarget"+
i);if(material.morphNormals===true)geometry.removeAttribute("morphNormal"+i)}}program.getUniforms().setValue(_gl,"morphTargetInfluences",morphInfluences);updateBuffers=true}var index=geometry.index;var position=geometry.attributes.position;if(material.wireframe===true)index=objects.getWireframeAttribute(geometry);var renderer;if(index!==null){renderer=indexedBufferRenderer;renderer.setIndex(index)}else renderer=bufferRenderer;if(updateBuffers){setupVertexAttributes(material,program,geometry);if(index!==
null)_gl.bindBuffer(_gl.ELEMENT_ARRAY_BUFFER,objects.getAttributeBuffer(index))}var dataStart=0;var dataCount=Infinity;if(index!==null)dataCount=index.count;else if(position!==undefined)dataCount=position.count;var rangeStart=geometry.drawRange.start;var rangeCount=geometry.drawRange.count;var groupStart=group!==null?group.start:0;var groupCount=group!==null?group.count:Infinity;var drawStart=Math.max(dataStart,rangeStart,groupStart);var drawEnd=Math.min(dataStart+dataCount,rangeStart+rangeCount,
groupStart+groupCount)-1;var drawCount=Math.max(0,drawEnd-drawStart+1);if(object instanceof THREE.Mesh)if(material.wireframe===true){state.setLineWidth(material.wireframeLinewidth*getTargetPixelRatio());renderer.setMode(_gl.LINES)}else switch(object.drawMode){case THREE.TrianglesDrawMode:renderer.setMode(_gl.TRIANGLES);break;case THREE.TriangleStripDrawMode:renderer.setMode(_gl.TRIANGLE_STRIP);break;case THREE.TriangleFanDrawMode:renderer.setMode(_gl.TRIANGLE_FAN);break}else if(object instanceof THREE.Line){var lineWidth=
material.linewidth;if(lineWidth===undefined)lineWidth=1;state.setLineWidth(lineWidth*getTargetPixelRatio());if(object instanceof THREE.LineSegments)renderer.setMode(_gl.LINES);else renderer.setMode(_gl.LINE_STRIP)}else if(object instanceof THREE.Points)renderer.setMode(_gl.POINTS);if(geometry instanceof THREE.InstancedBufferGeometry){if(geometry.maxInstancedCount>0)renderer.renderInstances(geometry,drawStart,drawCount)}else renderer.render(drawStart,drawCount)};function setupVertexAttributes(material,
program,geometry,startIndex){var extension;if(geometry instanceof THREE.InstancedBufferGeometry){extension=extensions.get("ANGLE_instanced_arrays");if(extension===null){console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}}if(startIndex===undefined)startIndex=0;state.initAttributes();var geometryAttributes=geometry.attributes;var programAttributes=program.getAttributes();var materialDefaultAttributeValues=
material.defaultAttributeValues;for(var name in programAttributes){var programAttribute=programAttributes[name];if(programAttribute>=0){var geometryAttribute=geometryAttributes[name];if(geometryAttribute!==undefined){var type=_gl.FLOAT;var array=geometryAttribute.array;var normalized=geometryAttribute.normalized;if(array instanceof Float32Array)type=_gl.FLOAT;else if(array instanceof Float64Array)console.warn("Unsupported data buffer format: Float64Array");else if(array instanceof Uint16Array)type=
_gl.UNSIGNED_SHORT;else if(array instanceof Int16Array)type=_gl.SHORT;else if(array instanceof Uint32Array)type=_gl.UNSIGNED_INT;else if(array instanceof Int32Array)type=_gl.INT;else if(array instanceof Int8Array)type=_gl.BYTE;else if(array instanceof Uint8Array)type=_gl.UNSIGNED_BYTE;var size=geometryAttribute.itemSize;var buffer=objects.getAttributeBuffer(geometryAttribute);if(geometryAttribute instanceof THREE.InterleavedBufferAttribute){var data=geometryAttribute.data;var stride=data.stride;var offset=
geometryAttribute.offset;if(data instanceof THREE.InstancedInterleavedBuffer){state.enableAttributeAndDivisor(programAttribute,data.meshPerAttribute,extension);if(geometry.maxInstancedCount===undefined)geometry.maxInstancedCount=data.meshPerAttribute*data.count}else state.enableAttribute(programAttribute);_gl.bindBuffer(_gl.ARRAY_BUFFER,buffer);_gl.vertexAttribPointer(programAttribute,size,type,normalized,stride*data.array.BYTES_PER_ELEMENT,(startIndex*stride+offset)*data.array.BYTES_PER_ELEMENT)}else{if(geometryAttribute instanceof
THREE.InstancedBufferAttribute){state.enableAttributeAndDivisor(programAttribute,geometryAttribute.meshPerAttribute,extension);if(geometry.maxInstancedCount===undefined)geometry.maxInstancedCount=geometryAttribute.meshPerAttribute*geometryAttribute.count}else state.enableAttribute(programAttribute);_gl.bindBuffer(_gl.ARRAY_BUFFER,buffer);_gl.vertexAttribPointer(programAttribute,size,type,normalized,0,startIndex*size*geometryAttribute.array.BYTES_PER_ELEMENT)}}else if(materialDefaultAttributeValues!==
undefined){var value=materialDefaultAttributeValues[name];if(value!==undefined)switch(value.length){case 2:_gl.vertexAttrib2fv(programAttribute,value);break;case 3:_gl.vertexAttrib3fv(programAttribute,value);break;case 4:_gl.vertexAttrib4fv(programAttribute,value);break;default:_gl.vertexAttrib1fv(programAttribute,value)}}}}state.disableUnusedAttributes()}function absNumericalSort(a,b){return Math.abs(b[0])-Math.abs(a[0])}function painterSortStable(a,b){if(a.object.renderOrder!==b.object.renderOrder)return a.object.renderOrder-
b.object.renderOrder;else if(a.material.id!==b.material.id)return a.material.id-b.material.id;else if(a.z!==b.z)return a.z-b.z;else return a.id-b.id}function reversePainterSortStable(a,b){if(a.object.renderOrder!==b.object.renderOrder)return a.object.renderOrder-b.object.renderOrder;if(a.z!==b.z)return b.z-a.z;else return a.id-b.id}this.render=function(scene,camera,renderTarget,forceClear){if(camera instanceof THREE.Camera===false){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
return}var fog=scene.fog;_currentGeometryProgram="";_currentMaterialId=-1;_currentCamera=null;if(scene.autoUpdate===true)scene.updateMatrixWorld();if(camera.parent===null)camera.updateMatrixWorld();camera.matrixWorldInverse.getInverse(camera.matrixWorld);_projScreenMatrix.multiplyMatrices(camera.projectionMatrix,camera.matrixWorldInverse);_frustum.setFromMatrix(_projScreenMatrix);lights.length=0;opaqueObjectsLastIndex=-1;transparentObjectsLastIndex=-1;sprites.length=0;lensFlares.length=0;_localClippingEnabled=
this.localClippingEnabled;_clippingEnabled=_clipping.init(this.clippingPlanes,_localClippingEnabled,camera);projectObject(scene,camera);opaqueObjects.length=opaqueObjectsLastIndex+1;transparentObjects.length=transparentObjectsLastIndex+1;if(_this.sortObjects===true){opaqueObjects.sort(painterSortStable);transparentObjects.sort(reversePainterSortStable)}if(_clippingEnabled)_clipping.beginShadows();setupShadows(lights);shadowMap.render(scene,camera);setupLights(lights,camera);if(_clippingEnabled)_clipping.endShadows();
_infoRender.calls=0;_infoRender.vertices=0;_infoRender.faces=0;_infoRender.points=0;if(renderTarget===undefined)renderTarget=null;this.setRenderTarget(renderTarget);if(this.autoClear||forceClear)this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);if(scene.overrideMaterial){var overrideMaterial=scene.overrideMaterial;renderObjects(opaqueObjects,camera,fog,overrideMaterial);renderObjects(transparentObjects,camera,fog,overrideMaterial)}else{state.setBlending(THREE.NoBlending);renderObjects(opaqueObjects,
camera,fog);renderObjects(transparentObjects,camera,fog)}spritePlugin.render(scene,camera);lensFlarePlugin.render(scene,camera,_currentViewport);if(renderTarget){var texture=renderTarget.texture;if(texture.generateMipmaps&&isPowerOfTwo(renderTarget)&&texture.minFilter!==THREE.NearestFilter&&texture.minFilter!==THREE.LinearFilter)updateRenderTargetMipmap(renderTarget)}state.setDepthTest(true);state.setDepthWrite(true);state.setColorWrite(true)};function pushRenderItem(object,geometry,material,z,group){var array,
index;if(material.transparent){array=transparentObjects;index=++transparentObjectsLastIndex}else{array=opaqueObjects;index=++opaqueObjectsLastIndex}var renderItem=array[index];if(renderItem!==undefined){renderItem.id=object.id;renderItem.object=object;renderItem.geometry=geometry;renderItem.material=material;renderItem.z=_vector3.z;renderItem.group=group}else{renderItem={id:object.id,object:object,geometry:geometry,material:material,z:_vector3.z,group:group};array.push(renderItem)}}function isObjectViewable(object){var geometry=
object.geometry;if(geometry.boundingSphere===null)geometry.computeBoundingSphere();_sphere.copy(geometry.boundingSphere).applyMatrix4(object.matrixWorld);return isSphereViewable(_sphere)}function isSpriteViewable(sprite){_sphere.center.set(0,0,0);_sphere.radius=.7071067811865476;_sphere.applyMatrix4(sprite.matrixWorld);return isSphereViewable(_sphere)}function isSphereViewable(sphere){if(!_frustum.intersectsSphere(sphere))return false;var numPlanes=_clipping.numPlanes;if(numPlanes===0)return true;
var planes=_this.clippingPlanes,center=sphere.center,negRad=-sphere.radius,i=0;do if(planes[i].distanceToPoint(center)<negRad)return false;while(++i!==numPlanes);return true}function projectObject(object,camera){if(object.visible===false)return;if(object.layers.test(camera.layers))if(object instanceof THREE.Light)lights.push(object);else if(object instanceof THREE.Sprite){if(object.frustumCulled===false||isSpriteViewable(object)===true)sprites.push(object)}else if(object instanceof THREE.LensFlare)lensFlares.push(object);
else if(object instanceof THREE.ImmediateRenderObject){if(_this.sortObjects===true){_vector3.setFromMatrixPosition(object.matrixWorld);_vector3.applyProjection(_projScreenMatrix)}pushRenderItem(object,null,object.material,_vector3.z,null)}else if(object instanceof THREE.Mesh||object instanceof THREE.Line||object instanceof THREE.Points){if(object instanceof THREE.SkinnedMesh)object.skeleton.update();if(object.frustumCulled===false||isObjectViewable(object)===true){var material=object.material;if(material.visible===
true){if(_this.sortObjects===true){_vector3.setFromMatrixPosition(object.matrixWorld);_vector3.applyProjection(_projScreenMatrix)}var geometry=objects.update(object);if(material instanceof THREE.MultiMaterial){var groups=geometry.groups;var materials=material.materials;for(var i=0,l=groups.length;i<l;i++){var group=groups[i];var groupMaterial=materials[group.materialIndex];if(groupMaterial.visible===true)pushRenderItem(object,geometry,groupMaterial,_vector3.z,group)}}else pushRenderItem(object,geometry,
material,_vector3.z,null)}}}var children=object.children;for(var i=0,l=children.length;i<l;i++)projectObject(children[i],camera)}function renderObjects(renderList,camera,fog,overrideMaterial){for(var i=0,l=renderList.length;i<l;i++){var renderItem=renderList[i];var object=renderItem.object;var geometry=renderItem.geometry;var material=overrideMaterial===undefined?renderItem.material:overrideMaterial;var group=renderItem.group;object.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,object.matrixWorld);
object.normalMatrix.getNormalMatrix(object.modelViewMatrix);if(object instanceof THREE.ImmediateRenderObject){setMaterial(material);var program=setProgram(camera,fog,material,object);_currentGeometryProgram="";object.render(function(object){_this.renderBufferImmediate(object,program,material)})}else _this.renderBufferDirect(camera,fog,geometry,material,object,group)}}function initMaterial(material,fog,object){var materialProperties=properties.get(material);var parameters=programCache.getParameters(material,
_lights,fog,_clipping.numPlanes,object);var code=programCache.getProgramCode(material,parameters);var program=materialProperties.program;var programChange=true;if(program===undefined)material.addEventListener("dispose",onMaterialDispose);else if(program.code!==code)releaseMaterialProgramReference(material);else if(parameters.shaderID!==undefined)return;else programChange=false;if(programChange){if(parameters.shaderID){var shader=THREE.ShaderLib[parameters.shaderID];materialProperties.__webglShader=
{name:material.type,uniforms:THREE.UniformsUtils.clone(shader.uniforms),vertexShader:shader.vertexShader,fragmentShader:shader.fragmentShader}}else materialProperties.__webglShader={name:material.type,uniforms:material.uniforms,vertexShader:material.vertexShader,fragmentShader:material.fragmentShader};material.__webglShader=materialProperties.__webglShader;program=programCache.acquireProgram(material,parameters,code);materialProperties.program=program;material.program=program}var attributes=program.getAttributes();
if(material.morphTargets){material.numSupportedMorphTargets=0;for(var i=0;i<_this.maxMorphTargets;i++)if(attributes["morphTarget"+i]>=0)material.numSupportedMorphTargets++}if(material.morphNormals){material.numSupportedMorphNormals=0;for(var i=0;i<_this.maxMorphNormals;i++)if(attributes["morphNormal"+i]>=0)material.numSupportedMorphNormals++}var uniforms=materialProperties.__webglShader.uniforms;if(!(material instanceof THREE.ShaderMaterial)&&!(material instanceof THREE.RawShaderMaterial)||material.clipping===
true){materialProperties.numClippingPlanes=_clipping.numPlanes;uniforms.clippingPlanes=_clipping.uniform}if(material.lights){materialProperties.lightsHash=_lights.hash;uniforms.ambientLightColor.value=_lights.ambient;uniforms.directionalLights.value=_lights.directional;uniforms.spotLights.value=_lights.spot;uniforms.pointLights.value=_lights.point;uniforms.hemisphereLights.value=_lights.hemi;uniforms.directionalShadowMap.value=_lights.directionalShadowMap;uniforms.directionalShadowMatrix.value=_lights.directionalShadowMatrix;
uniforms.spotShadowMap.value=_lights.spotShadowMap;uniforms.spotShadowMatrix.value=_lights.spotShadowMatrix;uniforms.pointShadowMap.value=_lights.pointShadowMap;uniforms.pointShadowMatrix.value=_lights.pointShadowMatrix}var progUniforms=materialProperties.program.getUniforms(),uniformsList=THREE.WebGLUniforms.seqWithValue(progUniforms.seq,uniforms);materialProperties.uniformsList=uniformsList;materialProperties.dynamicUniforms=THREE.WebGLUniforms.splitDynamic(uniformsList,uniforms)}function setMaterial(material){if(material.side!==
THREE.DoubleSide)state.enable(_gl.CULL_FACE);else state.disable(_gl.CULL_FACE);state.setFlipSided(material.side===THREE.BackSide);if(material.transparent===true)state.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst,material.blendEquationAlpha,material.blendSrcAlpha,material.blendDstAlpha,material.premultipliedAlpha);else state.setBlending(THREE.NoBlending);state.setDepthFunc(material.depthFunc);state.setDepthTest(material.depthTest);state.setDepthWrite(material.depthWrite);
state.setColorWrite(material.colorWrite);state.setPolygonOffset(material.polygonOffset,material.polygonOffsetFactor,material.polygonOffsetUnits)}function setProgram(camera,fog,material,object){_usedTextureUnits=0;var materialProperties=properties.get(material);if(_clippingEnabled){if(_localClippingEnabled||camera!==_currentCamera){var useCache=camera===_currentCamera&&material.id===_currentMaterialId;_clipping.setState(material.clippingPlanes,material.clipShadows,camera,materialProperties,useCache)}if(materialProperties.numClippingPlanes!==
undefined&&materialProperties.numClippingPlanes!==_clipping.numPlanes)material.needsUpdate=true}if(materialProperties.program===undefined)material.needsUpdate=true;if(materialProperties.lightsHash!==undefined&&materialProperties.lightsHash!==_lights.hash)material.needsUpdate=true;if(material.needsUpdate){initMaterial(material,fog,object);material.needsUpdate=false}var refreshProgram=false;var refreshMaterial=false;var refreshLights=false;var program=materialProperties.program,p_uniforms=program.getUniforms(),
m_uniforms=materialProperties.__webglShader.uniforms;if(program.id!==_currentProgram){_gl.useProgram(program.program);_currentProgram=program.id;refreshProgram=true;refreshMaterial=true;refreshLights=true}if(material.id!==_currentMaterialId){_currentMaterialId=material.id;refreshMaterial=true}if(refreshProgram||camera!==_currentCamera){p_uniforms.set(_gl,camera,"projectionMatrix");if(capabilities.logarithmicDepthBuffer)p_uniforms.setValue(_gl,"logDepthBufFC",2/(Math.log(camera.far+1)/Math.LN2));if(camera!==
_currentCamera){_currentCamera=camera;refreshMaterial=true;refreshLights=true}if(material instanceof THREE.ShaderMaterial||material instanceof THREE.MeshPhongMaterial||material instanceof THREE.MeshStandardMaterial||material.envMap){var uCamPos=p_uniforms.map.cameraPosition;if(uCamPos!==undefined)uCamPos.setValue(_gl,_vector3.setFromMatrixPosition(camera.matrixWorld))}if(material instanceof THREE.MeshPhongMaterial||material instanceof THREE.MeshLambertMaterial||material instanceof THREE.MeshBasicMaterial||
material instanceof THREE.MeshStandardMaterial||material instanceof THREE.ShaderMaterial||material.skinning)p_uniforms.setValue(_gl,"viewMatrix",camera.matrixWorldInverse);p_uniforms.set(_gl,_this,"toneMappingExposure");p_uniforms.set(_gl,_this,"toneMappingWhitePoint")}if(material.skinning){p_uniforms.setOptional(_gl,object,"bindMatrix");p_uniforms.setOptional(_gl,object,"bindMatrixInverse");var skeleton=object.skeleton;if(skeleton)if(capabilities.floatVertexTextures&&skeleton.useVertexTexture){p_uniforms.set(_gl,
skeleton,"boneTexture");p_uniforms.set(_gl,skeleton,"boneTextureWidth");p_uniforms.set(_gl,skeleton,"boneTextureHeight")}else p_uniforms.setOptional(_gl,skeleton,"boneMatrices")}if(refreshMaterial){if(material.lights)markUniformsLightsNeedsUpdate(m_uniforms,refreshLights);if(fog&&material.fog)refreshUniformsFog(m_uniforms,fog);if(material instanceof THREE.MeshBasicMaterial||material instanceof THREE.MeshLambertMaterial||material instanceof THREE.MeshPhongMaterial||material instanceof THREE.MeshStandardMaterial||
material instanceof THREE.MeshDepthMaterial)refreshUniformsCommon(m_uniforms,material);if(material instanceof THREE.LineBasicMaterial)refreshUniformsLine(m_uniforms,material);else if(material instanceof THREE.LineDashedMaterial){refreshUniformsLine(m_uniforms,material);refreshUniformsDash(m_uniforms,material)}else if(material instanceof THREE.PointsMaterial)refreshUniformsPoints(m_uniforms,material);else if(material instanceof THREE.MeshLambertMaterial)refreshUniformsLambert(m_uniforms,material);
else if(material instanceof THREE.MeshPhongMaterial)refreshUniformsPhong(m_uniforms,material);else if(material instanceof THREE.MeshPhysicalMaterial)refreshUniformsPhysical(m_uniforms,material);else if(material instanceof THREE.MeshStandardMaterial)refreshUniformsStandard(m_uniforms,material);else if(material instanceof THREE.MeshDepthMaterial){if(material.displacementMap){m_uniforms.displacementMap.value=material.displacementMap;m_uniforms.displacementScale.value=material.displacementScale;m_uniforms.displacementBias.value=
material.displacementBias}}else if(material instanceof THREE.MeshNormalMaterial)m_uniforms.opacity.value=material.opacity;THREE.WebGLUniforms.upload(_gl,materialProperties.uniformsList,m_uniforms,_this)}p_uniforms.set(_gl,object,"modelViewMatrix");p_uniforms.set(_gl,object,"normalMatrix");p_uniforms.setValue(_gl,"modelMatrix",object.matrixWorld);var dynUniforms=materialProperties.dynamicUniforms;if(dynUniforms!==null){THREE.WebGLUniforms.evalDynamic(dynUniforms,m_uniforms,object,camera);THREE.WebGLUniforms.upload(_gl,
dynUniforms,m_uniforms,_this)}return program}function refreshUniformsCommon(uniforms,material){uniforms.opacity.value=material.opacity;uniforms.diffuse.value=material.color;if(material.emissive)uniforms.emissive.value.copy(material.emissive).multiplyScalar(material.emissiveIntensity);uniforms.map.value=material.map;uniforms.specularMap.value=material.specularMap;uniforms.alphaMap.value=material.alphaMap;if(material.aoMap){uniforms.aoMap.value=material.aoMap;uniforms.aoMapIntensity.value=material.aoMapIntensity}var uvScaleMap;
if(material.map)uvScaleMap=material.map;else if(material.specularMap)uvScaleMap=material.specularMap;else if(material.displacementMap)uvScaleMap=material.displacementMap;else if(material.normalMap)uvScaleMap=material.normalMap;else if(material.bumpMap)uvScaleMap=material.bumpMap;else if(material.roughnessMap)uvScaleMap=material.roughnessMap;else if(material.metalnessMap)uvScaleMap=material.metalnessMap;else if(material.alphaMap)uvScaleMap=material.alphaMap;else if(material.emissiveMap)uvScaleMap=
material.emissiveMap;if(uvScaleMap!==undefined){if(uvScaleMap instanceof THREE.WebGLRenderTarget)uvScaleMap=uvScaleMap.texture;var offset=uvScaleMap.offset;var repeat=uvScaleMap.repeat;uniforms.offsetRepeat.value.set(offset.x,offset.y,repeat.x,repeat.y)}uniforms.envMap.value=material.envMap;uniforms.flipEnvMap.value=!(material.envMap instanceof THREE.CubeTexture)?1:-1;uniforms.reflectivity.value=material.reflectivity;uniforms.refractionRatio.value=material.refractionRatio}function refreshUniformsLine(uniforms,
material){uniforms.diffuse.value=material.color;uniforms.opacity.value=material.opacity}function refreshUniformsDash(uniforms,material){uniforms.dashSize.value=material.dashSize;uniforms.totalSize.value=material.dashSize+material.gapSize;uniforms.scale.value=material.scale}function refreshUniformsPoints(uniforms,material){uniforms.diffuse.value=material.color;uniforms.opacity.value=material.opacity;uniforms.size.value=material.size*_pixelRatio;uniforms.scale.value=_canvas.clientHeight*.5;uniforms.map.value=
material.map;if(material.map!==null){var offset=material.map.offset;var repeat=material.map.repeat;uniforms.offsetRepeat.value.set(offset.x,offset.y,repeat.x,repeat.y)}}function refreshUniformsFog(uniforms,fog){uniforms.fogColor.value=fog.color;if(fog instanceof THREE.Fog){uniforms.fogNear.value=fog.near;uniforms.fogFar.value=fog.far}else if(fog instanceof THREE.FogExp2)uniforms.fogDensity.value=fog.density}function refreshUniformsLambert(uniforms,material){if(material.lightMap){uniforms.lightMap.value=
material.lightMap;uniforms.lightMapIntensity.value=material.lightMapIntensity}if(material.emissiveMap)uniforms.emissiveMap.value=material.emissiveMap}function refreshUniformsPhong(uniforms,material){uniforms.specular.value=material.specular;uniforms.shininess.value=Math.max(material.shininess,1E-4);if(material.lightMap){uniforms.lightMap.value=material.lightMap;uniforms.lightMapIntensity.value=material.lightMapIntensity}if(material.emissiveMap)uniforms.emissiveMap.value=material.emissiveMap;if(material.bumpMap){uniforms.bumpMap.value=
material.bumpMap;uniforms.bumpScale.value=material.bumpScale}if(material.normalMap){uniforms.normalMap.value=material.normalMap;uniforms.normalScale.value.copy(material.normalScale)}if(material.displacementMap){uniforms.displacementMap.value=material.displacementMap;uniforms.displacementScale.value=material.displacementScale;uniforms.displacementBias.value=material.displacementBias}}function refreshUniformsStandard(uniforms,material){uniforms.roughness.value=material.roughness;uniforms.metalness.value=
material.metalness;if(material.roughnessMap)uniforms.roughnessMap.value=material.roughnessMap;if(material.metalnessMap)uniforms.metalnessMap.value=material.metalnessMap;if(material.lightMap){uniforms.lightMap.value=material.lightMap;uniforms.lightMapIntensity.value=material.lightMapIntensity}if(material.emissiveMap)uniforms.emissiveMap.value=material.emissiveMap;if(material.bumpMap){uniforms.bumpMap.value=material.bumpMap;uniforms.bumpScale.value=material.bumpScale}if(material.normalMap){uniforms.normalMap.value=
material.normalMap;uniforms.normalScale.value.copy(material.normalScale)}if(material.displacementMap){uniforms.displacementMap.value=material.displacementMap;uniforms.displacementScale.value=material.displacementScale;uniforms.displacementBias.value=material.displacementBias}if(material.envMap)uniforms.envMapIntensity.value=material.envMapIntensity}function refreshUniformsPhysical(uniforms,material){refreshUniformsStandard(uniforms,material)}function markUniformsLightsNeedsUpdate(uniforms,value){uniforms.ambientLightColor.needsUpdate=
value;uniforms.directionalLights.needsUpdate=value;uniforms.pointLights.needsUpdate=value;uniforms.spotLights.needsUpdate=value;uniforms.hemisphereLights.needsUpdate=value}function setupShadows(lights){var lightShadowsLength=0;for(var i=0,l=lights.length;i<l;i++){var light=lights[i];if(light.castShadow)_lights.shadows[lightShadowsLength++]=light}_lights.shadows.length=lightShadowsLength}function setupLights(lights,camera){var l,ll,light,r=0,g=0,b=0,color,intensity,distance,shadowMap,viewMatrix=camera.matrixWorldInverse,
directionalLength=0,pointLength=0,spotLength=0,hemiLength=0;for(l=0,ll=lights.length;l<ll;l++){light=lights[l];color=light.color;intensity=light.intensity;distance=light.distance;shadowMap=light.shadow&&light.shadow.map?light.shadow.map.texture:null;if(light instanceof THREE.AmbientLight){r+=color.r*intensity;g+=color.g*intensity;b+=color.b*intensity}else if(light instanceof THREE.DirectionalLight){var uniforms=lightCache.get(light);uniforms.color.copy(light.color).multiplyScalar(light.intensity);
uniforms.direction.setFromMatrixPosition(light.matrixWorld);_vector3.setFromMatrixPosition(light.target.matrixWorld);uniforms.direction.sub(_vector3);uniforms.direction.transformDirection(viewMatrix);uniforms.shadow=light.castShadow;if(light.castShadow){uniforms.shadowBias=light.shadow.bias;uniforms.shadowRadius=light.shadow.radius;uniforms.shadowMapSize=light.shadow.mapSize}_lights.directionalShadowMap[directionalLength]=shadowMap;_lights.directionalShadowMatrix[directionalLength]=light.shadow.matrix;
_lights.directional[directionalLength++]=uniforms}else if(light instanceof THREE.SpotLight){var uniforms=lightCache.get(light);uniforms.position.setFromMatrixPosition(light.matrixWorld);uniforms.position.applyMatrix4(viewMatrix);uniforms.color.copy(color).multiplyScalar(intensity);uniforms.distance=distance;uniforms.direction.setFromMatrixPosition(light.matrixWorld);_vector3.setFromMatrixPosition(light.target.matrixWorld);uniforms.direction.sub(_vector3);uniforms.direction.transformDirection(viewMatrix);
uniforms.coneCos=Math.cos(light.angle);uniforms.penumbraCos=Math.cos(light.angle*(1-light.penumbra));uniforms.decay=light.distance===0?0:light.decay;uniforms.shadow=light.castShadow;if(light.castShadow){uniforms.shadowBias=light.shadow.bias;uniforms.shadowRadius=light.shadow.radius;uniforms.shadowMapSize=light.shadow.mapSize}_lights.spotShadowMap[spotLength]=shadowMap;_lights.spotShadowMatrix[spotLength]=light.shadow.matrix;_lights.spot[spotLength++]=uniforms}else if(light instanceof THREE.PointLight){var uniforms=
lightCache.get(light);uniforms.position.setFromMatrixPosition(light.matrixWorld);uniforms.position.applyMatrix4(viewMatrix);uniforms.color.copy(light.color).multiplyScalar(light.intensity);uniforms.distance=light.distance;uniforms.decay=light.distance===0?0:light.decay;uniforms.shadow=light.castShadow;if(light.castShadow){uniforms.shadowBias=light.shadow.bias;uniforms.shadowRadius=light.shadow.radius;uniforms.shadowMapSize=light.shadow.mapSize}_lights.pointShadowMap[pointLength]=shadowMap;if(_lights.pointShadowMatrix[pointLength]===
undefined)_lights.pointShadowMatrix[pointLength]=new THREE.Matrix4;_vector3.setFromMatrixPosition(light.matrixWorld).negate();_lights.pointShadowMatrix[pointLength].identity().setPosition(_vector3);_lights.point[pointLength++]=uniforms}else if(light instanceof THREE.HemisphereLight){var uniforms=lightCache.get(light);uniforms.direction.setFromMatrixPosition(light.matrixWorld);uniforms.direction.transformDirection(viewMatrix);uniforms.direction.normalize();uniforms.skyColor.copy(light.color).multiplyScalar(intensity);
uniforms.groundColor.copy(light.groundColor).multiplyScalar(intensity);_lights.hemi[hemiLength++]=uniforms}}_lights.ambient[0]=r;_lights.ambient[1]=g;_lights.ambient[2]=b;_lights.directional.length=directionalLength;_lights.spot.length=spotLength;_lights.point.length=pointLength;_lights.hemi.length=hemiLength;_lights.hash=directionalLength+","+pointLength+","+spotLength+","+hemiLength+","+_lights.shadows.length}this.setFaceCulling=function(cullFace,frontFaceDirection){state.setCullFace(cullFace);
state.setFlipSided(frontFaceDirection===THREE.FrontFaceDirectionCW)};function allocTextureUnit(){var textureUnit=_usedTextureUnits;if(textureUnit>=capabilities.maxTextures)console.warn("WebGLRenderer: trying to use "+textureUnit+" texture units while this GPU supports only "+capabilities.maxTextures);_usedTextureUnits+=1;return textureUnit}function setTextureParameters(textureType,texture,isPowerOfTwoImage){var extension;if(isPowerOfTwoImage){_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,paramThreeToGL(texture.wrapS));
_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,paramThreeToGL(texture.wrapT));_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,paramThreeToGL(texture.magFilter));_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,paramThreeToGL(texture.minFilter))}else{_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_S,_gl.CLAMP_TO_EDGE);_gl.texParameteri(textureType,_gl.TEXTURE_WRAP_T,_gl.CLAMP_TO_EDGE);if(texture.wrapS!==THREE.ClampToEdgeWrapping||texture.wrapT!==THREE.ClampToEdgeWrapping)console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",
texture);_gl.texParameteri(textureType,_gl.TEXTURE_MAG_FILTER,filterFallback(texture.magFilter));_gl.texParameteri(textureType,_gl.TEXTURE_MIN_FILTER,filterFallback(texture.minFilter));if(texture.minFilter!==THREE.NearestFilter&&texture.minFilter!==THREE.LinearFilter)console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",texture)}extension=extensions.get("EXT_texture_filter_anisotropic");if(extension){if(texture.type===
THREE.FloatType&&extensions.get("OES_texture_float_linear")===null)return;if(texture.type===THREE.HalfFloatType&&extensions.get("OES_texture_half_float_linear")===null)return;if(texture.anisotropy>1||properties.get(texture).__currentAnisotropy){_gl.texParameterf(textureType,extension.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(texture.anisotropy,_this.getMaxAnisotropy()));properties.get(texture).__currentAnisotropy=texture.anisotropy}}}function uploadTexture(textureProperties,texture,slot){if(textureProperties.__webglInit===
undefined){textureProperties.__webglInit=true;texture.addEventListener("dispose",onTextureDispose);textureProperties.__webglTexture=_gl.createTexture();_infoMemory.textures++}state.activeTexture(_gl.TEXTURE0+slot);state.bindTexture(_gl.TEXTURE_2D,textureProperties.__webglTexture);_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY);_gl.pixelStorei(_gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultiplyAlpha);_gl.pixelStorei(_gl.UNPACK_ALIGNMENT,texture.unpackAlignment);var image=clampToMaxSize(texture.image,
capabilities.maxTextureSize);if(textureNeedsPowerOfTwo(texture)&&isPowerOfTwo(image)===false)image=makePowerOfTwo(image);var isPowerOfTwoImage=isPowerOfTwo(image),glFormat=paramThreeToGL(texture.format),glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_2D,texture,isPowerOfTwoImage);var mipmap,mipmaps=texture.mipmaps;if(texture instanceof THREE.DepthTexture){var internalFormat=_gl.DEPTH_COMPONENT;if(texture.type===THREE.FloatType){if(!_isWebGL2)throw new Error("Float Depth Texture only supported in WebGL2.0");
internalFormat=_gl.DEPTH_COMPONENT32F}else if(_isWebGL2)internalFormat=_gl.DEPTH_COMPONENT16;state.texImage2D(_gl.TEXTURE_2D,0,internalFormat,image.width,image.height,0,glFormat,glType,null)}else if(texture instanceof THREE.DataTexture)if(mipmaps.length>0&&isPowerOfTwoImage){for(var i=0,il=mipmaps.length;i<il;i++){mipmap=mipmaps[i];state.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data)}texture.generateMipmaps=false}else state.texImage2D(_gl.TEXTURE_2D,
0,glFormat,image.width,image.height,0,glFormat,glType,image.data);else if(texture instanceof THREE.CompressedTexture)for(var i=0,il=mipmaps.length;i<il;i++){mipmap=mipmaps[i];if(texture.format!==THREE.RGBAFormat&&texture.format!==THREE.RGBFormat)if(state.getCompressedTextureFormats().indexOf(glFormat)>-1)state.compressedTexImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,mipmap.data);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");
else state.texImage2D(_gl.TEXTURE_2D,i,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data)}else if(mipmaps.length>0&&isPowerOfTwoImage){for(var i=0,il=mipmaps.length;i<il;i++){mipmap=mipmaps[i];state.texImage2D(_gl.TEXTURE_2D,i,glFormat,glFormat,glType,mipmap)}texture.generateMipmaps=false}else state.texImage2D(_gl.TEXTURE_2D,0,glFormat,glFormat,glType,image);if(texture.generateMipmaps&&isPowerOfTwoImage)_gl.generateMipmap(_gl.TEXTURE_2D);textureProperties.__version=texture.version;
if(texture.onUpdate)texture.onUpdate(texture)}function setTexture2D(texture,slot){var textureProperties=properties.get(texture);if(texture.version>0&&textureProperties.__version!==texture.version){var image=texture.image;if(image===undefined){console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",texture);return}if(image.complete===false){console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",texture);return}uploadTexture(textureProperties,
texture,slot);return}state.activeTexture(_gl.TEXTURE0+slot);state.bindTexture(_gl.TEXTURE_2D,textureProperties.__webglTexture)}function clampToMaxSize(image,maxSize){if(image.width>maxSize||image.height>maxSize){var scale=maxSize/Math.max(image.width,image.height);var canvas=document.createElement("canvas");canvas.width=Math.floor(image.width*scale);canvas.height=Math.floor(image.height*scale);var context=canvas.getContext("2d");context.drawImage(image,0,0,image.width,image.height,0,0,canvas.width,
canvas.height);console.warn("THREE.WebGLRenderer: image is too big ("+image.width+"x"+image.height+"). Resized to "+canvas.width+"x"+canvas.height,image);return canvas}return image}function isPowerOfTwo(image){return THREE.Math.isPowerOfTwo(image.width)&&THREE.Math.isPowerOfTwo(image.height)}function textureNeedsPowerOfTwo(texture){if(texture.wrapS!==THREE.ClampToEdgeWrapping||texture.wrapT!==THREE.ClampToEdgeWrapping)return true;if(texture.minFilter!==THREE.NearestFilter&&texture.minFilter!==THREE.LinearFilter)return true;
return false}function makePowerOfTwo(image){if(image instanceof HTMLImageElement||image instanceof HTMLCanvasElement){var canvas=document.createElement("canvas");canvas.width=THREE.Math.nearestPowerOfTwo(image.width);canvas.height=THREE.Math.nearestPowerOfTwo(image.height);var context=canvas.getContext("2d");context.drawImage(image,0,0,canvas.width,canvas.height);console.warn("THREE.WebGLRenderer: image is not power of two ("+image.width+"x"+image.height+"). Resized to "+canvas.width+"x"+canvas.height,
image);return canvas}return image}function setTextureCube(texture,slot){var textureProperties=properties.get(texture);if(texture.image.length===6)if(texture.version>0&&textureProperties.__version!==texture.version){if(!textureProperties.__image__webglTextureCube){texture.addEventListener("dispose",onTextureDispose);textureProperties.__image__webglTextureCube=_gl.createTexture();_infoMemory.textures++}state.activeTexture(_gl.TEXTURE0+slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,textureProperties.__image__webglTextureCube);
_gl.pixelStorei(_gl.UNPACK_FLIP_Y_WEBGL,texture.flipY);var isCompressed=texture instanceof THREE.CompressedTexture;var isDataTexture=texture.image[0]instanceof THREE.DataTexture;var cubeImage=[];for(var i=0;i<6;i++)if(_this.autoScaleCubemaps&&!isCompressed&&!isDataTexture)cubeImage[i]=clampToMaxSize(texture.image[i],capabilities.maxCubemapSize);else cubeImage[i]=isDataTexture?texture.image[i].image:texture.image[i];var image=cubeImage[0],isPowerOfTwoImage=isPowerOfTwo(image),glFormat=paramThreeToGL(texture.format),
glType=paramThreeToGL(texture.type);setTextureParameters(_gl.TEXTURE_CUBE_MAP,texture,isPowerOfTwoImage);for(var i=0;i<6;i++)if(!isCompressed)if(isDataTexture)state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,glFormat,cubeImage[i].width,cubeImage[i].height,0,glFormat,glType,cubeImage[i].data);else state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,glFormat,glFormat,glType,cubeImage[i]);else{var mipmap,mipmaps=cubeImage[i].mipmaps;for(var j=0,jl=mipmaps.length;j<jl;j++){mipmap=mipmaps[j];if(texture.format!==
THREE.RGBAFormat&&texture.format!==THREE.RGBFormat)if(state.getCompressedTextureFormats().indexOf(glFormat)>-1)state.compressedTexImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,j,glFormat,mipmap.width,mipmap.height,0,mipmap.data);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()");else state.texImage2D(_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i,j,glFormat,mipmap.width,mipmap.height,0,glFormat,glType,mipmap.data)}}if(texture.generateMipmaps&&isPowerOfTwoImage)_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);
textureProperties.__version=texture.version;if(texture.onUpdate)texture.onUpdate(texture)}else{state.activeTexture(_gl.TEXTURE0+slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,textureProperties.__image__webglTextureCube)}}function setTextureCubeDynamic(texture,slot){state.activeTexture(_gl.TEXTURE0+slot);state.bindTexture(_gl.TEXTURE_CUBE_MAP,properties.get(texture).__webglTexture)}this.allocTextureUnit=allocTextureUnit;this.setTexture2D=function(){var warned=false;return function(texture,slot){if(texture instanceof
THREE.WebGLRenderTarget){if(!warned){console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead.");warned=true}texture=texture.texture}setTexture2D(texture,slot)}}();this.setTexture=function(){var warned=false;return function(texture,slot){if(!warned){console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead.");warned=true}_this.setTexture2D(texture,slot)}}();this.setTextureCube=function(){var warned=false;
return function(texture,slot){if(texture instanceof THREE.WebGLRenderTargetCube){if(!warned){console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead.");warned=true}texture=texture.texture}if(texture instanceof THREE.CubeTexture||Array.isArray(texture.image)&&texture.image.length===6)setTextureCube(texture,slot);else setTextureCubeDynamic(texture,slot)}}();function setupFrameBufferTexture(framebuffer,renderTarget,attachment,textureTarget){var glFormat=
paramThreeToGL(renderTarget.texture.format);var glType=paramThreeToGL(renderTarget.texture.type);state.texImage2D(textureTarget,0,glFormat,renderTarget.width,renderTarget.height,0,glFormat,glType,null);_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);_gl.framebufferTexture2D(_gl.FRAMEBUFFER,attachment,textureTarget,properties.get(renderTarget.texture).__webglTexture,0);_gl.bindFramebuffer(_gl.FRAMEBUFFER,null)}function setupRenderBufferStorage(renderbuffer,renderTarget){_gl.bindRenderbuffer(_gl.RENDERBUFFER,
renderbuffer);if(renderTarget.depthBuffer&&!renderTarget.stencilBuffer){_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_COMPONENT16,renderTarget.width,renderTarget.height);_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_ATTACHMENT,_gl.RENDERBUFFER,renderbuffer)}else if(renderTarget.depthBuffer&&renderTarget.stencilBuffer){_gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.DEPTH_STENCIL,renderTarget.width,renderTarget.height);_gl.framebufferRenderbuffer(_gl.FRAMEBUFFER,_gl.DEPTH_STENCIL_ATTACHMENT,
_gl.RENDERBUFFER,renderbuffer)}else _gl.renderbufferStorage(_gl.RENDERBUFFER,_gl.RGBA4,renderTarget.width,renderTarget.height);_gl.bindRenderbuffer(_gl.RENDERBUFFER,null)}function setupDepthTexture(framebuffer,renderTarget){var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;if(isCube)throw new Error("Depth Texture with cube render targets is not supported!");_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);if(!(renderTarget.depthTexture instanceof THREE.DepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
if(!properties.get(renderTarget.depthTexture).__webglTexture||renderTarget.depthTexture.image.width!==renderTarget.width||renderTarget.depthTexture.image.height!==renderTarget.height){renderTarget.depthTexture.image.width=renderTarget.width;renderTarget.depthTexture.image.height=renderTarget.height;renderTarget.depthTexture.needsUpdate=true}_this.setTexture2D(renderTarget.depthTexture,0);var webglDepthTexture=properties.get(renderTarget.depthTexture).__webglTexture;_gl.framebufferTexture2D(_gl.FRAMEBUFFER,
_gl.DEPTH_ATTACHMENT,_gl.TEXTURE_2D,webglDepthTexture,0)}function setupDepthRenderbuffer(renderTarget){var renderTargetProperties=properties.get(renderTarget);var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;if(renderTarget.depthTexture){if(isCube)throw new Error("target.depthTexture not supported in Cube render targets");setupDepthTexture(renderTargetProperties.__webglFramebuffer,renderTarget)}else if(isCube){renderTargetProperties.__webglDepthbuffer=[];for(var i=0;i<6;i++){_gl.bindFramebuffer(_gl.FRAMEBUFFER,
renderTargetProperties.__webglFramebuffer[i]);renderTargetProperties.__webglDepthbuffer[i]=_gl.createRenderbuffer();setupRenderBufferStorage(renderTargetProperties.__webglDepthbuffer[i],renderTarget)}}else{_gl.bindFramebuffer(_gl.FRAMEBUFFER,renderTargetProperties.__webglFramebuffer);renderTargetProperties.__webglDepthbuffer=_gl.createRenderbuffer();setupRenderBufferStorage(renderTargetProperties.__webglDepthbuffer,renderTarget)}_gl.bindFramebuffer(_gl.FRAMEBUFFER,null)}function setupRenderTarget(renderTarget){var renderTargetProperties=
properties.get(renderTarget);var textureProperties=properties.get(renderTarget.texture);renderTarget.addEventListener("dispose",onRenderTargetDispose);textureProperties.__webglTexture=_gl.createTexture();_infoMemory.textures++;var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;var isTargetPowerOfTwo=THREE.Math.isPowerOfTwo(renderTarget.width)&&THREE.Math.isPowerOfTwo(renderTarget.height);if(isCube){renderTargetProperties.__webglFramebuffer=[];for(var i=0;i<6;i++)renderTargetProperties.__webglFramebuffer[i]=
_gl.createFramebuffer()}else renderTargetProperties.__webglFramebuffer=_gl.createFramebuffer();if(isCube){state.bindTexture(_gl.TEXTURE_CUBE_MAP,textureProperties.__webglTexture);setTextureParameters(_gl.TEXTURE_CUBE_MAP,renderTarget.texture,isTargetPowerOfTwo);for(var i=0;i<6;i++)setupFrameBufferTexture(renderTargetProperties.__webglFramebuffer[i],renderTarget,_gl.COLOR_ATTACHMENT0,_gl.TEXTURE_CUBE_MAP_POSITIVE_X+i);if(renderTarget.texture.generateMipmaps&&isTargetPowerOfTwo)_gl.generateMipmap(_gl.TEXTURE_CUBE_MAP);
state.bindTexture(_gl.TEXTURE_CUBE_MAP,null)}else{state.bindTexture(_gl.TEXTURE_2D,textureProperties.__webglTexture);setTextureParameters(_gl.TEXTURE_2D,renderTarget.texture,isTargetPowerOfTwo);setupFrameBufferTexture(renderTargetProperties.__webglFramebuffer,renderTarget,_gl.COLOR_ATTACHMENT0,_gl.TEXTURE_2D);if(renderTarget.texture.generateMipmaps&&isTargetPowerOfTwo)_gl.generateMipmap(_gl.TEXTURE_2D);state.bindTexture(_gl.TEXTURE_2D,null)}if(renderTarget.depthBuffer)setupDepthRenderbuffer(renderTarget)}
this.getCurrentRenderTarget=function(){return _currentRenderTarget};this.setRenderTarget=function(renderTarget){_currentRenderTarget=renderTarget;if(renderTarget&&properties.get(renderTarget).__webglFramebuffer===undefined)setupRenderTarget(renderTarget);var isCube=renderTarget instanceof THREE.WebGLRenderTargetCube;var framebuffer;if(renderTarget){var renderTargetProperties=properties.get(renderTarget);if(isCube)framebuffer=renderTargetProperties.__webglFramebuffer[renderTarget.activeCubeFace];else framebuffer=
renderTargetProperties.__webglFramebuffer;_currentScissor.copy(renderTarget.scissor);_currentScissorTest=renderTarget.scissorTest;_currentViewport.copy(renderTarget.viewport)}else{framebuffer=null;_currentScissor.copy(_scissor).multiplyScalar(_pixelRatio);_currentScissorTest=_scissorTest;_currentViewport.copy(_viewport).multiplyScalar(_pixelRatio)}if(_currentFramebuffer!==framebuffer){_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);_currentFramebuffer=framebuffer}state.scissor(_currentScissor);state.setScissorTest(_currentScissorTest);
state.viewport(_currentViewport);if(isCube){var textureProperties=properties.get(renderTarget.texture);_gl.framebufferTexture2D(_gl.FRAMEBUFFER,_gl.COLOR_ATTACHMENT0,_gl.TEXTURE_CUBE_MAP_POSITIVE_X+renderTarget.activeCubeFace,textureProperties.__webglTexture,renderTarget.activeMipMapLevel)}};this.readRenderTargetPixels=function(renderTarget,x,y,width,height,buffer){if(renderTarget instanceof THREE.WebGLRenderTarget===false){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
return}var framebuffer=properties.get(renderTarget).__webglFramebuffer;if(framebuffer){var restore=false;if(framebuffer!==_currentFramebuffer){_gl.bindFramebuffer(_gl.FRAMEBUFFER,framebuffer);restore=true}try{var texture=renderTarget.texture;if(texture.format!==THREE.RGBAFormat&&paramThreeToGL(texture.format)!==_gl.getParameter(_gl.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(texture.type!==
THREE.UnsignedByteType&&paramThreeToGL(texture.type)!==_gl.getParameter(_gl.IMPLEMENTATION_COLOR_READ_TYPE)&&!(texture.type===THREE.FloatType&&extensions.get("WEBGL_color_buffer_float"))&&!(texture.type===THREE.HalfFloatType&&extensions.get("EXT_color_buffer_half_float"))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}if(_gl.checkFramebufferStatus(_gl.FRAMEBUFFER)===_gl.FRAMEBUFFER_COMPLETE){if(x>=0&&x<=
renderTarget.width-width&&(y>=0&&y<=renderTarget.height-height))_gl.readPixels(x,y,width,height,paramThreeToGL(texture.format),paramThreeToGL(texture.type),buffer)}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{if(restore)_gl.bindFramebuffer(_gl.FRAMEBUFFER,_currentFramebuffer)}}};function updateRenderTargetMipmap(renderTarget){var target=renderTarget instanceof THREE.WebGLRenderTargetCube?_gl.TEXTURE_CUBE_MAP:
_gl.TEXTURE_2D;var texture=properties.get(renderTarget.texture).__webglTexture;state.bindTexture(target,texture);_gl.generateMipmap(target);state.bindTexture(target,null)}function filterFallback(f){if(f===THREE.NearestFilter||f===THREE.NearestMipMapNearestFilter||f===THREE.NearestMipMapLinearFilter)return _gl.NEAREST;return _gl.LINEAR}function paramThreeToGL(p){var extension;if(p===THREE.RepeatWrapping)return _gl.REPEAT;if(p===THREE.ClampToEdgeWrapping)return _gl.CLAMP_TO_EDGE;if(p===THREE.MirroredRepeatWrapping)return _gl.MIRRORED_REPEAT;
if(p===THREE.NearestFilter)return _gl.NEAREST;if(p===THREE.NearestMipMapNearestFilter)return _gl.NEAREST_MIPMAP_NEAREST;if(p===THREE.NearestMipMapLinearFilter)return _gl.NEAREST_MIPMAP_LINEAR;if(p===THREE.LinearFilter)return _gl.LINEAR;if(p===THREE.LinearMipMapNearestFilter)return _gl.LINEAR_MIPMAP_NEAREST;if(p===THREE.LinearMipMapLinearFilter)return _gl.LINEAR_MIPMAP_LINEAR;if(p===THREE.UnsignedByteType)return _gl.UNSIGNED_BYTE;if(p===THREE.UnsignedShort4444Type)return _gl.UNSIGNED_SHORT_4_4_4_4;
if(p===THREE.UnsignedShort5551Type)return _gl.UNSIGNED_SHORT_5_5_5_1;if(p===THREE.UnsignedShort565Type)return _gl.UNSIGNED_SHORT_5_6_5;if(p===THREE.ByteType)return _gl.BYTE;if(p===THREE.ShortType)return _gl.SHORT;if(p===THREE.UnsignedShortType)return _gl.UNSIGNED_SHORT;if(p===THREE.IntType)return _gl.INT;if(p===THREE.UnsignedIntType)return _gl.UNSIGNED_INT;if(p===THREE.FloatType)return _gl.FLOAT;extension=extensions.get("OES_texture_half_float");if(extension!==null)if(p===THREE.HalfFloatType)return extension.HALF_FLOAT_OES;
if(p===THREE.AlphaFormat)return _gl.ALPHA;if(p===THREE.RGBFormat)return _gl.RGB;if(p===THREE.RGBAFormat)return _gl.RGBA;if(p===THREE.LuminanceFormat)return _gl.LUMINANCE;if(p===THREE.LuminanceAlphaFormat)return _gl.LUMINANCE_ALPHA;if(p===THREE.DepthFormat)return _gl.DEPTH_COMPONENT;if(p===THREE.AddEquation)return _gl.FUNC_ADD;if(p===THREE.SubtractEquation)return _gl.FUNC_SUBTRACT;if(p===THREE.ReverseSubtractEquation)return _gl.FUNC_REVERSE_SUBTRACT;if(p===THREE.ZeroFactor)return _gl.ZERO;if(p===THREE.OneFactor)return _gl.ONE;
if(p===THREE.SrcColorFactor)return _gl.SRC_COLOR;if(p===THREE.OneMinusSrcColorFactor)return _gl.ONE_MINUS_SRC_COLOR;if(p===THREE.SrcAlphaFactor)return _gl.SRC_ALPHA;if(p===THREE.OneMinusSrcAlphaFactor)return _gl.ONE_MINUS_SRC_ALPHA;if(p===THREE.DstAlphaFactor)return _gl.DST_ALPHA;if(p===THREE.OneMinusDstAlphaFactor)return _gl.ONE_MINUS_DST_ALPHA;if(p===THREE.DstColorFactor)return _gl.DST_COLOR;if(p===THREE.OneMinusDstColorFactor)return _gl.ONE_MINUS_DST_COLOR;if(p===THREE.SrcAlphaSaturateFactor)return _gl.SRC_ALPHA_SATURATE;
extension=extensions.get("WEBGL_compressed_texture_s3tc");if(extension!==null){if(p===THREE.RGB_S3TC_DXT1_Format)return extension.COMPRESSED_RGB_S3TC_DXT1_EXT;if(p===THREE.RGBA_S3TC_DXT1_Format)return extension.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(p===THREE.RGBA_S3TC_DXT3_Format)return extension.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(p===THREE.RGBA_S3TC_DXT5_Format)return extension.COMPRESSED_RGBA_S3TC_DXT5_EXT}extension=extensions.get("WEBGL_compressed_texture_pvrtc");if(extension!==null){if(p===THREE.RGB_PVRTC_4BPPV1_Format)return extension.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
if(p===THREE.RGB_PVRTC_2BPPV1_Format)return extension.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(p===THREE.RGBA_PVRTC_4BPPV1_Format)return extension.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(p===THREE.RGBA_PVRTC_2BPPV1_Format)return extension.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}extension=extensions.get("WEBGL_compressed_texture_etc1");if(extension!==null)if(p===THREE.RGB_ETC1_Format)return extension.COMPRESSED_RGB_ETC1_WEBGL;extension=extensions.get("EXT_blend_minmax");if(extension!==null){if(p===THREE.MinEquation)return extension.MIN_EXT;
if(p===THREE.MaxEquation)return extension.MAX_EXT}return 0}};
THREE.WebGLRenderTarget=function(width,height,options){this.uuid=THREE.Math.generateUUID();this.width=width;this.height=height;this.scissor=new THREE.Vector4(0,0,width,height);this.scissorTest=false;this.viewport=new THREE.Vector4(0,0,width,height);options=options||{};if(options.minFilter===undefined)options.minFilter=THREE.LinearFilter;this.texture=new THREE.Texture(undefined,undefined,options.wrapS,options.wrapT,options.magFilter,options.minFilter,options.format,options.type,options.anisotropy,
options.encoding);this.depthBuffer=options.depthBuffer!==undefined?options.depthBuffer:true;this.stencilBuffer=options.stencilBuffer!==undefined?options.stencilBuffer:true;this.depthTexture=null};
Object.assign(THREE.WebGLRenderTarget.prototype,THREE.EventDispatcher.prototype,{setSize:function(width,height){if(this.width!==width||this.height!==height){this.width=width;this.height=height;this.dispose()}this.viewport.set(0,0,width,height);this.scissor.set(0,0,width,height)},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.width=source.width;this.height=source.height;this.viewport.copy(source.viewport);this.texture=source.texture.clone();this.depthBuffer=source.depthBuffer;
this.stencilBuffer=source.stencilBuffer;this.depthTexture=source.depthTexture;return this},dispose:function(){this.dispatchEvent({type:"dispose"})}});THREE.WebGLRenderTargetCube=function(width,height,options){THREE.WebGLRenderTarget.call(this,width,height,options);this.activeCubeFace=0;this.activeMipMapLevel=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;
THREE.WebGLBufferRenderer=function(_gl,extensions,_infoRender){var mode;function setMode(value){mode=value}function render(start,count){_gl.drawArrays(mode,start,count);_infoRender.calls++;_infoRender.vertices+=count;if(mode===_gl.TRIANGLES)_infoRender.faces+=count/3}function renderInstances(geometry){var extension=extensions.get("ANGLE_instanced_arrays");if(extension===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
return}var position=geometry.attributes.position;var count=0;if(position instanceof THREE.InterleavedBufferAttribute){count=position.data.count;extension.drawArraysInstancedANGLE(mode,0,count,geometry.maxInstancedCount)}else{count=position.count;extension.drawArraysInstancedANGLE(mode,0,count,geometry.maxInstancedCount)}_infoRender.calls++;_infoRender.vertices+=count*geometry.maxInstancedCount;if(mode===_gl.TRIANGLES)_infoRender.faces+=geometry.maxInstancedCount*count/3}this.setMode=setMode;this.render=
render;this.renderInstances=renderInstances};
THREE.WebGLClipping=function(){var scope=this,globalState=null,numGlobalPlanes=0,localClippingEnabled=false,renderingShadows=false,plane=new THREE.Plane,viewNormalMatrix=new THREE.Matrix3,uniform={value:null,needsUpdate:false};this.uniform=uniform;this.numPlanes=0;this.init=function(planes,enableLocalClipping,camera){var enabled=planes.length!==0||enableLocalClipping||numGlobalPlanes!==0||localClippingEnabled;localClippingEnabled=enableLocalClipping;globalState=projectPlanes(planes,camera,0);numGlobalPlanes=
planes.length;return enabled};this.beginShadows=function(){renderingShadows=true;projectPlanes(null)};this.endShadows=function(){renderingShadows=false;resetGlobalState()};this.setState=function(planes,clipShadows,camera,cache,fromCache){if(!localClippingEnabled||planes===null||planes.length===0||renderingShadows&&!clipShadows)if(renderingShadows)projectPlanes(null);else resetGlobalState();else{var nGlobal=renderingShadows?0:numGlobalPlanes,lGlobal=nGlobal*4,dstArray=cache.clippingState||null;uniform.value=
dstArray;dstArray=projectPlanes(planes,camera,lGlobal,fromCache);for(var i=0;i!==lGlobal;++i)dstArray[i]=globalState[i];cache.clippingState=dstArray;this.numPlanes+=nGlobal}};function resetGlobalState(){if(uniform.value!==globalState){uniform.value=globalState;uniform.needsUpdate=numGlobalPlanes>0}scope.numPlanes=numGlobalPlanes}function projectPlanes(planes,camera,dstOffset,skipTransform){var nPlanes=planes!==null?planes.length:0,dstArray=null;if(nPlanes!==0){dstArray=uniform.value;if(skipTransform!==
true||dstArray===null){var flatSize=dstOffset+nPlanes*4,viewMatrix=camera.matrixWorldInverse;viewNormalMatrix.getNormalMatrix(viewMatrix);if(dstArray===null||dstArray.length<flatSize)dstArray=new Float32Array(flatSize);for(var i=0,i4=dstOffset;i!==nPlanes;++i,i4+=4){plane.copy(planes[i]).applyMatrix4(viewMatrix,viewNormalMatrix);plane.normal.toArray(dstArray,i4);dstArray[i4+3]=plane.constant}}uniform.value=dstArray;uniform.needsUpdate=true}scope.numPlanes=nPlanes;return dstArray}};
THREE.WebGLIndexedBufferRenderer=function(_gl,extensions,_infoRender){var mode;function setMode(value){mode=value}var type,size;function setIndex(index){if(index.array instanceof Uint32Array&&extensions.get("OES_element_index_uint")){type=_gl.UNSIGNED_INT;size=4}else{type=_gl.UNSIGNED_SHORT;size=2}}function render(start,count){_gl.drawElements(mode,count,type,start*size);_infoRender.calls++;_infoRender.vertices+=count;if(mode===_gl.TRIANGLES)_infoRender.faces+=count/3}function renderInstances(geometry,
start,count){var extension=extensions.get("ANGLE_instanced_arrays");if(extension===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}extension.drawElementsInstancedANGLE(mode,count,type,start*size,geometry.maxInstancedCount);_infoRender.calls++;_infoRender.vertices+=count*geometry.maxInstancedCount;if(mode===_gl.TRIANGLES)_infoRender.faces+=geometry.maxInstancedCount*count/3}this.setMode=setMode;
this.setIndex=setIndex;this.render=render;this.renderInstances=renderInstances};
THREE.WebGLExtensions=function(gl){var extensions={};this.get=function(name){if(extensions[name]!==undefined)return extensions[name];var extension;switch(name){case "WEBGL_depth_texture":extension=gl.getExtension("WEBGL_depth_texture")||gl.getExtension("MOZ_WEBGL_depth_texture")||gl.getExtension("WEBKIT_WEBGL_depth_texture");break;case "EXT_texture_filter_anisotropic":extension=gl.getExtension("EXT_texture_filter_anisotropic")||gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
break;case "WEBGL_compressed_texture_s3tc":extension=gl.getExtension("WEBGL_compressed_texture_s3tc")||gl.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case "WEBGL_compressed_texture_pvrtc":extension=gl.getExtension("WEBGL_compressed_texture_pvrtc")||gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case "WEBGL_compressed_texture_etc1":extension=gl.getExtension("WEBGL_compressed_texture_etc1");break;default:extension=
gl.getExtension(name)}if(extension===null)console.warn("THREE.WebGLRenderer: "+name+" extension not supported.");extensions[name]=extension;return extension}};
THREE.WebGLCapabilities=function(gl,extensions,parameters){function getMaxPrecision(precision){if(precision==="highp"){if(gl.getShaderPrecisionFormat(gl.VERTEX_SHADER,gl.HIGH_FLOAT).precision>0&&gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.HIGH_FLOAT).precision>0)return"highp";precision="mediump"}if(precision==="mediump")if(gl.getShaderPrecisionFormat(gl.VERTEX_SHADER,gl.MEDIUM_FLOAT).precision>0&&gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER,gl.MEDIUM_FLOAT).precision>0)return"mediump";return"lowp"}
this.getMaxPrecision=getMaxPrecision;this.precision=parameters.precision!==undefined?parameters.precision:"highp";this.logarithmicDepthBuffer=parameters.logarithmicDepthBuffer!==undefined?parameters.logarithmicDepthBuffer:false;this.maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);this.maxVertexTextures=gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);this.maxTextureSize=gl.getParameter(gl.MAX_TEXTURE_SIZE);this.maxCubemapSize=gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);this.maxAttributes=
gl.getParameter(gl.MAX_VERTEX_ATTRIBS);this.maxVertexUniforms=gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);this.maxVaryings=gl.getParameter(gl.MAX_VARYING_VECTORS);this.maxFragmentUniforms=gl.getParameter(gl.MAX_FRAGMENT_UNIFORM_VECTORS);this.vertexTextures=this.maxVertexTextures>0;this.floatFragmentTextures=!!extensions.get("OES_texture_float");this.floatVertexTextures=this.vertexTextures&&this.floatFragmentTextures;var _maxPrecision=getMaxPrecision(this.precision);if(_maxPrecision!==this.precision){console.warn("THREE.WebGLRenderer:",
this.precision,"not supported, using",_maxPrecision,"instead.");this.precision=_maxPrecision}if(this.logarithmicDepthBuffer)this.logarithmicDepthBuffer=!!extensions.get("EXT_frag_depth")};
THREE.WebGLGeometries=function(gl,properties,info){var geometries={};function get(object){var geometry=object.geometry;if(geometries[geometry.id]!==undefined)return geometries[geometry.id];geometry.addEventListener("dispose",onGeometryDispose);var buffergeometry;if(geometry instanceof THREE.BufferGeometry)buffergeometry=geometry;else if(geometry instanceof THREE.Geometry){if(geometry._bufferGeometry===undefined)geometry._bufferGeometry=(new THREE.BufferGeometry).setFromObject(object);buffergeometry=
geometry._bufferGeometry}geometries[geometry.id]=buffergeometry;info.memory.geometries++;return buffergeometry}function onGeometryDispose(event){var geometry=event.target;var buffergeometry=geometries[geometry.id];if(buffergeometry.index!==null)deleteAttribute(buffergeometry.index);deleteAttributes(buffergeometry.attributes);geometry.removeEventListener("dispose",onGeometryDispose);delete geometries[geometry.id];var property=properties.get(geometry);if(property.wireframe)deleteAttribute(property.wireframe);
properties["delete"](geometry);var bufferproperty=properties.get(buffergeometry);if(bufferproperty.wireframe)deleteAttribute(bufferproperty.wireframe);properties["delete"](buffergeometry);info.memory.geometries--}function getAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute)return properties.get(attribute.data).__webglBuffer;return properties.get(attribute).__webglBuffer}function deleteAttribute(attribute){var buffer=getAttributeBuffer(attribute);if(buffer!==undefined){gl.deleteBuffer(buffer);
removeAttributeBuffer(attribute)}}function deleteAttributes(attributes){for(var name in attributes)deleteAttribute(attributes[name])}function removeAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute)properties["delete"](attribute.data);else properties["delete"](attribute)}this.get=get};
THREE.WebGLLights=function(){var lights={};this.get=function(light){if(lights[light.id]!==undefined)return lights[light.id];var uniforms;switch(light.type){case "DirectionalLight":uniforms={direction:new THREE.Vector3,color:new THREE.Color,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case "SpotLight":uniforms={position:new THREE.Vector3,direction:new THREE.Vector3,color:new THREE.Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,
shadowMapSize:new THREE.Vector2};break;case "PointLight":uniforms={position:new THREE.Vector3,color:new THREE.Color,distance:0,decay:0,shadow:false,shadowBias:0,shadowRadius:1,shadowMapSize:new THREE.Vector2};break;case "HemisphereLight":uniforms={direction:new THREE.Vector3,skyColor:new THREE.Color,groundColor:new THREE.Color};break}lights[light.id]=uniforms;return uniforms}};
THREE.WebGLObjects=function(gl,properties,info){var geometries=new THREE.WebGLGeometries(gl,properties,info);function update(object){var geometry=geometries.get(object);if(object.geometry instanceof THREE.Geometry)geometry.updateFromObject(object);var index=geometry.index;var attributes=geometry.attributes;if(index!==null)updateAttribute(index,gl.ELEMENT_ARRAY_BUFFER);for(var name in attributes)updateAttribute(attributes[name],gl.ARRAY_BUFFER);var morphAttributes=geometry.morphAttributes;for(var name in morphAttributes){var array=
morphAttributes[name];for(var i=0,l=array.length;i<l;i++)updateAttribute(array[i],gl.ARRAY_BUFFER)}return geometry}function updateAttribute(attribute,bufferType){var data=attribute instanceof THREE.InterleavedBufferAttribute?attribute.data:attribute;var attributeProperties=properties.get(data);if(attributeProperties.__webglBuffer===undefined)createBuffer(attributeProperties,data,bufferType);else if(attributeProperties.version!==data.version)updateBuffer(attributeProperties,data,bufferType)}function createBuffer(attributeProperties,
data,bufferType){attributeProperties.__webglBuffer=gl.createBuffer();gl.bindBuffer(bufferType,attributeProperties.__webglBuffer);var usage=data.dynamic?gl.DYNAMIC_DRAW:gl.STATIC_DRAW;gl.bufferData(bufferType,data.array,usage);attributeProperties.version=data.version}function updateBuffer(attributeProperties,data,bufferType){gl.bindBuffer(bufferType,attributeProperties.__webglBuffer);if(data.dynamic===false||data.updateRange.count===-1)gl.bufferSubData(bufferType,0,data.array);else if(data.updateRange.count===
0)console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.");else{gl.bufferSubData(bufferType,data.updateRange.offset*data.array.BYTES_PER_ELEMENT,data.array.subarray(data.updateRange.offset,data.updateRange.offset+data.updateRange.count));data.updateRange.count=0}attributeProperties.version=data.version}function getAttributeBuffer(attribute){if(attribute instanceof THREE.InterleavedBufferAttribute)return properties.get(attribute.data).__webglBuffer;
return properties.get(attribute).__webglBuffer}function getWireframeAttribute(geometry){var property=properties.get(geometry);if(property.wireframe!==undefined)return property.wireframe;var indices=[];var index=geometry.index;var attributes=geometry.attributes;var position=attributes.position;if(index!==null){var edges={};var array=index.array;for(var i=0,l=array.length;i<l;i+=3){var a=array[i+0];var b=array[i+1];var c=array[i+2];if(checkEdge(edges,a,b))indices.push(a,b);if(checkEdge(edges,b,c))indices.push(b,
c);if(checkEdge(edges,c,a))indices.push(c,a)}}else{var array=attributes.position.array;for(var i=0,l=array.length/3-1;i<l;i+=3){var a=i+0;var b=i+1;var c=i+2;indices.push(a,b,b,c,c,a)}}var TypeArray=position.count>65535?Uint32Array:Uint16Array;var attribute=new THREE.BufferAttribute(new TypeArray(indices),1);updateAttribute(attribute,gl.ELEMENT_ARRAY_BUFFER);property.wireframe=attribute;return attribute}function checkEdge(edges,a,b){if(a>b){var tmp=a;a=b;b=tmp}var list=edges[a];if(list===undefined){edges[a]=
[b];return true}else if(list.indexOf(b)===-1){list.push(b);return true}return false}this.getAttributeBuffer=getAttributeBuffer;this.getWireframeAttribute=getWireframeAttribute;this.update=update};
THREE.WebGLProgram=function(){var programIdCount=0;function getEncodingComponents(encoding){switch(encoding){case THREE.LinearEncoding:return["Linear","( value )"];case THREE.sRGBEncoding:return["sRGB","( value )"];case THREE.RGBEEncoding:return["RGBE","( value )"];case THREE.RGBM7Encoding:return["RGBM","( value, 7.0 )"];case THREE.RGBM16Encoding:return["RGBM","( value, 16.0 )"];case THREE.RGBDEncoding:return["RGBD","( value, 256.0 )"];case THREE.GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];
default:throw new Error("unsupported encoding: "+encoding);}}function getTexelDecodingFunction(functionName,encoding){var components=getEncodingComponents(encoding);return"vec4 "+functionName+"( vec4 value ) { return "+components[0]+"ToLinear"+components[1]+"; }"}function getTexelEncodingFunction(functionName,encoding){var components=getEncodingComponents(encoding);return"vec4 "+functionName+"( vec4 value ) { return LinearTo"+components[0]+components[1]+"; }"}function getToneMappingFunction(functionName,
toneMapping){var toneMappingName;switch(toneMapping){case THREE.LinearToneMapping:toneMappingName="Linear";break;case THREE.ReinhardToneMapping:toneMappingName="Reinhard";break;case THREE.Uncharted2ToneMapping:toneMappingName="Uncharted2";break;case THREE.CineonToneMapping:toneMappingName="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+toneMapping);}return"vec3 "+functionName+"( vec3 color ) { return "+toneMappingName+"ToneMapping( color ); }"}function generateExtensions(extensions,
parameters,rendererExtensions){extensions=extensions||{};var chunks=[extensions.derivatives||parameters.envMapCubeUV||parameters.bumpMap||parameters.normalMap||parameters.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(extensions.fragDepth||parameters.logarithmicDepthBuffer)&&rendererExtensions.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",extensions.drawBuffers&&rendererExtensions.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(extensions.shaderTextureLOD||
parameters.envMap)&&rendererExtensions.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return chunks.filter(filterEmptyLine).join("\n")}function generateDefines(defines){var chunks=[];for(var name in defines){var value=defines[name];if(value===false)continue;chunks.push("#define "+name+" "+value)}return chunks.join("\n")}function fetchAttributeLocations(gl,program,identifiers){var attributes={};var n=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(var i=
0;i<n;i++){var info=gl.getActiveAttrib(program,i);var name=info.name;attributes[name]=gl.getAttribLocation(program,name)}return attributes}function filterEmptyLine(string){return string!==""}function replaceLightNums(string,parameters){return string.replace(/NUM_DIR_LIGHTS/g,parameters.numDirLights).replace(/NUM_SPOT_LIGHTS/g,parameters.numSpotLights).replace(/NUM_POINT_LIGHTS/g,parameters.numPointLights).replace(/NUM_HEMI_LIGHTS/g,parameters.numHemiLights)}function parseIncludes(string){var pattern=
/#include +<([\w\d.]+)>/g;function replace(match,include){var replace=THREE.ShaderChunk[include];if(replace===undefined)throw new Error("Can not resolve #include <"+include+">");return parseIncludes(replace)}return string.replace(pattern,replace)}function unrollLoops(string){var pattern=/for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function replace(match,start,end,snippet){var unroll="";for(var i=parseInt(start);i<parseInt(end);i++)unroll+=snippet.replace(/\[ i \]/g,"[ "+i+
" ]");return unroll}return string.replace(pattern,replace)}return function WebGLProgram(renderer,code,material,parameters){var gl=renderer.context;var extensions=material.extensions;var defines=material.defines;var vertexShader=material.__webglShader.vertexShader;var fragmentShader=material.__webglShader.fragmentShader;var shadowMapTypeDefine="SHADOWMAP_TYPE_BASIC";if(parameters.shadowMapType===THREE.PCFShadowMap)shadowMapTypeDefine="SHADOWMAP_TYPE_PCF";else if(parameters.shadowMapType===THREE.PCFSoftShadowMap)shadowMapTypeDefine=
"SHADOWMAP_TYPE_PCF_SOFT";var envMapTypeDefine="ENVMAP_TYPE_CUBE";var envMapModeDefine="ENVMAP_MODE_REFLECTION";var envMapBlendingDefine="ENVMAP_BLENDING_MULTIPLY";if(parameters.envMap){switch(material.envMap.mapping){case THREE.CubeReflectionMapping:case THREE.CubeRefractionMapping:envMapTypeDefine="ENVMAP_TYPE_CUBE";break;case THREE.CubeUVReflectionMapping:case THREE.CubeUVRefractionMapping:envMapTypeDefine="ENVMAP_TYPE_CUBE_UV";break;case THREE.EquirectangularReflectionMapping:case THREE.EquirectangularRefractionMapping:envMapTypeDefine=
"ENVMAP_TYPE_EQUIREC";break;case THREE.SphericalReflectionMapping:envMapTypeDefine="ENVMAP_TYPE_SPHERE";break}switch(material.envMap.mapping){case THREE.CubeRefractionMapping:case THREE.EquirectangularRefractionMapping:envMapModeDefine="ENVMAP_MODE_REFRACTION";break}switch(material.combine){case THREE.MultiplyOperation:envMapBlendingDefine="ENVMAP_BLENDING_MULTIPLY";break;case THREE.MixOperation:envMapBlendingDefine="ENVMAP_BLENDING_MIX";break;case THREE.AddOperation:envMapBlendingDefine="ENVMAP_BLENDING_ADD";
break}}var gammaFactorDefine=renderer.gammaFactor>0?renderer.gammaFactor:1;var customExtensions=generateExtensions(extensions,parameters,renderer.extensions);var customDefines=generateDefines(defines);var program=gl.createProgram();var prefixVertex,prefixFragment;if(material instanceof THREE.RawShaderMaterial){prefixVertex="";prefixFragment=""}else{prefixVertex=["precision "+parameters.precision+" float;","precision "+parameters.precision+" int;","#define SHADER_NAME "+material.__webglShader.name,
customDefines,parameters.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+gammaFactorDefine,"#define MAX_BONES "+parameters.maxBones,parameters.map?"#define USE_MAP":"",parameters.envMap?"#define USE_ENVMAP":"",parameters.envMap?"#define "+envMapModeDefine:"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.aoMap?"#define USE_AOMAP":"",parameters.emissiveMap?"#define USE_EMISSIVEMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":
"",parameters.displacementMap&&parameters.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.roughnessMap?"#define USE_ROUGHNESSMAP":"",parameters.metalnessMap?"#define USE_METALNESSMAP":"",parameters.alphaMap?"#define USE_ALPHAMAP":"",parameters.vertexColors?"#define USE_COLOR":"",parameters.flatShading?"#define FLAT_SHADED":"",parameters.skinning?"#define USE_SKINNING":"",parameters.useVertexTexture?"#define BONE_TEXTURE":"",parameters.morphTargets?
"#define USE_MORPHTARGETS":"",parameters.morphNormals&&parameters.flatShading===false?"#define USE_MORPHNORMALS":"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+parameters.numClippingPlanes,parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.sizeAttenuation?"#define USE_SIZEATTENUATION":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":
"",parameters.logarithmicDepthBuffer&&renderer.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;",
"\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n");
prefixFragment=[customExtensions,"precision "+parameters.precision+" float;","precision "+parameters.precision+" int;","#define SHADER_NAME "+material.__webglShader.name,customDefines,parameters.alphaTest?"#define ALPHATEST "+parameters.alphaTest:"","#define GAMMA_FACTOR "+gammaFactorDefine,parameters.useFog&&parameters.fog?"#define USE_FOG":"",parameters.useFog&&parameters.fogExp?"#define FOG_EXP2":"",parameters.map?"#define USE_MAP":"",parameters.envMap?"#define USE_ENVMAP":"",parameters.envMap?
"#define "+envMapTypeDefine:"",parameters.envMap?"#define "+envMapModeDefine:"",parameters.envMap?"#define "+envMapBlendingDefine:"",parameters.lightMap?"#define USE_LIGHTMAP":"",parameters.aoMap?"#define USE_AOMAP":"",parameters.emissiveMap?"#define USE_EMISSIVEMAP":"",parameters.bumpMap?"#define USE_BUMPMAP":"",parameters.normalMap?"#define USE_NORMALMAP":"",parameters.specularMap?"#define USE_SPECULARMAP":"",parameters.roughnessMap?"#define USE_ROUGHNESSMAP":"",parameters.metalnessMap?"#define USE_METALNESSMAP":
"",parameters.alphaMap?"#define USE_ALPHAMAP":"",parameters.vertexColors?"#define USE_COLOR":"",parameters.flatShading?"#define FLAT_SHADED":"",parameters.doubleSided?"#define DOUBLE_SIDED":"",parameters.flipSided?"#define FLIP_SIDED":"","#define NUM_CLIPPING_PLANES "+parameters.numClippingPlanes,parameters.shadowMapEnabled?"#define USE_SHADOWMAP":"",parameters.shadowMapEnabled?"#define "+shadowMapTypeDefine:"",parameters.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",parameters.physicallyCorrectLights?
"#define PHYSICALLY_CORRECT_LIGHTS":"",parameters.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",parameters.logarithmicDepthBuffer&&renderer.extensions.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",parameters.envMap&&renderer.extensions.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",parameters.toneMapping!==THREE.NoToneMapping?"#define TONE_MAPPING":"",parameters.toneMapping!==THREE.NoToneMapping?THREE.ShaderChunk["tonemapping_pars_fragment"]:
"",parameters.toneMapping!==THREE.NoToneMapping?getToneMappingFunction("toneMapping",parameters.toneMapping):"",parameters.outputEncoding||parameters.mapEncoding||parameters.envMapEncoding||parameters.emissiveMapEncoding?THREE.ShaderChunk["encodings_pars_fragment"]:"",parameters.mapEncoding?getTexelDecodingFunction("mapTexelToLinear",parameters.mapEncoding):"",parameters.envMapEncoding?getTexelDecodingFunction("envMapTexelToLinear",parameters.envMapEncoding):"",parameters.emissiveMapEncoding?getTexelDecodingFunction("emissiveMapTexelToLinear",
parameters.emissiveMapEncoding):"",parameters.outputEncoding?getTexelEncodingFunction("linearToOutputTexel",parameters.outputEncoding):"",parameters.depthPacking?"#define DEPTH_PACKING "+material.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")}vertexShader=parseIncludes(vertexShader,parameters);vertexShader=replaceLightNums(vertexShader,parameters);fragmentShader=parseIncludes(fragmentShader,parameters);fragmentShader=replaceLightNums(fragmentShader,parameters);if(material instanceof THREE.ShaderMaterial===
false){vertexShader=unrollLoops(vertexShader);fragmentShader=unrollLoops(fragmentShader)}var vertexGlsl=prefixVertex+vertexShader;var fragmentGlsl=prefixFragment+fragmentShader;var glVertexShader=THREE.WebGLShader(gl,gl.VERTEX_SHADER,vertexGlsl);var glFragmentShader=THREE.WebGLShader(gl,gl.FRAGMENT_SHADER,fragmentGlsl);gl.attachShader(program,glVertexShader);gl.attachShader(program,glFragmentShader);if(material.index0AttributeName!==undefined)gl.bindAttribLocation(program,0,material.index0AttributeName);
else if(parameters.morphTargets===true)gl.bindAttribLocation(program,0,"position");gl.linkProgram(program);var programLog=gl.getProgramInfoLog(program);var vertexLog=gl.getShaderInfoLog(glVertexShader);var fragmentLog=gl.getShaderInfoLog(glFragmentShader);var runnable=true;var haveDiagnostics=true;if(gl.getProgramParameter(program,gl.LINK_STATUS)===false){runnable=false;console.error("THREE.WebGLProgram: shader error: ",gl.getError(),"gl.VALIDATE_STATUS",gl.getProgramParameter(program,gl.VALIDATE_STATUS),
"gl.getProgramInfoLog",programLog,vertexLog,fragmentLog)}else if(programLog!=="")console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",programLog);else if(vertexLog===""||fragmentLog==="")haveDiagnostics=false;if(haveDiagnostics)this.diagnostics={runnable:runnable,material:material,programLog:programLog,vertexShader:{log:vertexLog,prefix:prefixVertex},fragmentShader:{log:fragmentLog,prefix:prefixFragment}};gl.deleteShader(glVertexShader);gl.deleteShader(glFragmentShader);var cachedUniforms;this.getUniforms=
function(){if(cachedUniforms===undefined)cachedUniforms=new THREE.WebGLUniforms(gl,program,renderer);return cachedUniforms};var cachedAttributes;this.getAttributes=function(){if(cachedAttributes===undefined)cachedAttributes=fetchAttributeLocations(gl,program);return cachedAttributes};this.destroy=function(){gl.deleteProgram(program);this.program=undefined};Object.defineProperties(this,{uniforms:{get:function(){console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms().");return this.getUniforms()}},
attributes:{get:function(){console.warn("THREE.WebGLProgram: .attributes is now .getAttributes().");return this.getAttributes()}}});this.id=programIdCount++;this.code=code;this.usedTimes=1;this.program=program;this.vertexShader=glVertexShader;this.fragmentShader=glFragmentShader;return this}}();
THREE.WebGLPrograms=function(renderer,capabilities){var programs=[];var shaderIDs={MeshDepthMaterial:"depth",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points"};var parameterNames=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap",
"emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest",
"doubleSided","flipSided","numClippingPlanes","depthPacking"];function allocateBones(object){if(capabilities.floatVertexTextures&&object&&object.skeleton&&object.skeleton.useVertexTexture)return 1024;else{var nVertexUniforms=capabilities.maxVertexUniforms;var nVertexMatrices=Math.floor((nVertexUniforms-20)/4);var maxBones=nVertexMatrices;if(object!==undefined&&object instanceof THREE.SkinnedMesh){maxBones=Math.min(object.skeleton.bones.length,maxBones);if(maxBones<object.skeleton.bones.length)console.warn("WebGLRenderer: too many bones - "+
object.skeleton.bones.length+", this GPU supports just "+maxBones+" (try OpenGL instead of ANGLE)")}return maxBones}}function getTextureEncodingFromMap(map,gammaOverrideLinear){var encoding;if(!map)encoding=THREE.LinearEncoding;else if(map instanceof THREE.Texture)encoding=map.encoding;else if(map instanceof THREE.WebGLRenderTarget){console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead.");encoding=map.texture.encoding}if(encoding===
THREE.LinearEncoding&&gammaOverrideLinear)encoding=THREE.GammaEncoding;return encoding}this.getParameters=function(material,lights,fog,nClipPlanes,object){var shaderID=shaderIDs[material.type];var maxBones=allocateBones(object);var precision=renderer.getPrecision();if(material.precision!==null){precision=capabilities.getMaxPrecision(material.precision);if(precision!==material.precision)console.warn("THREE.WebGLProgram.getParameters:",material.precision,"not supported, using",precision,"instead.")}var currentRenderTarget=
renderer.getCurrentRenderTarget();var parameters={shaderID:shaderID,precision:precision,supportsVertexTextures:capabilities.vertexTextures,outputEncoding:getTextureEncodingFromMap(!currentRenderTarget?null:currentRenderTarget.texture,renderer.gammaOutput),map:!!material.map,mapEncoding:getTextureEncodingFromMap(material.map,renderer.gammaInput),envMap:!!material.envMap,envMapMode:material.envMap&&material.envMap.mapping,envMapEncoding:getTextureEncodingFromMap(material.envMap,renderer.gammaInput),
envMapCubeUV:!!material.envMap&&(material.envMap.mapping===THREE.CubeUVReflectionMapping||material.envMap.mapping===THREE.CubeUVRefractionMapping),lightMap:!!material.lightMap,aoMap:!!material.aoMap,emissiveMap:!!material.emissiveMap,emissiveMapEncoding:getTextureEncodingFromMap(material.emissiveMap,renderer.gammaInput),bumpMap:!!material.bumpMap,normalMap:!!material.normalMap,displacementMap:!!material.displacementMap,roughnessMap:!!material.roughnessMap,metalnessMap:!!material.metalnessMap,specularMap:!!material.specularMap,
alphaMap:!!material.alphaMap,combine:material.combine,vertexColors:material.vertexColors,fog:fog,useFog:material.fog,fogExp:fog instanceof THREE.FogExp2,flatShading:material.shading===THREE.FlatShading,sizeAttenuation:material.sizeAttenuation,logarithmicDepthBuffer:capabilities.logarithmicDepthBuffer,skinning:material.skinning,maxBones:maxBones,useVertexTexture:capabilities.floatVertexTextures&&object&&object.skeleton&&object.skeleton.useVertexTexture,morphTargets:material.morphTargets,morphNormals:material.morphNormals,
maxMorphTargets:renderer.maxMorphTargets,maxMorphNormals:renderer.maxMorphNormals,numDirLights:lights.directional.length,numPointLights:lights.point.length,numSpotLights:lights.spot.length,numHemiLights:lights.hemi.length,numClippingPlanes:nClipPlanes,shadowMapEnabled:renderer.shadowMap.enabled&&object.receiveShadow&&lights.shadows.length>0,shadowMapType:renderer.shadowMap.type,toneMapping:renderer.toneMapping,physicallyCorrectLights:renderer.physicallyCorrectLights,premultipliedAlpha:material.premultipliedAlpha,
alphaTest:material.alphaTest,doubleSided:material.side===THREE.DoubleSide,flipSided:material.side===THREE.BackSide,depthPacking:material.depthPacking!==undefined?material.depthPacking:false};return parameters};this.getProgramCode=function(material,parameters){var array=[];if(parameters.shaderID)array.push(parameters.shaderID);else{array.push(material.fragmentShader);array.push(material.vertexShader)}if(material.defines!==undefined)for(var name in material.defines){array.push(name);array.push(material.defines[name])}for(var i=
0;i<parameterNames.length;i++)array.push(parameters[parameterNames[i]]);return array.join()};this.acquireProgram=function(material,parameters,code){var program;for(var p=0,pl=programs.length;p<pl;p++){var programInfo=programs[p];if(programInfo.code===code){program=programInfo;++program.usedTimes;break}}if(program===undefined){program=new THREE.WebGLProgram(renderer,code,material,parameters);programs.push(program)}return program};this.releaseProgram=function(program){if(--program.usedTimes===0){var i=
programs.indexOf(program);programs[i]=programs[programs.length-1];programs.pop();program.destroy()}};this.programs=programs};THREE.WebGLProperties=function(){var properties={};this.get=function(object){var uuid=object.uuid;var map=properties[uuid];if(map===undefined){map={};properties[uuid]=map}return map};this["delete"]=function(object){delete properties[object.uuid]};this.clear=function(){properties={}}};
THREE.WebGLShader=function(){function addLineNumbers(string){var lines=string.split("\n");for(var i=0;i<lines.length;i++)lines[i]=i+1+": "+lines[i];return lines.join("\n")}return function WebGLShader(gl,type,string){var shader=gl.createShader(type);gl.shaderSource(shader,string);gl.compileShader(shader);if(gl.getShaderParameter(shader,gl.COMPILE_STATUS)===false)console.error("THREE.WebGLShader: Shader couldn't compile.");if(gl.getShaderInfoLog(shader)!=="")console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",
type===gl.VERTEX_SHADER?"vertex":"fragment",gl.getShaderInfoLog(shader),addLineNumbers(string));return shader}}();
THREE.WebGLShadowMap=function(_renderer,_lights,_objects){var _gl=_renderer.context,_state=_renderer.state,_frustum=new THREE.Frustum,_projScreenMatrix=new THREE.Matrix4,_lightShadows=_lights.shadows,_shadowMapSize=new THREE.Vector2,_lookTarget=new THREE.Vector3,_lightPositionWorld=new THREE.Vector3,_renderList=[],_MorphingFlag=1,_SkinningFlag=2,_NumberOfMaterialVariants=(_MorphingFlag|_SkinningFlag)+1,_depthMaterials=new Array(_NumberOfMaterialVariants),_distanceMaterials=new Array(_NumberOfMaterialVariants),
_materialCache={};var cubeDirections=[new THREE.Vector3(1,0,0),new THREE.Vector3(-1,0,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1),new THREE.Vector3(0,1,0),new THREE.Vector3(0,-1,0)];var cubeUps=[new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,1,0),new THREE.Vector3(0,0,1),new THREE.Vector3(0,0,-1)];var cube2DViewPorts=[new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4,new THREE.Vector4];var depthMaterialTemplate=
new THREE.MeshDepthMaterial;depthMaterialTemplate.depthPacking=THREE.RGBADepthPacking;depthMaterialTemplate.clipping=true;var distanceShader=THREE.ShaderLib["distanceRGBA"];var distanceUniforms=THREE.UniformsUtils.clone(distanceShader.uniforms);for(var i=0;i!==_NumberOfMaterialVariants;++i){var useMorphing=(i&_MorphingFlag)!==0;var useSkinning=(i&_SkinningFlag)!==0;var depthMaterial=depthMaterialTemplate.clone();depthMaterial.morphTargets=useMorphing;depthMaterial.skinning=useSkinning;_depthMaterials[i]=
depthMaterial;var distanceMaterial=new THREE.ShaderMaterial({defines:{"USE_SHADOWMAP":""},uniforms:distanceUniforms,vertexShader:distanceShader.vertexShader,fragmentShader:distanceShader.fragmentShader,morphTargets:useMorphing,skinning:useSkinning,clipping:true});_distanceMaterials[i]=distanceMaterial}var scope=this;this.enabled=false;this.autoUpdate=true;this.needsUpdate=false;this.type=THREE.PCFShadowMap;this.renderReverseSided=true;this.renderSingleSided=true;this.render=function(scene,camera){if(scope.enabled===
false)return;if(scope.autoUpdate===false&&scope.needsUpdate===false)return;if(_lightShadows.length===0)return;_state.clearColor(1,1,1,1);_state.disable(_gl.BLEND);_state.setDepthTest(true);_state.setScissorTest(false);var faceCount,isPointLight;for(var i=0,il=_lightShadows.length;i<il;i++){var light=_lightShadows[i];var shadow=light.shadow;if(shadow===undefined){console.warn("THREE.WebGLShadowMap:",light,"has no shadow.");continue}var shadowCamera=shadow.camera;_shadowMapSize.copy(shadow.mapSize);
if(light instanceof THREE.PointLight){faceCount=6;isPointLight=true;var vpWidth=_shadowMapSize.x;var vpHeight=_shadowMapSize.y;cube2DViewPorts[0].set(vpWidth*2,vpHeight,vpWidth,vpHeight);cube2DViewPorts[1].set(0,vpHeight,vpWidth,vpHeight);cube2DViewPorts[2].set(vpWidth*3,vpHeight,vpWidth,vpHeight);cube2DViewPorts[3].set(vpWidth,vpHeight,vpWidth,vpHeight);cube2DViewPorts[4].set(vpWidth*3,0,vpWidth,vpHeight);cube2DViewPorts[5].set(vpWidth,0,vpWidth,vpHeight);_shadowMapSize.x*=4;_shadowMapSize.y*=2}else{faceCount=
1;isPointLight=false}if(shadow.map===null){var pars={minFilter:THREE.NearestFilter,magFilter:THREE.NearestFilter,format:THREE.RGBAFormat};shadow.map=new THREE.WebGLRenderTarget(_shadowMapSize.x,_shadowMapSize.y,pars);shadowCamera.updateProjectionMatrix()}if(shadow instanceof THREE.SpotLightShadow)shadow.update(light);var shadowMap=shadow.map;var shadowMatrix=shadow.matrix;_lightPositionWorld.setFromMatrixPosition(light.matrixWorld);shadowCamera.position.copy(_lightPositionWorld);_renderer.setRenderTarget(shadowMap);
_renderer.clear();for(var face=0;face<faceCount;face++){if(isPointLight){_lookTarget.copy(shadowCamera.position);_lookTarget.add(cubeDirections[face]);shadowCamera.up.copy(cubeUps[face]);shadowCamera.lookAt(_lookTarget);var vpDimensions=cube2DViewPorts[face];_state.viewport(vpDimensions)}else{_lookTarget.setFromMatrixPosition(light.target.matrixWorld);shadowCamera.lookAt(_lookTarget)}shadowCamera.updateMatrixWorld();shadowCamera.matrixWorldInverse.getInverse(shadowCamera.matrixWorld);shadowMatrix.set(.5,
0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);shadowMatrix.multiply(shadowCamera.projectionMatrix);shadowMatrix.multiply(shadowCamera.matrixWorldInverse);_projScreenMatrix.multiplyMatrices(shadowCamera.projectionMatrix,shadowCamera.matrixWorldInverse);_frustum.setFromMatrix(_projScreenMatrix);_renderList.length=0;projectObject(scene,camera,shadowCamera);for(var j=0,jl=_renderList.length;j<jl;j++){var object=_renderList[j];var geometry=_objects.update(object);var material=object.material;if(material instanceof
THREE.MultiMaterial){var groups=geometry.groups;var materials=material.materials;for(var k=0,kl=groups.length;k<kl;k++){var group=groups[k];var groupMaterial=materials[group.materialIndex];if(groupMaterial.visible===true){var depthMaterial=getDepthMaterial(object,groupMaterial,isPointLight,_lightPositionWorld);_renderer.renderBufferDirect(shadowCamera,null,geometry,depthMaterial,object,group)}}}else{var depthMaterial=getDepthMaterial(object,material,isPointLight,_lightPositionWorld);_renderer.renderBufferDirect(shadowCamera,
null,geometry,depthMaterial,object,null)}}}}var clearColor=_renderer.getClearColor(),clearAlpha=_renderer.getClearAlpha();_renderer.setClearColor(clearColor,clearAlpha);scope.needsUpdate=false};function getDepthMaterial(object,material,isPointLight,lightPositionWorld){var geometry=object.geometry;var result=null;var materialVariants=_depthMaterials;var customMaterial=object.customDepthMaterial;if(isPointLight){materialVariants=_distanceMaterials;customMaterial=object.customDistanceMaterial}if(!customMaterial){var useMorphing=
geometry.morphTargets!==undefined&&geometry.morphTargets.length>0&&material.morphTargets;var useSkinning=object instanceof THREE.SkinnedMesh&&material.skinning;var variantIndex=0;if(useMorphing)variantIndex|=_MorphingFlag;if(useSkinning)variantIndex|=_SkinningFlag;result=materialVariants[variantIndex]}else result=customMaterial;if(_renderer.localClippingEnabled&&material.clipShadows===true&&material.clippingPlanes.length!==0){var keyA=result.uuid,keyB=material.uuid;var materialsForVariant=_materialCache[keyA];
if(materialsForVariant===undefined){materialsForVariant={};_materialCache[keyA]=materialsForVariant}var cachedMaterial=materialsForVariant[keyB];if(cachedMaterial===undefined){cachedMaterial=result.clone();materialsForVariant[keyB]=cachedMaterial}result=cachedMaterial}result.visible=material.visible;result.wireframe=material.wireframe;var side=material.side;if(scope.renderSingleSided&&side==THREE.DoubleSide)side=THREE.FrontSide;if(scope.renderReverseSided)if(side===THREE.FrontSide)side=THREE.BackSide;
else if(side===THREE.BackSide)side=THREE.FrontSide;result.side=side;result.clipShadows=material.clipShadows;result.clippingPlanes=material.clippingPlanes;result.wireframeLinewidth=material.wireframeLinewidth;result.linewidth=material.linewidth;if(isPointLight&&result.uniforms.lightPos!==undefined)result.uniforms.lightPos.value.copy(lightPositionWorld);return result}function projectObject(object,camera,shadowCamera){if(object.visible===false)return;if(object.layers.test(camera.layers)&&(object instanceof
THREE.Mesh||object instanceof THREE.Line||object instanceof THREE.Points))if(object.castShadow&&(object.frustumCulled===false||_frustum.intersectsObject(object)===true)){var material=object.material;if(material.visible===true){object.modelViewMatrix.multiplyMatrices(shadowCamera.matrixWorldInverse,object.matrixWorld);_renderList.push(object)}}var children=object.children;for(var i=0,l=children.length;i<l;i++)projectObject(children[i],camera,shadowCamera)}};
THREE.WebGLState=function(gl,extensions,paramThreeToGL){var _this=this;this.buffers={color:new THREE.WebGLColorBuffer(gl,this),depth:new THREE.WebGLDepthBuffer(gl,this),stencil:new THREE.WebGLStencilBuffer(gl,this)};var maxVertexAttributes=gl.getParameter(gl.MAX_VERTEX_ATTRIBS);var newAttributes=new Uint8Array(maxVertexAttributes);var enabledAttributes=new Uint8Array(maxVertexAttributes);var attributeDivisors=new Uint8Array(maxVertexAttributes);var capabilities={};var compressedTextureFormats=null;
var currentBlending=null;var currentBlendEquation=null;var currentBlendSrc=null;var currentBlendDst=null;var currentBlendEquationAlpha=null;var currentBlendSrcAlpha=null;var currentBlendDstAlpha=null;var currentPremultipledAlpha=false;var currentFlipSided=null;var currentCullFace=null;var currentLineWidth=null;var currentPolygonOffsetFactor=null;var currentPolygonOffsetUnits=null;var currentScissorTest=null;var maxTextures=gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);var currentTextureSlot=null;var currentBoundTextures=
{};var currentScissor=new THREE.Vector4;var currentViewport=new THREE.Vector4;function createTexture(type,target,count){var data=new Uint8Array(3);var texture=gl.createTexture();gl.bindTexture(type,texture);gl.texParameteri(type,gl.TEXTURE_MIN_FILTER,gl.NEAREST);gl.texParameteri(type,gl.TEXTURE_MAG_FILTER,gl.NEAREST);for(var i=0;i<count;i++)gl.texImage2D(target+i,0,gl.RGB,1,1,0,gl.RGB,gl.UNSIGNED_BYTE,data);return texture}var emptyTextures={};emptyTextures[gl.TEXTURE_2D]=createTexture(gl.TEXTURE_2D,
gl.TEXTURE_2D,1);emptyTextures[gl.TEXTURE_CUBE_MAP]=createTexture(gl.TEXTURE_CUBE_MAP,gl.TEXTURE_CUBE_MAP_POSITIVE_X,6);this.init=function(){this.clearColor(0,0,0,1);this.clearDepth(1);this.clearStencil(0);this.enable(gl.DEPTH_TEST);this.setDepthFunc(THREE.LessEqualDepth);this.setFlipSided(false);this.setCullFace(THREE.CullFaceBack);this.enable(gl.CULL_FACE);this.enable(gl.BLEND);this.setBlending(THREE.NormalBlending)};this.initAttributes=function(){for(var i=0,l=newAttributes.length;i<l;i++)newAttributes[i]=
0};this.enableAttribute=function(attribute){newAttributes[attribute]=1;if(enabledAttributes[attribute]===0){gl.enableVertexAttribArray(attribute);enabledAttributes[attribute]=1}if(attributeDivisors[attribute]!==0){var extension=extensions.get("ANGLE_instanced_arrays");extension.vertexAttribDivisorANGLE(attribute,0);attributeDivisors[attribute]=0}};this.enableAttributeAndDivisor=function(attribute,meshPerAttribute,extension){newAttributes[attribute]=1;if(enabledAttributes[attribute]===0){gl.enableVertexAttribArray(attribute);
enabledAttributes[attribute]=1}if(attributeDivisors[attribute]!==meshPerAttribute){extension.vertexAttribDivisorANGLE(attribute,meshPerAttribute);attributeDivisors[attribute]=meshPerAttribute}};this.disableUnusedAttributes=function(){for(var i=0,l=enabledAttributes.length;i!==l;++i)if(enabledAttributes[i]!==newAttributes[i]){gl.disableVertexAttribArray(i);enabledAttributes[i]=0}};this.enable=function(id){if(capabilities[id]!==true){gl.enable(id);capabilities[id]=true}};this.disable=function(id){if(capabilities[id]!==
false){gl.disable(id);capabilities[id]=false}};this.getCompressedTextureFormats=function(){if(compressedTextureFormats===null){compressedTextureFormats=[];if(extensions.get("WEBGL_compressed_texture_pvrtc")||extensions.get("WEBGL_compressed_texture_s3tc")||extensions.get("WEBGL_compressed_texture_etc1")){var formats=gl.getParameter(gl.COMPRESSED_TEXTURE_FORMATS);for(var i=0;i<formats.length;i++)compressedTextureFormats.push(formats[i])}}return compressedTextureFormats};this.setBlending=function(blending,
blendEquation,blendSrc,blendDst,blendEquationAlpha,blendSrcAlpha,blendDstAlpha,premultipliedAlpha){if(blending!==THREE.NoBlending)this.enable(gl.BLEND);else{this.disable(gl.BLEND);currentBlending=blending;return}if(blending!==currentBlending||premultipliedAlpha!==currentPremultipledAlpha){if(blending===THREE.AdditiveBlending)if(premultipliedAlpha){gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE,gl.ONE,gl.ONE,gl.ONE)}else{gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.SRC_ALPHA,
gl.ONE)}else if(blending===THREE.SubtractiveBlending)if(premultipliedAlpha){gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ZERO,gl.ZERO,gl.ONE_MINUS_SRC_COLOR,gl.ONE_MINUS_SRC_ALPHA)}else{gl.blendEquation(gl.FUNC_ADD);gl.blendFunc(gl.ZERO,gl.ONE_MINUS_SRC_COLOR)}else if(blending===THREE.MultiplyBlending)if(premultipliedAlpha){gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ZERO,gl.SRC_COLOR,gl.ZERO,gl.SRC_ALPHA)}else{gl.blendEquation(gl.FUNC_ADD);
gl.blendFunc(gl.ZERO,gl.SRC_COLOR)}else if(premultipliedAlpha){gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.ONE,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA)}else{gl.blendEquationSeparate(gl.FUNC_ADD,gl.FUNC_ADD);gl.blendFuncSeparate(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA,gl.ONE,gl.ONE_MINUS_SRC_ALPHA)}currentBlending=blending;currentPremultipledAlpha=premultipliedAlpha}if(blending===THREE.CustomBlending){blendEquationAlpha=blendEquationAlpha||blendEquation;blendSrcAlpha=
blendSrcAlpha||blendSrc;blendDstAlpha=blendDstAlpha||blendDst;if(blendEquation!==currentBlendEquation||blendEquationAlpha!==currentBlendEquationAlpha){gl.blendEquationSeparate(paramThreeToGL(blendEquation),paramThreeToGL(blendEquationAlpha));currentBlendEquation=blendEquation;currentBlendEquationAlpha=blendEquationAlpha}if(blendSrc!==currentBlendSrc||blendDst!==currentBlendDst||blendSrcAlpha!==currentBlendSrcAlpha||blendDstAlpha!==currentBlendDstAlpha){gl.blendFuncSeparate(paramThreeToGL(blendSrc),
paramThreeToGL(blendDst),paramThreeToGL(blendSrcAlpha),paramThreeToGL(blendDstAlpha));currentBlendSrc=blendSrc;currentBlendDst=blendDst;currentBlendSrcAlpha=blendSrcAlpha;currentBlendDstAlpha=blendDstAlpha}}else{currentBlendEquation=null;currentBlendSrc=null;currentBlendDst=null;currentBlendEquationAlpha=null;currentBlendSrcAlpha=null;currentBlendDstAlpha=null}};this.setColorWrite=function(colorWrite){this.buffers.color.setMask(colorWrite)};this.setDepthTest=function(depthTest){this.buffers.depth.setTest(depthTest)};
this.setDepthWrite=function(depthWrite){this.buffers.depth.setMask(depthWrite)};this.setDepthFunc=function(depthFunc){this.buffers.depth.setFunc(depthFunc)};this.setStencilTest=function(stencilTest){this.buffers.stencil.setTest(stencilTest)};this.setStencilWrite=function(stencilWrite){this.buffers.stencil.setMask(stencilWrite)};this.setStencilFunc=function(stencilFunc,stencilRef,stencilMask){this.buffers.stencil.setFunc(stencilFunc,stencilRef,stencilMask)};this.setStencilOp=function(stencilFail,stencilZFail,
stencilZPass){this.buffers.stencil.setOp(stencilFail,stencilZFail,stencilZPass)};this.setFlipSided=function(flipSided){if(currentFlipSided!==flipSided){if(flipSided)gl.frontFace(gl.CW);else gl.frontFace(gl.CCW);currentFlipSided=flipSided}};this.setCullFace=function(cullFace){if(cullFace!==THREE.CullFaceNone){this.enable(gl.CULL_FACE);if(cullFace!==currentCullFace)if(cullFace===THREE.CullFaceBack)gl.cullFace(gl.BACK);else if(cullFace===THREE.CullFaceFront)gl.cullFace(gl.FRONT);else gl.cullFace(gl.FRONT_AND_BACK)}else this.disable(gl.CULL_FACE);
currentCullFace=cullFace};this.setLineWidth=function(width){if(width!==currentLineWidth){gl.lineWidth(width);currentLineWidth=width}};this.setPolygonOffset=function(polygonOffset,factor,units){if(polygonOffset){this.enable(gl.POLYGON_OFFSET_FILL);if(currentPolygonOffsetFactor!==factor||currentPolygonOffsetUnits!==units){gl.polygonOffset(factor,units);currentPolygonOffsetFactor=factor;currentPolygonOffsetUnits=units}}else this.disable(gl.POLYGON_OFFSET_FILL)};this.getScissorTest=function(){return currentScissorTest};
this.setScissorTest=function(scissorTest){currentScissorTest=scissorTest;if(scissorTest)this.enable(gl.SCISSOR_TEST);else this.disable(gl.SCISSOR_TEST)};this.activeTexture=function(webglSlot){if(webglSlot===undefined)webglSlot=gl.TEXTURE0+maxTextures-1;if(currentTextureSlot!==webglSlot){gl.activeTexture(webglSlot);currentTextureSlot=webglSlot}};this.bindTexture=function(webglType,webglTexture){if(currentTextureSlot===null)_this.activeTexture();var boundTexture=currentBoundTextures[currentTextureSlot];
if(boundTexture===undefined){boundTexture={type:undefined,texture:undefined};currentBoundTextures[currentTextureSlot]=boundTexture}if(boundTexture.type!==webglType||boundTexture.texture!==webglTexture){gl.bindTexture(webglType,webglTexture||emptyTextures[webglType]);boundTexture.type=webglType;boundTexture.texture=webglTexture}};this.compressedTexImage2D=function(){try{gl.compressedTexImage2D.apply(gl,arguments)}catch(error){console.error(error)}};this.texImage2D=function(){try{gl.texImage2D.apply(gl,
arguments)}catch(error){console.error(error)}};this.clearColor=function(r,g,b,a){this.buffers.color.setClear(r,g,b,a)};this.clearDepth=function(depth){this.buffers.depth.setClear(depth)};this.clearStencil=function(stencil){this.buffers.stencil.setClear(stencil)};this.scissor=function(scissor){if(currentScissor.equals(scissor)===false){gl.scissor(scissor.x,scissor.y,scissor.z,scissor.w);currentScissor.copy(scissor)}};this.viewport=function(viewport){if(currentViewport.equals(viewport)===false){gl.viewport(viewport.x,
viewport.y,viewport.z,viewport.w);currentViewport.copy(viewport)}};this.reset=function(){for(var i=0;i<enabledAttributes.length;i++)if(enabledAttributes[i]===1){gl.disableVertexAttribArray(i);enabledAttributes[i]=0}capabilities={};compressedTextureFormats=null;currentTextureSlot=null;currentBoundTextures={};currentBlending=null;currentFlipSided=null;currentCullFace=null;this.buffers.color.reset();this.buffers.depth.reset();this.buffers.stencil.reset()}};
THREE.WebGLColorBuffer=function(gl,state){var locked=false;var color=new THREE.Vector4;var currentColorMask=null;var currentColorClear=new THREE.Vector4;this.setMask=function(colorMask){if(currentColorMask!==colorMask&&!locked){gl.colorMask(colorMask,colorMask,colorMask,colorMask);currentColorMask=colorMask}};this.setLocked=function(lock){locked=lock};this.setClear=function(r,g,b,a){color.set(r,g,b,a);if(currentColorClear.equals(color)===false){gl.clearColor(r,g,b,a);currentColorClear.copy(color)}};
this.reset=function(){locked=false;currentColorMask=null;currentColorClear=new THREE.Vector4}};
THREE.WebGLDepthBuffer=function(gl,state){var locked=false;var currentDepthMask=null;var currentDepthFunc=null;var currentDepthClear=null;this.setTest=function(depthTest){if(depthTest)state.enable(gl.DEPTH_TEST);else state.disable(gl.DEPTH_TEST)};this.setMask=function(depthMask){if(currentDepthMask!==depthMask&&!locked){gl.depthMask(depthMask);currentDepthMask=depthMask}};this.setFunc=function(depthFunc){if(currentDepthFunc!==depthFunc){if(depthFunc)switch(depthFunc){case THREE.NeverDepth:gl.depthFunc(gl.NEVER);
break;case THREE.AlwaysDepth:gl.depthFunc(gl.ALWAYS);break;case THREE.LessDepth:gl.depthFunc(gl.LESS);break;case THREE.LessEqualDepth:gl.depthFunc(gl.LEQUAL);break;case THREE.EqualDepth:gl.depthFunc(gl.EQUAL);break;case THREE.GreaterEqualDepth:gl.depthFunc(gl.GEQUAL);break;case THREE.GreaterDepth:gl.depthFunc(gl.GREATER);break;case THREE.NotEqualDepth:gl.depthFunc(gl.NOTEQUAL);break;default:gl.depthFunc(gl.LEQUAL)}else gl.depthFunc(gl.LEQUAL);currentDepthFunc=depthFunc}};this.setLocked=function(lock){locked=
lock};this.setClear=function(depth){if(currentDepthClear!==depth){gl.clearDepth(depth);currentDepthClear=depth}};this.reset=function(){locked=false;currentDepthMask=null;currentDepthFunc=null;currentDepthClear=null}};
THREE.WebGLStencilBuffer=function(gl,state){var locked=false;var currentStencilMask=null;var currentStencilFunc=null;var currentStencilRef=null;var currentStencilFuncMask=null;var currentStencilFail=null;var currentStencilZFail=null;var currentStencilZPass=null;var currentStencilClear=null;this.setTest=function(stencilTest){if(stencilTest)state.enable(gl.STENCIL_TEST);else state.disable(gl.STENCIL_TEST)};this.setMask=function(stencilMask){if(currentStencilMask!==stencilMask&&!locked){gl.stencilMask(stencilMask);
currentStencilMask=stencilMask}};this.setFunc=function(stencilFunc,stencilRef,stencilMask){if(currentStencilFunc!==stencilFunc||currentStencilRef!==stencilRef||currentStencilFuncMask!==stencilMask){gl.stencilFunc(stencilFunc,stencilRef,stencilMask);currentStencilFunc=stencilFunc;currentStencilRef=stencilRef;currentStencilFuncMask=stencilMask}};this.setOp=function(stencilFail,stencilZFail,stencilZPass){if(currentStencilFail!==stencilFail||currentStencilZFail!==stencilZFail||currentStencilZPass!==stencilZPass){gl.stencilOp(stencilFail,
stencilZFail,stencilZPass);currentStencilFail=stencilFail;currentStencilZFail=stencilZFail;currentStencilZPass=stencilZPass}};this.setLocked=function(lock){locked=lock};this.setClear=function(stencil){if(currentStencilClear!==stencil){gl.clearStencil(stencil);currentStencilClear=stencil}};this.reset=function(){locked=false;currentStencilMask=null;currentStencilFunc=null;currentStencilRef=null;currentStencilFuncMask=null;currentStencilFail=null;currentStencilZFail=null;currentStencilZPass=null;currentStencilClear=
null}};
THREE.WebGLUniforms=function(){var UniformContainer=function(){this.seq=[];this.map={}},arrayCacheF32=[],arrayCacheI32=[],uncacheTemporaryArrays=function(){arrayCacheF32.length=0;arrayCacheI32.length=0},flatten=function(array,nBlocks,blockSize){var firstElem=array[0];if(firstElem<=0||firstElem>0)return array;var n=nBlocks*blockSize,r=arrayCacheF32[n];if(r===undefined){r=new Float32Array(n);arrayCacheF32[n]=r}if(nBlocks!==0){firstElem.toArray(r,0);for(var i=1,offset=0;i!==nBlocks;++i){offset+=blockSize;
array[i].toArray(r,offset)}}return r},allocTexUnits=function(renderer,n){var r=arrayCacheI32[n];if(r===undefined){r=new Int32Array(n);arrayCacheI32[n]=r}for(var i=0;i!==n;++i)r[i]=renderer.allocTextureUnit();return r},setValue1f=function(gl,v){gl.uniform1f(this.addr,v)},setValue1i=function(gl,v){gl.uniform1i(this.addr,v)},setValue2fv=function(gl,v){if(v.x===undefined)gl.uniform2fv(this.addr,v);else gl.uniform2f(this.addr,v.x,v.y)},setValue3fv=function(gl,v){if(v.x!==undefined)gl.uniform3f(this.addr,
v.x,v.y,v.z);else if(v.r!==undefined)gl.uniform3f(this.addr,v.r,v.g,v.b);else gl.uniform3fv(this.addr,v)},setValue4fv=function(gl,v){if(v.x===undefined)gl.uniform4fv(this.addr,v);else gl.uniform4f(this.addr,v.x,v.y,v.z,v.w)},setValue2fm=function(gl,v){gl.uniformMatrix2fv(this.addr,false,v.elements||v)},setValue3fm=function(gl,v){gl.uniformMatrix3fv(this.addr,false,v.elements||v)},setValue4fm=function(gl,v){gl.uniformMatrix4fv(this.addr,false,v.elements||v)},setValueT1=function(gl,v,renderer){var unit=
renderer.allocTextureUnit();gl.uniform1i(this.addr,unit);if(v)renderer.setTexture2D(v,unit)},setValueT6=function(gl,v,renderer){var unit=renderer.allocTextureUnit();gl.uniform1i(this.addr,unit);if(v)renderer.setTextureCube(v,unit)},setValue2iv=function(gl,v){gl.uniform2iv(this.addr,v)},setValue3iv=function(gl,v){gl.uniform3iv(this.addr,v)},setValue4iv=function(gl,v){gl.uniform4iv(this.addr,v)},getSingularSetter=function(type){switch(type){case 5126:return setValue1f;case 35664:return setValue2fv;
case 35665:return setValue3fv;case 35666:return setValue4fv;case 35674:return setValue2fm;case 35675:return setValue3fm;case 35676:return setValue4fm;case 35678:return setValueT1;case 35680:return setValueT6;case 5124:case 35670:return setValue1i;case 35667:case 35671:return setValue2iv;case 35668:case 35672:return setValue3iv;case 35669:case 35673:return setValue4iv}},setValue1fv=function(gl,v){gl.uniform1fv(this.addr,v)},setValue1iv=function(gl,v){gl.uniform1iv(this.addr,v)},setValueV2a=function(gl,
v){gl.uniform2fv(this.addr,flatten(v,this.size,2))},setValueV3a=function(gl,v){gl.uniform3fv(this.addr,flatten(v,this.size,3))},setValueV4a=function(gl,v){gl.uniform4fv(this.addr,flatten(v,this.size,4))},setValueM2a=function(gl,v){gl.uniformMatrix2fv(this.addr,false,flatten(v,this.size,4))},setValueM3a=function(gl,v){gl.uniformMatrix3fv(this.addr,false,flatten(v,this.size,9))},setValueM4a=function(gl,v){gl.uniformMatrix4fv(this.addr,false,flatten(v,this.size,16))},setValueT1a=function(gl,v,renderer){var n=
v.length,units=allocTexUnits(renderer,n);gl.uniform1iv(this.addr,units);for(var i=0;i!==n;++i){var tex=v[i];if(tex)renderer.setTexture2D(tex,units[i])}},setValueT6a=function(gl,v,renderer){var n=v.length,units=allocTexUnits(renderer,n);gl.uniform1iv(this.addr,units);for(var i=0;i!==n;++i){var tex=v[i];if(tex)renderer.setTextureCube(tex,units[i])}},getPureArraySetter=function(type){switch(type){case 5126:return setValue1fv;case 35664:return setValueV2a;case 35665:return setValueV3a;case 35666:return setValueV4a;
case 35674:return setValueM2a;case 35675:return setValueM3a;case 35676:return setValueM4a;case 35678:return setValueT1a;case 35680:return setValueT6a;case 5124:case 35670:return setValue1iv;case 35667:case 35671:return setValue2iv;case 35668:case 35672:return setValue3iv;case 35669:case 35673:return setValue4iv}},SingleUniform=function SingleUniform(id,activeInfo,addr){this.id=id;this.addr=addr;this.setValue=getSingularSetter(activeInfo.type)},PureArrayUniform=function(id,activeInfo,addr){this.id=
id;this.addr=addr;this.size=activeInfo.size;this.setValue=getPureArraySetter(activeInfo.type)},StructuredUniform=function(id){this.id=id;UniformContainer.call(this)};StructuredUniform.prototype.setValue=function(gl,value){var seq=this.seq;for(var i=0,n=seq.length;i!==n;++i){var u=seq[i];u.setValue(gl,value[u.id])}};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g,addUniform=function(container,uniformObject){container.seq.push(uniformObject);container.map[uniformObject.id]=uniformObject},parseUniform=function(activeInfo,
addr,container){var path=activeInfo.name,pathLength=path.length;RePathPart.lastIndex=0;for(;;){var match=RePathPart.exec(path),matchEnd=RePathPart.lastIndex,id=match[1],idIsIndex=match[2]==="]",subscript=match[3];if(idIsIndex)id=id|0;if(subscript===undefined||subscript==="["&&matchEnd+2===pathLength){addUniform(container,subscript===undefined?new SingleUniform(id,activeInfo,addr):new PureArrayUniform(id,activeInfo,addr));break}else{var map=container.map,next=map[id];if(next===undefined){next=new StructuredUniform(id);
addUniform(container,next)}container=next}}},WebGLUniforms=function WebGLUniforms(gl,program,renderer){UniformContainer.call(this);this.renderer=renderer;var n=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(var i=0;i!==n;++i){var info=gl.getActiveUniform(program,i),path=info.name,addr=gl.getUniformLocation(program,path);parseUniform(info,addr,this)}};WebGLUniforms.prototype.setValue=function(gl,name,value){var u=this.map[name];if(u!==undefined)u.setValue(gl,value,this.renderer)};WebGLUniforms.prototype.set=
function(gl,object,name){var u=this.map[name];if(u!==undefined)u.setValue(gl,object[name],this.renderer)};WebGLUniforms.prototype.setOptional=function(gl,object,name){var v=object[name];if(v!==undefined)this.setValue(gl,name,v)};WebGLUniforms.upload=function(gl,seq,values,renderer){for(var i=0,n=seq.length;i!==n;++i){var u=seq[i],v=values[u.id];if(v.needsUpdate!==false)u.setValue(gl,v.value,renderer)}};WebGLUniforms.seqWithValue=function(seq,values){var r=[];for(var i=0,n=seq.length;i!==n;++i){var u=
seq[i];if(u.id in values)r.push(u)}return r};WebGLUniforms.splitDynamic=function(seq,values){var r=null,n=seq.length,w=0;for(var i=0;i!==n;++i){var u=seq[i],v=values[u.id];if(v&&v.dynamic===true){if(r===null)r=[];r.push(u)}else{if(w<i)seq[w]=u;++w}}if(w<n)seq.length=w;return r};WebGLUniforms.evalDynamic=function(seq,values,object,camera){for(var i=0,n=seq.length;i!==n;++i){var v=values[seq[i].id],f=v.onUpdateCallback;if(f!==undefined)f.call(v,object,camera)}};return WebGLUniforms}();
THREE.LensFlarePlugin=function(renderer,flares){var gl=renderer.context;var state=renderer.state;var vertexBuffer,elementBuffer;var shader,program,attributes,uniforms;var tempTexture,occlusionTexture;function init(){var vertices=new Float32Array([-1,-1,0,0,1,-1,1,0,1,1,1,1,-1,1,0,1]);var faces=new Uint16Array([0,1,2,0,2,3]);vertexBuffer=gl.createBuffer();elementBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,
elementBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,faces,gl.STATIC_DRAW);tempTexture=gl.createTexture();occlusionTexture=gl.createTexture();state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGB,16,16,0,gl.RGB,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,
gl.NEAREST);state.bindTexture(gl.TEXTURE_2D,occlusionTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,16,16,0,gl.RGBA,gl.UNSIGNED_BYTE,null);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.NEAREST);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.NEAREST);shader={vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;",
"uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if ( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );",
"visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;",
"}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if ( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if ( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;",
"gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")};program=createProgram(shader);attributes={vertex:gl.getAttribLocation(program,"position"),uv:gl.getAttribLocation(program,"uv")};uniforms={renderType:gl.getUniformLocation(program,"renderType"),map:gl.getUniformLocation(program,"map"),occlusionMap:gl.getUniformLocation(program,"occlusionMap"),opacity:gl.getUniformLocation(program,"opacity"),color:gl.getUniformLocation(program,"color"),scale:gl.getUniformLocation(program,"scale"),
rotation:gl.getUniformLocation(program,"rotation"),screenPosition:gl.getUniformLocation(program,"screenPosition")}}this.render=function(scene,camera,viewport){if(flares.length===0)return;var tempPosition=new THREE.Vector3;var invAspect=viewport.w/viewport.z,halfViewportWidth=viewport.z*.5,halfViewportHeight=viewport.w*.5;var size=16/viewport.w,scale=new THREE.Vector2(size*invAspect,size);var screenPosition=new THREE.Vector3(1,1,0),screenPositionPixels=new THREE.Vector2(1,1);var validArea=new THREE.Box2;
validArea.min.set(0,0);validArea.max.set(viewport.z-16,viewport.w-16);if(program===undefined)init();gl.useProgram(program);state.initAttributes();state.enableAttribute(attributes.vertex);state.enableAttribute(attributes.uv);state.disableUnusedAttributes();gl.uniform1i(uniforms.occlusionMap,0);gl.uniform1i(uniforms.map,1);gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.vertexAttribPointer(attributes.vertex,2,gl.FLOAT,false,2*8,0);gl.vertexAttribPointer(attributes.uv,2,gl.FLOAT,false,2*8,8);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,
elementBuffer);state.disable(gl.CULL_FACE);state.setDepthWrite(false);for(var i=0,l=flares.length;i<l;i++){size=16/viewport.w;scale.set(size*invAspect,size);var flare=flares[i];tempPosition.set(flare.matrixWorld.elements[12],flare.matrixWorld.elements[13],flare.matrixWorld.elements[14]);tempPosition.applyMatrix4(camera.matrixWorldInverse);tempPosition.applyProjection(camera.projectionMatrix);screenPosition.copy(tempPosition);screenPositionPixels.x=viewport.x+screenPosition.x*halfViewportWidth+halfViewportWidth-
8;screenPositionPixels.y=viewport.y+screenPosition.y*halfViewportHeight+halfViewportHeight-8;if(validArea.containsPoint(screenPositionPixels)===true){state.activeTexture(gl.TEXTURE0);state.bindTexture(gl.TEXTURE_2D,null);state.activeTexture(gl.TEXTURE1);state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGB,screenPositionPixels.x,screenPositionPixels.y,16,16,0);gl.uniform1i(uniforms.renderType,0);gl.uniform2f(uniforms.scale,scale.x,scale.y);gl.uniform3f(uniforms.screenPosition,
screenPosition.x,screenPosition.y,screenPosition.z);state.disable(gl.BLEND);state.enable(gl.DEPTH_TEST);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0);state.activeTexture(gl.TEXTURE0);state.bindTexture(gl.TEXTURE_2D,occlusionTexture);gl.copyTexImage2D(gl.TEXTURE_2D,0,gl.RGBA,screenPositionPixels.x,screenPositionPixels.y,16,16,0);gl.uniform1i(uniforms.renderType,1);state.disable(gl.DEPTH_TEST);state.activeTexture(gl.TEXTURE1);state.bindTexture(gl.TEXTURE_2D,tempTexture);gl.drawElements(gl.TRIANGLES,
6,gl.UNSIGNED_SHORT,0);flare.positionScreen.copy(screenPosition);if(flare.customUpdateCallback)flare.customUpdateCallback(flare);else flare.updateLensFlares();gl.uniform1i(uniforms.renderType,2);state.enable(gl.BLEND);for(var j=0,jl=flare.lensFlares.length;j<jl;j++){var sprite=flare.lensFlares[j];if(sprite.opacity>.001&&sprite.scale>.001){screenPosition.x=sprite.x;screenPosition.y=sprite.y;screenPosition.z=sprite.z;size=sprite.size*sprite.scale/viewport.w;scale.x=size*invAspect;scale.y=size;gl.uniform3f(uniforms.screenPosition,
screenPosition.x,screenPosition.y,screenPosition.z);gl.uniform2f(uniforms.scale,scale.x,scale.y);gl.uniform1f(uniforms.rotation,sprite.rotation);gl.uniform1f(uniforms.opacity,sprite.opacity);gl.uniform3f(uniforms.color,sprite.color.r,sprite.color.g,sprite.color.b);state.setBlending(sprite.blending,sprite.blendEquation,sprite.blendSrc,sprite.blendDst);renderer.setTexture2D(sprite.texture,1);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0)}}}}state.enable(gl.CULL_FACE);state.enable(gl.DEPTH_TEST);
state.setDepthWrite(true);renderer.resetGLState()};function createProgram(shader){var program=gl.createProgram();var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);var vertexShader=gl.createShader(gl.VERTEX_SHADER);var prefix="precision "+renderer.getPrecision()+" float;\n";gl.shaderSource(fragmentShader,prefix+shader.fragmentShader);gl.shaderSource(vertexShader,prefix+shader.vertexShader);gl.compileShader(fragmentShader);gl.compileShader(vertexShader);gl.attachShader(program,fragmentShader);
gl.attachShader(program,vertexShader);gl.linkProgram(program);return program}};
THREE.SpritePlugin=function(renderer,sprites){var gl=renderer.context;var state=renderer.state;var vertexBuffer,elementBuffer;var program,attributes,uniforms;var texture;var spritePosition=new THREE.Vector3;var spriteRotation=new THREE.Quaternion;var spriteScale=new THREE.Vector3;function init(){var vertices=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]);var faces=new Uint16Array([0,1,2,0,2,3]);vertexBuffer=gl.createBuffer();elementBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,
vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,faces,gl.STATIC_DRAW);program=createProgram();attributes={position:gl.getAttribLocation(program,"position"),uv:gl.getAttribLocation(program,"uv")};uniforms={uvOffset:gl.getUniformLocation(program,"uvOffset"),uvScale:gl.getUniformLocation(program,"uvScale"),rotation:gl.getUniformLocation(program,"rotation"),scale:gl.getUniformLocation(program,
"scale"),color:gl.getUniformLocation(program,"color"),map:gl.getUniformLocation(program,"map"),opacity:gl.getUniformLocation(program,"opacity"),modelViewMatrix:gl.getUniformLocation(program,"modelViewMatrix"),projectionMatrix:gl.getUniformLocation(program,"projectionMatrix"),fogType:gl.getUniformLocation(program,"fogType"),fogDensity:gl.getUniformLocation(program,"fogDensity"),fogNear:gl.getUniformLocation(program,"fogNear"),fogFar:gl.getUniformLocation(program,"fogFar"),fogColor:gl.getUniformLocation(program,
"fogColor"),alphaTest:gl.getUniformLocation(program,"alphaTest")};var canvas=document.createElement("canvas");canvas.width=8;canvas.height=8;var context=canvas.getContext("2d");context.fillStyle="white";context.fillRect(0,0,8,8);texture=new THREE.Texture(canvas);texture.needsUpdate=true}this.render=function(scene,camera){if(sprites.length===0)return;if(program===undefined)init();gl.useProgram(program);state.initAttributes();state.enableAttribute(attributes.position);state.enableAttribute(attributes.uv);
state.disableUnusedAttributes();state.disable(gl.CULL_FACE);state.enable(gl.BLEND);gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer);gl.vertexAttribPointer(attributes.position,2,gl.FLOAT,false,2*8,0);gl.vertexAttribPointer(attributes.uv,2,gl.FLOAT,false,2*8,8);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,elementBuffer);gl.uniformMatrix4fv(uniforms.projectionMatrix,false,camera.projectionMatrix.elements);state.activeTexture(gl.TEXTURE0);gl.uniform1i(uniforms.map,0);var oldFogType=0;var sceneFogType=0;var fog=scene.fog;
if(fog){gl.uniform3f(uniforms.fogColor,fog.color.r,fog.color.g,fog.color.b);if(fog instanceof THREE.Fog){gl.uniform1f(uniforms.fogNear,fog.near);gl.uniform1f(uniforms.fogFar,fog.far);gl.uniform1i(uniforms.fogType,1);oldFogType=1;sceneFogType=1}else if(fog instanceof THREE.FogExp2){gl.uniform1f(uniforms.fogDensity,fog.density);gl.uniform1i(uniforms.fogType,2);oldFogType=2;sceneFogType=2}}else{gl.uniform1i(uniforms.fogType,0);oldFogType=0;sceneFogType=0}for(var i=0,l=sprites.length;i<l;i++){var sprite=
sprites[i];sprite.modelViewMatrix.multiplyMatrices(camera.matrixWorldInverse,sprite.matrixWorld);sprite.z=-sprite.modelViewMatrix.elements[14]}sprites.sort(painterSortStable);var scale=[];for(var i=0,l=sprites.length;i<l;i++){var sprite=sprites[i];var material=sprite.material;gl.uniform1f(uniforms.alphaTest,material.alphaTest);gl.uniformMatrix4fv(uniforms.modelViewMatrix,false,sprite.modelViewMatrix.elements);sprite.matrixWorld.decompose(spritePosition,spriteRotation,spriteScale);scale[0]=spriteScale.x;
scale[1]=spriteScale.y;var fogType=0;if(scene.fog&&material.fog)fogType=sceneFogType;if(oldFogType!==fogType){gl.uniform1i(uniforms.fogType,fogType);oldFogType=fogType}if(material.map!==null){gl.uniform2f(uniforms.uvOffset,material.map.offset.x,material.map.offset.y);gl.uniform2f(uniforms.uvScale,material.map.repeat.x,material.map.repeat.y)}else{gl.uniform2f(uniforms.uvOffset,0,0);gl.uniform2f(uniforms.uvScale,1,1)}gl.uniform1f(uniforms.opacity,material.opacity);gl.uniform3f(uniforms.color,material.color.r,
material.color.g,material.color.b);gl.uniform1f(uniforms.rotation,material.rotation);gl.uniform2fv(uniforms.scale,scale);state.setBlending(material.blending,material.blendEquation,material.blendSrc,material.blendDst);state.setDepthTest(material.depthTest);state.setDepthWrite(material.depthWrite);if(material.map)renderer.setTexture2D(material.map,0);else renderer.setTexture2D(texture,0);gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0)}state.enable(gl.CULL_FACE);renderer.resetGLState()};function createProgram(){var program=
gl.createProgram();var vertexShader=gl.createShader(gl.VERTEX_SHADER);var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(vertexShader,["precision "+renderer.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;",
"vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n"));gl.shaderSource(fragmentShader,["precision "+renderer.getPrecision()+
" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;",
"if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n"));gl.compileShader(vertexShader);gl.compileShader(fragmentShader);gl.attachShader(program,vertexShader);gl.attachShader(program,fragmentShader);gl.linkProgram(program);
return program}function painterSortStable(a,b){if(a.renderOrder!==b.renderOrder)return a.renderOrder-b.renderOrder;else if(a.z!==b.z)return b.z-a.z;else return b.id-a.id}};
Object.assign(THREE,{Face4:function(a,b,c,d,normal,color,materialIndex){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(a,b,c,normal,color,materialIndex)},LineStrip:0,LinePieces:1,MeshFaceMaterial:THREE.MultiMaterial,PointCloud:function(geometry,material){console.warn("THREE.PointCloud has been renamed to THREE.Points.");return new THREE.Points(geometry,material)},Particle:THREE.Sprite,ParticleSystem:function(geometry,material){console.warn("THREE.ParticleSystem has been renamed to THREE.Points.");
return new THREE.Points(geometry,material)},PointCloudMaterial:function(parameters){console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(parameters)},ParticleBasicMaterial:function(parameters){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial.");return new THREE.PointsMaterial(parameters)},ParticleSystemMaterial:function(parameters){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial.");
return new THREE.PointsMaterial(parameters)},Vertex:function(x,y,z){console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead.");return new THREE.Vector3(x,y,z)}});Object.assign(THREE.Box2.prototype,{empty:function(){console.warn("THREE.Box2: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(box){console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)}});
Object.assign(THREE.Box3.prototype,{empty:function(){console.warn("THREE.Box3: .empty() has been renamed to .isEmpty().");return this.isEmpty()},isIntersectionBox:function(box){console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)},isIntersectionSphere:function(sphere){console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(sphere)}});
Object.assign(THREE.Matrix3.prototype,{multiplyVector3:function(vector){console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return vector.applyMatrix3(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)}});
Object.assign(THREE.Matrix4.prototype,{extractPosition:function(m){console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(m)},setRotationFromQuaternion:function(q){console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(q)},multiplyVector3:function(vector){console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return vector.applyProjection(this)},multiplyVector4:function(vector){console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return vector.applyMatrix4(this)},multiplyVector3Array:function(a){console.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},rotateAxis:function(v){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
v.transformDirection(this)},crossVector:function(vector){console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return vector.applyMatrix4(this)},translate:function(v){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(angle){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(angle){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(angle){console.error("THREE.Matrix4: .rotateZ() has been removed.")},
rotateByAxis:function(axis,angle){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")}});Object.assign(THREE.Plane.prototype,{isIntersectionLine:function(line){console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine().");return this.intersectsLine(line)}});
Object.assign(THREE.Quaternion.prototype,{multiplyVector3:function(vector){console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return vector.applyQuaternion(this)}});
Object.assign(THREE.Ray.prototype,{isIntersectionBox:function(box){console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox().");return this.intersectsBox(box)},isIntersectionPlane:function(plane){console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane().");return this.intersectsPlane(plane)},isIntersectionSphere:function(sphere){console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere().");return this.intersectsSphere(sphere)}});
Object.assign(THREE.Vector3.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(m){console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(m)},
getScaleFromMatrix:function(m){console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(m)},getColumnFromMatrix:function(index,matrix){console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(matrix,index)}});
Object.assign(THREE.Object3D.prototype,{getChildByName:function(name){console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(name)},renderDepth:function(value){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(distance,axis){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(axis,distance)}});
Object.defineProperties(THREE.Object3D.prototype,{eulerOrder:{get:function(){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");return this.rotation.order},set:function(value){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order.");this.rotation.order=value}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(value){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});
Object.defineProperties(THREE.LOD.prototype,{objects:{get:function(){console.warn("THREE.LOD: .objects has been renamed to .levels.");return this.levels}}});THREE.PerspectiveCamera.prototype.setLens=function(focalLength,filmGauge){console.warn("THREE.PerspectiveCamera.setLens is deprecated. "+"Use .setFocalLength and .filmGauge for a photographic setup.");if(filmGauge!==undefined)this.filmGauge=filmGauge;this.setFocalLength(focalLength)};
Object.defineProperties(THREE.Light.prototype,{onlyShadow:{set:function(value){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(value){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov.");this.shadow.camera.fov=value}},shadowCameraLeft:{set:function(value){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left.");this.shadow.camera.left=value}},shadowCameraRight:{set:function(value){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right.");
this.shadow.camera.right=value}},shadowCameraTop:{set:function(value){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top.");this.shadow.camera.top=value}},shadowCameraBottom:{set:function(value){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom.");this.shadow.camera.bottom=value}},shadowCameraNear:{set:function(value){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near.");this.shadow.camera.near=value}},shadowCameraFar:{set:function(value){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far.");
this.shadow.camera.far=value}},shadowCameraVisible:{set:function(value){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(value){console.warn("THREE.Light: .shadowBias is now .shadow.bias.");this.shadow.bias=value}},shadowDarkness:{set:function(value){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(value){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width.");
this.shadow.mapSize.width=value}},shadowMapHeight:{set:function(value){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height.");this.shadow.mapSize.height=value}}});Object.defineProperties(THREE.BufferAttribute.prototype,{length:{get:function(){console.warn("THREE.BufferAttribute: .length has been deprecated. Please use .count.");return this.array.length}}});
Object.assign(THREE.BufferGeometry.prototype,{addIndex:function(index){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex().");this.setIndex(index)},addDrawCall:function(start,count,indexOffset){if(indexOffset!==undefined)console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset.");console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup().");this.addGroup(start,count)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups().");
this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}});
Object.defineProperties(THREE.BufferGeometry.prototype,{drawcalls:{get:function(){console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups.");return this.groups}},offsets:{get:function(){console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups.");return this.groups}}});
Object.defineProperties(THREE.Material.prototype,{wrapAround:{get:function(){console.warn("THREE."+this.type+": .wrapAround has been removed.")},set:function(value){console.warn("THREE."+this.type+": .wrapAround has been removed.")}},wrapRGB:{get:function(){console.warn("THREE."+this.type+": .wrapRGB has been removed.");return new THREE.Color}}});
Object.defineProperties(THREE.MeshPhongMaterial.prototype,{metal:{get:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead.");return false},set:function(value){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});
Object.defineProperties(THREE.ShaderMaterial.prototype,{derivatives:{get:function(){console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");return this.extensions.derivatives},set:function(value){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives.");this.extensions.derivatives=value}}});
THREE.EventDispatcher.prototype=Object.assign(Object.create({constructor:THREE.EventDispatcher,apply:function(target){console.warn("THREE.EventDispatcher: .apply is deprecated, "+"just inherit or Object.assign the prototype to mix-in.");Object.assign(target,this)}}),THREE.EventDispatcher.prototype);
Object.assign(THREE.WebGLRenderer.prototype,{supportsFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' ).");return this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' ).");return this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' ).");
return this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' ).");return this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' ).");return this.extensions.get("WEBGL_compressed_texture_pvrtc")},
supportsBlendMinMax:function(){console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' ).");return this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return this.capabilities.vertexTextures},supportsInstancedArrays:function(){console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' ).");return this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(boolean){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest().");
this.setScissorTest(boolean)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")}});
Object.defineProperties(THREE.WebGLRenderer.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(value){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled.");this.shadowMap.enabled=value}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(value){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type.");this.shadowMap.type=value}},shadowMapCullFace:{get:function(){return this.shadowMap.cullFace},set:function(value){console.warn("THREE.WebGLRenderer: .shadowMapCullFace is now .shadowMap.cullFace.");
this.shadowMap.cullFace=value}}});Object.defineProperties(THREE.WebGLShadowMap.prototype,{cullFace:{get:function(){return this.renderReverseSided?THREE.CullFaceFront:THREE.CullFaceBack},set:function(cullFace){var value=cullFace!==THREE.CullFaceBack;console.warn("WebGLRenderer: .shadowMap.cullFace is deprecated. Set .shadowMap.renderReverseSided to "+value+".");this.renderReverseSided=value}}});
Object.defineProperties(THREE.WebGLRenderTarget.prototype,{wrapS:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");return this.texture.wrapS},set:function(value){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS.");this.texture.wrapS=value}},wrapT:{get:function(){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");return this.texture.wrapT},set:function(value){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT.");
this.texture.wrapT=value}},magFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");return this.texture.magFilter},set:function(value){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter.");this.texture.magFilter=value}},minFilter:{get:function(){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");return this.texture.minFilter},set:function(value){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter.");
this.texture.minFilter=value}},anisotropy:{get:function(){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");return this.texture.anisotropy},set:function(value){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy.");this.texture.anisotropy=value}},offset:{get:function(){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");return this.texture.offset},set:function(value){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset.");
this.texture.offset=value}},repeat:{get:function(){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");return this.texture.repeat},set:function(value){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat.");this.texture.repeat=value}},format:{get:function(){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");return this.texture.format},set:function(value){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format.");this.texture.format=
value}},type:{get:function(){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");return this.texture.type},set:function(value){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type.");this.texture.type=value}},generateMipmaps:{get:function(){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");return this.texture.generateMipmaps},set:function(value){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps.");
this.texture.generateMipmaps=value}}});Object.assign(THREE.Audio.prototype,{load:function(file){console.warn("THREE.Audio: .load has been deprecated. Please use THREE.AudioLoader.");var scope=this;var audioLoader=new THREE.AudioLoader;audioLoader.load(file,function(buffer){scope.setBuffer(buffer)});return this}});Object.assign(THREE.AudioAnalyser.prototype,{getData:function(file){console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData().");return this.getFrequencyData()}});
THREE.GeometryUtils={merge:function(geometry1,geometry2,materialIndexOffset){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var matrix;if(geometry2 instanceof THREE.Mesh){geometry2.matrixAutoUpdate&&geometry2.updateMatrix();matrix=geometry2.matrix;geometry2=geometry2.geometry}geometry1.merge(geometry2,matrix,materialIndexOffset)},center:function(geometry){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");
return geometry.center()}};
THREE.ImageUtils={crossOrigin:undefined,loadTexture:function(url,mapping,onLoad,onError){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var loader=new THREE.TextureLoader;loader.setCrossOrigin(this.crossOrigin);var texture=loader.load(url,onLoad,undefined,onError);if(mapping)texture.mapping=mapping;return texture},loadTextureCube:function(urls,mapping,onLoad,onError){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var loader=
new THREE.CubeTextureLoader;loader.setCrossOrigin(this.crossOrigin);var texture=loader.load(urls,onLoad,undefined,onError);if(mapping)texture.mapping=mapping;return texture},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};
THREE.Projector=function(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js.");this.projectVector=function(vector,camera){console.warn("THREE.Projector: .projectVector() is now vector.project().");vector.project(camera)};this.unprojectVector=function(vector,camera){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject().");vector.unproject(camera)};this.pickingRay=function(vector,camera){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}};
THREE.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js");this.domElement=document.createElement("canvas");this.clear=function(){};this.render=function(){};this.setClearColor=function(){};this.setSize=function(){}};
THREE.CurveUtils={tangentQuadraticBezier:function(t,p0,p1,p2){return 2*(1-t)*(p1-p0)+2*t*(p2-p1)},tangentCubicBezier:function(t,p0,p1,p2,p3){return-3*p0*(1-t)*(1-t)+3*p1*(1-t)*(1-t)-6*t*p1*(1-t)+6*t*p2*(1-t)-3*t*t*p2+3*t*t*p3},tangentSpline:function(t,p0,p1,p2,p3){var h00=6*t*t-6*t;var h10=3*t*t-4*t+1;var h01=-6*t*t+6*t;var h11=3*t*t-2*t;return h00+h10+h01+h11},interpolate:function(p0,p1,p2,p3,t){var v0=(p2-p0)*.5;var v1=(p3-p1)*.5;var t2=t*t;var t3=t*t2;return(2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-
v1)*t2+v0*t+p1}};
THREE.SceneUtils={createMultiMaterialObject:function(geometry,materials){var group=new THREE.Group;for(var i=0,l=materials.length;i<l;i++)group.add(new THREE.Mesh(geometry,materials[i]));return group},detach:function(child,parent,scene){child.applyMatrix(parent.matrixWorld);parent.remove(child);scene.add(child)},attach:function(child,scene,parent){var matrixWorldInverse=new THREE.Matrix4;matrixWorldInverse.getInverse(parent.matrixWorld);child.applyMatrix(matrixWorldInverse);scene.remove(child);parent.add(child)}};
THREE.ShapeUtils={area:function(contour){var n=contour.length;var a=0;for(var p=n-1,q=0;q<n;p=q++)a+=contour[p].x*contour[q].y-contour[q].x*contour[p].y;return a*.5},triangulate:function(){function snip(contour,u,v,w,n,verts){var p;var ax,ay,bx,by;var cx,cy,px,py;ax=contour[verts[u]].x;ay=contour[verts[u]].y;bx=contour[verts[v]].x;by=contour[verts[v]].y;cx=contour[verts[w]].x;cy=contour[verts[w]].y;if(Number.EPSILON>(bx-ax)*(cy-ay)-(by-ay)*(cx-ax))return false;var aX,aY,bX,bY,cX,cY;var apx,apy,bpx,
bpy,cpx,cpy;var cCROSSap,bCROSScp,aCROSSbp;aX=cx-bx;aY=cy-by;bX=ax-cx;bY=ay-cy;cX=bx-ax;cY=by-ay;for(p=0;p<n;p++){px=contour[verts[p]].x;py=contour[verts[p]].y;if(px===ax&&py===ay||px===bx&&py===by||px===cx&&py===cy)continue;apx=px-ax;apy=py-ay;bpx=px-bx;bpy=py-by;cpx=px-cx;cpy=py-cy;aCROSSbp=aX*bpy-aY*bpx;cCROSSap=cX*apy-cY*apx;bCROSScp=bX*cpy-bY*cpx;if(aCROSSbp>=-Number.EPSILON&&bCROSScp>=-Number.EPSILON&&cCROSSap>=-Number.EPSILON)return false}return true}return function(contour,indices){var n=
contour.length;if(n<3)return null;var result=[],verts=[],vertIndices=[];var u,v,w;if(THREE.ShapeUtils.area(contour)>0)for(v=0;v<n;v++)verts[v]=v;else for(v=0;v<n;v++)verts[v]=n-1-v;var nv=n;var count=2*nv;for(v=nv-1;nv>2;){if(count--<=0){console.warn("THREE.ShapeUtils: Unable to triangulate polygon! in triangulate()");if(indices)return vertIndices;return result}u=v;if(nv<=u)u=0;v=u+1;if(nv<=v)v=0;w=v+1;if(nv<=w)w=0;if(snip(contour,u,v,w,nv,verts)){var a,b,c,s,t;a=verts[u];b=verts[v];c=verts[w];result.push([contour[a],
contour[b],contour[c]]);vertIndices.push([verts[u],verts[v],verts[w]]);for(s=v,t=v+1;t<nv;s++,t++)verts[s]=verts[t];nv--;count=2*nv}}if(indices)return vertIndices;return result}}(),triangulateShape:function(contour,holes){function point_in_segment_2D_colin(inSegPt1,inSegPt2,inOtherPt){if(inSegPt1.x!==inSegPt2.x)if(inSegPt1.x<inSegPt2.x)return inSegPt1.x<=inOtherPt.x&&inOtherPt.x<=inSegPt2.x;else return inSegPt2.x<=inOtherPt.x&&inOtherPt.x<=inSegPt1.x;else if(inSegPt1.y<inSegPt2.y)return inSegPt1.y<=
inOtherPt.y&&inOtherPt.y<=inSegPt2.y;else return inSegPt2.y<=inOtherPt.y&&inOtherPt.y<=inSegPt1.y}function intersect_segments_2D(inSeg1Pt1,inSeg1Pt2,inSeg2Pt1,inSeg2Pt2,inExcludeAdjacentSegs){var seg1dx=inSeg1Pt2.x-inSeg1Pt1.x,seg1dy=inSeg1Pt2.y-inSeg1Pt1.y;var seg2dx=inSeg2Pt2.x-inSeg2Pt1.x,seg2dy=inSeg2Pt2.y-inSeg2Pt1.y;var seg1seg2dx=inSeg1Pt1.x-inSeg2Pt1.x;var seg1seg2dy=inSeg1Pt1.y-inSeg2Pt1.y;var limit=seg1dy*seg2dx-seg1dx*seg2dy;var perpSeg1=seg1dy*seg1seg2dx-seg1dx*seg1seg2dy;if(Math.abs(limit)>
Number.EPSILON){var perpSeg2;if(limit>0){if(perpSeg1<0||perpSeg1>limit)return[];perpSeg2=seg2dy*seg1seg2dx-seg2dx*seg1seg2dy;if(perpSeg2<0||perpSeg2>limit)return[]}else{if(perpSeg1>0||perpSeg1<limit)return[];perpSeg2=seg2dy*seg1seg2dx-seg2dx*seg1seg2dy;if(perpSeg2>0||perpSeg2<limit)return[]}if(perpSeg2===0){if(inExcludeAdjacentSegs&&(perpSeg1===0||perpSeg1===limit))return[];return[inSeg1Pt1]}if(perpSeg2===limit){if(inExcludeAdjacentSegs&&(perpSeg1===0||perpSeg1===limit))return[];return[inSeg1Pt2]}if(perpSeg1===
0)return[inSeg2Pt1];if(perpSeg1===limit)return[inSeg2Pt2];var factorSeg1=perpSeg2/limit;return[{x:inSeg1Pt1.x+factorSeg1*seg1dx,y:inSeg1Pt1.y+factorSeg1*seg1dy}]}else{if(perpSeg1!==0||seg2dy*seg1seg2dx!==seg2dx*seg1seg2dy)return[];var seg1Pt=seg1dx===0&&seg1dy===0;var seg2Pt=seg2dx===0&&seg2dy===0;if(seg1Pt&&seg2Pt){if(inSeg1Pt1.x!==inSeg2Pt1.x||inSeg1Pt1.y!==inSeg2Pt1.y)return[];return[inSeg1Pt1]}if(seg1Pt){if(!point_in_segment_2D_colin(inSeg2Pt1,inSeg2Pt2,inSeg1Pt1))return[];return[inSeg1Pt1]}if(seg2Pt){if(!point_in_segment_2D_colin(inSeg1Pt1,
inSeg1Pt2,inSeg2Pt1))return[];return[inSeg2Pt1]}var seg1min,seg1max,seg1minVal,seg1maxVal;var seg2min,seg2max,seg2minVal,seg2maxVal;if(seg1dx!==0){if(inSeg1Pt1.x<inSeg1Pt2.x){seg1min=inSeg1Pt1;seg1minVal=inSeg1Pt1.x;seg1max=inSeg1Pt2;seg1maxVal=inSeg1Pt2.x}else{seg1min=inSeg1Pt2;seg1minVal=inSeg1Pt2.x;seg1max=inSeg1Pt1;seg1maxVal=inSeg1Pt1.x}if(inSeg2Pt1.x<inSeg2Pt2.x){seg2min=inSeg2Pt1;seg2minVal=inSeg2Pt1.x;seg2max=inSeg2Pt2;seg2maxVal=inSeg2Pt2.x}else{seg2min=inSeg2Pt2;seg2minVal=inSeg2Pt2.x;seg2max=
inSeg2Pt1;seg2maxVal=inSeg2Pt1.x}}else{if(inSeg1Pt1.y<inSeg1Pt2.y){seg1min=inSeg1Pt1;seg1minVal=inSeg1Pt1.y;seg1max=inSeg1Pt2;seg1maxVal=inSeg1Pt2.y}else{seg1min=inSeg1Pt2;seg1minVal=inSeg1Pt2.y;seg1max=inSeg1Pt1;seg1maxVal=inSeg1Pt1.y}if(inSeg2Pt1.y<inSeg2Pt2.y){seg2min=inSeg2Pt1;seg2minVal=inSeg2Pt1.y;seg2max=inSeg2Pt2;seg2maxVal=inSeg2Pt2.y}else{seg2min=inSeg2Pt2;seg2minVal=inSeg2Pt2.y;seg2max=inSeg2Pt1;seg2maxVal=inSeg2Pt1.y}}if(seg1minVal<=seg2minVal){if(seg1maxVal<seg2minVal)return[];if(seg1maxVal===
seg2minVal){if(inExcludeAdjacentSegs)return[];return[seg2min]}if(seg1maxVal<=seg2maxVal)return[seg2min,seg1max];return[seg2min,seg2max]}else{if(seg1minVal>seg2maxVal)return[];if(seg1minVal===seg2maxVal){if(inExcludeAdjacentSegs)return[];return[seg1min]}if(seg1maxVal<=seg2maxVal)return[seg1min,seg1max];return[seg1min,seg2max]}}}function isPointInsideAngle(inVertex,inLegFromPt,inLegToPt,inOtherPt){var legFromPtX=inLegFromPt.x-inVertex.x,legFromPtY=inLegFromPt.y-inVertex.y;var legToPtX=inLegToPt.x-inVertex.x,
legToPtY=inLegToPt.y-inVertex.y;var otherPtX=inOtherPt.x-inVertex.x,otherPtY=inOtherPt.y-inVertex.y;var from2toAngle=legFromPtX*legToPtY-legFromPtY*legToPtX;var from2otherAngle=legFromPtX*otherPtY-legFromPtY*otherPtX;if(Math.abs(from2toAngle)>Number.EPSILON){var other2toAngle=otherPtX*legToPtY-otherPtY*legToPtX;if(from2toAngle>0)return from2otherAngle>=0&&other2toAngle>=0;else return from2otherAngle>=0||other2toAngle>=0}else return from2otherAngle>0}function removeHoles(contour,holes){var shape=contour.concat();
var hole;function isCutLineInsideAngles(inShapeIdx,inHoleIdx){var lastShapeIdx=shape.length-1;var prevShapeIdx=inShapeIdx-1;if(prevShapeIdx<0)prevShapeIdx=lastShapeIdx;var nextShapeIdx=inShapeIdx+1;if(nextShapeIdx>lastShapeIdx)nextShapeIdx=0;var insideAngle=isPointInsideAngle(shape[inShapeIdx],shape[prevShapeIdx],shape[nextShapeIdx],hole[inHoleIdx]);if(!insideAngle)return false;var lastHoleIdx=hole.length-1;var prevHoleIdx=inHoleIdx-1;if(prevHoleIdx<0)prevHoleIdx=lastHoleIdx;var nextHoleIdx=inHoleIdx+
1;if(nextHoleIdx>lastHoleIdx)nextHoleIdx=0;insideAngle=isPointInsideAngle(hole[inHoleIdx],hole[prevHoleIdx],hole[nextHoleIdx],shape[inShapeIdx]);if(!insideAngle)return false;return true}function intersectsShapeEdge(inShapePt,inHolePt){var sIdx,nextIdx,intersection;for(sIdx=0;sIdx<shape.length;sIdx++){nextIdx=sIdx+1;nextIdx%=shape.length;intersection=intersect_segments_2D(inShapePt,inHolePt,shape[sIdx],shape[nextIdx],true);if(intersection.length>0)return true}return false}var indepHoles=[];function intersectsHoleEdge(inShapePt,
inHolePt){var ihIdx,chkHole,hIdx,nextIdx,intersection;for(ihIdx=0;ihIdx<indepHoles.length;ihIdx++){chkHole=holes[indepHoles[ihIdx]];for(hIdx=0;hIdx<chkHole.length;hIdx++){nextIdx=hIdx+1;nextIdx%=chkHole.length;intersection=intersect_segments_2D(inShapePt,inHolePt,chkHole[hIdx],chkHole[nextIdx],true);if(intersection.length>0)return true}}return false}var holeIndex,shapeIndex,shapePt,holePt,holeIdx,cutKey,failedCuts=[],tmpShape1,tmpShape2,tmpHole1,tmpHole2;for(var h=0,hl=holes.length;h<hl;h++)indepHoles.push(h);
var minShapeIndex=0;var counter=indepHoles.length*2;while(indepHoles.length>0){counter--;if(counter<0){console.log("Infinite Loop! Holes left:"+indepHoles.length+", Probably Hole outside Shape!");break}for(shapeIndex=minShapeIndex;shapeIndex<shape.length;shapeIndex++){shapePt=shape[shapeIndex];holeIndex=-1;for(var h=0;h<indepHoles.length;h++){holeIdx=indepHoles[h];cutKey=shapePt.x+":"+shapePt.y+":"+holeIdx;if(failedCuts[cutKey]!==undefined)continue;hole=holes[holeIdx];for(var h2=0;h2<hole.length;h2++){holePt=
hole[h2];if(!isCutLineInsideAngles(shapeIndex,h2))continue;if(intersectsShapeEdge(shapePt,holePt))continue;if(intersectsHoleEdge(shapePt,holePt))continue;holeIndex=h2;indepHoles.splice(h,1);tmpShape1=shape.slice(0,shapeIndex+1);tmpShape2=shape.slice(shapeIndex);tmpHole1=hole.slice(holeIndex);tmpHole2=hole.slice(0,holeIndex+1);shape=tmpShape1.concat(tmpHole1).concat(tmpHole2).concat(tmpShape2);minShapeIndex=shapeIndex;break}if(holeIndex>=0)break;failedCuts[cutKey]=true}if(holeIndex>=0)break}}return shape}
var i,il,f,face,key,index,allPointsMap={};var allpoints=contour.concat();for(var h=0,hl=holes.length;h<hl;h++)Array.prototype.push.apply(allpoints,holes[h]);for(i=0,il=allpoints.length;i<il;i++){key=allpoints[i].x+":"+allpoints[i].y;if(allPointsMap[key]!==undefined)console.warn("THREE.Shape: Duplicate point",key);allPointsMap[key]=i}var shapeWithoutHoles=removeHoles(contour,holes);var triangles=THREE.ShapeUtils.triangulate(shapeWithoutHoles,false);for(i=0,il=triangles.length;i<il;i++){face=triangles[i];
for(f=0;f<3;f++){key=face[f].x+":"+face[f].y;index=allPointsMap[key];if(index!==undefined)face[f]=index}}return triangles.concat()},isClockWise:function(pts){return THREE.ShapeUtils.area(pts)<0},b2:function(){function b2p0(t,p){var k=1-t;return k*k*p}function b2p1(t,p){return 2*(1-t)*t*p}function b2p2(t,p){return t*t*p}return function(t,p0,p1,p2){return b2p0(t,p0)+b2p1(t,p1)+b2p2(t,p2)}}(),b3:function(){function b3p0(t,p){var k=1-t;return k*k*k*p}function b3p1(t,p){var k=1-t;return 3*k*k*t*p}function b3p2(t,
p){var k=1-t;return 3*k*t*t*p}function b3p3(t,p){return t*t*t*p}return function(t,p0,p1,p2,p3){return b3p0(t,p0)+b3p1(t,p1)+b3p2(t,p2)+b3p3(t,p3)}}()};THREE.Curve=function(){};
THREE.Curve.prototype={constructor:THREE.Curve,getPoint:function(t){console.warn("THREE.Curve: Warning, getPoint() not implemented!");return null},getPointAt:function(u){var t=this.getUtoTmapping(u);return this.getPoint(t)},getPoints:function(divisions){if(!divisions)divisions=5;var d,pts=[];for(d=0;d<=divisions;d++)pts.push(this.getPoint(d/divisions));return pts},getSpacedPoints:function(divisions){if(!divisions)divisions=5;var d,pts=[];for(d=0;d<=divisions;d++)pts.push(this.getPointAt(d/divisions));
return pts},getLength:function(){var lengths=this.getLengths();return lengths[lengths.length-1]},getLengths:function(divisions){if(!divisions)divisions=this.__arcLengthDivisions?this.__arcLengthDivisions:200;if(this.cacheArcLengths&&this.cacheArcLengths.length===divisions+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=false;var cache=[];var current,last=this.getPoint(0);var p,sum=0;cache.push(0);for(p=1;p<=divisions;p++){current=this.getPoint(p/divisions);sum+=current.distanceTo(last);
cache.push(sum);last=current}this.cacheArcLengths=cache;return cache},updateArcLengths:function(){this.needsUpdate=true;this.getLengths()},getUtoTmapping:function(u,distance){var arcLengths=this.getLengths();var i=0,il=arcLengths.length;var targetArcLength;if(distance)targetArcLength=distance;else targetArcLength=u*arcLengths[il-1];var low=0,high=il-1,comparison;while(low<=high){i=Math.floor(low+(high-low)/2);comparison=arcLengths[i]-targetArcLength;if(comparison<0)low=i+1;else if(comparison>0)high=
i-1;else{high=i;break}}i=high;if(arcLengths[i]===targetArcLength){var t=i/(il-1);return t}var lengthBefore=arcLengths[i];var lengthAfter=arcLengths[i+1];var segmentLength=lengthAfter-lengthBefore;var segmentFraction=(targetArcLength-lengthBefore)/segmentLength;var t=(i+segmentFraction)/(il-1);return t},getTangent:function(t){var delta=1E-4;var t1=t-delta;var t2=t+delta;if(t1<0)t1=0;if(t2>1)t2=1;var pt1=this.getPoint(t1);var pt2=this.getPoint(t2);var vec=pt2.clone().sub(pt1);return vec.normalize()},
getTangentAt:function(u){var t=this.getUtoTmapping(u);return this.getTangent(t)}};THREE.Curve.create=function(constructor,getPointFunc){constructor.prototype=Object.create(THREE.Curve.prototype);constructor.prototype.constructor=constructor;constructor.prototype.getPoint=getPointFunc;return constructor};THREE.CurvePath=function(){this.curves=[];this.autoClose=false};
THREE.CurvePath.prototype=Object.assign(Object.create(THREE.Curve.prototype),{constructor:THREE.CurvePath,add:function(curve){this.curves.push(curve)},closePath:function(){var startPoint=this.curves[0].getPoint(0);var endPoint=this.curves[this.curves.length-1].getPoint(1);if(!startPoint.equals(endPoint))this.curves.push(new THREE.LineCurve(endPoint,startPoint))},getPoint:function(t){var d=t*this.getLength();var curveLengths=this.getCurveLengths();var i=0;while(i<curveLengths.length){if(curveLengths[i]>=
d){var diff=curveLengths[i]-d;var curve=this.curves[i];var u=1-diff/curve.getLength();return curve.getPointAt(u)}i++}return null},getLength:function(){var lens=this.getCurveLengths();return lens[lens.length-1]},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;var lengths=[],sums=0;for(var i=0,l=this.curves.length;i<l;i++){sums+=this.curves[i].getLength();lengths.push(sums)}this.cacheLengths=lengths;return lengths},createPointsGeometry:function(divisions){var pts=
this.getPoints(divisions);return this.createGeometry(pts)},createSpacedPointsGeometry:function(divisions){var pts=this.getSpacedPoints(divisions);return this.createGeometry(pts)},createGeometry:function(points){var geometry=new THREE.Geometry;for(var i=0,l=points.length;i<l;i++){var point=points[i];geometry.vertices.push(new THREE.Vector3(point.x,point.y,point.z||0))}return geometry}});THREE.Font=function(data){this.data=data};
Object.assign(THREE.Font.prototype,{generateShapes:function(text,size,divisions){function createPaths(text){var chars=String(text).split("");var scale=size/data.resolution;var offset=0;var paths=[];for(var i=0;i<chars.length;i++){var ret=createPath(chars[i],scale,offset);offset+=ret.offset;paths.push(ret.path)}return paths}function createPath(c,scale,offset){var glyph=data.glyphs[c]||data.glyphs["?"];if(!glyph)return;var path=new THREE.Path;var pts=[],b2=THREE.ShapeUtils.b2,b3=THREE.ShapeUtils.b3;
var x,y,cpx,cpy,cpx0,cpy0,cpx1,cpy1,cpx2,cpy2,laste;if(glyph.o){var outline=glyph._cachedOutline||(glyph._cachedOutline=glyph.o.split(" "));for(var i=0,l=outline.length;i<l;){var action=outline[i++];switch(action){case "m":x=outline[i++]*scale+offset;y=outline[i++]*scale;path.moveTo(x,y);break;case "l":x=outline[i++]*scale+offset;y=outline[i++]*scale;path.lineTo(x,y);break;case "q":cpx=outline[i++]*scale+offset;cpy=outline[i++]*scale;cpx1=outline[i++]*scale+offset;cpy1=outline[i++]*scale;path.quadraticCurveTo(cpx1,
cpy1,cpx,cpy);laste=pts[pts.length-1];if(laste){cpx0=laste.x;cpy0=laste.y;for(var i2=1;i2<=divisions;i2++){var t=i2/divisions;b2(t,cpx0,cpx1,cpx);b2(t,cpy0,cpy1,cpy)}}break;case "b":cpx=outline[i++]*scale+offset;cpy=outline[i++]*scale;cpx1=outline[i++]*scale+offset;cpy1=outline[i++]*scale;cpx2=outline[i++]*scale+offset;cpy2=outline[i++]*scale;path.bezierCurveTo(cpx1,cpy1,cpx2,cpy2,cpx,cpy);laste=pts[pts.length-1];if(laste){cpx0=laste.x;cpy0=laste.y;for(var i2=1;i2<=divisions;i2++){var t=i2/divisions;
b3(t,cpx0,cpx1,cpx2,cpx);b3(t,cpy0,cpy1,cpy2,cpy)}}break}}}return{offset:glyph.ha*scale,path:path}}if(size===undefined)size=100;if(divisions===undefined)divisions=4;var data=this.data;var paths=createPaths(text);var shapes=[];for(var p=0,pl=paths.length;p<pl;p++)Array.prototype.push.apply(shapes,paths[p].toShapes());return shapes}});THREE.Path=function(points){THREE.CurvePath.call(this);this.actions=[];if(points)this.fromPoints(points)};
THREE.Path.prototype=Object.assign(Object.create(THREE.CurvePath.prototype),{constructor:THREE.Path,fromPoints:function(vectors){this.moveTo(vectors[0].x,vectors[0].y);for(var i=1,l=vectors.length;i<l;i++)this.lineTo(vectors[i].x,vectors[i].y)},moveTo:function(x,y){this.actions.push({action:"moveTo",args:[x,y]})},lineTo:function(x,y){var lastargs=this.actions[this.actions.length-1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];var curve=new THREE.LineCurve(new THREE.Vector2(x0,
y0),new THREE.Vector2(x,y));this.curves.push(curve);this.actions.push({action:"lineTo",args:[x,y]})},quadraticCurveTo:function(aCPx,aCPy,aX,aY){var lastargs=this.actions[this.actions.length-1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];var curve=new THREE.QuadraticBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCPx,aCPy),new THREE.Vector2(aX,aY));this.curves.push(curve);this.actions.push({action:"quadraticCurveTo",args:[aCPx,aCPy,aX,aY]})},bezierCurveTo:function(aCP1x,
aCP1y,aCP2x,aCP2y,aX,aY){var lastargs=this.actions[this.actions.length-1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];var curve=new THREE.CubicBezierCurve(new THREE.Vector2(x0,y0),new THREE.Vector2(aCP1x,aCP1y),new THREE.Vector2(aCP2x,aCP2y),new THREE.Vector2(aX,aY));this.curves.push(curve);this.actions.push({action:"bezierCurveTo",args:[aCP1x,aCP1y,aCP2x,aCP2y,aX,aY]})},splineThru:function(pts){var args=Array.prototype.slice.call(arguments);var lastargs=this.actions[this.actions.length-
1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];var npts=[new THREE.Vector2(x0,y0)];Array.prototype.push.apply(npts,pts);var curve=new THREE.SplineCurve(npts);this.curves.push(curve);this.actions.push({action:"splineThru",args:args})},arc:function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){var lastargs=this.actions[this.actions.length-1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];this.absarc(aX+x0,aY+y0,aRadius,aStartAngle,aEndAngle,
aClockwise)},absarc:function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){this.absellipse(aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise)},ellipse:function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){var lastargs=this.actions[this.actions.length-1].args;var x0=lastargs[lastargs.length-2];var y0=lastargs[lastargs.length-1];this.absellipse(aX+x0,aY+y0,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation)},absellipse:function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,
aClockwise,aRotation){var args=[aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation||0];var curve=new THREE.EllipseCurve(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation);this.curves.push(curve);var lastPoint=curve.getPoint(1);args.push(lastPoint.x);args.push(lastPoint.y);this.actions.push({action:"ellipse",args:args})},getSpacedPoints:function(divisions){if(!divisions)divisions=40;var points=[];for(var i=0;i<divisions;i++)points.push(this.getPoint(i/divisions));if(this.autoClose)points.push(points[0]);
return points},getPoints:function(divisions){divisions=divisions||12;var b2=THREE.ShapeUtils.b2;var b3=THREE.ShapeUtils.b3;var points=[];var cpx,cpy,cpx2,cpy2,cpx1,cpy1,cpx0,cpy0,laste,tx,ty;for(var i=0,l=this.actions.length;i<l;i++){var item=this.actions[i];var action=item.action;var args=item.args;switch(action){case "moveTo":points.push(new THREE.Vector2(args[0],args[1]));break;case "lineTo":points.push(new THREE.Vector2(args[0],args[1]));break;case "quadraticCurveTo":cpx=args[2];cpy=args[3];cpx1=
args[0];cpy1=args[1];if(points.length>0){laste=points[points.length-1];cpx0=laste.x;cpy0=laste.y}else{laste=this.actions[i-1].args;cpx0=laste[laste.length-2];cpy0=laste[laste.length-1]}for(var j=1;j<=divisions;j++){var t=j/divisions;tx=b2(t,cpx0,cpx1,cpx);ty=b2(t,cpy0,cpy1,cpy);points.push(new THREE.Vector2(tx,ty))}break;case "bezierCurveTo":cpx=args[4];cpy=args[5];cpx1=args[0];cpy1=args[1];cpx2=args[2];cpy2=args[3];if(points.length>0){laste=points[points.length-1];cpx0=laste.x;cpy0=laste.y}else{laste=
this.actions[i-1].args;cpx0=laste[laste.length-2];cpy0=laste[laste.length-1]}for(var j=1;j<=divisions;j++){var t=j/divisions;tx=b3(t,cpx0,cpx1,cpx2,cpx);ty=b3(t,cpy0,cpy1,cpy2,cpy);points.push(new THREE.Vector2(tx,ty))}break;case "splineThru":laste=this.actions[i-1].args;var last=new THREE.Vector2(laste[laste.length-2],laste[laste.length-1]);var spts=[last];var n=divisions*args[0].length;spts=spts.concat(args[0]);var spline=new THREE.SplineCurve(spts);for(var j=1;j<=n;j++)points.push(spline.getPointAt(j/
n));break;case "arc":var aX=args[0],aY=args[1],aRadius=args[2],aStartAngle=args[3],aEndAngle=args[4],aClockwise=!!args[5];var deltaAngle=aEndAngle-aStartAngle;var angle;var tdivisions=divisions*2;for(var j=1;j<=tdivisions;j++){var t=j/tdivisions;if(!aClockwise)t=1-t;angle=aStartAngle+t*deltaAngle;tx=aX+aRadius*Math.cos(angle);ty=aY+aRadius*Math.sin(angle);points.push(new THREE.Vector2(tx,ty))}break;case "ellipse":var aX=args[0],aY=args[1],xRadius=args[2],yRadius=args[3],aStartAngle=args[4],aEndAngle=
args[5],aClockwise=!!args[6],aRotation=args[7];var deltaAngle=aEndAngle-aStartAngle;var angle;var tdivisions=divisions*2;var cos,sin;if(aRotation!==0){cos=Math.cos(aRotation);sin=Math.sin(aRotation)}for(var j=1;j<=tdivisions;j++){var t=j/tdivisions;if(!aClockwise)t=1-t;angle=aStartAngle+t*deltaAngle;tx=aX+xRadius*Math.cos(angle);ty=aY+yRadius*Math.sin(angle);if(aRotation!==0){var x=tx,y=ty;tx=(x-aX)*cos-(y-aY)*sin+aX;ty=(x-aX)*sin+(y-aY)*cos+aY}points.push(new THREE.Vector2(tx,ty))}break}}var lastPoint=
points[points.length-1];if(Math.abs(lastPoint.x-points[0].x)<Number.EPSILON&&Math.abs(lastPoint.y-points[0].y)<Number.EPSILON)points.splice(points.length-1,1);if(this.autoClose)points.push(points[0]);return points},toShapes:function(isCCW,noHoles){function extractSubpaths(inActions){var subPaths=[],lastPath=new THREE.Path;for(var i=0,l=inActions.length;i<l;i++){var item=inActions[i];var args=item.args;var action=item.action;if(action==="moveTo")if(lastPath.actions.length!==0){subPaths.push(lastPath);
lastPath=new THREE.Path}lastPath[action].apply(lastPath,args)}if(lastPath.actions.length!==0)subPaths.push(lastPath);return subPaths}function toShapesNoHoles(inSubpaths){var shapes=[];for(var i=0,l=inSubpaths.length;i<l;i++){var tmpPath=inSubpaths[i];var tmpShape=new THREE.Shape;tmpShape.actions=tmpPath.actions;tmpShape.curves=tmpPath.curves;shapes.push(tmpShape)}return shapes}function isPointInsidePolygon(inPt,inPolygon){var polyLen=inPolygon.length;var inside=false;for(var p=polyLen-1,q=0;q<polyLen;p=
q++){var edgeLowPt=inPolygon[p];var edgeHighPt=inPolygon[q];var edgeDx=edgeHighPt.x-edgeLowPt.x;var edgeDy=edgeHighPt.y-edgeLowPt.y;if(Math.abs(edgeDy)>Number.EPSILON){if(edgeDy<0){edgeLowPt=inPolygon[q];edgeDx=-edgeDx;edgeHighPt=inPolygon[p];edgeDy=-edgeDy}if(inPt.y<edgeLowPt.y||inPt.y>edgeHighPt.y)continue;if(inPt.y===edgeLowPt.y){if(inPt.x===edgeLowPt.x)return true}else{var perpEdge=edgeDy*(inPt.x-edgeLowPt.x)-edgeDx*(inPt.y-edgeLowPt.y);if(perpEdge===0)return true;if(perpEdge<0)continue;inside=
!inside}}else{if(inPt.y!==edgeLowPt.y)continue;if(edgeHighPt.x<=inPt.x&&inPt.x<=edgeLowPt.x||edgeLowPt.x<=inPt.x&&inPt.x<=edgeHighPt.x)return true}}return inside}var isClockWise=THREE.ShapeUtils.isClockWise;var subPaths=extractSubpaths(this.actions);if(subPaths.length===0)return[];if(noHoles===true)return toShapesNoHoles(subPaths);var solid,tmpPath,tmpShape,shapes=[];if(subPaths.length===1){tmpPath=subPaths[0];tmpShape=new THREE.Shape;tmpShape.actions=tmpPath.actions;tmpShape.curves=tmpPath.curves;
shapes.push(tmpShape);return shapes}var holesFirst=!isClockWise(subPaths[0].getPoints());holesFirst=isCCW?!holesFirst:holesFirst;var betterShapeHoles=[];var newShapes=[];var newShapeHoles=[];var mainIdx=0;var tmpPoints;newShapes[mainIdx]=undefined;newShapeHoles[mainIdx]=[];for(var i=0,l=subPaths.length;i<l;i++){tmpPath=subPaths[i];tmpPoints=tmpPath.getPoints();solid=isClockWise(tmpPoints);solid=isCCW?!solid:solid;if(solid){if(!holesFirst&&newShapes[mainIdx])mainIdx++;newShapes[mainIdx]={s:new THREE.Shape,
p:tmpPoints};newShapes[mainIdx].s.actions=tmpPath.actions;newShapes[mainIdx].s.curves=tmpPath.curves;if(holesFirst)mainIdx++;newShapeHoles[mainIdx]=[]}else newShapeHoles[mainIdx].push({h:tmpPath,p:tmpPoints[0]})}if(!newShapes[0])return toShapesNoHoles(subPaths);if(newShapes.length>1){var ambiguous=false;var toChange=[];for(var sIdx=0,sLen=newShapes.length;sIdx<sLen;sIdx++)betterShapeHoles[sIdx]=[];for(var sIdx=0,sLen=newShapes.length;sIdx<sLen;sIdx++){var sho=newShapeHoles[sIdx];for(var hIdx=0;hIdx<
sho.length;hIdx++){var ho=sho[hIdx];var hole_unassigned=true;for(var s2Idx=0;s2Idx<newShapes.length;s2Idx++)if(isPointInsidePolygon(ho.p,newShapes[s2Idx].p)){if(sIdx!==s2Idx)toChange.push({froms:sIdx,tos:s2Idx,hole:hIdx});if(hole_unassigned){hole_unassigned=false;betterShapeHoles[s2Idx].push(ho)}else ambiguous=true}if(hole_unassigned)betterShapeHoles[sIdx].push(ho)}}if(toChange.length>0)if(!ambiguous)newShapeHoles=betterShapeHoles}var tmpHoles;for(var i=0,il=newShapes.length;i<il;i++){tmpShape=newShapes[i].s;
shapes.push(tmpShape);tmpHoles=newShapeHoles[i];for(var j=0,jl=tmpHoles.length;j<jl;j++)tmpShape.holes.push(tmpHoles[j].h)}return shapes}});THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};
THREE.Shape.prototype=Object.assign(Object.create(THREE.Path.prototype),{constructor:THREE.Shape,extrude:function(options){return new THREE.ExtrudeGeometry(this,options)},makeGeometry:function(options){return new THREE.ShapeGeometry(this,options)},getPointsHoles:function(divisions){var holesPts=[];for(var i=0,l=this.holes.length;i<l;i++)holesPts[i]=this.holes[i].getPoints(divisions);return holesPts},extractAllPoints:function(divisions){return{shape:this.getPoints(divisions),holes:this.getPointsHoles(divisions)}},
extractPoints:function(divisions){return this.extractAllPoints(divisions)}});THREE.LineCurve=function(v1,v2){this.v1=v1;this.v2=v2};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.constructor=THREE.LineCurve;THREE.LineCurve.prototype.getPoint=function(t){var point=this.v2.clone().sub(this.v1);point.multiplyScalar(t).add(this.v1);return point};THREE.LineCurve.prototype.getPointAt=function(u){return this.getPoint(u)};
THREE.LineCurve.prototype.getTangent=function(t){var tangent=this.v2.clone().sub(this.v1);return tangent.normalize()};THREE.QuadraticBezierCurve=function(v0,v1,v2){this.v0=v0;this.v1=v1;this.v2=v2};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.constructor=THREE.QuadraticBezierCurve;
THREE.QuadraticBezierCurve.prototype.getPoint=function(t){var b2=THREE.ShapeUtils.b2;return new THREE.Vector2(b2(t,this.v0.x,this.v1.x,this.v2.x),b2(t,this.v0.y,this.v1.y,this.v2.y))};THREE.QuadraticBezierCurve.prototype.getTangent=function(t){var tangentQuadraticBezier=THREE.CurveUtils.tangentQuadraticBezier;return(new THREE.Vector2(tangentQuadraticBezier(t,this.v0.x,this.v1.x,this.v2.x),tangentQuadraticBezier(t,this.v0.y,this.v1.y,this.v2.y))).normalize()};
THREE.CubicBezierCurve=function(v0,v1,v2,v3){this.v0=v0;this.v1=v1;this.v2=v2;this.v3=v3};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.constructor=THREE.CubicBezierCurve;THREE.CubicBezierCurve.prototype.getPoint=function(t){var b3=THREE.ShapeUtils.b3;return new THREE.Vector2(b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))};
THREE.CubicBezierCurve.prototype.getTangent=function(t){var tangentCubicBezier=THREE.CurveUtils.tangentCubicBezier;return(new THREE.Vector2(tangentCubicBezier(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),tangentCubicBezier(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y))).normalize()};THREE.SplineCurve=function(points){this.points=points==undefined?[]:points};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.constructor=THREE.SplineCurve;
THREE.SplineCurve.prototype.getPoint=function(t){var points=this.points;var point=(points.length-1)*t;var intPoint=Math.floor(point);var weight=point-intPoint;var point0=points[intPoint===0?intPoint:intPoint-1];var point1=points[intPoint];var point2=points[intPoint>points.length-2?points.length-1:intPoint+1];var point3=points[intPoint>points.length-3?points.length-1:intPoint+2];var interpolate=THREE.CurveUtils.interpolate;return new THREE.Vector2(interpolate(point0.x,point1.x,point2.x,point3.x,weight),
interpolate(point0.y,point1.y,point2.y,point3.y,weight))};THREE.EllipseCurve=function(aX,aY,xRadius,yRadius,aStartAngle,aEndAngle,aClockwise,aRotation){this.aX=aX;this.aY=aY;this.xRadius=xRadius;this.yRadius=yRadius;this.aStartAngle=aStartAngle;this.aEndAngle=aEndAngle;this.aClockwise=aClockwise;this.aRotation=aRotation||0};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.constructor=THREE.EllipseCurve;
THREE.EllipseCurve.prototype.getPoint=function(t){var deltaAngle=this.aEndAngle-this.aStartAngle;if(deltaAngle<0)deltaAngle+=Math.PI*2;if(deltaAngle>Math.PI*2)deltaAngle-=Math.PI*2;var angle;if(this.aClockwise===true)angle=this.aEndAngle+(1-t)*(Math.PI*2-deltaAngle);else angle=this.aStartAngle+t*deltaAngle;var x=this.aX+this.xRadius*Math.cos(angle);var y=this.aY+this.yRadius*Math.sin(angle);if(this.aRotation!==0){var cos=Math.cos(this.aRotation);var sin=Math.sin(this.aRotation);var tx=x,ty=y;x=(tx-
this.aX)*cos-(ty-this.aY)*sin+this.aX;y=(tx-this.aX)*sin+(ty-this.aY)*cos+this.aY}return new THREE.Vector2(x,y)};THREE.ArcCurve=function(aX,aY,aRadius,aStartAngle,aEndAngle,aClockwise){THREE.EllipseCurve.call(this,aX,aY,aRadius,aRadius,aStartAngle,aEndAngle,aClockwise)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.ArcCurve.prototype.constructor=THREE.ArcCurve;
THREE.LineCurve3=THREE.Curve.create(function(v1,v2){this.v1=v1;this.v2=v2},function(t){var vector=new THREE.Vector3;vector.subVectors(this.v2,this.v1);vector.multiplyScalar(t);vector.add(this.v1);return vector});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(v0,v1,v2){this.v0=v0;this.v1=v1;this.v2=v2},function(t){var b2=THREE.ShapeUtils.b2;return new THREE.Vector3(b2(t,this.v0.x,this.v1.x,this.v2.x),b2(t,this.v0.y,this.v1.y,this.v2.y),b2(t,this.v0.z,this.v1.z,this.v2.z))});
THREE.CubicBezierCurve3=THREE.Curve.create(function(v0,v1,v2,v3){this.v0=v0;this.v1=v1;this.v2=v2;this.v3=v3},function(t){var b3=THREE.ShapeUtils.b3;return new THREE.Vector3(b3(t,this.v0.x,this.v1.x,this.v2.x,this.v3.x),b3(t,this.v0.y,this.v1.y,this.v2.y,this.v3.y),b3(t,this.v0.z,this.v1.z,this.v2.z,this.v3.z))});
THREE.SplineCurve3=THREE.Curve.create(function(points){console.warn("THREE.SplineCurve3 will be deprecated. Please use THREE.CatmullRomCurve3");this.points=points==undefined?[]:points},function(t){var points=this.points;var point=(points.length-1)*t;var intPoint=Math.floor(point);var weight=point-intPoint;var point0=points[intPoint==0?intPoint:intPoint-1];var point1=points[intPoint];var point2=points[intPoint>points.length-2?points.length-1:intPoint+1];var point3=points[intPoint>points.length-3?points.length-
1:intPoint+2];var interpolate=THREE.CurveUtils.interpolate;return new THREE.Vector3(interpolate(point0.x,point1.x,point2.x,point3.x,weight),interpolate(point0.y,point1.y,point2.y,point3.y,weight),interpolate(point0.z,point1.z,point2.z,point3.z,weight))});
THREE.CatmullRomCurve3=function(){var tmp=new THREE.Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;function CubicPoly(){}CubicPoly.prototype.init=function(x0,x1,t0,t1){this.c0=x0;this.c1=t0;this.c2=-3*x0+3*x1-2*t0-t1;this.c3=2*x0-2*x1+t0+t1};CubicPoly.prototype.initNonuniformCatmullRom=function(x0,x1,x2,x3,dt0,dt1,dt2){var t1=(x1-x0)/dt0-(x2-x0)/(dt0+dt1)+(x2-x1)/dt1;var t2=(x2-x1)/dt1-(x3-x1)/(dt1+dt2)+(x3-x2)/dt2;t1*=dt1;t2*=dt1;this.init(x1,x2,t1,t2)};CubicPoly.prototype.initCatmullRom=
function(x0,x1,x2,x3,tension){this.init(x1,x2,tension*(x2-x0),tension*(x3-x1))};CubicPoly.prototype.calc=function(t){var t2=t*t;var t3=t2*t;return this.c0+this.c1*t+this.c2*t2+this.c3*t3};return THREE.Curve.create(function(p){this.points=p||[];this.closed=false},function(t){var points=this.points,point,intPoint,weight,l;l=points.length;if(l<2)console.log("duh, you need at least 2 points");point=(l-(this.closed?0:1))*t;intPoint=Math.floor(point);weight=point-intPoint;if(this.closed)intPoint+=intPoint>
0?0:(Math.floor(Math.abs(intPoint)/points.length)+1)*points.length;else if(weight===0&&intPoint===l-1){intPoint=l-2;weight=1}var p0,p1,p2,p3;if(this.closed||intPoint>0)p0=points[(intPoint-1)%l];else{tmp.subVectors(points[0],points[1]).add(points[0]);p0=tmp}p1=points[intPoint%l];p2=points[(intPoint+1)%l];if(this.closed||intPoint+2<l)p3=points[(intPoint+2)%l];else{tmp.subVectors(points[l-1],points[l-2]).add(points[l-1]);p3=tmp}if(this.type===undefined||this.type==="centripetal"||this.type==="chordal"){var pow=
this.type==="chordal"?.5:.25;var dt0=Math.pow(p0.distanceToSquared(p1),pow);var dt1=Math.pow(p1.distanceToSquared(p2),pow);var dt2=Math.pow(p2.distanceToSquared(p3),pow);if(dt1<1E-4)dt1=1;if(dt0<1E-4)dt0=dt1;if(dt2<1E-4)dt2=dt1;px.initNonuniformCatmullRom(p0.x,p1.x,p2.x,p3.x,dt0,dt1,dt2);py.initNonuniformCatmullRom(p0.y,p1.y,p2.y,p3.y,dt0,dt1,dt2);pz.initNonuniformCatmullRom(p0.z,p1.z,p2.z,p3.z,dt0,dt1,dt2)}else if(this.type==="catmullrom"){var tension=this.tension!==undefined?this.tension:.5;px.initCatmullRom(p0.x,
p1.x,p2.x,p3.x,tension);py.initCatmullRom(p0.y,p1.y,p2.y,p3.y,tension);pz.initCatmullRom(p0.z,p1.z,p2.z,p3.z,tension)}var v=new THREE.Vector3(px.calc(weight),py.calc(weight),pz.calc(weight));return v})}();THREE.ClosedSplineCurve3=function(points){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Please use THREE.CatmullRomCurve3.");THREE.CatmullRomCurve3.call(this,points);this.type="catmullrom";this.closed=true};THREE.ClosedSplineCurve3.prototype=Object.create(THREE.CatmullRomCurve3.prototype);
THREE.BoxGeometry=function(width,height,depth,widthSegments,heightSegments,depthSegments){THREE.Geometry.call(this);this.type="BoxGeometry";this.parameters={width:width,height:height,depth:depth,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments};this.fromBufferGeometry(new THREE.BoxBufferGeometry(width,height,depth,widthSegments,heightSegments,depthSegments));this.mergeVertices()};THREE.BoxGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.BoxGeometry.prototype.constructor=THREE.BoxGeometry;THREE.CubeGeometry=THREE.BoxGeometry;
THREE.BoxBufferGeometry=function(width,height,depth,widthSegments,heightSegments,depthSegments){THREE.BufferGeometry.call(this);this.type="BoxBufferGeometry";this.parameters={width:width,height:height,depth:depth,widthSegments:widthSegments,heightSegments:heightSegments,depthSegments:depthSegments};var scope=this;widthSegments=Math.floor(widthSegments)||1;heightSegments=Math.floor(heightSegments)||1;depthSegments=Math.floor(depthSegments)||1;var vertexCount=calculateVertexCount(widthSegments,heightSegments,
depthSegments);var indexCount=calculateIndexCount(widthSegments,heightSegments,depthSegments);var indices=new (indexCount>65535?Uint32Array:Uint16Array)(indexCount);var vertices=new Float32Array(vertexCount*3);var normals=new Float32Array(vertexCount*3);var uvs=new Float32Array(vertexCount*2);var vertexBufferOffset=0;var uvBufferOffset=0;var indexBufferOffset=0;var numberOfVertices=0;var groupStart=0;buildPlane("z","y","x",-1,-1,depth,height,width,depthSegments,heightSegments,0);buildPlane("z","y",
"x",1,-1,depth,height,-width,depthSegments,heightSegments,1);buildPlane("x","z","y",1,1,width,depth,height,widthSegments,depthSegments,2);buildPlane("x","z","y",1,-1,width,depth,-height,widthSegments,depthSegments,3);buildPlane("x","y","z",1,-1,width,height,depth,widthSegments,heightSegments,4);buildPlane("x","y","z",-1,-1,width,height,-depth,widthSegments,heightSegments,5);this.setIndex(new THREE.BufferAttribute(indices,1));this.addAttribute("position",new THREE.BufferAttribute(vertices,3));this.addAttribute("normal",
new THREE.BufferAttribute(normals,3));this.addAttribute("uv",new THREE.BufferAttribute(uvs,2));function calculateVertexCount(w,h,d){var vertices=0;vertices+=(w+1)*(h+1)*2;vertices+=(w+1)*(d+1)*2;vertices+=(d+1)*(h+1)*2;return vertices}function calculateIndexCount(w,h,d){var index=0;index+=w*h*2;index+=w*d*2;index+=d*h*2;return index*6}function buildPlane(u,v,w,udir,vdir,width,height,depth,gridX,gridY,materialIndex){var segmentWidth=width/gridX;var segmentHeight=height/gridY;var widthHalf=width/2;
var heightHalf=height/2;var depthHalf=depth/2;var gridX1=gridX+1;var gridY1=gridY+1;var vertexCounter=0;var groupCount=0;var vector=new THREE.Vector3;for(var iy=0;iy<gridY1;iy++){var y=iy*segmentHeight-heightHalf;for(var ix=0;ix<gridX1;ix++){var x=ix*segmentWidth-widthHalf;vector[u]=x*udir;vector[v]=y*vdir;vector[w]=depthHalf;vertices[vertexBufferOffset]=vector.x;vertices[vertexBufferOffset+1]=vector.y;vertices[vertexBufferOffset+2]=vector.z;vector[u]=0;vector[v]=0;vector[w]=depth>0?1:-1;normals[vertexBufferOffset]=
vector.x;normals[vertexBufferOffset+1]=vector.y;normals[vertexBufferOffset+2]=vector.z;uvs[uvBufferOffset]=ix/gridX;uvs[uvBufferOffset+1]=1-iy/gridY;vertexBufferOffset+=3;uvBufferOffset+=2;vertexCounter+=1}}for(iy=0;iy<gridY;iy++)for(ix=0;ix<gridX;ix++){var a=numberOfVertices+ix+gridX1*iy;var b=numberOfVertices+ix+gridX1*(iy+1);var c=numberOfVertices+(ix+1)+gridX1*(iy+1);var d=numberOfVertices+(ix+1)+gridX1*iy;indices[indexBufferOffset]=a;indices[indexBufferOffset+1]=b;indices[indexBufferOffset+2]=
d;indices[indexBufferOffset+3]=b;indices[indexBufferOffset+4]=c;indices[indexBufferOffset+5]=d;indexBufferOffset+=6;groupCount+=6}scope.addGroup(groupStart,groupCount,materialIndex);groupStart+=groupCount;numberOfVertices+=vertexCounter}};THREE.BoxBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.BoxBufferGeometry.prototype.constructor=THREE.BoxBufferGeometry;
THREE.CircleGeometry=function(radius,segments,thetaStart,thetaLength){THREE.Geometry.call(this);this.type="CircleGeometry";this.parameters={radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};this.fromBufferGeometry(new THREE.CircleBufferGeometry(radius,segments,thetaStart,thetaLength))};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CircleGeometry.prototype.constructor=THREE.CircleGeometry;
THREE.CircleBufferGeometry=function(radius,segments,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type="CircleBufferGeometry";this.parameters={radius:radius,segments:segments,thetaStart:thetaStart,thetaLength:thetaLength};radius=radius||50;segments=segments!==undefined?Math.max(3,segments):8;thetaStart=thetaStart!==undefined?thetaStart:0;thetaLength=thetaLength!==undefined?thetaLength:Math.PI*2;var vertices=segments+2;var positions=new Float32Array(vertices*3);var normals=new Float32Array(vertices*
3);var uvs=new Float32Array(vertices*2);normals[2]=1;uvs[0]=.5;uvs[1]=.5;for(var s=0,i=3,ii=2;s<=segments;s++,i+=3,ii+=2){var segment=thetaStart+s/segments*thetaLength;positions[i]=radius*Math.cos(segment);positions[i+1]=radius*Math.sin(segment);normals[i+2]=1;uvs[ii]=(positions[i]/radius+1)/2;uvs[ii+1]=(positions[i+1]/radius+1)/2}var indices=[];for(var i=1;i<=segments;i++)indices.push(i,i+1,0);this.setIndex(new THREE.BufferAttribute(new Uint16Array(indices),1));this.addAttribute("position",new THREE.BufferAttribute(positions,
3));this.addAttribute("normal",new THREE.BufferAttribute(normals,3));this.addAttribute("uv",new THREE.BufferAttribute(uvs,2));this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)};THREE.CircleBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.CircleBufferGeometry.prototype.constructor=THREE.CircleBufferGeometry;
THREE.CylinderBufferGeometry=function(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type="CylinderBufferGeometry";this.parameters={radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};var scope=this;radiusTop=radiusTop!==undefined?radiusTop:20;radiusBottom=radiusBottom!==undefined?
radiusBottom:20;height=height!==undefined?height:100;radialSegments=Math.floor(radialSegments)||8;heightSegments=Math.floor(heightSegments)||1;openEnded=openEnded!==undefined?openEnded:false;thetaStart=thetaStart!==undefined?thetaStart:0;thetaLength=thetaLength!==undefined?thetaLength:2*Math.PI;var nbCap=0;if(openEnded===false){if(radiusTop>0)nbCap++;if(radiusBottom>0)nbCap++}var vertexCount=calculateVertexCount();var indexCount=calculateIndexCount();var indices=new THREE.BufferAttribute(new (indexCount>
65535?Uint32Array:Uint16Array)(indexCount),1);var vertices=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var normals=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount*2),2);var index=0,indexOffset=0,indexArray=[],halfHeight=height/2;var groupStart=0;generateTorso();if(openEnded===false){if(radiusTop>0)generateCap(true);if(radiusBottom>0)generateCap(false)}this.setIndex(indices);this.addAttribute("position",vertices);
this.addAttribute("normal",normals);this.addAttribute("uv",uvs);function calculateVertexCount(){var count=(radialSegments+1)*(heightSegments+1);if(openEnded===false)count+=(radialSegments+1)*nbCap+radialSegments*nbCap;return count}function calculateIndexCount(){var count=radialSegments*heightSegments*2*3;if(openEnded===false)count+=radialSegments*nbCap*3;return count}function generateTorso(){var x,y;var normal=new THREE.Vector3;var vertex=new THREE.Vector3;var groupCount=0;var tanTheta=(radiusBottom-
radiusTop)/height;for(y=0;y<=heightSegments;y++){var indexRow=[];var v=y/heightSegments;var radius=v*(radiusBottom-radiusTop)+radiusTop;for(x=0;x<=radialSegments;x++){var u=x/radialSegments;vertex.x=radius*Math.sin(u*thetaLength+thetaStart);vertex.y=-v*height+halfHeight;vertex.z=radius*Math.cos(u*thetaLength+thetaStart);vertices.setXYZ(index,vertex.x,vertex.y,vertex.z);normal.copy(vertex);if(radiusTop===0&&y===0||radiusBottom===0&&y===heightSegments){normal.x=Math.sin(u*thetaLength+thetaStart);normal.z=
Math.cos(u*thetaLength+thetaStart)}normal.setY(Math.sqrt(normal.x*normal.x+normal.z*normal.z)*tanTheta).normalize();normals.setXYZ(index,normal.x,normal.y,normal.z);uvs.setXY(index,u,1-v);indexRow.push(index);index++}indexArray.push(indexRow)}for(x=0;x<radialSegments;x++)for(y=0;y<heightSegments;y++){var i1=indexArray[y][x];var i2=indexArray[y+1][x];var i3=indexArray[y+1][x+1];var i4=indexArray[y][x+1];indices.setX(indexOffset,i1);indexOffset++;indices.setX(indexOffset,i2);indexOffset++;indices.setX(indexOffset,
i4);indexOffset++;indices.setX(indexOffset,i2);indexOffset++;indices.setX(indexOffset,i3);indexOffset++;indices.setX(indexOffset,i4);indexOffset++;groupCount+=6}scope.addGroup(groupStart,groupCount,0);groupStart+=groupCount}function generateCap(top){var x,centerIndexStart,centerIndexEnd;var uv=new THREE.Vector2;var vertex=new THREE.Vector3;var groupCount=0;var radius=top===true?radiusTop:radiusBottom;var sign=top===true?1:-1;centerIndexStart=index;for(x=1;x<=radialSegments;x++){vertices.setXYZ(index,
0,halfHeight*sign,0);normals.setXYZ(index,0,sign,0);uv.x=.5;uv.y=.5;uvs.setXY(index,uv.x,uv.y);index++}centerIndexEnd=index;for(x=0;x<=radialSegments;x++){var u=x/radialSegments;var theta=u*thetaLength+thetaStart;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);vertex.x=radius*sinTheta;vertex.y=halfHeight*sign;vertex.z=radius*cosTheta;vertices.setXYZ(index,vertex.x,vertex.y,vertex.z);normals.setXYZ(index,0,sign,0);uv.x=cosTheta*.5+.5;uv.y=sinTheta*.5*sign+.5;uvs.setXY(index,uv.x,uv.y);index++}for(x=
0;x<radialSegments;x++){var c=centerIndexStart+x;var i=centerIndexEnd+x;if(top===true){indices.setX(indexOffset,i);indexOffset++;indices.setX(indexOffset,i+1);indexOffset++;indices.setX(indexOffset,c);indexOffset++}else{indices.setX(indexOffset,i+1);indexOffset++;indices.setX(indexOffset,i);indexOffset++;indices.setX(indexOffset,c);indexOffset++}groupCount+=3}scope.addGroup(groupStart,groupCount,top===true?1:2);groupStart+=groupCount}};THREE.CylinderBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);
THREE.CylinderBufferGeometry.prototype.constructor=THREE.CylinderBufferGeometry;
THREE.CylinderGeometry=function(radiusTop,radiusBottom,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){THREE.Geometry.call(this);this.type="CylinderGeometry";this.parameters={radiusTop:radiusTop,radiusBottom:radiusBottom,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength};this.fromBufferGeometry(new THREE.CylinderBufferGeometry(radiusTop,radiusBottom,height,radialSegments,heightSegments,
openEnded,thetaStart,thetaLength));this.mergeVertices()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry.prototype.constructor=THREE.CylinderGeometry;
THREE.ConeBufferGeometry=function(radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){THREE.CylinderBufferGeometry.call(this,0,radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength);this.type="ConeBufferGeometry";this.parameters={radius:radius,height:height,radialSegments:radialSegments,heightSegments:heightSegments,thetaStart:thetaStart,thetaLength:thetaLength}};THREE.ConeBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);
THREE.ConeBufferGeometry.prototype.constructor=THREE.ConeBufferGeometry;THREE.ConeGeometry=function(radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength){THREE.CylinderGeometry.call(this,0,radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength);this.type="ConeGeometry";this.parameters={radius:radius,height:height,radialSegments:radialSegments,heightSegments:heightSegments,openEnded:openEnded,thetaStart:thetaStart,thetaLength:thetaLength}};
THREE.ConeGeometry.prototype=Object.create(THREE.CylinderGeometry.prototype);THREE.ConeGeometry.prototype.constructor=THREE.ConeGeometry;
THREE.EdgesGeometry=function(geometry,thresholdAngle){THREE.BufferGeometry.call(this);thresholdAngle=thresholdAngle!==undefined?thresholdAngle:1;var thresholdDot=Math.cos(THREE.Math.DEG2RAD*thresholdAngle);var edge=[0,0],hash={};function sortFunction(a,b){return a-b}var keys=["a","b","c"];var geometry2;if(geometry instanceof THREE.BufferGeometry){geometry2=new THREE.Geometry;geometry2.fromBufferGeometry(geometry)}else geometry2=geometry.clone();geometry2.mergeVertices();geometry2.computeFaceNormals();
var vertices=geometry2.vertices;var faces=geometry2.faces;for(var i=0,l=faces.length;i<l;i++){var face=faces[i];for(var j=0;j<3;j++){edge[0]=face[keys[j]];edge[1]=face[keys[(j+1)%3]];edge.sort(sortFunction);var key=edge.toString();if(hash[key]===undefined)hash[key]={vert1:edge[0],vert2:edge[1],face1:i,face2:undefined};else hash[key].face2=i}}var coords=[];for(var key in hash){var h=hash[key];if(h.face2===undefined||faces[h.face1].normal.dot(faces[h.face2].normal)<=thresholdDot){var vertex=vertices[h.vert1];
coords.push(vertex.x);coords.push(vertex.y);coords.push(vertex.z);vertex=vertices[h.vert2];coords.push(vertex.x);coords.push(vertex.y);coords.push(vertex.z)}}this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(coords),3))};THREE.EdgesGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.EdgesGeometry.prototype.constructor=THREE.EdgesGeometry;
THREE.ExtrudeGeometry=function(shapes,options){if(typeof shapes==="undefined"){shapes=[];return}THREE.Geometry.call(this);this.type="ExtrudeGeometry";shapes=Array.isArray(shapes)?shapes:[shapes];this.addShapeList(shapes,options);this.computeFaceNormals()};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.constructor=THREE.ExtrudeGeometry;
THREE.ExtrudeGeometry.prototype.addShapeList=function(shapes,options){var sl=shapes.length;for(var s=0;s<sl;s++){var shape=shapes[s];this.addShape(shape,options)}};
THREE.ExtrudeGeometry.prototype.addShape=function(shape,options){var amount=options.amount!==undefined?options.amount:100;var bevelThickness=options.bevelThickness!==undefined?options.bevelThickness:6;var bevelSize=options.bevelSize!==undefined?options.bevelSize:bevelThickness-2;var bevelSegments=options.bevelSegments!==undefined?options.bevelSegments:3;var bevelEnabled=options.bevelEnabled!==undefined?options.bevelEnabled:true;var curveSegments=options.curveSegments!==undefined?options.curveSegments:
12;var steps=options.steps!==undefined?options.steps:1;var extrudePath=options.extrudePath;var extrudePts,extrudeByPath=false;var uvgen=options.UVGenerator!==undefined?options.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;var splineTube,binormal,normal,position2;if(extrudePath){extrudePts=extrudePath.getSpacedPoints(steps);extrudeByPath=true;bevelEnabled=false;splineTube=options.frames!==undefined?options.frames:new THREE.TubeGeometry.FrenetFrames(extrudePath,steps,false);binormal=new THREE.Vector3;
normal=new THREE.Vector3;position2=new THREE.Vector3}if(!bevelEnabled){bevelSegments=0;bevelThickness=0;bevelSize=0}var ahole,h,hl;var scope=this;var shapesOffset=this.vertices.length;var shapePoints=shape.extractPoints(curveSegments);var vertices=shapePoints.shape;var holes=shapePoints.holes;var reverse=!THREE.ShapeUtils.isClockWise(vertices);if(reverse){vertices=vertices.reverse();for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];if(THREE.ShapeUtils.isClockWise(ahole))holes[h]=ahole.reverse()}reverse=
false}var faces=THREE.ShapeUtils.triangulateShape(vertices,holes);var contour=vertices;for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];vertices=vertices.concat(ahole)}function scalePt2(pt,vec,size){if(!vec)console.error("THREE.ExtrudeGeometry: vec does not exist");return vec.clone().multiplyScalar(size).add(pt)}var b,bs,t,z,vert,vlen=vertices.length,face,flen=faces.length;function getBevelVec(inPt,inPrev,inNext){var v_trans_x,v_trans_y,shrink_by=1;var v_prev_x=inPt.x-inPrev.x,v_prev_y=inPt.y-inPrev.y;
var v_next_x=inNext.x-inPt.x,v_next_y=inNext.y-inPt.y;var v_prev_lensq=v_prev_x*v_prev_x+v_prev_y*v_prev_y;var collinear0=v_prev_x*v_next_y-v_prev_y*v_next_x;if(Math.abs(collinear0)>Number.EPSILON){var v_prev_len=Math.sqrt(v_prev_lensq);var v_next_len=Math.sqrt(v_next_x*v_next_x+v_next_y*v_next_y);var ptPrevShift_x=inPrev.x-v_prev_y/v_prev_len;var ptPrevShift_y=inPrev.y+v_prev_x/v_prev_len;var ptNextShift_x=inNext.x-v_next_y/v_next_len;var ptNextShift_y=inNext.y+v_next_x/v_next_len;var sf=((ptNextShift_x-
ptPrevShift_x)*v_next_y-(ptNextShift_y-ptPrevShift_y)*v_next_x)/(v_prev_x*v_next_y-v_prev_y*v_next_x);v_trans_x=ptPrevShift_x+v_prev_x*sf-inPt.x;v_trans_y=ptPrevShift_y+v_prev_y*sf-inPt.y;var v_trans_lensq=v_trans_x*v_trans_x+v_trans_y*v_trans_y;if(v_trans_lensq<=2)return new THREE.Vector2(v_trans_x,v_trans_y);else shrink_by=Math.sqrt(v_trans_lensq/2)}else{var direction_eq=false;if(v_prev_x>Number.EPSILON){if(v_next_x>Number.EPSILON)direction_eq=true}else if(v_prev_x<-Number.EPSILON){if(v_next_x<
-Number.EPSILON)direction_eq=true}else if(Math.sign(v_prev_y)===Math.sign(v_next_y))direction_eq=true;if(direction_eq){v_trans_x=-v_prev_y;v_trans_y=v_prev_x;shrink_by=Math.sqrt(v_prev_lensq)}else{v_trans_x=v_prev_x;v_trans_y=v_prev_y;shrink_by=Math.sqrt(v_prev_lensq/2)}}return new THREE.Vector2(v_trans_x/shrink_by,v_trans_y/shrink_by)}var contourMovements=[];for(var i=0,il=contour.length,j=il-1,k=i+1;i<il;i++,j++,k++){if(j===il)j=0;if(k===il)k=0;contourMovements[i]=getBevelVec(contour[i],contour[j],
contour[k])}var holesMovements=[],oneHoleMovements,verticesMovements=contourMovements.concat();for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];oneHoleMovements=[];for(i=0,il=ahole.length,j=il-1,k=i+1;i<il;i++,j++,k++){if(j===il)j=0;if(k===il)k=0;oneHoleMovements[i]=getBevelVec(ahole[i],ahole[j],ahole[k])}holesMovements.push(oneHoleMovements);verticesMovements=verticesMovements.concat(oneHoleMovements)}for(b=0;b<bevelSegments;b++){t=b/bevelSegments;z=bevelThickness*(1-t);bs=bevelSize*Math.sin(t*Math.PI/
2);for(i=0,il=contour.length;i<il;i++){vert=scalePt2(contour[i],contourMovements[i],bs);v(vert.x,vert.y,-z)}for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];oneHoleMovements=holesMovements[h];for(i=0,il=ahole.length;i<il;i++){vert=scalePt2(ahole[i],oneHoleMovements[i],bs);v(vert.x,vert.y,-z)}}}bs=bevelSize;for(i=0;i<vlen;i++){vert=bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i];if(!extrudeByPath)v(vert.x,vert.y,0);else{normal.copy(splineTube.normals[0]).multiplyScalar(vert.x);
binormal.copy(splineTube.binormals[0]).multiplyScalar(vert.y);position2.copy(extrudePts[0]).add(normal).add(binormal);v(position2.x,position2.y,position2.z)}}var s;for(s=1;s<=steps;s++)for(i=0;i<vlen;i++){vert=bevelEnabled?scalePt2(vertices[i],verticesMovements[i],bs):vertices[i];if(!extrudeByPath)v(vert.x,vert.y,amount/steps*s);else{normal.copy(splineTube.normals[s]).multiplyScalar(vert.x);binormal.copy(splineTube.binormals[s]).multiplyScalar(vert.y);position2.copy(extrudePts[s]).add(normal).add(binormal);
v(position2.x,position2.y,position2.z)}}for(b=bevelSegments-1;b>=0;b--){t=b/bevelSegments;z=bevelThickness*(1-t);bs=bevelSize*Math.sin(t*Math.PI/2);for(i=0,il=contour.length;i<il;i++){vert=scalePt2(contour[i],contourMovements[i],bs);v(vert.x,vert.y,amount+z)}for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];oneHoleMovements=holesMovements[h];for(i=0,il=ahole.length;i<il;i++){vert=scalePt2(ahole[i],oneHoleMovements[i],bs);if(!extrudeByPath)v(vert.x,vert.y,amount+z);else v(vert.x,vert.y+extrudePts[steps-
1].y,extrudePts[steps-1].x+z)}}}buildLidFaces();buildSideFaces();function buildLidFaces(){if(bevelEnabled){var layer=0;var offset=vlen*layer;for(i=0;i<flen;i++){face=faces[i];f3(face[2]+offset,face[1]+offset,face[0]+offset)}layer=steps+bevelSegments*2;offset=vlen*layer;for(i=0;i<flen;i++){face=faces[i];f3(face[0]+offset,face[1]+offset,face[2]+offset)}}else{for(i=0;i<flen;i++){face=faces[i];f3(face[2],face[1],face[0])}for(i=0;i<flen;i++){face=faces[i];f3(face[0]+vlen*steps,face[1]+vlen*steps,face[2]+
vlen*steps)}}}function buildSideFaces(){var layeroffset=0;sidewalls(contour,layeroffset);layeroffset+=contour.length;for(h=0,hl=holes.length;h<hl;h++){ahole=holes[h];sidewalls(ahole,layeroffset);layeroffset+=ahole.length}}function sidewalls(contour,layeroffset){var j,k;i=contour.length;while(--i>=0){j=i;k=i-1;if(k<0)k=contour.length-1;var s=0,sl=steps+bevelSegments*2;for(s=0;s<sl;s++){var slen1=vlen*s;var slen2=vlen*(s+1);var a=layeroffset+j+slen1,b=layeroffset+k+slen1,c=layeroffset+k+slen2,d=layeroffset+
j+slen2;f4(a,b,c,d,contour,s,sl,j,k)}}}function v(x,y,z){scope.vertices.push(new THREE.Vector3(x,y,z))}function f3(a,b,c){a+=shapesOffset;b+=shapesOffset;c+=shapesOffset;scope.faces.push(new THREE.Face3(a,b,c,null,null,0));var uvs=uvgen.generateTopUV(scope,a,b,c);scope.faceVertexUvs[0].push(uvs)}function f4(a,b,c,d,wallContour,stepIndex,stepsLength,contourIndex1,contourIndex2){a+=shapesOffset;b+=shapesOffset;c+=shapesOffset;d+=shapesOffset;scope.faces.push(new THREE.Face3(a,b,d,null,null,1));scope.faces.push(new THREE.Face3(b,
c,d,null,null,1));var uvs=uvgen.generateSideWallUV(scope,a,b,c,d);scope.faceVertexUvs[0].push([uvs[0],uvs[1],uvs[3]]);scope.faceVertexUvs[0].push([uvs[1],uvs[2],uvs[3]])}};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(geometry,indexA,indexB,indexC){var vertices=geometry.vertices;var a=vertices[indexA];var b=vertices[indexB];var c=vertices[indexC];return[new THREE.Vector2(a.x,a.y),new THREE.Vector2(b.x,b.y),new THREE.Vector2(c.x,c.y)]},generateSideWallUV:function(geometry,indexA,indexB,indexC,indexD){var vertices=geometry.vertices;var a=vertices[indexA];var b=vertices[indexB];var c=vertices[indexC];var d=vertices[indexD];if(Math.abs(a.y-b.y)<.01)return[new THREE.Vector2(a.x,
1-a.z),new THREE.Vector2(b.x,1-b.z),new THREE.Vector2(c.x,1-c.z),new THREE.Vector2(d.x,1-d.z)];else return[new THREE.Vector2(a.y,1-a.z),new THREE.Vector2(b.y,1-b.z),new THREE.Vector2(c.y,1-c.z),new THREE.Vector2(d.y,1-d.z)]}};THREE.ShapeGeometry=function(shapes,options){THREE.Geometry.call(this);this.type="ShapeGeometry";if(Array.isArray(shapes)===false)shapes=[shapes];this.addShapeList(shapes,options);this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ShapeGeometry.prototype.constructor=THREE.ShapeGeometry;THREE.ShapeGeometry.prototype.addShapeList=function(shapes,options){for(var i=0,l=shapes.length;i<l;i++)this.addShape(shapes[i],options);return this};
THREE.ShapeGeometry.prototype.addShape=function(shape,options){if(options===undefined)options={};var curveSegments=options.curveSegments!==undefined?options.curveSegments:12;var material=options.material;var uvgen=options.UVGenerator===undefined?THREE.ExtrudeGeometry.WorldUVGenerator:options.UVGenerator;var i,l,hole;var shapesOffset=this.vertices.length;var shapePoints=shape.extractPoints(curveSegments);var vertices=shapePoints.shape;var holes=shapePoints.holes;var reverse=!THREE.ShapeUtils.isClockWise(vertices);
if(reverse){vertices=vertices.reverse();for(i=0,l=holes.length;i<l;i++){hole=holes[i];if(THREE.ShapeUtils.isClockWise(hole))holes[i]=hole.reverse()}reverse=false}var faces=THREE.ShapeUtils.triangulateShape(vertices,holes);for(i=0,l=holes.length;i<l;i++){hole=holes[i];vertices=vertices.concat(hole)}var vert,vlen=vertices.length;var face,flen=faces.length;for(i=0;i<vlen;i++){vert=vertices[i];this.vertices.push(new THREE.Vector3(vert.x,vert.y,0))}for(i=0;i<flen;i++){face=faces[i];var a=face[0]+shapesOffset;
var b=face[1]+shapesOffset;var c=face[2]+shapesOffset;this.faces.push(new THREE.Face3(a,b,c,null,null,material));this.faceVertexUvs[0].push(uvgen.generateTopUV(this,a,b,c))}};
THREE.LatheBufferGeometry=function(points,segments,phiStart,phiLength){THREE.BufferGeometry.call(this);this.type="LatheBufferGeometry";this.parameters={points:points,segments:segments,phiStart:phiStart,phiLength:phiLength};segments=Math.floor(segments)||12;phiStart=phiStart||0;phiLength=phiLength||Math.PI*2;phiLength=THREE.Math.clamp(phiLength,0,Math.PI*2);var vertexCount=(segments+1)*points.length;var indexCount=segments*points.length*2*3;var indices=new THREE.BufferAttribute(new (indexCount>65535?
Uint32Array:Uint16Array)(indexCount),1);var vertices=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount*2),2);var index=0,indexOffset=0,base;var inversePointLength=1/(points.length-1);var inverseSegments=1/segments;var vertex=new THREE.Vector3;var uv=new THREE.Vector2;var i,j;for(i=0;i<=segments;i++){var phi=phiStart+i*inverseSegments*phiLength;var sin=Math.sin(phi);var cos=Math.cos(phi);for(j=0;j<=points.length-1;j++){vertex.x=
points[j].x*sin;vertex.y=points[j].y;vertex.z=points[j].x*cos;vertices.setXYZ(index,vertex.x,vertex.y,vertex.z);uv.x=i/segments;uv.y=j/(points.length-1);uvs.setXY(index,uv.x,uv.y);index++}}for(i=0;i<segments;i++)for(j=0;j<points.length-1;j++){base=j+i*points.length;var a=base;var b=base+points.length;var c=base+points.length+1;var d=base+1;indices.setX(indexOffset,a);indexOffset++;indices.setX(indexOffset,b);indexOffset++;indices.setX(indexOffset,d);indexOffset++;indices.setX(indexOffset,b);indexOffset++;
indices.setX(indexOffset,c);indexOffset++;indices.setX(indexOffset,d);indexOffset++}this.setIndex(indices);this.addAttribute("position",vertices);this.addAttribute("uv",uvs);this.computeVertexNormals();if(phiLength===Math.PI*2){var normals=this.attributes.normal.array;var n1=new THREE.Vector3;var n2=new THREE.Vector3;var n=new THREE.Vector3;base=segments*points.length*3;for(i=0,j=0;i<points.length;i++,j+=3){n1.x=normals[j+0];n1.y=normals[j+1];n1.z=normals[j+2];n2.x=normals[base+j+0];n2.y=normals[base+
j+1];n2.z=normals[base+j+2];n.addVectors(n1,n2).normalize();normals[j+0]=normals[base+j+0]=n.x;normals[j+1]=normals[base+j+1]=n.y;normals[j+2]=normals[base+j+2]=n.z}}};THREE.LatheBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.LatheBufferGeometry.prototype.constructor=THREE.LatheBufferGeometry;
THREE.LatheGeometry=function(points,segments,phiStart,phiLength){THREE.Geometry.call(this);this.type="LatheGeometry";this.parameters={points:points,segments:segments,phiStart:phiStart,phiLength:phiLength};this.fromBufferGeometry(new THREE.LatheBufferGeometry(points,segments,phiStart,phiLength));this.mergeVertices()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.LatheGeometry.prototype.constructor=THREE.LatheGeometry;
THREE.PlaneGeometry=function(width,height,widthSegments,heightSegments){THREE.Geometry.call(this);this.type="PlaneGeometry";this.parameters={width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};this.fromBufferGeometry(new THREE.PlaneBufferGeometry(width,height,widthSegments,heightSegments))};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry.prototype.constructor=THREE.PlaneGeometry;
THREE.PlaneBufferGeometry=function(width,height,widthSegments,heightSegments){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:width,height:height,widthSegments:widthSegments,heightSegments:heightSegments};var width_half=width/2;var height_half=height/2;var gridX=Math.floor(widthSegments)||1;var gridY=Math.floor(heightSegments)||1;var gridX1=gridX+1;var gridY1=gridY+1;var segment_width=width/gridX;var segment_height=height/gridY;var vertices=new Float32Array(gridX1*
gridY1*3);var normals=new Float32Array(gridX1*gridY1*3);var uvs=new Float32Array(gridX1*gridY1*2);var offset=0;var offset2=0;for(var iy=0;iy<gridY1;iy++){var y=iy*segment_height-height_half;for(var ix=0;ix<gridX1;ix++){var x=ix*segment_width-width_half;vertices[offset]=x;vertices[offset+1]=-y;normals[offset+2]=1;uvs[offset2]=ix/gridX;uvs[offset2+1]=1-iy/gridY;offset+=3;offset2+=2}}offset=0;var indices=new (vertices.length/3>65535?Uint32Array:Uint16Array)(gridX*gridY*6);for(var iy=0;iy<gridY;iy++)for(var ix=
0;ix<gridX;ix++){var a=ix+gridX1*iy;var b=ix+gridX1*(iy+1);var c=ix+1+gridX1*(iy+1);var d=ix+1+gridX1*iy;indices[offset]=a;indices[offset+1]=b;indices[offset+2]=d;indices[offset+3]=b;indices[offset+4]=c;indices[offset+5]=d;offset+=6}this.setIndex(new THREE.BufferAttribute(indices,1));this.addAttribute("position",new THREE.BufferAttribute(vertices,3));this.addAttribute("normal",new THREE.BufferAttribute(normals,3));this.addAttribute("uv",new THREE.BufferAttribute(uvs,2))};
THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry;
THREE.RingBufferGeometry=function(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type="RingBufferGeometry";this.parameters={innerRadius:innerRadius,outerRadius:outerRadius,thetaSegments:thetaSegments,phiSegments:phiSegments,thetaStart:thetaStart,thetaLength:thetaLength};innerRadius=innerRadius||20;outerRadius=outerRadius||50;thetaStart=thetaStart!==undefined?thetaStart:0;thetaLength=thetaLength!==undefined?thetaLength:Math.PI*2;thetaSegments=
thetaSegments!==undefined?Math.max(3,thetaSegments):8;phiSegments=phiSegments!==undefined?Math.max(1,phiSegments):1;var vertexCount=(thetaSegments+1)*(phiSegments+1);var indexCount=thetaSegments*phiSegments*2*3;var indices=new THREE.BufferAttribute(new (indexCount>65535?Uint32Array:Uint16Array)(indexCount),1);var vertices=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var normals=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount*
2),2);var index=0,indexOffset=0,segment;var radius=innerRadius;var radiusStep=(outerRadius-innerRadius)/phiSegments;var vertex=new THREE.Vector3;var uv=new THREE.Vector2;var j,i;for(j=0;j<=phiSegments;j++){for(i=0;i<=thetaSegments;i++){segment=thetaStart+i/thetaSegments*thetaLength;vertex.x=radius*Math.cos(segment);vertex.y=radius*Math.sin(segment);vertices.setXYZ(index,vertex.x,vertex.y,vertex.z);normals.setXYZ(index,0,0,1);uv.x=(vertex.x/outerRadius+1)/2;uv.y=(vertex.y/outerRadius+1)/2;uvs.setXY(index,
uv.x,uv.y);index++}radius+=radiusStep}for(j=0;j<phiSegments;j++){var thetaSegmentLevel=j*(thetaSegments+1);for(i=0;i<thetaSegments;i++){segment=i+thetaSegmentLevel;var a=segment;var b=segment+thetaSegments+1;var c=segment+thetaSegments+2;var d=segment+1;indices.setX(indexOffset,a);indexOffset++;indices.setX(indexOffset,b);indexOffset++;indices.setX(indexOffset,c);indexOffset++;indices.setX(indexOffset,a);indexOffset++;indices.setX(indexOffset,c);indexOffset++;indices.setX(indexOffset,d);indexOffset++}}this.setIndex(indices);
this.addAttribute("position",vertices);this.addAttribute("normal",normals);this.addAttribute("uv",uvs)};THREE.RingBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.RingBufferGeometry.prototype.constructor=THREE.RingBufferGeometry;
THREE.RingGeometry=function(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength){THREE.Geometry.call(this);this.type="RingGeometry";this.parameters={innerRadius:innerRadius,outerRadius:outerRadius,thetaSegments:thetaSegments,phiSegments:phiSegments,thetaStart:thetaStart,thetaLength:thetaLength};this.fromBufferGeometry(new THREE.RingBufferGeometry(innerRadius,outerRadius,thetaSegments,phiSegments,thetaStart,thetaLength))};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry.prototype.constructor=THREE.RingGeometry;
THREE.SphereGeometry=function(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){THREE.Geometry.call(this);this.type="SphereGeometry";this.parameters={radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};this.fromBufferGeometry(new THREE.SphereBufferGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength))};
THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry.prototype.constructor=THREE.SphereGeometry;
THREE.SphereBufferGeometry=function(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength){THREE.BufferGeometry.call(this);this.type="SphereBufferGeometry";this.parameters={radius:radius,widthSegments:widthSegments,heightSegments:heightSegments,phiStart:phiStart,phiLength:phiLength,thetaStart:thetaStart,thetaLength:thetaLength};radius=radius||50;widthSegments=Math.max(3,Math.floor(widthSegments)||8);heightSegments=Math.max(2,Math.floor(heightSegments)||6);phiStart=phiStart!==
undefined?phiStart:0;phiLength=phiLength!==undefined?phiLength:Math.PI*2;thetaStart=thetaStart!==undefined?thetaStart:0;thetaLength=thetaLength!==undefined?thetaLength:Math.PI;var thetaEnd=thetaStart+thetaLength;var vertexCount=(widthSegments+1)*(heightSegments+1);var positions=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var normals=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount*2),2);var index=0,vertices=
[],normal=new THREE.Vector3;for(var y=0;y<=heightSegments;y++){var verticesRow=[];var v=y/heightSegments;for(var x=0;x<=widthSegments;x++){var u=x/widthSegments;var px=-radius*Math.cos(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);var py=radius*Math.cos(thetaStart+v*thetaLength);var pz=radius*Math.sin(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);normal.set(px,py,pz).normalize();positions.setXYZ(index,px,py,pz);normals.setXYZ(index,normal.x,normal.y,normal.z);uvs.setXY(index,
u,1-v);verticesRow.push(index);index++}vertices.push(verticesRow)}var indices=[];for(var y=0;y<heightSegments;y++)for(var x=0;x<widthSegments;x++){var v1=vertices[y][x+1];var v2=vertices[y][x];var v3=vertices[y+1][x];var v4=vertices[y+1][x+1];if(y!==0||thetaStart>0)indices.push(v1,v2,v4);if(y!==heightSegments-1||thetaEnd<Math.PI)indices.push(v2,v3,v4)}this.setIndex(new (positions.count>65535?THREE.Uint32Attribute:THREE.Uint16Attribute)(indices,1));this.addAttribute("position",positions);this.addAttribute("normal",
normals);this.addAttribute("uv",uvs);this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius)};THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry;
THREE.TextGeometry=function(text,parameters){parameters=parameters||{};var font=parameters.font;if(font instanceof THREE.Font===false){console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font.");return new THREE.Geometry}var shapes=font.generateShapes(text,parameters.size,parameters.curveSegments);parameters.amount=parameters.height!==undefined?parameters.height:50;if(parameters.bevelThickness===undefined)parameters.bevelThickness=10;if(parameters.bevelSize===undefined)parameters.bevelSize=
8;if(parameters.bevelEnabled===undefined)parameters.bevelEnabled=false;THREE.ExtrudeGeometry.call(this,shapes,parameters);this.type="TextGeometry"};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TextGeometry.prototype.constructor=THREE.TextGeometry;
THREE.TorusBufferGeometry=function(radius,tube,radialSegments,tubularSegments,arc){THREE.BufferGeometry.call(this);this.type="TorusBufferGeometry";this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc};radius=radius||100;tube=tube||40;radialSegments=Math.floor(radialSegments)||8;tubularSegments=Math.floor(tubularSegments)||6;arc=arc||Math.PI*2;var vertexCount=(radialSegments+1)*(tubularSegments+1);var indexCount=radialSegments*tubularSegments*
2*3;var indices=new (indexCount>65535?Uint32Array:Uint16Array)(indexCount);var vertices=new Float32Array(vertexCount*3);var normals=new Float32Array(vertexCount*3);var uvs=new Float32Array(vertexCount*2);var vertexBufferOffset=0;var uvBufferOffset=0;var indexBufferOffset=0;var center=new THREE.Vector3;var vertex=new THREE.Vector3;var normal=new THREE.Vector3;var j,i;for(j=0;j<=radialSegments;j++)for(i=0;i<=tubularSegments;i++){var u=i/tubularSegments*arc;var v=j/radialSegments*Math.PI*2;vertex.x=
(radius+tube*Math.cos(v))*Math.cos(u);vertex.y=(radius+tube*Math.cos(v))*Math.sin(u);vertex.z=tube*Math.sin(v);vertices[vertexBufferOffset]=vertex.x;vertices[vertexBufferOffset+1]=vertex.y;vertices[vertexBufferOffset+2]=vertex.z;center.x=radius*Math.cos(u);center.y=radius*Math.sin(u);normal.subVectors(vertex,center).normalize();normals[vertexBufferOffset]=normal.x;normals[vertexBufferOffset+1]=normal.y;normals[vertexBufferOffset+2]=normal.z;uvs[uvBufferOffset]=i/tubularSegments;uvs[uvBufferOffset+
1]=j/radialSegments;vertexBufferOffset+=3;uvBufferOffset+=2}for(j=1;j<=radialSegments;j++)for(i=1;i<=tubularSegments;i++){var a=(tubularSegments+1)*j+i-1;var b=(tubularSegments+1)*(j-1)+i-1;var c=(tubularSegments+1)*(j-1)+i;var d=(tubularSegments+1)*j+i;indices[indexBufferOffset]=a;indices[indexBufferOffset+1]=b;indices[indexBufferOffset+2]=d;indices[indexBufferOffset+3]=b;indices[indexBufferOffset+4]=c;indices[indexBufferOffset+5]=d;indexBufferOffset+=6}this.setIndex(new THREE.BufferAttribute(indices,
1));this.addAttribute("position",new THREE.BufferAttribute(vertices,3));this.addAttribute("normal",new THREE.BufferAttribute(normals,3));this.addAttribute("uv",new THREE.BufferAttribute(uvs,2))};THREE.TorusBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.TorusBufferGeometry.prototype.constructor=THREE.TorusBufferGeometry;
THREE.TorusGeometry=function(radius,tube,radialSegments,tubularSegments,arc){THREE.Geometry.call(this);this.type="TorusGeometry";this.parameters={radius:radius,tube:tube,radialSegments:radialSegments,tubularSegments:tubularSegments,arc:arc};this.fromBufferGeometry(new THREE.TorusBufferGeometry(radius,tube,radialSegments,tubularSegments,arc))};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusGeometry.prototype.constructor=THREE.TorusGeometry;
THREE.TorusKnotBufferGeometry=function(radius,tube,tubularSegments,radialSegments,p,q){THREE.BufferGeometry.call(this);this.type="TorusKnotBufferGeometry";this.parameters={radius:radius,tube:tube,tubularSegments:tubularSegments,radialSegments:radialSegments,p:p,q:q};radius=radius||100;tube=tube||40;tubularSegments=Math.floor(tubularSegments)||64;radialSegments=Math.floor(radialSegments)||8;p=p||2;q=q||3;var vertexCount=(radialSegments+1)*(tubularSegments+1);var indexCount=radialSegments*tubularSegments*
2*3;var indices=new THREE.BufferAttribute(new (indexCount>65535?Uint32Array:Uint16Array)(indexCount),1);var vertices=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var normals=new THREE.BufferAttribute(new Float32Array(vertexCount*3),3);var uvs=new THREE.BufferAttribute(new Float32Array(vertexCount*2),2);var i,j,index=0,indexOffset=0;var vertex=new THREE.Vector3;var normal=new THREE.Vector3;var uv=new THREE.Vector2;var P1=new THREE.Vector3;var P2=new THREE.Vector3;var B=new THREE.Vector3;
var T=new THREE.Vector3;var N=new THREE.Vector3;for(i=0;i<=tubularSegments;++i){var u=i/tubularSegments*p*Math.PI*2;calculatePositionOnCurve(u,p,q,radius,P1);calculatePositionOnCurve(u+.01,p,q,radius,P2);T.subVectors(P2,P1);N.addVectors(P2,P1);B.crossVectors(T,N);N.crossVectors(B,T);B.normalize();N.normalize();for(j=0;j<=radialSegments;++j){var v=j/radialSegments*Math.PI*2;var cx=-tube*Math.cos(v);var cy=tube*Math.sin(v);vertex.x=P1.x+(cx*N.x+cy*B.x);vertex.y=P1.y+(cx*N.y+cy*B.y);vertex.z=P1.z+(cx*
N.z+cy*B.z);vertices.setXYZ(index,vertex.x,vertex.y,vertex.z);normal.subVectors(vertex,P1).normalize();normals.setXYZ(index,normal.x,normal.y,normal.z);uv.x=i/tubularSegments;uv.y=j/radialSegments;uvs.setXY(index,uv.x,uv.y);index++}}for(j=1;j<=tubularSegments;j++)for(i=1;i<=radialSegments;i++){var a=(radialSegments+1)*(j-1)+(i-1);var b=(radialSegments+1)*j+(i-1);var c=(radialSegments+1)*j+i;var d=(radialSegments+1)*(j-1)+i;indices.setX(indexOffset,a);indexOffset++;indices.setX(indexOffset,b);indexOffset++;
indices.setX(indexOffset,d);indexOffset++;indices.setX(indexOffset,b);indexOffset++;indices.setX(indexOffset,c);indexOffset++;indices.setX(indexOffset,d);indexOffset++}this.setIndex(indices);this.addAttribute("position",vertices);this.addAttribute("normal",normals);this.addAttribute("uv",uvs);function calculatePositionOnCurve(u,p,q,radius,position){var cu=Math.cos(u);var su=Math.sin(u);var quOverP=q/p*u;var cs=Math.cos(quOverP);position.x=radius*(2+cs)*.5*cu;position.y=radius*(2+cs)*su*.5;position.z=
radius*Math.sin(quOverP)*.5}};THREE.TorusKnotBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.TorusKnotBufferGeometry.prototype.constructor=THREE.TorusKnotBufferGeometry;
THREE.TorusKnotGeometry=function(radius,tube,tubularSegments,radialSegments,p,q,heightScale){THREE.Geometry.call(this);this.type="TorusKnotGeometry";this.parameters={radius:radius,tube:tube,tubularSegments:tubularSegments,radialSegments:radialSegments,p:p,q:q};if(heightScale!==undefined)console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead.");this.fromBufferGeometry(new THREE.TorusKnotBufferGeometry(radius,tube,tubularSegments,radialSegments,p,q));this.mergeVertices()};
THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry.prototype.constructor=THREE.TorusKnotGeometry;
THREE.TubeGeometry=function(path,segments,radius,radialSegments,closed,taper){THREE.Geometry.call(this);this.type="TubeGeometry";this.parameters={path:path,segments:segments,radius:radius,radialSegments:radialSegments,closed:closed,taper:taper};segments=segments||64;radius=radius||1;radialSegments=radialSegments||8;closed=closed||false;taper=taper||THREE.TubeGeometry.NoTaper;var grid=[];var scope=this,tangent,normal,binormal,numpoints=segments+1,u,v,r,cx,cy,pos,pos2=new THREE.Vector3,i,j,ip,jp,a,
b,c,d,uva,uvb,uvc,uvd;var frames=new THREE.TubeGeometry.FrenetFrames(path,segments,closed),tangents=frames.tangents,normals=frames.normals,binormals=frames.binormals;this.tangents=tangents;this.normals=normals;this.binormals=binormals;function vert(x,y,z){return scope.vertices.push(new THREE.Vector3(x,y,z))-1}for(i=0;i<numpoints;i++){grid[i]=[];u=i/(numpoints-1);pos=path.getPointAt(u);tangent=tangents[i];normal=normals[i];binormal=binormals[i];r=radius*taper(u);for(j=0;j<radialSegments;j++){v=j/radialSegments*
2*Math.PI;cx=-r*Math.cos(v);cy=r*Math.sin(v);pos2.copy(pos);pos2.x+=cx*normal.x+cy*binormal.x;pos2.y+=cx*normal.y+cy*binormal.y;pos2.z+=cx*normal.z+cy*binormal.z;grid[i][j]=vert(pos2.x,pos2.y,pos2.z)}}for(i=0;i<segments;i++)for(j=0;j<radialSegments;j++){ip=closed?(i+1)%segments:i+1;jp=(j+1)%radialSegments;a=grid[i][j];b=grid[ip][j];c=grid[ip][jp];d=grid[i][jp];uva=new THREE.Vector2(i/segments,j/radialSegments);uvb=new THREE.Vector2((i+1)/segments,j/radialSegments);uvc=new THREE.Vector2((i+1)/segments,
(j+1)/radialSegments);uvd=new THREE.Vector2(i/segments,(j+1)/radialSegments);this.faces.push(new THREE.Face3(a,b,d));this.faceVertexUvs[0].push([uva,uvb,uvd]);this.faces.push(new THREE.Face3(b,c,d));this.faceVertexUvs[0].push([uvb.clone(),uvc,uvd.clone()])}this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.prototype.constructor=THREE.TubeGeometry;THREE.TubeGeometry.NoTaper=function(u){return 1};
THREE.TubeGeometry.SinusoidalTaper=function(u){return Math.sin(Math.PI*u)};
THREE.TubeGeometry.FrenetFrames=function(path,segments,closed){var normal=new THREE.Vector3,tangents=[],normals=[],binormals=[],vec=new THREE.Vector3,mat=new THREE.Matrix4,numpoints=segments+1,theta,smallest,tx,ty,tz,i,u;this.tangents=tangents;this.normals=normals;this.binormals=binormals;for(i=0;i<numpoints;i++){u=i/(numpoints-1);tangents[i]=path.getTangentAt(u);tangents[i].normalize()}initialNormal3();function initialNormal3(){normals[0]=new THREE.Vector3;binormals[0]=new THREE.Vector3;smallest=
Number.MAX_VALUE;tx=Math.abs(tangents[0].x);ty=Math.abs(tangents[0].y);tz=Math.abs(tangents[0].z);if(tx<=smallest){smallest=tx;normal.set(1,0,0)}if(ty<=smallest){smallest=ty;normal.set(0,1,0)}if(tz<=smallest)normal.set(0,0,1);vec.crossVectors(tangents[0],normal).normalize();normals[0].crossVectors(tangents[0],vec);binormals[0].crossVectors(tangents[0],normals[0])}for(i=1;i<numpoints;i++){normals[i]=normals[i-1].clone();binormals[i]=binormals[i-1].clone();vec.crossVectors(tangents[i-1],tangents[i]);
if(vec.length()>Number.EPSILON){vec.normalize();theta=Math.acos(THREE.Math.clamp(tangents[i-1].dot(tangents[i]),-1,1));normals[i].applyMatrix4(mat.makeRotationAxis(vec,theta))}binormals[i].crossVectors(tangents[i],normals[i])}if(closed){theta=Math.acos(THREE.Math.clamp(normals[0].dot(normals[numpoints-1]),-1,1));theta/=numpoints-1;if(tangents[0].dot(vec.crossVectors(normals[0],normals[numpoints-1]))>0)theta=-theta;for(i=1;i<numpoints;i++){normals[i].applyMatrix4(mat.makeRotationAxis(tangents[i],theta*
i));binormals[i].crossVectors(tangents[i],normals[i])}}};
THREE.PolyhedronGeometry=function(vertices,indices,radius,detail){THREE.Geometry.call(this);this.type="PolyhedronGeometry";this.parameters={vertices:vertices,indices:indices,radius:radius,detail:detail};radius=radius||1;detail=detail||0;var that=this;for(var i=0,l=vertices.length;i<l;i+=3)prepare(new THREE.Vector3(vertices[i],vertices[i+1],vertices[i+2]));var p=this.vertices;var faces=[];for(var i=0,j=0,l=indices.length;i<l;i+=3,j++){var v1=p[indices[i]];var v2=p[indices[i+1]];var v3=p[indices[i+
2]];faces[j]=new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()],undefined,j)}var centroid=new THREE.Vector3;for(var i=0,l=faces.length;i<l;i++)subdivide(faces[i],detail);for(var i=0,l=this.faceVertexUvs[0].length;i<l;i++){var uvs=this.faceVertexUvs[0][i];var x0=uvs[0].x;var x1=uvs[1].x;var x2=uvs[2].x;var max=Math.max(x0,x1,x2);var min=Math.min(x0,x1,x2);if(max>.9&&min<.1){if(x0<.2)uvs[0].x+=1;if(x1<.2)uvs[1].x+=1;if(x2<.2)uvs[2].x+=1}}for(var i=0,l=this.vertices.length;i<
l;i++)this.vertices[i].multiplyScalar(radius);this.mergeVertices();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,radius);function prepare(vector){var vertex=vector.normalize().clone();vertex.index=that.vertices.push(vertex)-1;var u=azimuth(vector)/2/Math.PI+.5;var v=inclination(vector)/Math.PI+.5;vertex.uv=new THREE.Vector2(u,1-v);return vertex}function make(v1,v2,v3,materialIndex){var face=new THREE.Face3(v1.index,v2.index,v3.index,[v1.clone(),v2.clone(),v3.clone()],
undefined,materialIndex);that.faces.push(face);centroid.copy(v1).add(v2).add(v3).divideScalar(3);var azi=azimuth(centroid);that.faceVertexUvs[0].push([correctUV(v1.uv,v1,azi),correctUV(v2.uv,v2,azi),correctUV(v3.uv,v3,azi)])}function subdivide(face,detail){var cols=Math.pow(2,detail);var a=prepare(that.vertices[face.a]);var b=prepare(that.vertices[face.b]);var c=prepare(that.vertices[face.c]);var v=[];var materialIndex=face.materialIndex;for(var i=0;i<=cols;i++){v[i]=[];var aj=prepare(a.clone().lerp(c,
i/cols));var bj=prepare(b.clone().lerp(c,i/cols));var rows=cols-i;for(var j=0;j<=rows;j++)if(j===0&&i===cols)v[i][j]=aj;else v[i][j]=prepare(aj.clone().lerp(bj,j/rows))}for(var i=0;i<cols;i++)for(var j=0;j<2*(cols-i)-1;j++){var k=Math.floor(j/2);if(j%2===0)make(v[i][k+1],v[i+1][k],v[i][k],materialIndex);else make(v[i][k+1],v[i+1][k+1],v[i+1][k],materialIndex)}}function azimuth(vector){return Math.atan2(vector.z,-vector.x)}function inclination(vector){return Math.atan2(-vector.y,Math.sqrt(vector.x*
vector.x+vector.z*vector.z))}function correctUV(uv,vector,azimuth){if(azimuth<0&&uv.x===1)uv=new THREE.Vector2(uv.x-1,uv.y);if(vector.x===0&&vector.z===0)uv=new THREE.Vector2(azimuth/2/Math.PI+.5,uv.y);return uv.clone()}};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PolyhedronGeometry.prototype.constructor=THREE.PolyhedronGeometry;
THREE.DodecahedronGeometry=function(radius,detail){var t=(1+Math.sqrt(5))/2;var r=1/t;var vertices=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-t,0,-r,t,0,r,-t,0,r,t,-r,-t,0,-r,t,0,r,-t,0,r,t,0,-t,0,-r,t,0,-r,-t,0,r,t,0,r];var indices=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,
1,12,14,1,14,5,1,5,9];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type="DodecahedronGeometry";this.parameters={radius:radius,detail:detail}};THREE.DodecahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.DodecahedronGeometry.prototype.constructor=THREE.DodecahedronGeometry;
THREE.IcosahedronGeometry=function(radius,detail){var t=(1+Math.sqrt(5))/2;var vertices=[-1,t,0,1,t,0,-1,-t,0,1,-t,0,0,-1,t,0,1,t,0,-1,-t,0,1,-t,t,0,-1,t,0,1,-t,0,-1,-t,0,1];var indices=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type="IcosahedronGeometry";this.parameters={radius:radius,detail:detail}};THREE.IcosahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);
THREE.IcosahedronGeometry.prototype.constructor=THREE.IcosahedronGeometry;THREE.OctahedronGeometry=function(radius,detail){var vertices=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1];var indices=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type="OctahedronGeometry";this.parameters={radius:radius,detail:detail}};THREE.OctahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);
THREE.OctahedronGeometry.prototype.constructor=THREE.OctahedronGeometry;THREE.TetrahedronGeometry=function(radius,detail){var vertices=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1];var indices=[2,1,0,0,3,2,1,3,0,2,3,1];THREE.PolyhedronGeometry.call(this,vertices,indices,radius,detail);this.type="TetrahedronGeometry";this.parameters={radius:radius,detail:detail}};THREE.TetrahedronGeometry.prototype=Object.create(THREE.PolyhedronGeometry.prototype);THREE.TetrahedronGeometry.prototype.constructor=THREE.TetrahedronGeometry;
THREE.ParametricGeometry=function(func,slices,stacks){THREE.Geometry.call(this);this.type="ParametricGeometry";this.parameters={func:func,slices:slices,stacks:stacks};var verts=this.vertices;var faces=this.faces;var uvs=this.faceVertexUvs[0];var i,j,p;var u,v;var sliceCount=slices+1;for(i=0;i<=stacks;i++){v=i/stacks;for(j=0;j<=slices;j++){u=j/slices;p=func(u,v);verts.push(p)}}var a,b,c,d;var uva,uvb,uvc,uvd;for(i=0;i<stacks;i++)for(j=0;j<slices;j++){a=i*sliceCount+j;b=i*sliceCount+j+1;c=(i+1)*sliceCount+
j+1;d=(i+1)*sliceCount+j;uva=new THREE.Vector2(j/slices,i/stacks);uvb=new THREE.Vector2((j+1)/slices,i/stacks);uvc=new THREE.Vector2((j+1)/slices,(i+1)/stacks);uvd=new THREE.Vector2(j/slices,(i+1)/stacks);faces.push(new THREE.Face3(a,b,d));uvs.push([uva,uvb,uvd]);faces.push(new THREE.Face3(b,c,d));uvs.push([uvb.clone(),uvc,uvd.clone()])}this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry.prototype.constructor=THREE.ParametricGeometry;
THREE.WireframeGeometry=function(geometry){THREE.BufferGeometry.call(this);var edge=[0,0],hash={};function sortFunction(a,b){return a-b}var keys=["a","b","c"];if(geometry instanceof THREE.Geometry){var vertices=geometry.vertices;var faces=geometry.faces;var numEdges=0;var edges=new Uint32Array(6*faces.length);for(var i=0,l=faces.length;i<l;i++){var face=faces[i];for(var j=0;j<3;j++){edge[0]=face[keys[j]];edge[1]=face[keys[(j+1)%3]];edge.sort(sortFunction);var key=edge.toString();if(hash[key]===undefined){edges[2*
numEdges]=edge[0];edges[2*numEdges+1]=edge[1];hash[key]=true;numEdges++}}}var coords=new Float32Array(numEdges*2*3);for(var i=0,l=numEdges;i<l;i++)for(var j=0;j<2;j++){var vertex=vertices[edges[2*i+j]];var index=6*i+3*j;coords[index+0]=vertex.x;coords[index+1]=vertex.y;coords[index+2]=vertex.z}this.addAttribute("position",new THREE.BufferAttribute(coords,3))}else if(geometry instanceof THREE.BufferGeometry)if(geometry.index!==null){var indices=geometry.index.array;var vertices=geometry.attributes.position;
var groups=geometry.groups;var numEdges=0;if(groups.length===0)geometry.addGroup(0,indices.length);var edges=new Uint32Array(2*indices.length);for(var o=0,ol=groups.length;o<ol;++o){var group=groups[o];var start=group.start;var count=group.count;for(var i=start,il=start+count;i<il;i+=3)for(var j=0;j<3;j++){edge[0]=indices[i+j];edge[1]=indices[i+(j+1)%3];edge.sort(sortFunction);var key=edge.toString();if(hash[key]===undefined){edges[2*numEdges]=edge[0];edges[2*numEdges+1]=edge[1];hash[key]=true;numEdges++}}}var coords=
new Float32Array(numEdges*2*3);for(var i=0,l=numEdges;i<l;i++)for(var j=0;j<2;j++){var index=6*i+3*j;var index2=edges[2*i+j];coords[index+0]=vertices.getX(index2);coords[index+1]=vertices.getY(index2);coords[index+2]=vertices.getZ(index2)}this.addAttribute("position",new THREE.BufferAttribute(coords,3))}else{var vertices=geometry.attributes.position.array;var numEdges=vertices.length/3;var numTris=numEdges/3;var coords=new Float32Array(numEdges*2*3);for(var i=0,l=numTris;i<l;i++)for(var j=0;j<3;j++){var index=
18*i+6*j;var index1=9*i+3*j;coords[index+0]=vertices[index1];coords[index+1]=vertices[index1+1];coords[index+2]=vertices[index1+2];var index2=9*i+3*((j+1)%3);coords[index+3]=vertices[index2];coords[index+4]=vertices[index2+1];coords[index+5]=vertices[index2+2]}this.addAttribute("position",new THREE.BufferAttribute(coords,3))}};THREE.WireframeGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.WireframeGeometry.prototype.constructor=THREE.WireframeGeometry;
THREE.AxisHelper=function(size){size=size||1;var vertices=new Float32Array([0,0,0,size,0,0,0,0,0,0,size,0,0,0,0,0,0,size]);var colors=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);var geometry=new THREE.BufferGeometry;geometry.addAttribute("position",new THREE.BufferAttribute(vertices,3));geometry.addAttribute("color",new THREE.BufferAttribute(colors,3));var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,geometry,material)};
THREE.AxisHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.AxisHelper.prototype.constructor=THREE.AxisHelper;
THREE.ArrowHelper=function(){var lineGeometry=new THREE.BufferGeometry;lineGeometry.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,1,0],3));var coneGeometry=new THREE.CylinderBufferGeometry(0,.5,1,5,1);coneGeometry.translate(0,-.5,0);return function ArrowHelper(dir,origin,length,color,headLength,headWidth){THREE.Object3D.call(this);if(color===undefined)color=16776960;if(length===undefined)length=1;if(headLength===undefined)headLength=.2*length;if(headWidth===undefined)headWidth=.2*headLength;
this.position.copy(origin);this.line=new THREE.Line(lineGeometry,new THREE.LineBasicMaterial({color:color}));this.line.matrixAutoUpdate=false;this.add(this.line);this.cone=new THREE.Mesh(coneGeometry,new THREE.MeshBasicMaterial({color:color}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(dir);this.setLength(length,headLength,headWidth)}}();THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.constructor=THREE.ArrowHelper;
THREE.ArrowHelper.prototype.setDirection=function(){var axis=new THREE.Vector3;var radians;return function setDirection(dir){if(dir.y>.99999)this.quaternion.set(0,0,0,1);else if(dir.y<-.99999)this.quaternion.set(1,0,0,0);else{axis.set(dir.z,0,-dir.x).normalize();radians=Math.acos(dir.y);this.quaternion.setFromAxisAngle(axis,radians)}}}();
THREE.ArrowHelper.prototype.setLength=function(length,headLength,headWidth){if(headLength===undefined)headLength=.2*length;if(headWidth===undefined)headWidth=.2*headLength;this.line.scale.set(1,Math.max(0,length-headLength),1);this.line.updateMatrix();this.cone.scale.set(headWidth,headLength,headWidth);this.cone.position.y=length;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(color){this.line.material.color.copy(color);this.cone.material.color.copy(color)};
THREE.BoxHelper=function(object){var indices=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var positions=new Float32Array(8*3);var geometry=new THREE.BufferGeometry;geometry.setIndex(new THREE.BufferAttribute(indices,1));geometry.addAttribute("position",new THREE.BufferAttribute(positions,3));THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:16776960}));if(object!==undefined)this.update(object)};THREE.BoxHelper.prototype=Object.create(THREE.LineSegments.prototype);
THREE.BoxHelper.prototype.constructor=THREE.BoxHelper;
THREE.BoxHelper.prototype.update=function(){var box=new THREE.Box3;return function(object){if(object instanceof THREE.Box3)box.copy(object);else box.setFromObject(object);if(box.isEmpty())return;var min=box.min;var max=box.max;var position=this.geometry.attributes.position;var array=position.array;array[0]=max.x;array[1]=max.y;array[2]=max.z;array[3]=min.x;array[4]=max.y;array[5]=max.z;array[6]=min.x;array[7]=min.y;array[8]=max.z;array[9]=max.x;array[10]=min.y;array[11]=max.z;array[12]=max.x;array[13]=
max.y;array[14]=min.z;array[15]=min.x;array[16]=max.y;array[17]=min.z;array[18]=min.x;array[19]=min.y;array[20]=min.z;array[21]=max.x;array[22]=min.y;array[23]=min.z;position.needsUpdate=true;this.geometry.computeBoundingSphere()}}();THREE.BoundingBoxHelper=function(object,hex){var color=hex!==undefined?hex:8947848;this.object=object;this.box=new THREE.Box3;THREE.Mesh.call(this,new THREE.BoxGeometry(1,1,1),new THREE.MeshBasicMaterial({color:color,wireframe:true}))};
THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.constructor=THREE.BoundingBoxHelper;THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};
THREE.CameraHelper=function(camera){var geometry=new THREE.Geometry;var material=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});var pointMap={};var hexFrustum=16755200;var hexCone=16711680;var hexUp=43775;var hexTarget=16777215;var hexCross=3355443;addLine("n1","n2",hexFrustum);addLine("n2","n4",hexFrustum);addLine("n4","n3",hexFrustum);addLine("n3","n1",hexFrustum);addLine("f1","f2",hexFrustum);addLine("f2","f4",hexFrustum);addLine("f4","f3",hexFrustum);addLine("f3",
"f1",hexFrustum);addLine("n1","f1",hexFrustum);addLine("n2","f2",hexFrustum);addLine("n3","f3",hexFrustum);addLine("n4","f4",hexFrustum);addLine("p","n1",hexCone);addLine("p","n2",hexCone);addLine("p","n3",hexCone);addLine("p","n4",hexCone);addLine("u1","u2",hexUp);addLine("u2","u3",hexUp);addLine("u3","u1",hexUp);addLine("c","t",hexTarget);addLine("p","c",hexCross);addLine("cn1","cn2",hexCross);addLine("cn3","cn4",hexCross);addLine("cf1","cf2",hexCross);addLine("cf3","cf4",hexCross);function addLine(a,
b,hex){addPoint(a,hex);addPoint(b,hex)}function addPoint(id,hex){geometry.vertices.push(new THREE.Vector3);geometry.colors.push(new THREE.Color(hex));if(pointMap[id]===undefined)pointMap[id]=[];pointMap[id].push(geometry.vertices.length-1)}THREE.LineSegments.call(this,geometry,material);this.camera=camera;this.camera.updateProjectionMatrix();this.matrix=camera.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=pointMap;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.LineSegments.prototype);
THREE.CameraHelper.prototype.constructor=THREE.CameraHelper;
THREE.CameraHelper.prototype.update=function(){var geometry,pointMap;var vector=new THREE.Vector3;var camera=new THREE.Camera;function setPoint(point,x,y,z){vector.set(x,y,z).unproject(camera);var points=pointMap[point];if(points!==undefined)for(var i=0,il=points.length;i<il;i++)geometry.vertices[points[i]].copy(vector)}return function(){geometry=this.geometry;pointMap=this.pointMap;var w=1,h=1;camera.projectionMatrix.copy(this.camera.projectionMatrix);setPoint("c",0,0,-1);setPoint("t",0,0,1);setPoint("n1",
-w,-h,-1);setPoint("n2",w,-h,-1);setPoint("n3",-w,h,-1);setPoint("n4",w,h,-1);setPoint("f1",-w,-h,1);setPoint("f2",w,-h,1);setPoint("f3",-w,h,1);setPoint("f4",w,h,1);setPoint("u1",w*.7,h*1.1,-1);setPoint("u2",-w*.7,h*1.1,-1);setPoint("u3",0,h*2,-1);setPoint("cf1",-w,0,1);setPoint("cf2",w,0,1);setPoint("cf3",0,-h,1);setPoint("cf4",0,h,1);setPoint("cn1",-w,0,-1);setPoint("cn2",w,0,-1);setPoint("cn3",0,-h,-1);setPoint("cn4",0,h,-1);geometry.verticesNeedUpdate=true}}();
THREE.DirectionalLightHelper=function(light,size){THREE.Object3D.call(this);this.light=light;this.light.updateMatrixWorld();this.matrix=light.matrixWorld;this.matrixAutoUpdate=false;if(size===undefined)size=1;var geometry=new THREE.BufferGeometry;geometry.addAttribute("position",new THREE.Float32Attribute([-size,size,0,size,size,0,size,-size,0,-size,-size,0,-size,size,0],3));var material=new THREE.LineBasicMaterial({fog:false});this.add(new THREE.Line(geometry,material));geometry=new THREE.BufferGeometry;
geometry.addAttribute("position",new THREE.Float32Attribute([0,0,0,0,0,1],3));this.add(new THREE.Line(geometry,material));this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.constructor=THREE.DirectionalLightHelper;
THREE.DirectionalLightHelper.prototype.dispose=function(){var lightPlane=this.children[0];var targetLine=this.children[1];lightPlane.geometry.dispose();lightPlane.material.dispose();targetLine.geometry.dispose();targetLine.material.dispose()};
THREE.DirectionalLightHelper.prototype.update=function(){var v1=new THREE.Vector3;var v2=new THREE.Vector3;var v3=new THREE.Vector3;return function(){v1.setFromMatrixPosition(this.light.matrixWorld);v2.setFromMatrixPosition(this.light.target.matrixWorld);v3.subVectors(v2,v1);var lightPlane=this.children[0];var targetLine=this.children[1];lightPlane.lookAt(v3);lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);targetLine.lookAt(v3);targetLine.scale.z=v3.length()}}();
THREE.EdgesHelper=function(object,hex,thresholdAngle){var color=hex!==undefined?hex:16777215;THREE.LineSegments.call(this,new THREE.EdgesGeometry(object.geometry,thresholdAngle),new THREE.LineBasicMaterial({color:color}));this.matrix=object.matrixWorld;this.matrixAutoUpdate=false};THREE.EdgesHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.EdgesHelper.prototype.constructor=THREE.EdgesHelper;
THREE.FaceNormalsHelper=function(object,size,hex,linewidth){this.object=object;this.size=size!==undefined?size:1;var color=hex!==undefined?hex:16776960;var width=linewidth!==undefined?linewidth:1;var nNormals=0;var objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry)nNormals=objGeometry.faces.length;else console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var geometry=new THREE.BufferGeometry;var positions=new THREE.Float32Attribute(nNormals*
2*3,3);geometry.addAttribute("position",positions);THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width}));this.matrixAutoUpdate=false;this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.FaceNormalsHelper.prototype.constructor=THREE.FaceNormalsHelper;
THREE.FaceNormalsHelper.prototype.update=function(){var v1=new THREE.Vector3;var v2=new THREE.Vector3;var normalMatrix=new THREE.Matrix3;return function update(){this.object.updateMatrixWorld(true);normalMatrix.getNormalMatrix(this.object.matrixWorld);var matrixWorld=this.object.matrixWorld;var position=this.geometry.attributes.position;var objGeometry=this.object.geometry;var vertices=objGeometry.vertices;var faces=objGeometry.faces;var idx=0;for(var i=0,l=faces.length;i<l;i++){var face=faces[i];
var normal=face.normal;v1.copy(vertices[face.a]).add(vertices[face.b]).add(vertices[face.c]).divideScalar(3).applyMatrix4(matrixWorld);v2.copy(normal).applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx=idx+1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx=idx+1}position.needsUpdate=true;return this}}();
THREE.GridHelper=function(size,step,color1,color2){color1=new THREE.Color(color1!==undefined?color1:4473924);color2=new THREE.Color(color2!==undefined?color2:8947848);var vertices=[];var colors=[];for(var i=-size,j=0;i<=size;i+=step){vertices.push(-size,0,i,size,0,i);vertices.push(i,0,-size,i,0,size);var color=i===0?color1:color2;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3;color.toArray(colors,j);j+=3}var geometry=new THREE.BufferGeometry;geometry.addAttribute("position",
new THREE.Float32Attribute(vertices,3));geometry.addAttribute("color",new THREE.Float32Attribute(colors,3));var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.LineSegments.call(this,geometry,material)};THREE.GridHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.GridHelper.prototype.constructor=THREE.GridHelper;THREE.GridHelper.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};
THREE.HemisphereLightHelper=function(light,sphereSize){THREE.Object3D.call(this);this.light=light;this.light.updateMatrixWorld();this.matrix=light.matrixWorld;this.matrixAutoUpdate=false;this.colors=[new THREE.Color,new THREE.Color];var geometry=new THREE.SphereGeometry(sphereSize,4,2);geometry.rotateX(-Math.PI/2);for(var i=0,il=8;i<il;i++)geometry.faces[i].color=this.colors[i<4?0:1];var material=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:true});this.lightSphere=new THREE.Mesh(geometry,
material);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.constructor=THREE.HemisphereLightHelper;THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};
THREE.HemisphereLightHelper.prototype.update=function(){var vector=new THREE.Vector3;return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(vector.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=true}}();
THREE.PointLightHelper=function(light,sphereSize){this.light=light;this.light.updateMatrixWorld();var geometry=new THREE.SphereBufferGeometry(sphereSize,4,2);var material=new THREE.MeshBasicMaterial({wireframe:true,fog:false});material.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,geometry,material);this.matrix=this.light.matrixWorld;this.matrixAutoUpdate=false};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);
THREE.PointLightHelper.prototype.constructor=THREE.PointLightHelper;THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SkeletonHelper=function(object){this.bones=this.getBoneList(object);var geometry=new THREE.Geometry;for(var i=0;i<this.bones.length;i++){var bone=this.bones[i];if(bone.parent instanceof THREE.Bone){geometry.vertices.push(new THREE.Vector3);geometry.vertices.push(new THREE.Vector3);geometry.colors.push(new THREE.Color(0,0,1));geometry.colors.push(new THREE.Color(0,1,0))}}geometry.dynamic=true;var material=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors,depthTest:false,depthWrite:false,
transparent:true});THREE.LineSegments.call(this,geometry,material);this.root=object;this.matrix=object.matrixWorld;this.matrixAutoUpdate=false;this.update()};THREE.SkeletonHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.SkeletonHelper.prototype.constructor=THREE.SkeletonHelper;
THREE.SkeletonHelper.prototype.getBoneList=function(object){var boneList=[];if(object instanceof THREE.Bone)boneList.push(object);for(var i=0;i<object.children.length;i++)boneList.push.apply(boneList,this.getBoneList(object.children[i]));return boneList};
THREE.SkeletonHelper.prototype.update=function(){var geometry=this.geometry;var matrixWorldInv=(new THREE.Matrix4).getInverse(this.root.matrixWorld);var boneMatrix=new THREE.Matrix4;var j=0;for(var i=0;i<this.bones.length;i++){var bone=this.bones[i];if(bone.parent instanceof THREE.Bone){boneMatrix.multiplyMatrices(matrixWorldInv,bone.matrixWorld);geometry.vertices[j].setFromMatrixPosition(boneMatrix);boneMatrix.multiplyMatrices(matrixWorldInv,bone.parent.matrixWorld);geometry.vertices[j+1].setFromMatrixPosition(boneMatrix);
j+=2}}geometry.verticesNeedUpdate=true;geometry.computeBoundingSphere()};
THREE.SpotLightHelper=function(light){THREE.Object3D.call(this);this.light=light;this.light.updateMatrixWorld();this.matrix=light.matrixWorld;this.matrixAutoUpdate=false;var geometry=new THREE.BufferGeometry;var positions=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,j=1,l=32;i<l;i++,j++){var p1=i/l*Math.PI*2;var p2=j/l*Math.PI*2;positions.push(Math.cos(p1),Math.sin(p1),1,Math.cos(p2),Math.sin(p2),1)}geometry.addAttribute("position",new THREE.Float32Attribute(positions,
3));var material=new THREE.LineBasicMaterial({fog:false});this.cone=new THREE.LineSegments(geometry,material);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.constructor=THREE.SpotLightHelper;THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};
THREE.SpotLightHelper.prototype.update=function(){var vector=new THREE.Vector3;var vector2=new THREE.Vector3;return function(){var coneLength=this.light.distance?this.light.distance:1E3;var coneWidth=coneLength*Math.tan(this.light.angle);this.cone.scale.set(coneWidth,coneWidth,coneLength);vector.setFromMatrixPosition(this.light.matrixWorld);vector2.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(vector2.sub(vector));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();
THREE.VertexNormalsHelper=function(object,size,hex,linewidth){this.object=object;this.size=size!==undefined?size:1;var color=hex!==undefined?hex:16711680;var width=linewidth!==undefined?linewidth:1;var nNormals=0;var objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry)nNormals=objGeometry.faces.length*3;else if(objGeometry instanceof THREE.BufferGeometry)nNormals=objGeometry.attributes.normal.count;var geometry=new THREE.BufferGeometry;var positions=new THREE.Float32Attribute(nNormals*
2*3,3);geometry.addAttribute("position",positions);THREE.LineSegments.call(this,geometry,new THREE.LineBasicMaterial({color:color,linewidth:width}));this.matrixAutoUpdate=false;this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.VertexNormalsHelper.prototype.constructor=THREE.VertexNormalsHelper;
THREE.VertexNormalsHelper.prototype.update=function(){var v1=new THREE.Vector3;var v2=new THREE.Vector3;var normalMatrix=new THREE.Matrix3;return function update(){var keys=["a","b","c"];this.object.updateMatrixWorld(true);normalMatrix.getNormalMatrix(this.object.matrixWorld);var matrixWorld=this.object.matrixWorld;var position=this.geometry.attributes.position;var objGeometry=this.object.geometry;if(objGeometry instanceof THREE.Geometry){var vertices=objGeometry.vertices;var faces=objGeometry.faces;
var idx=0;for(var i=0,l=faces.length;i<l;i++){var face=faces[i];for(var j=0,jl=face.vertexNormals.length;j<jl;j++){var vertex=vertices[face[keys[j]]];var normal=face.vertexNormals[j];v1.copy(vertex).applyMatrix4(matrixWorld);v2.copy(normal).applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx=idx+1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx=idx+1}}}else if(objGeometry instanceof THREE.BufferGeometry){var objPos=objGeometry.attributes.position;
var objNorm=objGeometry.attributes.normal;var idx=0;for(var j=0,jl=objPos.count;j<jl;j++){v1.set(objPos.getX(j),objPos.getY(j),objPos.getZ(j)).applyMatrix4(matrixWorld);v2.set(objNorm.getX(j),objNorm.getY(j),objNorm.getZ(j));v2.applyMatrix3(normalMatrix).normalize().multiplyScalar(this.size).add(v1);position.setXYZ(idx,v1.x,v1.y,v1.z);idx=idx+1;position.setXYZ(idx,v2.x,v2.y,v2.z);idx=idx+1}}position.needsUpdate=true;return this}}();
THREE.WireframeHelper=function(object,hex){var color=hex!==undefined?hex:16777215;THREE.LineSegments.call(this,new THREE.WireframeGeometry(object.geometry),new THREE.LineBasicMaterial({color:color}));this.matrix=object.matrixWorld;this.matrixAutoUpdate=false};THREE.WireframeHelper.prototype=Object.create(THREE.LineSegments.prototype);THREE.WireframeHelper.prototype.constructor=THREE.WireframeHelper;
THREE.ImmediateRenderObject=function(material){THREE.Object3D.call(this);this.material=material;this.render=function(renderCallback){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.ImmediateRenderObject.prototype.constructor=THREE.ImmediateRenderObject;
THREE.MorphBlendMesh=function(geometry,material){THREE.Mesh.call(this,geometry,material);this.animationsMap={};this.animationsList=[];var numFrames=this.geometry.morphTargets.length;var name="__default";var startFrame=0;var endFrame=numFrames-1;var fps=numFrames/1;this.createAnimation(name,startFrame,endFrame,fps);this.setAnimationWeight(name,1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.constructor=THREE.MorphBlendMesh;
THREE.MorphBlendMesh.prototype.createAnimation=function(name,start,end,fps){var animation={start:start,end:end,length:end-start+1,fps:fps,duration:(end-start)/fps,lastFrame:0,currentFrame:0,active:false,time:0,direction:1,weight:1,directionBackwards:false,mirroredLoop:false};this.animationsMap[name]=animation;this.animationsList.push(animation)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(fps){var pattern=/([a-z]+)_?(\d+)/i;var firstAnimation,frameRanges={};var geometry=this.geometry;for(var i=0,il=geometry.morphTargets.length;i<il;i++){var morph=geometry.morphTargets[i];var chunks=morph.name.match(pattern);if(chunks&&chunks.length>1){var name=chunks[1];if(!frameRanges[name])frameRanges[name]={start:Infinity,end:-Infinity};var range=frameRanges[name];if(i<range.start)range.start=i;if(i>range.end)range.end=i;if(!firstAnimation)firstAnimation=
name}}for(var name in frameRanges){var range=frameRanges[name];this.createAnimation(name,range.start,range.end,fps)}this.firstAnimation=firstAnimation};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(name){var animation=this.animationsMap[name];if(animation){animation.direction=1;animation.directionBackwards=false}};
THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(name){var animation=this.animationsMap[name];if(animation){animation.direction=-1;animation.directionBackwards=true}};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(name,fps){var animation=this.animationsMap[name];if(animation){animation.fps=fps;animation.duration=(animation.end-animation.start)/animation.fps}};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(name,duration){var animation=this.animationsMap[name];if(animation){animation.duration=duration;animation.fps=(animation.end-animation.start)/animation.duration}};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(name,weight){var animation=this.animationsMap[name];if(animation)animation.weight=weight};
THREE.MorphBlendMesh.prototype.setAnimationTime=function(name,time){var animation=this.animationsMap[name];if(animation)animation.time=time};THREE.MorphBlendMesh.prototype.getAnimationTime=function(name){var time=0;var animation=this.animationsMap[name];if(animation)time=animation.time;return time};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(name){var duration=-1;var animation=this.animationsMap[name];if(animation)duration=animation.duration;return duration};
THREE.MorphBlendMesh.prototype.playAnimation=function(name){var animation=this.animationsMap[name];if(animation){animation.time=0;animation.active=true}else console.warn("THREE.MorphBlendMesh: animation["+name+"] undefined in .playAnimation()")};THREE.MorphBlendMesh.prototype.stopAnimation=function(name){var animation=this.animationsMap[name];if(animation)animation.active=false};
THREE.MorphBlendMesh.prototype.update=function(delta){for(var i=0,il=this.animationsList.length;i<il;i++){var animation=this.animationsList[i];if(!animation.active)continue;var frameTime=animation.duration/animation.length;animation.time+=animation.direction*delta;if(animation.mirroredLoop){if(animation.time>animation.duration||animation.time<0){animation.direction*=-1;if(animation.time>animation.duration){animation.time=animation.duration;animation.directionBackwards=true}if(animation.time<0){animation.time=
0;animation.directionBackwards=false}}}else{animation.time=animation.time%animation.duration;if(animation.time<0)animation.time+=animation.duration}var keyframe=animation.start+THREE.Math.clamp(Math.floor(animation.time/frameTime),0,animation.length-1);var weight=animation.weight;if(keyframe!==animation.currentFrame){this.morphTargetInfluences[animation.lastFrame]=0;this.morphTargetInfluences[animation.currentFrame]=1*weight;this.morphTargetInfluences[keyframe]=0;animation.lastFrame=animation.currentFrame;
animation.currentFrame=keyframe}var mix=animation.time%frameTime/frameTime;if(animation.directionBackwards)mix=1-mix;if(animation.currentFrame!==animation.lastFrame){this.morphTargetInfluences[animation.currentFrame]=mix*weight;this.morphTargetInfluences[animation.lastFrame]=(1-mix)*weight}else this.morphTargetInfluences[animation.currentFrame]=weight}};window.vanillaSmoothScroller={_data:{params:{}},getTargetNode:function(obj){var _this=this,data=_this._data;if(obj.sourceEl==obj.el)return obj.el;else{obj.el=obj.el.parentNode;return _this.getTargetNode(obj)}},getDocumentHeight:function(){var body=document.body,html=document.documentElement,height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);return height},processDestination:function(string){if(!string)return false;if(!isNaN(string))return parseInt(string,
10);else if(string.indexOf("%")>0){var percents=parseInt(string,10);return Math.floor(this.getDocumentHeight()/100*percents)}else{if(string==="top")return 0;else if(string==="bottom")return this.getDocumentHeight()-window.innerHeight;return Math.floor((window.pageYOffset||document.documentElement.scrollTop)+document.querySelectorAll(string)[0].getBoundingClientRect().top)}},scroll:function(event){event.preventDefault();var _this=window.vanillaSmoothScroller,data=_this._data,obj;data.defaults={destination:0,
duration:400,scrollUp:true};if(!event)event={};if(event.target)obj=_this.getTargetNode({sourceEl:event.currentTarget,el:event.target});else if(!event.nodeType)obj={dataset:event};data.params.destination=_this.processDestination(obj.dataset.to)||data.defaults.destination;if(data.offset)if(typeof data.offset==="function")data.params.destination-=data.offset();else data.params.destination-=data.offset;data.params.duration=parseInt(obj.dataset.duration,10)||data.defaults.duration;data.params.scrollUp=
(window.pageYOffset||document.documentElement.scrollTop)-data.params.destination>0?true:false;data.params.scrollHeight=Math.abs((window.pageYOffset||document.documentElement.scrollTop)-data.params.destination);data.params.scrollStep=Math.PI/(data.params.duration/15);data.params.gap=Math.floor(data.params.scrollStep*100);data.params.cosParameter=data.params.scrollHeight/2;data.params.scrollCount=0;data.params.scrollMargin=0;function step(){var params=window.vanillaSmoothScroller._data.params,a=params.destination,
b=params.scrollMargin,c=params.scrollHeight,docHeight=window.vanillaSmoothScroller.getDocumentHeight(),windowHeight=window.innerHeight,pageYoffset=window.pageYOffset||document.documentElement.scrollTop,condition=pageYoffset<params.destination-params.gap&&pageYoffset+windowHeight<docHeight-params.scrollStep;if(params.scrollUp){b=params.scrollHeight;c=params.scrollMargin;condition=pageYoffset>params.destination+params.gap&&pageYoffset>params.scrollStep}if(condition){window.requestAnimationFrame(step);
params.scrollCount+=1;params.scrollMargin=params.cosParameter-params.cosParameter*Math.cos(params.scrollCount*params.scrollStep);window.scrollTo(0,a+b-c)}else window.scrollTo(0,params.destination)}window.requestAnimationFrame(step);return false},bind:function(obj){if(!obj||!obj.selector)return false;var _this=this,data=_this._data,vanillaSmoothScrollerButtons=[].slice.call(document.querySelectorAll(obj.selector));data.offset=obj.offset;for(var i=vanillaSmoothScrollerButtons.length-1;i>=0;i--){vanillaSmoothScrollerButtons[i].addEventListener(obj.event||
"click",window.vanillaSmoothScroller.scroll,false);if(obj.event&&obj.event!=="click")vanillaSmoothScrollerButtons[i].addEventListener("click",function(event){event.preventDefault();return false},false)}}};(function(factory){if(typeof define==="function"&&define.amd)define(["jquery"],factory);else if(typeof exports!=="undefined")module.exports=factory(require("jquery"));else factory(jQuery)})(function($){var Slick=window.Slick||{};Slick=function(){var instanceUid=0;function Slick(element,settings){var _=this,dataSettings;_.defaults={accessibility:true,adaptiveHeight:false,appendArrows:$(element),appendDots:$(element),arrows:true,asNavFor:null,prevArrow:'<button type="button" data-role="none" class="slick-prev" aria-label="Previous" tabindex="0" role="button">Previous</button>',
nextArrow:'<button type="button" data-role="none" class="slick-next" aria-label="Next" tabindex="0" role="button">Next</button>',autoplay:false,autoplaySpeed:3E3,centerMode:false,centerPadding:"50px",cssEase:"ease",customPaging:function(slider,i){return $('<button type="button" data-role="none" role="button" tabindex="0" />').text(i+1)},dots:false,dotsClass:"slick-dots",draggable:true,easing:"linear",edgeFriction:.35,fade:false,focusOnSelect:false,infinite:true,initialSlide:0,lazyLoad:"ondemand",
mobileFirst:false,pauseOnHover:true,pauseOnFocus:true,pauseOnDotsHover:false,respondTo:"window",responsive:null,rows:1,rtl:false,slide:"",slidesPerRow:1,slidesToShow:1,slidesToScroll:1,speed:500,swipe:true,swipeToSlide:false,touchMove:true,touchThreshold:5,useCSS:true,useTransform:true,variableWidth:false,vertical:false,verticalSwiping:false,waitForAnimate:true,zIndex:1E3};_.initials={animating:false,dragging:false,autoPlayTimer:null,currentDirection:0,currentLeft:null,currentSlide:0,direction:1,
$dots:null,listWidth:null,listHeight:null,loadIndex:0,$nextArrow:null,$prevArrow:null,slideCount:null,slideWidth:null,$slideTrack:null,$slides:null,sliding:false,slideOffset:0,swipeLeft:null,$list:null,touchObject:{},transformsEnabled:false,unslicked:false};$.extend(_,_.initials);_.activeBreakpoint=null;_.animType=null;_.animProp=null;_.breakpoints=[];_.breakpointSettings=[];_.cssTransitions=false;_.focussed=false;_.interrupted=false;_.hidden="hidden";_.paused=true;_.positionProp=null;_.respondTo=
null;_.rowCount=1;_.shouldClick=true;_.$slider=$(element);_.$slidesCache=null;_.transformType=null;_.transitionType=null;_.visibilityChange="visibilitychange";_.windowWidth=0;_.windowTimer=null;dataSettings=$(element).data("slick")||{};_.options=$.extend({},_.defaults,settings,dataSettings);_.currentSlide=_.options.initialSlide;_.originalSettings=_.options;if(typeof document.mozHidden!=="undefined"){_.hidden="mozHidden";_.visibilityChange="mozvisibilitychange"}else if(typeof document.webkitHidden!==
"undefined"){_.hidden="webkitHidden";_.visibilityChange="webkitvisibilitychange"}_.autoPlay=$.proxy(_.autoPlay,_);_.autoPlayClear=$.proxy(_.autoPlayClear,_);_.autoPlayIterator=$.proxy(_.autoPlayIterator,_);_.changeSlide=$.proxy(_.changeSlide,_);_.clickHandler=$.proxy(_.clickHandler,_);_.selectHandler=$.proxy(_.selectHandler,_);_.setPosition=$.proxy(_.setPosition,_);_.swipeHandler=$.proxy(_.swipeHandler,_);_.dragHandler=$.proxy(_.dragHandler,_);_.keyHandler=$.proxy(_.keyHandler,_);_.instanceUid=instanceUid++;
_.htmlExpr=/^(?:\s*(<[\w\W]+>)[^>]*)$/;_.registerBreakpoints();_.init(true)}return Slick}();Slick.prototype.activateADA=function(){var _=this;_.$slideTrack.find(".slick-active").attr({"aria-hidden":"false"}).find("a, input, button, select").attr({"tabindex":"0"})};Slick.prototype.addSlide=Slick.prototype.slickAdd=function(markup,index,addBefore){var _=this;if(typeof index==="boolean"){addBefore=index;index=null}else if(index<0||index>=_.slideCount)return false;_.unload();if(typeof index==="number")if(index===
0&&_.$slides.length===0)$(markup).appendTo(_.$slideTrack);else if(addBefore)$(markup).insertBefore(_.$slides.eq(index));else $(markup).insertAfter(_.$slides.eq(index));else if(addBefore===true)$(markup).prependTo(_.$slideTrack);else $(markup).appendTo(_.$slideTrack);_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slides.each(function(index,element){$(element).attr("data-slick-index",index)});_.$slidesCache=
_.$slides;_.reinit()};Slick.prototype.animateHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.animate({height:targetHeight},_.options.speed)}};Slick.prototype.animateSlide=function(targetLeft,callback){var animProps={},_=this;_.animateHeight();if(_.options.rtl===true&&_.options.vertical===false)targetLeft=-targetLeft;if(_.transformsEnabled===false)if(_.options.vertical===
false)_.$slideTrack.animate({left:targetLeft},_.options.speed,_.options.easing,callback);else _.$slideTrack.animate({top:targetLeft},_.options.speed,_.options.easing,callback);else if(_.cssTransitions===false){if(_.options.rtl===true)_.currentLeft=-_.currentLeft;$({animStart:_.currentLeft}).animate({animStart:targetLeft},{duration:_.options.speed,easing:_.options.easing,step:function(now){now=Math.ceil(now);if(_.options.vertical===false){animProps[_.animType]="translate("+now+"px, 0px)";_.$slideTrack.css(animProps)}else{animProps[_.animType]=
"translate(0px,"+now+"px)";_.$slideTrack.css(animProps)}},complete:function(){if(callback)callback.call()}})}else{_.applyTransition();targetLeft=Math.ceil(targetLeft);if(_.options.vertical===false)animProps[_.animType]="translate3d("+targetLeft+"px, 0px, 0px)";else animProps[_.animType]="translate3d(0px,"+targetLeft+"px, 0px)";_.$slideTrack.css(animProps);if(callback)setTimeout(function(){_.disableTransition();callback.call()},_.options.speed)}};Slick.prototype.getNavTarget=function(){var _=this,
asNavFor=_.options.asNavFor;if(asNavFor&&asNavFor!==null)asNavFor=$(asNavFor).not(_.$slider);return asNavFor};Slick.prototype.asNavFor=function(index){var _=this,asNavFor=_.getNavTarget();if(asNavFor!==null&&typeof asNavFor==="object")asNavFor.each(function(){var target=$(this).slick("getSlick");if(!target.unslicked)target.slideHandler(index,true)})};Slick.prototype.applyTransition=function(slide){var _=this,transition={};if(_.options.fade===false)transition[_.transitionType]=_.transformType+" "+
_.options.speed+"ms "+_.options.cssEase;else transition[_.transitionType]="opacity "+_.options.speed+"ms "+_.options.cssEase;if(_.options.fade===false)_.$slideTrack.css(transition);else _.$slides.eq(slide).css(transition)};Slick.prototype.autoPlay=function(){var _=this;_.autoPlayClear();if(_.slideCount>_.options.slidesToShow)_.autoPlayTimer=setInterval(_.autoPlayIterator,_.options.autoplaySpeed)};Slick.prototype.autoPlayClear=function(){var _=this;if(_.autoPlayTimer)clearInterval(_.autoPlayTimer)};
Slick.prototype.autoPlayIterator=function(){var _=this,slideTo=_.currentSlide+_.options.slidesToScroll;if(!_.paused&&!_.interrupted&&!_.focussed){if(_.options.infinite===false)if(_.direction===1&&_.currentSlide+1===_.slideCount-1)_.direction=0;else if(_.direction===0){slideTo=_.currentSlide-_.options.slidesToScroll;if(_.currentSlide-1===0)_.direction=1}_.slideHandler(slideTo)}};Slick.prototype.buildArrows=function(){var _=this;if(_.options.arrows===true){_.$prevArrow=$(_.options.prevArrow).addClass("slick-arrow");
_.$nextArrow=$(_.options.nextArrow).addClass("slick-arrow");if(_.slideCount>_.options.slidesToShow){_.$prevArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");_.$nextArrow.removeClass("slick-hidden").removeAttr("aria-hidden tabindex");if(_.htmlExpr.test(_.options.prevArrow))_.$prevArrow.prependTo(_.options.appendArrows);if(_.htmlExpr.test(_.options.nextArrow))_.$nextArrow.appendTo(_.options.appendArrows);if(_.options.infinite!==true)_.$prevArrow.addClass("slick-disabled").attr("aria-disabled",
"true")}else _.$prevArrow.add(_.$nextArrow).addClass("slick-hidden").attr({"aria-disabled":"true","tabindex":"-1"})}};Slick.prototype.buildDots=function(){var _=this,i,dot;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow){_.$slider.addClass("slick-dotted");dot=$("<ul />").addClass(_.options.dotsClass);for(i=0;i<=_.getDotCount();i+=1)dot.append($("<li />").append(_.options.customPaging.call(this,_,i)));_.$dots=dot.appendTo(_.options.appendDots);_.$dots.find("li").first().addClass("slick-active").attr("aria-hidden",
"false")}};Slick.prototype.buildOut=function(){var _=this;_.$slides=_.$slider.children(_.options.slide+":not(.slick-cloned)").addClass("slick-slide");_.slideCount=_.$slides.length;_.$slides.each(function(index,element){$(element).attr("data-slick-index",index).data("originalStyling",$(element).attr("style")||"")});_.$slider.addClass("slick-slider");_.$slideTrack=_.slideCount===0?$('<div class="slick-track"/>').appendTo(_.$slider):_.$slides.wrapAll('<div class="slick-track"/>').parent();_.$list=_.$slideTrack.wrap('<div aria-live="polite" class="slick-list"/>').parent();
_.$slideTrack.css("opacity",0);if(_.options.centerMode===true||_.options.swipeToSlide===true)_.options.slidesToScroll=1;$("img[data-lazy]",_.$slider).not("[src]").addClass("slick-loading");_.setupInfinite();_.buildArrows();_.buildDots();_.updateDots();_.setSlideClasses(typeof _.currentSlide==="number"?_.currentSlide:0);if(_.options.draggable===true)_.$list.addClass("draggable")};Slick.prototype.buildRows=function(){var _=this,a,b,c,newSlides,numOfSlides,originalSlides,slidesPerSection;newSlides=document.createDocumentFragment();
originalSlides=_.$slider.children();if(_.options.rows>1){slidesPerSection=_.options.slidesPerRow*_.options.rows;numOfSlides=Math.ceil(originalSlides.length/slidesPerSection);for(a=0;a<numOfSlides;a++){var slide=document.createElement("div");for(b=0;b<_.options.rows;b++){var row=document.createElement("div");for(c=0;c<_.options.slidesPerRow;c++){var target=a*slidesPerSection+(b*_.options.slidesPerRow+c);if(originalSlides.get(target))row.appendChild(originalSlides.get(target))}slide.appendChild(row)}newSlides.appendChild(slide)}_.$slider.empty().append(newSlides);
_.$slider.children().children().children().css({"width":100/_.options.slidesPerRow+"%","display":"inline-block"})}};Slick.prototype.checkResponsive=function(initial,forceUpdate){var _=this,breakpoint,targetBreakpoint,respondToWidth,triggerBreakpoint=false;var sliderWidth=_.$slider.width();var windowWidth=window.innerWidth||$(window).width();if(_.respondTo==="window")respondToWidth=windowWidth;else if(_.respondTo==="slider")respondToWidth=sliderWidth;else if(_.respondTo==="min")respondToWidth=Math.min(windowWidth,
sliderWidth);if(_.options.responsive&&_.options.responsive.length&&_.options.responsive!==null){targetBreakpoint=null;for(breakpoint in _.breakpoints)if(_.breakpoints.hasOwnProperty(breakpoint))if(_.originalSettings.mobileFirst===false){if(respondToWidth<_.breakpoints[breakpoint])targetBreakpoint=_.breakpoints[breakpoint]}else if(respondToWidth>_.breakpoints[breakpoint])targetBreakpoint=_.breakpoints[breakpoint];if(targetBreakpoint!==null)if(_.activeBreakpoint!==null){if(targetBreakpoint!==_.activeBreakpoint||
forceUpdate){_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==="unslick")_.unslick(targetBreakpoint);else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);if(initial===true)_.currentSlide=_.options.initialSlide;_.refresh(initial)}triggerBreakpoint=targetBreakpoint}}else{_.activeBreakpoint=targetBreakpoint;if(_.breakpointSettings[targetBreakpoint]==="unslick")_.unslick(targetBreakpoint);else{_.options=$.extend({},_.originalSettings,_.breakpointSettings[targetBreakpoint]);
if(initial===true)_.currentSlide=_.options.initialSlide;_.refresh(initial)}triggerBreakpoint=targetBreakpoint}else if(_.activeBreakpoint!==null){_.activeBreakpoint=null;_.options=_.originalSettings;if(initial===true)_.currentSlide=_.options.initialSlide;_.refresh(initial);triggerBreakpoint=targetBreakpoint}if(!initial&&triggerBreakpoint!==false)_.$slider.trigger("breakpoint",[_,triggerBreakpoint])}};Slick.prototype.changeSlide=function(event,dontAnimate){var _=this,$target=$(event.currentTarget),
indexOffset,slideOffset,unevenOffset;if($target.is("a"))event.preventDefault();if(!$target.is("li"))$target=$target.closest("li");unevenOffset=_.slideCount%_.options.slidesToScroll!==0;indexOffset=unevenOffset?0:(_.slideCount-_.currentSlide)%_.options.slidesToScroll;switch(event.data.message){case "previous":slideOffset=indexOffset===0?_.options.slidesToScroll:_.options.slidesToShow-indexOffset;if(_.slideCount>_.options.slidesToShow)_.slideHandler(_.currentSlide-slideOffset,false,dontAnimate);break;
case "next":slideOffset=indexOffset===0?_.options.slidesToScroll:indexOffset;if(_.slideCount>_.options.slidesToShow)_.slideHandler(_.currentSlide+slideOffset,false,dontAnimate);break;case "index":var index=event.data.index===0?0:event.data.index||$target.index()*_.options.slidesToScroll;_.slideHandler(_.checkNavigable(index),false,dontAnimate);$target.children().trigger("focus");break;default:return}};Slick.prototype.checkNavigable=function(index){var _=this,navigables,prevNavigable;navigables=_.getNavigableIndexes();
prevNavigable=0;if(index>navigables[navigables.length-1])index=navigables[navigables.length-1];else for(var n in navigables){if(index<navigables[n]){index=prevNavigable;break}prevNavigable=navigables[n]}return index};Slick.prototype.cleanUpEvents=function(){var _=this;if(_.options.dots&&_.$dots!==null)$("li",_.$dots).off("click.slick",_.changeSlide).off("mouseenter.slick",$.proxy(_.interrupt,_,true)).off("mouseleave.slick",$.proxy(_.interrupt,_,false));_.$slider.off("focus.slick blur.slick");if(_.options.arrows===
true&&_.slideCount>_.options.slidesToShow){_.$prevArrow&&_.$prevArrow.off("click.slick",_.changeSlide);_.$nextArrow&&_.$nextArrow.off("click.slick",_.changeSlide)}_.$list.off("touchstart.slick mousedown.slick",_.swipeHandler);_.$list.off("touchmove.slick mousemove.slick",_.swipeHandler);_.$list.off("touchend.slick mouseup.slick",_.swipeHandler);_.$list.off("touchcancel.slick mouseleave.slick",_.swipeHandler);_.$list.off("click.slick",_.clickHandler);$(document).off(_.visibilityChange,_.visibility);
_.cleanUpSlideEvents();if(_.options.accessibility===true)_.$list.off("keydown.slick",_.keyHandler);if(_.options.focusOnSelect===true)$(_.$slideTrack).children().off("click.slick",_.selectHandler);$(window).off("orientationchange.slick.slick-"+_.instanceUid,_.orientationChange);$(window).off("resize.slick.slick-"+_.instanceUid,_.resize);$("[draggable!=true]",_.$slideTrack).off("dragstart",_.preventDefault);$(window).off("load.slick.slick-"+_.instanceUid,_.setPosition);$(document).off("ready.slick.slick-"+
_.instanceUid,_.setPosition)};Slick.prototype.cleanUpSlideEvents=function(){var _=this;_.$list.off("mouseenter.slick",$.proxy(_.interrupt,_,true));_.$list.off("mouseleave.slick",$.proxy(_.interrupt,_,false))};Slick.prototype.cleanUpRows=function(){var _=this,originalSlides;if(_.options.rows>1){originalSlides=_.$slides.children().children();originalSlides.removeAttr("style");_.$slider.empty().append(originalSlides)}};Slick.prototype.clickHandler=function(event){var _=this;if(_.shouldClick===false){event.stopImmediatePropagation();
event.stopPropagation();event.preventDefault()}};Slick.prototype.destroy=function(refresh){var _=this;_.autoPlayClear();_.touchObject={};_.cleanUpEvents();$(".slick-cloned",_.$slider).detach();if(_.$dots)_.$dots.remove();if(_.$prevArrow&&_.$prevArrow.length){_.$prevArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display","");if(_.htmlExpr.test(_.options.prevArrow))_.$prevArrow.remove()}if(_.$nextArrow&&_.$nextArrow.length){_.$nextArrow.removeClass("slick-disabled slick-arrow slick-hidden").removeAttr("aria-hidden aria-disabled tabindex").css("display",
"");if(_.htmlExpr.test(_.options.nextArrow))_.$nextArrow.remove()}if(_.$slides){_.$slides.removeClass("slick-slide slick-active slick-center slick-visible slick-current").removeAttr("aria-hidden").removeAttr("data-slick-index").each(function(){$(this).attr("style",$(this).data("originalStyling"))});_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.detach();_.$list.detach();_.$slider.append(_.$slides)}_.cleanUpRows();_.$slider.removeClass("slick-slider");_.$slider.removeClass("slick-initialized");
_.$slider.removeClass("slick-dotted");_.unslicked=true;if(!refresh)_.$slider.trigger("destroy",[_])};Slick.prototype.disableTransition=function(slide){var _=this,transition={};transition[_.transitionType]="";if(_.options.fade===false)_.$slideTrack.css(transition);else _.$slides.eq(slide).css(transition)};Slick.prototype.fadeSlide=function(slideIndex,callback){var _=this;if(_.cssTransitions===false){_.$slides.eq(slideIndex).css({zIndex:_.options.zIndex});_.$slides.eq(slideIndex).animate({opacity:1},
_.options.speed,_.options.easing,callback)}else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:1,zIndex:_.options.zIndex});if(callback)setTimeout(function(){_.disableTransition(slideIndex);callback.call()},_.options.speed)}};Slick.prototype.fadeSlideOut=function(slideIndex){var _=this;if(_.cssTransitions===false)_.$slides.eq(slideIndex).animate({opacity:0,zIndex:_.options.zIndex-2},_.options.speed,_.options.easing);else{_.applyTransition(slideIndex);_.$slides.eq(slideIndex).css({opacity:0,
zIndex:_.options.zIndex-2})}};Slick.prototype.filterSlides=Slick.prototype.slickFilter=function(filter){var _=this;if(filter!==null){_.$slidesCache=_.$slides;_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.filter(filter).appendTo(_.$slideTrack);_.reinit()}};Slick.prototype.focusHandler=function(){var _=this;_.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*:not(.slick-arrow)",function(event){event.stopImmediatePropagation();var $sf=$(this);setTimeout(function(){if(_.options.pauseOnFocus){_.focussed=
$sf.is(":focus");_.autoPlay()}},0)})};Slick.prototype.getCurrent=Slick.prototype.slickCurrentSlide=function(){var _=this;return _.currentSlide};Slick.prototype.getDotCount=function(){var _=this;var breakPoint=0;var counter=0;var pagerQty=0;if(_.options.infinite===true)while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow}else if(_.options.centerMode===true)pagerQty=
_.slideCount;else while(breakPoint<_.slideCount){++pagerQty;breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow}return pagerQty-1};Slick.prototype.getLeft=function(slideIndex){var _=this,targetLeft,verticalHeight,verticalOffset=0,targetSlide;_.slideOffset=0;verticalHeight=_.$slides.first().outerHeight(true);if(_.options.infinite===true){if(_.slideCount>_.options.slidesToShow){_.slideOffset=_.slideWidth*
_.options.slidesToShow*-1;verticalOffset=verticalHeight*_.options.slidesToShow*-1}if(_.slideCount%_.options.slidesToScroll!==0)if(slideIndex+_.options.slidesToScroll>_.slideCount&&_.slideCount>_.options.slidesToShow)if(slideIndex>_.slideCount){_.slideOffset=(_.options.slidesToShow-(slideIndex-_.slideCount))*_.slideWidth*-1;verticalOffset=(_.options.slidesToShow-(slideIndex-_.slideCount))*verticalHeight*-1}else{_.slideOffset=_.slideCount%_.options.slidesToScroll*_.slideWidth*-1;verticalOffset=_.slideCount%
_.options.slidesToScroll*verticalHeight*-1}}else if(slideIndex+_.options.slidesToShow>_.slideCount){_.slideOffset=(slideIndex+_.options.slidesToShow-_.slideCount)*_.slideWidth;verticalOffset=(slideIndex+_.options.slidesToShow-_.slideCount)*verticalHeight}if(_.slideCount<=_.options.slidesToShow){_.slideOffset=0;verticalOffset=0}if(_.options.centerMode===true&&_.options.infinite===true)_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)-_.slideWidth;else if(_.options.centerMode===true){_.slideOffset=
0;_.slideOffset+=_.slideWidth*Math.floor(_.options.slidesToShow/2)}if(_.options.vertical===false)targetLeft=slideIndex*_.slideWidth*-1+_.slideOffset;else targetLeft=slideIndex*verticalHeight*-1+verticalOffset;if(_.options.variableWidth===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false)targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex);else targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow);if(_.options.rtl===true)if(targetSlide[0])targetLeft=
(_.$slideTrack.width()-targetSlide[0].offsetLeft-targetSlide.width())*-1;else targetLeft=0;else targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;if(_.options.centerMode===true){if(_.slideCount<=_.options.slidesToShow||_.options.infinite===false)targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex);else targetSlide=_.$slideTrack.children(".slick-slide").eq(slideIndex+_.options.slidesToShow+1);if(_.options.rtl===true)if(targetSlide[0])targetLeft=(_.$slideTrack.width()-targetSlide[0].offsetLeft-
targetSlide.width())*-1;else targetLeft=0;else targetLeft=targetSlide[0]?targetSlide[0].offsetLeft*-1:0;targetLeft+=(_.$list.width()-targetSlide.outerWidth())/2}}return targetLeft};Slick.prototype.getOption=Slick.prototype.slickGetOption=function(option){var _=this;return _.options[option]};Slick.prototype.getNavigableIndexes=function(){var _=this,breakPoint=0,counter=0,indexes=[],max;if(_.options.infinite===false)max=_.slideCount;else{breakPoint=_.options.slidesToScroll*-1;counter=_.options.slidesToScroll*
-1;max=_.slideCount*2}while(breakPoint<max){indexes.push(breakPoint);breakPoint=counter+_.options.slidesToScroll;counter+=_.options.slidesToScroll<=_.options.slidesToShow?_.options.slidesToScroll:_.options.slidesToShow}return indexes};Slick.prototype.getSlick=function(){return this};Slick.prototype.getSlideCount=function(){var _=this,slidesTraversed,swipedSlide,centerOffset;centerOffset=_.options.centerMode===true?_.slideWidth*Math.floor(_.options.slidesToShow/2):0;if(_.options.swipeToSlide===true){_.$slideTrack.find(".slick-slide").each(function(index,
slide){if(slide.offsetLeft-centerOffset+$(slide).outerWidth()/2>_.swipeLeft*-1){swipedSlide=slide;return false}});slidesTraversed=Math.abs($(swipedSlide).attr("data-slick-index")-_.currentSlide)||1;return slidesTraversed}else return _.options.slidesToScroll};Slick.prototype.goTo=Slick.prototype.slickGoTo=function(slide,dontAnimate){var _=this;_.changeSlide({data:{message:"index",index:parseInt(slide)}},dontAnimate)};Slick.prototype.init=function(creation){var _=this;if(!$(_.$slider).hasClass("slick-initialized")){$(_.$slider).addClass("slick-initialized");
_.buildRows();_.buildOut();_.setProps();_.startLoad();_.loadSlider();_.initializeEvents();_.updateArrows();_.updateDots();_.checkResponsive(true);_.focusHandler()}if(creation)_.$slider.trigger("init",[_]);if(_.options.accessibility===true)_.initADA();if(_.options.autoplay){_.paused=false;_.autoPlay()}};Slick.prototype.initADA=function(){var _=this;_.$slides.add(_.$slideTrack.find(".slick-cloned")).attr({"aria-hidden":"true","tabindex":"-1"}).find("a, input, button, select").attr({"tabindex":"-1"});
_.$slideTrack.attr("role","listbox");_.$slides.not(_.$slideTrack.find(".slick-cloned")).each(function(i){$(this).attr({"role":"option","aria-describedby":"slick-slide"+_.instanceUid+i+""})});if(_.$dots!==null)_.$dots.attr("role","tablist").find("li").each(function(i){$(this).attr({"role":"presentation","aria-selected":"false","aria-controls":"navigation"+_.instanceUid+i+"","id":"slick-slide"+_.instanceUid+i+""})}).first().attr("aria-selected","true").end().find("button").attr("role","button").end().closest("div").attr("role",
"toolbar");_.activateADA()};Slick.prototype.initArrowEvents=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.off("click.slick").on("click.slick",{message:"previous"},_.changeSlide);_.$nextArrow.off("click.slick").on("click.slick",{message:"next"},_.changeSlide)}};Slick.prototype.initDotEvents=function(){var _=this;if(_.options.dots===true&&_.slideCount>_.options.slidesToShow)$("li",_.$dots).on("click.slick",{message:"index"},_.changeSlide);if(_.options.dots===
true&&_.options.pauseOnDotsHover===true)$("li",_.$dots).on("mouseenter.slick",$.proxy(_.interrupt,_,true)).on("mouseleave.slick",$.proxy(_.interrupt,_,false))};Slick.prototype.initSlideEvents=function(){var _=this;if(_.options.pauseOnHover){_.$list.on("mouseenter.slick",$.proxy(_.interrupt,_,true));_.$list.on("mouseleave.slick",$.proxy(_.interrupt,_,false))}};Slick.prototype.initializeEvents=function(){var _=this;_.initArrowEvents();_.initDotEvents();_.initSlideEvents();_.$list.on("touchstart.slick mousedown.slick",
{action:"start"},_.swipeHandler);_.$list.on("touchmove.slick mousemove.slick",{action:"move"},_.swipeHandler);_.$list.on("touchend.slick mouseup.slick",{action:"end"},_.swipeHandler);_.$list.on("touchcancel.slick mouseleave.slick",{action:"end"},_.swipeHandler);_.$list.on("click.slick",_.clickHandler);$(document).on(_.visibilityChange,$.proxy(_.visibility,_));if(_.options.accessibility===true)_.$list.on("keydown.slick",_.keyHandler);if(_.options.focusOnSelect===true)$(_.$slideTrack).children().on("click.slick",
_.selectHandler);$(window).on("orientationchange.slick.slick-"+_.instanceUid,$.proxy(_.orientationChange,_));$(window).on("resize.slick.slick-"+_.instanceUid,$.proxy(_.resize,_));$("[draggable!=true]",_.$slideTrack).on("dragstart",_.preventDefault);$(window).on("load.slick.slick-"+_.instanceUid,_.setPosition);$(document).on("ready.slick.slick-"+_.instanceUid,_.setPosition)};Slick.prototype.initUI=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.show();
_.$nextArrow.show()}if(_.options.dots===true&&_.slideCount>_.options.slidesToShow)_.$dots.show()};Slick.prototype.keyHandler=function(event){var _=this;if(!event.target.tagName.match("TEXTAREA|INPUT|SELECT"))if(event.keyCode===37&&_.options.accessibility===true)_.changeSlide({data:{message:_.options.rtl===true?"next":"previous"}});else if(event.keyCode===39&&_.options.accessibility===true)_.changeSlide({data:{message:_.options.rtl===true?"previous":"next"}})};Slick.prototype.lazyLoad=function(){var _=
this,loadRange,cloneRange,rangeStart,rangeEnd;function loadImages(imagesScope){$("img[data-lazy]",imagesScope).each(function(){var image=$(this),imageSource=$(this).attr("data-lazy"),imageToLoad=document.createElement("img");imageToLoad.onload=function(){image.animate({opacity:0},100,function(){image.attr("src",imageSource).animate({opacity:1},200,function(){image.removeAttr("data-lazy").removeClass("slick-loading")});_.$slider.trigger("lazyLoaded",[_,image,imageSource])})};imageToLoad.onerror=function(){image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");
_.$slider.trigger("lazyLoadError",[_,image,imageSource])};imageToLoad.src=imageSource})}if(_.options.centerMode===true)if(_.options.infinite===true){rangeStart=_.currentSlide+(_.options.slidesToShow/2+1);rangeEnd=rangeStart+_.options.slidesToShow+2}else{rangeStart=Math.max(0,_.currentSlide-(_.options.slidesToShow/2+1));rangeEnd=2+(_.options.slidesToShow/2+1)+_.currentSlide}else{rangeStart=_.options.infinite?_.options.slidesToShow+_.currentSlide:_.currentSlide;rangeEnd=Math.ceil(rangeStart+_.options.slidesToShow);
if(_.options.fade===true){if(rangeStart>0)rangeStart--;if(rangeEnd<=_.slideCount)rangeEnd++}}loadRange=_.$slider.find(".slick-slide").slice(rangeStart,rangeEnd);loadImages(loadRange);if(_.slideCount<=_.options.slidesToShow){cloneRange=_.$slider.find(".slick-slide");loadImages(cloneRange)}else if(_.currentSlide>=_.slideCount-_.options.slidesToShow){cloneRange=_.$slider.find(".slick-cloned").slice(0,_.options.slidesToShow);loadImages(cloneRange)}else if(_.currentSlide===0){cloneRange=_.$slider.find(".slick-cloned").slice(_.options.slidesToShow*
-1);loadImages(cloneRange)}};Slick.prototype.loadSlider=function(){var _=this;_.setPosition();_.$slideTrack.css({opacity:1});_.$slider.removeClass("slick-loading");_.initUI();if(_.options.lazyLoad==="progressive")_.progressiveLazyLoad()};Slick.prototype.next=Slick.prototype.slickNext=function(){var _=this;_.changeSlide({data:{message:"next"}})};Slick.prototype.orientationChange=function(){var _=this;_.checkResponsive();_.setPosition()};Slick.prototype.pause=Slick.prototype.slickPause=function(){var _=
this;_.autoPlayClear();_.paused=true};Slick.prototype.play=Slick.prototype.slickPlay=function(){var _=this;_.autoPlay();_.options.autoplay=true;_.paused=false;_.focussed=false;_.interrupted=false};Slick.prototype.postSlide=function(index){var _=this;if(!_.unslicked){_.$slider.trigger("afterChange",[_,index]);_.animating=false;_.setPosition();_.swipeLeft=null;if(_.options.autoplay)_.autoPlay();if(_.options.accessibility===true)_.initADA()}};Slick.prototype.prev=Slick.prototype.slickPrev=function(){var _=
this;_.changeSlide({data:{message:"previous"}})};Slick.prototype.preventDefault=function(event){event.preventDefault()};Slick.prototype.progressiveLazyLoad=function(tryCount){tryCount=tryCount||1;var _=this,$imgsToLoad=$("img[data-lazy]",_.$slider),image,imageSource,imageToLoad;if($imgsToLoad.length){image=$imgsToLoad.first();imageSource=image.attr("data-lazy");imageToLoad=document.createElement("img");imageToLoad.onload=function(){image.attr("src",imageSource).removeAttr("data-lazy").removeClass("slick-loading");
if(_.options.adaptiveHeight===true)_.setPosition();_.$slider.trigger("lazyLoaded",[_,image,imageSource]);_.progressiveLazyLoad()};imageToLoad.onerror=function(){if(tryCount<3)setTimeout(function(){_.progressiveLazyLoad(tryCount+1)},500);else{image.removeAttr("data-lazy").removeClass("slick-loading").addClass("slick-lazyload-error");_.$slider.trigger("lazyLoadError",[_,image,imageSource]);_.progressiveLazyLoad()}};imageToLoad.src=imageSource}else _.$slider.trigger("allImagesLoaded",[_])};Slick.prototype.refresh=
function(initializing){var _=this,currentSlide,lastVisibleIndex;lastVisibleIndex=_.slideCount-_.options.slidesToShow;if(!_.options.infinite&&_.currentSlide>lastVisibleIndex)_.currentSlide=lastVisibleIndex;if(_.slideCount<=_.options.slidesToShow)_.currentSlide=0;currentSlide=_.currentSlide;_.destroy(true);$.extend(_,_.initials,{currentSlide:currentSlide});_.init();if(!initializing)_.changeSlide({data:{message:"index",index:currentSlide}},false)};Slick.prototype.registerBreakpoints=function(){var _=
this,breakpoint,currentBreakpoint,l,responsiveSettings=_.options.responsive||null;if($.type(responsiveSettings)==="array"&&responsiveSettings.length){_.respondTo=_.options.respondTo||"window";for(breakpoint in responsiveSettings){l=_.breakpoints.length-1;currentBreakpoint=responsiveSettings[breakpoint].breakpoint;if(responsiveSettings.hasOwnProperty(breakpoint)){while(l>=0){if(_.breakpoints[l]&&_.breakpoints[l]===currentBreakpoint)_.breakpoints.splice(l,1);l--}_.breakpoints.push(currentBreakpoint);
_.breakpointSettings[currentBreakpoint]=responsiveSettings[breakpoint].settings}}_.breakpoints.sort(function(a,b){return _.options.mobileFirst?a-b:b-a})}};Slick.prototype.reinit=function(){var _=this;_.$slides=_.$slideTrack.children(_.options.slide).addClass("slick-slide");_.slideCount=_.$slides.length;if(_.currentSlide>=_.slideCount&&_.currentSlide!==0)_.currentSlide=_.currentSlide-_.options.slidesToScroll;if(_.slideCount<=_.options.slidesToShow)_.currentSlide=0;_.registerBreakpoints();_.setProps();
_.setupInfinite();_.buildArrows();_.updateArrows();_.initArrowEvents();_.buildDots();_.updateDots();_.initDotEvents();_.cleanUpSlideEvents();_.initSlideEvents();_.checkResponsive(false,true);if(_.options.focusOnSelect===true)$(_.$slideTrack).children().on("click.slick",_.selectHandler);_.setSlideClasses(typeof _.currentSlide==="number"?_.currentSlide:0);_.setPosition();_.focusHandler();_.paused=!_.options.autoplay;_.autoPlay();_.$slider.trigger("reInit",[_])};Slick.prototype.resize=function(){var _=
this;if($(window).width()!==_.windowWidth){clearTimeout(_.windowDelay);_.windowDelay=window.setTimeout(function(){_.windowWidth=$(window).width();_.checkResponsive();if(!_.unslicked)_.setPosition()},50)}};Slick.prototype.removeSlide=Slick.prototype.slickRemove=function(index,removeBefore,removeAll){var _=this;if(typeof index==="boolean"){removeBefore=index;index=removeBefore===true?0:_.slideCount-1}else index=removeBefore===true?--index:index;if(_.slideCount<1||index<0||index>_.slideCount-1)return false;
_.unload();if(removeAll===true)_.$slideTrack.children().remove();else _.$slideTrack.children(this.options.slide).eq(index).remove();_.$slides=_.$slideTrack.children(this.options.slide);_.$slideTrack.children(this.options.slide).detach();_.$slideTrack.append(_.$slides);_.$slidesCache=_.$slides;_.reinit()};Slick.prototype.setCSS=function(position){var _=this,positionProps={},x,y;if(_.options.rtl===true)position=-position;x=_.positionProp=="left"?Math.ceil(position)+"px":"0px";y=_.positionProp=="top"?
Math.ceil(position)+"px":"0px";positionProps[_.positionProp]=position;if(_.transformsEnabled===false)_.$slideTrack.css(positionProps);else{positionProps={};if(_.cssTransitions===false){positionProps[_.animType]="translate("+x+", "+y+")";_.$slideTrack.css(positionProps)}else{positionProps[_.animType]="translate3d("+x+", "+y+", 0px)";_.$slideTrack.css(positionProps)}}};Slick.prototype.setDimensions=function(){var _=this;if(_.options.vertical===false){if(_.options.centerMode===true)_.$list.css({padding:"0px "+
_.options.centerPadding})}else{_.$list.height(_.$slides.first().outerHeight(true)*_.options.slidesToShow);if(_.options.centerMode===true)_.$list.css({padding:_.options.centerPadding+" 0px"})}_.listWidth=_.$list.width();_.listHeight=_.$list.height();if(_.options.vertical===false&&_.options.variableWidth===false){_.slideWidth=Math.ceil(_.listWidth/_.options.slidesToShow);_.$slideTrack.width(Math.ceil(_.slideWidth*_.$slideTrack.children(".slick-slide").length))}else if(_.options.variableWidth===true)_.$slideTrack.width(5E3*
_.slideCount);else{_.slideWidth=Math.ceil(_.listWidth);_.$slideTrack.height(Math.ceil(_.$slides.first().outerHeight(true)*_.$slideTrack.children(".slick-slide").length))}var offset=_.$slides.first().outerWidth(true)-_.$slides.first().width();if(_.options.variableWidth===false)_.$slideTrack.children(".slick-slide").width(_.slideWidth-offset)};Slick.prototype.setFade=function(){var _=this,targetLeft;_.$slides.each(function(index,element){targetLeft=_.slideWidth*index*-1;if(_.options.rtl===true)$(element).css({position:"relative",
right:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0});else $(element).css({position:"relative",left:targetLeft,top:0,zIndex:_.options.zIndex-2,opacity:0})});_.$slides.eq(_.currentSlide).css({zIndex:_.options.zIndex-1,opacity:1})};Slick.prototype.setHeight=function(){var _=this;if(_.options.slidesToShow===1&&_.options.adaptiveHeight===true&&_.options.vertical===false){var targetHeight=_.$slides.eq(_.currentSlide).outerHeight(true);_.$list.css("height",targetHeight)}};Slick.prototype.setOption=
Slick.prototype.slickSetOption=function(){var _=this,l,item,option,value,refresh=false,type;if($.type(arguments[0])==="object"){option=arguments[0];refresh=arguments[1];type="multiple"}else if($.type(arguments[0])==="string"){option=arguments[0];value=arguments[1];refresh=arguments[2];if(arguments[0]==="responsive"&&$.type(arguments[1])==="array")type="responsive";else if(typeof arguments[1]!=="undefined")type="single"}if(type==="single")_.options[option]=value;else if(type==="multiple")$.each(option,
function(opt,val){_.options[opt]=val});else if(type==="responsive")for(item in value)if($.type(_.options.responsive)!=="array")_.options.responsive=[value[item]];else{l=_.options.responsive.length-1;while(l>=0){if(_.options.responsive[l].breakpoint===value[item].breakpoint)_.options.responsive.splice(l,1);l--}_.options.responsive.push(value[item])}if(refresh){_.unload();_.reinit()}};Slick.prototype.setPosition=function(){var _=this;_.setDimensions();_.setHeight();if(_.options.fade===false)_.setCSS(_.getLeft(_.currentSlide));
else _.setFade();_.$slider.trigger("setPosition",[_])};Slick.prototype.setProps=function(){var _=this,bodyStyle=document.body.style;_.positionProp=_.options.vertical===true?"top":"left";if(_.positionProp==="top")_.$slider.addClass("slick-vertical");else _.$slider.removeClass("slick-vertical");if(bodyStyle.WebkitTransition!==undefined||bodyStyle.MozTransition!==undefined||bodyStyle.msTransition!==undefined)if(_.options.useCSS===true)_.cssTransitions=true;if(_.options.fade)if(typeof _.options.zIndex===
"number"){if(_.options.zIndex<3)_.options.zIndex=3}else _.options.zIndex=_.defaults.zIndex;if(bodyStyle.OTransform!==undefined){_.animType="OTransform";_.transformType="-o-transform";_.transitionType="OTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false}if(bodyStyle.MozTransform!==undefined){_.animType="MozTransform";_.transformType="-moz-transform";_.transitionType="MozTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.MozPerspective===
undefined)_.animType=false}if(bodyStyle.webkitTransform!==undefined){_.animType="webkitTransform";_.transformType="-webkit-transform";_.transitionType="webkitTransition";if(bodyStyle.perspectiveProperty===undefined&&bodyStyle.webkitPerspective===undefined)_.animType=false}if(bodyStyle.msTransform!==undefined){_.animType="msTransform";_.transformType="-ms-transform";_.transitionType="msTransition";if(bodyStyle.msTransform===undefined)_.animType=false}if(bodyStyle.transform!==undefined&&_.animType!==
false){_.animType="transform";_.transformType="transform";_.transitionType="transition"}_.transformsEnabled=_.options.useTransform&&(_.animType!==null&&_.animType!==false)};Slick.prototype.setSlideClasses=function(index){var _=this,centerOffset,allSlides,indexOffset,remainder;allSlides=_.$slider.find(".slick-slide").removeClass("slick-active slick-center slick-current").attr("aria-hidden","true");_.$slides.eq(index).addClass("slick-current");if(_.options.centerMode===true){centerOffset=Math.floor(_.options.slidesToShow/
2);if(_.options.infinite===true){if(index>=centerOffset&&index<=_.slideCount-1-centerOffset)_.$slides.slice(index-centerOffset,index+centerOffset+1).addClass("slick-active").attr("aria-hidden","false");else{indexOffset=_.options.slidesToShow+index;allSlides.slice(indexOffset-centerOffset+1,indexOffset+centerOffset+2).addClass("slick-active").attr("aria-hidden","false")}if(index===0)allSlides.eq(allSlides.length-1-_.options.slidesToShow).addClass("slick-center");else if(index===_.slideCount-1)allSlides.eq(_.options.slidesToShow).addClass("slick-center")}_.$slides.eq(index).addClass("slick-center")}else if(index>=
0&&index<=_.slideCount-_.options.slidesToShow)_.$slides.slice(index,index+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false");else if(allSlides.length<=_.options.slidesToShow)allSlides.addClass("slick-active").attr("aria-hidden","false");else{remainder=_.slideCount%_.options.slidesToShow;indexOffset=_.options.infinite===true?_.options.slidesToShow+index:index;if(_.options.slidesToShow==_.options.slidesToScroll&&_.slideCount-index<_.options.slidesToShow)allSlides.slice(indexOffset-
(_.options.slidesToShow-remainder),indexOffset+remainder).addClass("slick-active").attr("aria-hidden","false");else allSlides.slice(indexOffset,indexOffset+_.options.slidesToShow).addClass("slick-active").attr("aria-hidden","false")}if(_.options.lazyLoad==="ondemand")_.lazyLoad()};Slick.prototype.setupInfinite=function(){var _=this,i,slideIndex,infiniteCount;if(_.options.fade===true)_.options.centerMode=false;if(_.options.infinite===true&&_.options.fade===false){slideIndex=null;if(_.slideCount>_.options.slidesToShow){if(_.options.centerMode===
true)infiniteCount=_.options.slidesToShow+1;else infiniteCount=_.options.slidesToShow;for(i=_.slideCount;i>_.slideCount-infiniteCount;i-=1){slideIndex=i-1;$(_.$slides[slideIndex]).clone(true).attr("id","").attr("data-slick-index",slideIndex-_.slideCount).prependTo(_.$slideTrack).addClass("slick-cloned")}for(i=0;i<infiniteCount;i+=1){slideIndex=i;$(_.$slides[slideIndex]).clone(true).attr("id","").attr("data-slick-index",slideIndex+_.slideCount).appendTo(_.$slideTrack).addClass("slick-cloned")}_.$slideTrack.find(".slick-cloned").find("[id]").each(function(){$(this).attr("id",
"")})}}};Slick.prototype.interrupt=function(toggle){var _=this;if(!toggle)_.autoPlay();_.interrupted=toggle};Slick.prototype.selectHandler=function(event){var _=this;var targetElement=$(event.target).is(".slick-slide")?$(event.target):$(event.target).parents(".slick-slide");var index=parseInt(targetElement.attr("data-slick-index"));if(!index)index=0;if(_.slideCount<=_.options.slidesToShow){_.setSlideClasses(index);_.asNavFor(index);return}_.slideHandler(index)};Slick.prototype.slideHandler=function(index,
sync,dontAnimate){var targetSlide,animSlide,oldSlide,slideLeft,targetLeft=null,_=this,navTarget;sync=sync||false;if(_.animating===true&&_.options.waitForAnimate===true)return;if(_.options.fade===true&&_.currentSlide===index)return;if(_.slideCount<=_.options.slidesToShow)return;if(sync===false)_.asNavFor(index);targetSlide=index;targetLeft=_.getLeft(targetSlide);slideLeft=_.getLeft(_.currentSlide);_.currentLeft=_.swipeLeft===null?slideLeft:_.swipeLeft;if(_.options.infinite===false&&_.options.centerMode===
false&&(index<0||index>_.getDotCount()*_.options.slidesToScroll)){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true)_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)});else _.postSlide(targetSlide)}return}else if(_.options.infinite===false&&_.options.centerMode===true&&(index<0||index>_.slideCount-_.options.slidesToScroll)){if(_.options.fade===false){targetSlide=_.currentSlide;if(dontAnimate!==true)_.animateSlide(slideLeft,function(){_.postSlide(targetSlide)});
else _.postSlide(targetSlide)}return}if(_.options.autoplay)clearInterval(_.autoPlayTimer);if(targetSlide<0)if(_.slideCount%_.options.slidesToScroll!==0)animSlide=_.slideCount-_.slideCount%_.options.slidesToScroll;else animSlide=_.slideCount+targetSlide;else if(targetSlide>=_.slideCount)if(_.slideCount%_.options.slidesToScroll!==0)animSlide=0;else animSlide=targetSlide-_.slideCount;else animSlide=targetSlide;_.animating=true;_.$slider.trigger("beforeChange",[_,_.currentSlide,animSlide]);oldSlide=_.currentSlide;
_.currentSlide=animSlide;_.setSlideClasses(_.currentSlide);if(_.options.asNavFor){navTarget=_.getNavTarget();navTarget=navTarget.slick("getSlick");if(navTarget.slideCount<=navTarget.options.slidesToShow)navTarget.setSlideClasses(_.currentSlide)}_.updateDots();_.updateArrows();if(_.options.fade===true){if(dontAnimate!==true){_.fadeSlideOut(oldSlide);_.fadeSlide(animSlide,function(){_.postSlide(animSlide)})}else _.postSlide(animSlide);_.animateHeight();return}if(dontAnimate!==true)_.animateSlide(targetLeft,
function(){_.postSlide(animSlide)});else _.postSlide(animSlide)};Slick.prototype.startLoad=function(){var _=this;if(_.options.arrows===true&&_.slideCount>_.options.slidesToShow){_.$prevArrow.hide();_.$nextArrow.hide()}if(_.options.dots===true&&_.slideCount>_.options.slidesToShow)_.$dots.hide();_.$slider.addClass("slick-loading")};Slick.prototype.swipeDirection=function(){var xDist,yDist,r,swipeAngle,_=this;xDist=_.touchObject.startX-_.touchObject.curX;yDist=_.touchObject.startY-_.touchObject.curY;
r=Math.atan2(yDist,xDist);swipeAngle=Math.round(r*180/Math.PI);if(swipeAngle<0)swipeAngle=360-Math.abs(swipeAngle);if(swipeAngle<=45&&swipeAngle>=0)return _.options.rtl===false?"left":"right";if(swipeAngle<=360&&swipeAngle>=315)return _.options.rtl===false?"left":"right";if(swipeAngle>=135&&swipeAngle<=225)return _.options.rtl===false?"right":"left";if(_.options.verticalSwiping===true)if(swipeAngle>=35&&swipeAngle<=135)return"down";else return"up";return"vertical"};Slick.prototype.swipeEnd=function(event){var _=
this,slideCount,direction;_.dragging=false;_.interrupted=false;_.shouldClick=_.touchObject.swipeLength>10?false:true;if(_.touchObject.curX===undefined)return false;if(_.touchObject.edgeHit===true)_.$slider.trigger("edge",[_,_.swipeDirection()]);if(_.touchObject.swipeLength>=_.touchObject.minSwipe){direction=_.swipeDirection();switch(direction){case "left":case "down":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide+_.getSlideCount()):_.currentSlide+_.getSlideCount();_.currentDirection=
0;break;case "right":case "up":slideCount=_.options.swipeToSlide?_.checkNavigable(_.currentSlide-_.getSlideCount()):_.currentSlide-_.getSlideCount();_.currentDirection=1;break;default:}if(direction!="vertical"){_.slideHandler(slideCount);_.touchObject={};_.$slider.trigger("swipe",[_,direction])}}else if(_.touchObject.startX!==_.touchObject.curX){_.slideHandler(_.currentSlide);_.touchObject={}}};Slick.prototype.swipeHandler=function(event){var _=this;if(_.options.swipe===false||"ontouchend"in document&&
_.options.swipe===false)return;else if(_.options.draggable===false&&event.type.indexOf("mouse")!==-1)return;_.touchObject.fingerCount=event.originalEvent&&event.originalEvent.touches!==undefined?event.originalEvent.touches.length:1;_.touchObject.minSwipe=_.listWidth/_.options.touchThreshold;if(_.options.verticalSwiping===true)_.touchObject.minSwipe=_.listHeight/_.options.touchThreshold;switch(event.data.action){case "start":_.swipeStart(event);break;case "move":_.swipeMove(event);break;case "end":_.swipeEnd(event);
break}};Slick.prototype.swipeMove=function(event){var _=this,edgeWasHit=false,curLeft,swipeDirection,swipeLength,positionOffset,touches;touches=event.originalEvent!==undefined?event.originalEvent.touches:null;if(!_.dragging||touches&&touches.length!==1)return false;curLeft=_.getLeft(_.currentSlide);_.touchObject.curX=touches!==undefined?touches[0].pageX:event.clientX;_.touchObject.curY=touches!==undefined?touches[0].pageY:event.clientY;_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curX-
_.touchObject.startX,2)));if(_.options.verticalSwiping===true)_.touchObject.swipeLength=Math.round(Math.sqrt(Math.pow(_.touchObject.curY-_.touchObject.startY,2)));swipeDirection=_.swipeDirection();if(swipeDirection==="vertical")return;if(event.originalEvent!==undefined&&_.touchObject.swipeLength>4)event.preventDefault();positionOffset=(_.options.rtl===false?1:-1)*(_.touchObject.curX>_.touchObject.startX?1:-1);if(_.options.verticalSwiping===true)positionOffset=_.touchObject.curY>_.touchObject.startY?
1:-1;swipeLength=_.touchObject.swipeLength;_.touchObject.edgeHit=false;if(_.options.infinite===false)if(_.currentSlide===0&&swipeDirection==="right"||_.currentSlide>=_.getDotCount()&&swipeDirection==="left"){swipeLength=_.touchObject.swipeLength*_.options.edgeFriction;_.touchObject.edgeHit=true}if(_.options.vertical===false)_.swipeLeft=curLeft+swipeLength*positionOffset;else _.swipeLeft=curLeft+swipeLength*(_.$list.height()/_.listWidth)*positionOffset;if(_.options.verticalSwiping===true)_.swipeLeft=
curLeft+swipeLength*positionOffset;if(_.options.fade===true||_.options.touchMove===false)return false;if(_.animating===true){_.swipeLeft=null;return false}_.setCSS(_.swipeLeft)};Slick.prototype.swipeStart=function(event){var _=this,touches;_.interrupted=true;if(_.touchObject.fingerCount!==1||_.slideCount<=_.options.slidesToShow){_.touchObject={};return false}if(event.originalEvent!==undefined&&event.originalEvent.touches!==undefined)touches=event.originalEvent.touches[0];_.touchObject.startX=_.touchObject.curX=
touches!==undefined?touches.pageX:event.clientX;_.touchObject.startY=_.touchObject.curY=touches!==undefined?touches.pageY:event.clientY;_.dragging=true};Slick.prototype.unfilterSlides=Slick.prototype.slickUnfilter=function(){var _=this;if(_.$slidesCache!==null){_.unload();_.$slideTrack.children(this.options.slide).detach();_.$slidesCache.appendTo(_.$slideTrack);_.reinit()}};Slick.prototype.unload=function(){var _=this;$(".slick-cloned",_.$slider).remove();if(_.$dots)_.$dots.remove();if(_.$prevArrow&&
_.htmlExpr.test(_.options.prevArrow))_.$prevArrow.remove();if(_.$nextArrow&&_.htmlExpr.test(_.options.nextArrow))_.$nextArrow.remove();_.$slides.removeClass("slick-slide slick-active slick-visible slick-current").attr("aria-hidden","true").css("width","")};Slick.prototype.unslick=function(fromBreakpoint){var _=this;_.$slider.trigger("unslick",[_,fromBreakpoint]);_.destroy()};Slick.prototype.updateArrows=function(){var _=this,centerOffset;centerOffset=Math.floor(_.options.slidesToShow/2);if(_.options.arrows===
true&&_.slideCount>_.options.slidesToShow&&!_.options.infinite){_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false");_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false");if(_.currentSlide===0){_.$prevArrow.addClass("slick-disabled").attr("aria-disabled","true");_.$nextArrow.removeClass("slick-disabled").attr("aria-disabled","false")}else if(_.currentSlide>=_.slideCount-_.options.slidesToShow&&_.options.centerMode===false){_.$nextArrow.addClass("slick-disabled").attr("aria-disabled",
"true");_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")}else if(_.currentSlide>=_.slideCount-1&&_.options.centerMode===true){_.$nextArrow.addClass("slick-disabled").attr("aria-disabled","true");_.$prevArrow.removeClass("slick-disabled").attr("aria-disabled","false")}}};Slick.prototype.updateDots=function(){var _=this;if(_.$dots!==null){_.$dots.find("li").removeClass("slick-active").attr("aria-hidden","true");_.$dots.find("li").eq(Math.floor(_.currentSlide/_.options.slidesToScroll)).addClass("slick-active").attr("aria-hidden",
"false")}};Slick.prototype.visibility=function(){var _=this;if(_.options.autoplay)if(document[_.hidden])_.interrupted=true;else _.interrupted=false};$.fn.slick=function(){var _=this,opt=arguments[0],args=Array.prototype.slice.call(arguments,1),l=_.length,i,ret;for(i=0;i<l;i++){if(typeof opt=="object"||typeof opt=="undefined")_[i].slick=new Slick(_[i],opt);else ret=_[i].slick[opt].apply(_[i].slick,args);if(typeof ret!="undefined")return ret}return _}});var _self=typeof window!=="undefined"?window:typeof WorkerGlobalScope!=="undefined"&&self instanceof WorkerGlobalScope?self:{};
var Prism=function(){var lang=/\blang(?:uage)?-(\w+)\b/i;var uniqueId=0;var _=_self.Prism={util:{encode:function(tokens){if(tokens instanceof Token)return new Token(tokens.type,_.util.encode(tokens.content),tokens.alias);else if(_.util.type(tokens)==="Array")return tokens.map(_.util.encode);else return tokens.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(o){return Object.prototype.toString.call(o).match(/\[object (\w+)\]/)[1]},objId:function(obj){if(!obj["__id"])Object.defineProperty(obj,
"__id",{value:++uniqueId});return obj["__id"]},clone:function(o){var type=_.util.type(o);switch(type){case "Object":var clone={};for(var key in o)if(o.hasOwnProperty(key))clone[key]=_.util.clone(o[key]);return clone;case "Array":return o.map&&o.map(function(v){return _.util.clone(v)})}return o}},languages:{extend:function(id,redef){var lang=_.util.clone(_.languages[id]);for(var key in redef)lang[key]=redef[key];return lang},insertBefore:function(inside,before,insert,root){root=root||_.languages;var grammar=
root[inside];if(arguments.length==2){insert=arguments[1];for(var newToken in insert)if(insert.hasOwnProperty(newToken))grammar[newToken]=insert[newToken];return grammar}var ret={};for(var token in grammar)if(grammar.hasOwnProperty(token)){if(token==before)for(var newToken in insert)if(insert.hasOwnProperty(newToken))ret[newToken]=insert[newToken];ret[token]=grammar[token]}_.languages.DFS(_.languages,function(key,value){if(value===root[inside]&&key!=inside)this[key]=ret});return root[inside]=ret},
DFS:function(o,callback,type,visited){visited=visited||{};for(var i in o)if(o.hasOwnProperty(i)){callback.call(o,i,o[i],type||i);if(_.util.type(o[i])==="Object"&&!visited[_.util.objId(o[i])]){visited[_.util.objId(o[i])]=true;_.languages.DFS(o[i],callback,null,visited)}else if(_.util.type(o[i])==="Array"&&!visited[_.util.objId(o[i])]){visited[_.util.objId(o[i])]=true;_.languages.DFS(o[i],callback,i,visited)}}}},plugins:{},highlightAll:function(async,callback){var env={callback:callback,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};
_.hooks.run("before-highlightall",env);var elements=env.elements||document.querySelectorAll(env.selector);for(var i=0,element;element=elements[i++];)_.highlightElement(element,async===true,env.callback)},highlightElement:function(element,async,callback){var language,grammar,parent=element;while(parent&&!lang.test(parent.className))parent=parent.parentNode;if(parent){language=(parent.className.match(lang)||[,""])[1];grammar=_.languages[language]}element.className=element.className.replace(lang,"").replace(/\s+/g,
" ")+" language-"+language;parent=element.parentNode;if(/pre/i.test(parent.nodeName))parent.className=parent.className.replace(lang,"").replace(/\s+/g," ")+" language-"+language;var code=element.textContent;var env={element:element,language:language,grammar:grammar,code:code};if(!code||!grammar){_.hooks.run("complete",env);return}_.hooks.run("before-highlight",env);if(async&&_self.Worker){var worker=new Worker(_.filename);worker.onmessage=function(evt){env.highlightedCode=evt.data;_.hooks.run("before-insert",
env);env.element.innerHTML=env.highlightedCode;callback&&callback.call(env.element);_.hooks.run("after-highlight",env);_.hooks.run("complete",env)};worker.postMessage(JSON.stringify({language:env.language,code:env.code,immediateClose:true}))}else{env.highlightedCode=_.highlight(env.code,env.grammar,env.language);_.hooks.run("before-insert",env);env.element.innerHTML=env.highlightedCode;callback&&callback.call(element);_.hooks.run("after-highlight",env);_.hooks.run("complete",env)}},highlight:function(text,
grammar,language){var tokens=_.tokenize(text,grammar);return Token.stringify(_.util.encode(tokens),language)},tokenize:function(text,grammar,language){var Token=_.Token;var strarr=[text];var rest=grammar.rest;if(rest){for(var token in rest)grammar[token]=rest[token];delete grammar.rest}tokenloop:for(var token in grammar){if(!grammar.hasOwnProperty(token)||!grammar[token])continue;var patterns=grammar[token];patterns=_.util.type(patterns)==="Array"?patterns:[patterns];for(var j=0;j<patterns.length;++j){var pattern=
patterns[j],inside=pattern.inside,lookbehind=!!pattern.lookbehind,greedy=!!pattern.greedy,lookbehindLength=0,alias=pattern.alias;pattern=pattern.pattern||pattern;for(var i=0;i<strarr.length;i++){var str=strarr[i];if(strarr.length>text.length)break tokenloop;if(str instanceof Token)continue;pattern.lastIndex=0;var match=pattern.exec(str),delNum=1;if(!match&&greedy&&i!=strarr.length-1){var nextToken=strarr[i+1].matchedStr||strarr[i+1],combStr=str+nextToken;if(i<strarr.length-2)combStr+=strarr[i+2].matchedStr||
strarr[i+2];pattern.lastIndex=0;match=pattern.exec(combStr);if(!match)continue;var from=match.index+(lookbehind?match[1].length:0);if(from>=str.length)continue;var to=match.index+match[0].length,len=str.length+nextToken.length;delNum=3;if(to<=len){if(strarr[i+1].greedy)continue;delNum=2;combStr=combStr.slice(0,len)}str=combStr}if(!match)continue;if(lookbehind)lookbehindLength=match[1].length;var from=match.index+lookbehindLength,match=match[0].slice(lookbehindLength),to=from+match.length,before=str.slice(0,
from),after=str.slice(to);var args=[i,delNum];if(before)args.push(before);var wrapped=new Token(token,inside?_.tokenize(match,inside):match,alias,match,greedy);args.push(wrapped);if(after)args.push(after);Array.prototype.splice.apply(strarr,args)}}}return strarr},hooks:{all:{},add:function(name,callback){var hooks=_.hooks.all;hooks[name]=hooks[name]||[];hooks[name].push(callback)},run:function(name,env){var callbacks=_.hooks.all[name];if(!callbacks||!callbacks.length)return;for(var i=0,callback;callback=
callbacks[i++];)callback(env)}}};var Token=_.Token=function(type,content,alias,matchedStr,greedy){this.type=type;this.content=content;this.alias=alias;this.matchedStr=matchedStr||null;this.greedy=!!greedy};Token.stringify=function(o,language,parent){if(typeof o=="string")return o;if(_.util.type(o)==="Array")return o.map(function(element){return Token.stringify(element,language,o)}).join("");var env={type:o.type,content:Token.stringify(o.content,language,parent),tag:"span",classes:["token",o.type],
attributes:{},language:language,parent:parent};if(env.type=="comment")env.attributes["spellcheck"]="true";if(o.alias){var aliases=_.util.type(o.alias)==="Array"?o.alias:[o.alias];Array.prototype.push.apply(env.classes,aliases)}_.hooks.run("wrap",env);var attributes="";for(var name in env.attributes)attributes+=(attributes?" ":"")+name+'="'+(env.attributes[name]||"")+'"';return"<"+env.tag+' class="'+env.classes.join(" ")+'" '+attributes+">"+env.content+"</"+env.tag+">"};if(!_self.document){if(!_self.addEventListener)return _self.Prism;
_self.addEventListener("message",function(evt){var message=JSON.parse(evt.data),lang=message.language,code=message.code,immediateClose=message.immediateClose;_self.postMessage(_.highlight(code,_.languages[lang],lang));if(immediateClose)_self.close()},false);return _self.Prism}var script=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();if(script){_.filename=script.src;if(document.addEventListener&&!script.hasAttribute("data-manual"))document.addEventListener("DOMContentLoaded",
_.highlightAll)}return _self.Prism}();if(typeof module!=="undefined"&&module.exports)module.exports=Prism;if(typeof global!=="undefined")global.Prism=Prism;
Prism.languages.clike={"comment":[{pattern:/(^|[^\\])\/\*[\w\W]*?\*\//,lookbehind:true},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:true}],"string":{pattern:/(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:true},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i,lookbehind:true,inside:{punctuation:/(\.|\\)/}},"keyword":/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,
"boolean":/\b(true|false)\b/,"function":/[a-z0-9_]+(?=\()/i,"number":/\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i,"operator":/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,"punctuation":/[{}[\];(),.:]/};
Prism.languages.java=Prism.languages.extend("clike",{"keyword":/\b(abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/,"number":/\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp\-]+\b|\b\d*\.?\d+(?:e[+-]?\d+)?[df]?\b/i,"operator":{pattern:/(^|[^.])(?:\+[+=]?|-[-=]?|!=?|<<?=?|>>?>?=?|==?|&[&=]?|\|[|=]?|\*=?|\/=?|%=?|\^=?|[?:~])/m,
lookbehind:true}});Prism.languages.insertBefore("java","function",{"annotation":{alias:"punctuation",pattern:/(^|[^.])@\w+/,lookbehind:true}});(function(){Prism.languages.graql={comment:{pattern:/#.*/,alias:"comment"},string:{pattern:/".*?"/,alias:"string"},keyword:{pattern:/(to|select|insert|delete|where|group|by|isa|has|as|value|id|of|plays-role|has-role|ako|limit|offset|order|format)(?![-\$a-zA-Z_0-9])/,alias:"keyword"},special:{pattern:/graql>|results>|\.\.\./},month:{pattern:/Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec(?!{-\$a-zA-Z_0-9})/,alias:"number"},variable:{pattern:/\$[a-zA-Z_][-a-zA-Z_0-9]*(?![-\$a-zA-Z_0-9])/,alias:"variable"},
type:{pattern:/[-a-zA-Z_][-a-zA-Z_0-9]*(?![-\$a-zA-Z_0-9])/,alias:"function"},number:{pattern:/[0-9]+(\.[0-9][0-9]*)?/,alias:"number"},operator:{pattern:/=|!=|>|<|>=|<=/,alias:"operator"}}})();!function(){var d3={version:"3.5.16"};var d3_arraySlice=[].slice,d3_array=function(list){return d3_arraySlice.call(list)};var d3_document=this.document;function d3_documentElement(node){return node&&(node.ownerDocument||node.document||node).documentElement}function d3_window(node){return node&&(node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView)}if(d3_document)try{d3_array(d3_document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=function(list){var i=
list.length,array=new Array(i);while(i--)array[i]=list[i];return array}}if(!Date.now)Date.now=function(){return+new Date};if(d3_document)try{d3_document.createElement("DIV").style.setProperty("opacity",0,"")}catch(error){var d3_element_prototype=this.Element.prototype,d3_element_setAttribute=d3_element_prototype.setAttribute,d3_element_setAttributeNS=d3_element_prototype.setAttributeNS,d3_style_prototype=this.CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_element_prototype.setAttribute=
function(name,value){d3_element_setAttribute.call(this,name,value+"")};d3_element_prototype.setAttributeNS=function(space,local,value){d3_element_setAttributeNS.call(this,space,local,value+"")};d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}d3.ascending=d3_ascending;function d3_ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN};d3.min=function(array,f){var i=-1,n=array.length,
a,b;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=b;break}while(++i<n)if((b=array[i])!=null&&a>b)a=b}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=b;break}while(++i<n)if((b=f.call(array,array[i],i))!=null&&a>b)a=b}return a};d3.max=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=b;break}while(++i<n)if((b=array[i])!=null&&b>a)a=b}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=b;
break}while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>a)a=b}return a};d3.extent=function(array,f){var i=-1,n=array.length,a,b,c;if(arguments.length===1){while(++i<n)if((b=array[i])!=null&&b>=b){a=c=b;break}while(++i<n)if((b=array[i])!=null){if(a>b)a=b;if(c<b)c=b}}else{while(++i<n)if((b=f.call(array,array[i],i))!=null&&b>=b){a=c=b;break}while(++i<n)if((b=f.call(array,array[i],i))!=null){if(a>b)a=b;if(c<b)c=b}}return[a,c]};function d3_number(x){return x===null?NaN:+x}function d3_numeric(x){return!isNaN(x)}
d3.sum=function(array,f){var s=0,n=array.length,a,i=-1;if(arguments.length===1)while(++i<n){if(d3_numeric(a=+array[i]))s+=a}else while(++i<n)if(d3_numeric(a=+f.call(array,array[i],i)))s+=a;return s};d3.mean=function(array,f){var s=0,n=array.length,a,i=-1,j=n;if(arguments.length===1)while(++i<n)if(d3_numeric(a=d3_number(array[i])))s+=a;else--j;else while(++i<n)if(d3_numeric(a=d3_number(f.call(array,array[i],i))))s+=a;else--j;if(j)return s/j};d3.quantile=function(values,p){var H=(values.length-1)*p+
1,h=Math.floor(H),v=+values[h-1],e=H-h;return e?v+e*(values[h]-v):v};d3.median=function(array,f){var numbers=[],n=array.length,a,i=-1;if(arguments.length===1)while(++i<n){if(d3_numeric(a=d3_number(array[i])))numbers.push(a)}else while(++i<n)if(d3_numeric(a=d3_number(f.call(array,array[i],i))))numbers.push(a);if(numbers.length)return d3.quantile(numbers.sort(d3_ascending),.5)};d3.variance=function(array,f){var n=array.length,m=0,a,d,s=0,i=-1,j=0;if(arguments.length===1)while(++i<n){if(d3_numeric(a=
d3_number(array[i]))){d=a-m;m+=d/++j;s+=d*(a-m)}}else while(++i<n)if(d3_numeric(a=d3_number(f.call(array,array[i],i)))){d=a-m;m+=d/++j;s+=d*(a-m)}if(j>1)return s/(j-1)};d3.deviation=function(){var v=d3.variance.apply(this,arguments);return v?Math.sqrt(v):v};function d3_bisector(compare){return{left:function(a,x,lo,hi){if(arguments.length<3)lo=0;if(arguments.length<4)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)<0)lo=mid+1;else hi=mid}return lo},right:function(a,x,lo,hi){if(arguments.length<
3)lo=0;if(arguments.length<4)hi=a.length;while(lo<hi){var mid=lo+hi>>>1;if(compare(a[mid],x)>0)hi=mid;else lo=mid+1}return lo}}}var d3_bisect=d3_bisector(d3_ascending);d3.bisectLeft=d3_bisect.left;d3.bisect=d3.bisectRight=d3_bisect.right;d3.bisector=function(f){return d3_bisector(f.length===1?function(d,x){return d3_ascending(f(d),x)}:f)};d3.shuffle=function(array,i0,i1){if((m=arguments.length)<3){i1=array.length;if(m<2)i0=0}var m=i1-i0,t,i;while(m){i=Math.random()*m--|0;t=array[m+i0],array[m+i0]=
array[i+i0],array[i+i0]=t}return array};d3.permute=function(array,indexes){var i=indexes.length,permutes=new Array(i);while(i--)permutes[i]=array[indexes[i]];return permutes};d3.pairs=function(array){var i=0,n=array.length-1,p0,p1=array[0],pairs=new Array(n<0?0:n);while(i<n)pairs[i]=[p0=p1,p1=array[++i]];return pairs};d3.transpose=function(matrix){if(!(n=matrix.length))return[];for(var i=-1,m=d3.min(matrix,d3_transposeLength),transpose=new Array(m);++i<m;)for(var j=-1,n,row=transpose[i]=new Array(n);++j<
n;)row[j]=matrix[j][i];return transpose};function d3_transposeLength(d){return d.length}d3.zip=function(){return d3.transpose(arguments)};d3.keys=function(map){var keys=[];for(var key in map)keys.push(key);return keys};d3.values=function(map){var values=[];for(var key in map)values.push(map[key]);return values};d3.entries=function(map){var entries=[];for(var key in map)entries.push({key:key,value:map[key]});return entries};d3.merge=function(arrays){var n=arrays.length,m,i=-1,j=0,merged,array;while(++i<
n)j+=arrays[i].length;merged=new Array(j);while(--n>=0){array=arrays[n];m=array.length;while(--m>=0)merged[--j]=array[m]}return merged};var abs=Math.abs;d3.range=function(start,stop,step){if(arguments.length<3){step=1;if(arguments.length<2){stop=start;start=0}}if((stop-start)/step===Infinity)throw new Error("infinite range");var range=[],k=d3_range_integerScale(abs(step)),i=-1,j;start*=k,stop*=k,step*=k;if(step<0)while((j=start+step*++i)>stop)range.push(j/k);else while((j=start+step*++i)<stop)range.push(j/
k);return range};function d3_range_integerScale(x){var k=1;while(x*k%1)k*=10;return k}function d3_class(ctor,properties){for(var key in properties)Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:false})}d3.map=function(object,f){var map=new d3_Map;if(object instanceof d3_Map)object.forEach(function(key,value){map.set(key,value)});else if(Array.isArray(object)){var i=-1,n=object.length,o;if(arguments.length===1)while(++i<n)map.set(i,object[i]);else while(++i<n)map.set(f.call(object,
o=object[i],i),o)}else for(var key in object)map.set(key,object[key]);return map};function d3_Map(){this._=Object.create(null)}var d3_map_proto="__proto__",d3_map_zero="\x00";d3_class(d3_Map,{has:d3_map_has,get:function(key){return this._[d3_map_escape(key)]},set:function(key,value){return this._[d3_map_escape(key)]=value},remove:d3_map_remove,keys:d3_map_keys,values:function(){var values=[];for(var key in this._)values.push(this._[key]);return values},entries:function(){var entries=[];for(var key in this._)entries.push({key:d3_map_unescape(key),
value:this._[key]});return entries},size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key),this._[key])}});function d3_map_escape(key){return(key+="")===d3_map_proto||key[0]===d3_map_zero?d3_map_zero+key:key}function d3_map_unescape(key){return(key+="")[0]===d3_map_zero?key.slice(1):key}function d3_map_has(key){return d3_map_escape(key)in this._}function d3_map_remove(key){return(key=d3_map_escape(key))in this._&&delete this._[key]}function d3_map_keys(){var keys=
[];for(var key in this._)keys.push(d3_map_unescape(key));return keys}function d3_map_size(){var size=0;for(var key in this._)++size;return size}function d3_map_empty(){for(var key in this._)return false;return true}d3.nest=function(){var nest={},keys=[],sortKeys=[],sortValues,rollup;function map(mapType,array,depth){if(depth>=keys.length)return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array;var i=-1,n=array.length,key=keys[depth++],keyValue,object,setter,valuesByKey=new d3_Map,
values;while(++i<n)if(values=valuesByKey.get(keyValue=key(object=array[i])))values.push(object);else valuesByKey.set(keyValue,[object]);if(mapType){object=mapType();setter=function(keyValue,values){object.set(keyValue,map(mapType,values,depth))}}else{object={};setter=function(keyValue,values){object[keyValue]=map(mapType,values,depth)}}valuesByKey.forEach(setter);return object}function entries(map,depth){if(depth>=keys.length)return map;var array=[],sortKey=sortKeys[depth++];map.forEach(function(key,
keyMap){array.push({key:key,values:entries(keyMap,depth)})});return sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}nest.map=function(array,mapType){return map(mapType,array,0)};nest.entries=function(array){return entries(map(d3.map,array,0),0)};nest.key=function(d){keys.push(d);return nest};nest.sortKeys=function(order){sortKeys[keys.length-1]=order;return nest};nest.sortValues=function(order){sortValues=order;return nest};nest.rollup=function(f){rollup=f;return nest};return nest};
d3.set=function(array){var set=new d3_Set;if(array)for(var i=0,n=array.length;i<n;++i)set.add(array[i]);return set};function d3_Set(){this._=Object.create(null)}d3_class(d3_Set,{has:d3_map_has,add:function(key){this._[d3_map_escape(key+="")]=true;return key},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(f){for(var key in this._)f.call(this,d3_map_unescape(key))}});d3.behavior={};function d3_identity(d){return d}d3.rebind=function(target,source){var i=
1,n=arguments.length,method;while(++i<n)target[method=arguments[i]]=d3_rebind(target,source,source[method]);return target};function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}function d3_vendorSymbol(object,name){if(name in object)return name;name=name.charAt(0).toUpperCase()+name.slice(1);for(var i=0,n=d3_vendorPrefixes.length;i<n;++i){var prefixName=d3_vendorPrefixes[i]+name;if(prefixName in object)return prefixName}}
var d3_vendorPrefixes=["webkit","ms","moz","Moz","o","O"];function d3_noop(){}d3.dispatch=function(){var dispatch=new d3_dispatch,i=-1,n=arguments.length;while(++i<n)dispatch[arguments[i]]=d3_dispatch_event(dispatch);return dispatch};function d3_dispatch(){}d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>=0){name=type.slice(i+1);type=type.slice(0,i)}if(type)return arguments.length<2?this[type].on(name):this[type].on(name,listener);if(arguments.length===2){if(listener==
null)for(type in this)if(this.hasOwnProperty(type))this[type].on(name,null);return this}};function d3_dispatch_event(dispatch){var listeners=[],listenerByName=new d3_Map;function event(){var z=listeners,i=-1,n=z.length,l;while(++i<n)if(l=z[i].on)l.apply(this,arguments);return dispatch}event.on=function(name,listener){var l=listenerByName.get(name),i;if(arguments.length<2)return l&&l.on;if(l){l.on=null;listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1));listenerByName.remove(name)}if(listener)listeners.push(listenerByName.set(name,
{on:listener}));return dispatch};return event}d3.event=null;function d3_eventPreventDefault(){d3.event.preventDefault()}function d3_eventSource(){var e=d3.event,s;while(s=e.sourceEvent)e=s;return e}function d3_eventDispatch(target){var dispatch=new d3_dispatch,i=0,n=arguments.length;while(++i<n)dispatch[arguments[i]]=d3_dispatch_event(dispatch);dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target;d3.event=e1;dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=
e0}}};return dispatch}d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;var d3_subclass={}.__proto__?function(object,prototype){object.__proto__=prototype}:function(object,prototype){for(var property in prototype)object[property]=prototype[property]};function d3_selection(groups){d3_subclass(groups,d3_selectionPrototype);return groups}var d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},
d3_selectMatches=function(n,s){var d3_selectMatcher=n.matches||n[d3_vendorSymbol(n,"matchesSelector")];d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)};return d3_selectMatches(n,s)};if(typeof Sizzle==="function"){d3_select=function(s,n){return Sizzle(s,n)[0]||null};d3_selectAll=Sizzle;d3_selectMatches=Sizzle.matchesSelector}d3.selection=function(){return d3.select(d3_document.documentElement)};var d3_selectionPrototype=d3.selection.prototype=[];d3_selectionPrototype.select=function(selector){var subgroups=
[],subgroup,subnode,group,node;selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;)if(node=group[i]){subgroup.push(subnode=selector.call(node,node.__data__,i,j));if(subnode&&"__data__"in node)subnode.__data__=node.__data__}else subgroup.push(null)}return d3_selection(subgroups)};function d3_selection_selector(selector){return typeof selector==="function"?selector:function(){return d3_select(selector,
this)}}d3_selectionPrototype.selectAll=function(selector){var subgroups=[],subgroup,node;selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)if(node=group[i]){subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i,j)));subgroup.parentNode=node}return d3_selection(subgroups)};function d3_selection_selectorAll(selector){return typeof selector==="function"?selector:function(){return d3_selectAll(selector,this)}}var d3_nsXhtml=
"http://www.w3.org/1999/xhtml";var d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:d3_nsXhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;if(i>=0&&(prefix=name.slice(0,i))!=="xmlns")name=name.slice(i+1);return d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}};d3_selectionPrototype.attr=function(name,value){if(arguments.length<
2){if(typeof name==="string"){var node=this.node();name=d3.ns.qualify(name);return name.local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name)this.each(d3_selection_attr(value,name[value]));return this}return this.each(d3_selection_attr(name,value))};function d3_selection_attr(name,value){name=d3.ns.qualify(name);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrConstant(){this.setAttribute(name,
value)}function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}function attrFunction(){var x=value.apply(this,arguments);if(x==null)this.removeAttribute(name);else this.setAttribute(name,x)}function attrFunctionNS(){var x=value.apply(this,arguments);if(x==null)this.removeAttributeNS(name.space,name.local);else this.setAttributeNS(name.space,name.local,x)}return value==null?name.local?attrNullNS:attrNull:typeof value==="function"?name.local?attrFunctionNS:attrFunction:name.local?
attrConstantNS:attrConstant}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node(),n=(name=d3_selection_classes(name)).length,i=-1;if(value=node.classList)while(++i<n){if(!value.contains(name[i]))return false}else{value=node.getAttribute("class");while(++i<n)if(!d3_selection_classedRe(name[i]).test(value))return false}return true}for(value in name)this.each(d3_selection_classed(value,
name[value]));return this}return this.each(d3_selection_classed(name,value))};function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classes(name){return(name+"").trim().split(/^|\s+/)}function d3_selection_classed(name,value){name=d3_selection_classes(name).map(d3_selection_classedName);var n=name.length;function classedConstant(){var i=-1;while(++i<n)name[i](this,value)}function classedFunction(){var i=-1,x=value.apply(this,
arguments);while(++i<n)name[i](this,x)}return typeof value==="function"?classedFunction:classedConstant}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList)return value?c.add(name):c.remove(name);var c=node.getAttribute("class")||"";if(value){re.lastIndex=0;if(!re.test(c))node.setAttribute("class",d3_collapse(c+" "+name))}else node.setAttribute("class",d3_collapse(c.replace(re," ")))}}d3_selectionPrototype.style=function(name,
value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2)value="";for(priority in name)this.each(d3_selection_style(priority,name[priority],value));return this}if(n<2){var node=this.node();return d3_window(node).getComputedStyle(node,null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))};function d3_selection_style(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleConstant(){this.style.setProperty(name,
value,priority)}function styleFunction(){var x=value.apply(this,arguments);if(x==null)this.style.removeProperty(name);else this.style.setProperty(name,x,priority)}return value==null?styleNull:typeof value==="function"?styleFunction:styleConstant}d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if(typeof name==="string")return this.node()[name];for(value in name)this.each(d3_selection_property(value,name[value]));return this}return this.each(d3_selection_property(name,value))};
function d3_selection_property(name,value){function propertyNull(){delete this[name]}function propertyConstant(){this[name]=value}function propertyFunction(){var x=value.apply(this,arguments);if(x==null)delete this[name];else this[name]=x}return value==null?propertyNull:typeof value==="function"?propertyFunction:propertyConstant}d3_selectionPrototype.text=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.textContent=v==null?
"":v}:value==null?function(){this.textContent=""}:function(){this.textContent=value}):this.node().textContent};d3_selectionPrototype.html=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.innerHTML=v==null?"":v}:value==null?function(){this.innerHTML=""}:function(){this.innerHTML=value}):this.node().innerHTML};d3_selectionPrototype.append=function(name){name=d3_selection_creator(name);return this.select(function(){return this.appendChild(name.apply(this,
arguments))})};function d3_selection_creator(name){function create(){var document=this.ownerDocument,namespace=this.namespaceURI;return namespace===d3_nsXhtml&&document.documentElement.namespaceURI===d3_nsXhtml?document.createElement(name):document.createElementNS(namespace,name)}function createNS(){return this.ownerDocument.createElementNS(name.space,name.local)}return typeof name==="function"?name:(name=d3.ns.qualify(name)).local?createNS:create}d3_selectionPrototype.insert=function(name,before){name=
d3_selection_creator(name);before=d3_selection_selector(before);return this.select(function(){return this.insertBefore(name.apply(this,arguments),before.apply(this,arguments)||null)})};d3_selectionPrototype.remove=function(){return this.each(d3_selectionRemove)};function d3_selectionRemove(){var parent=this.parentNode;if(parent)parent.removeChild(this)}d3_selectionPrototype.data=function(value,key){var i=-1,n=this.length,group,node;if(!arguments.length){value=new Array(n=(group=this[0]).length);while(++i<
n)if(node=group[i])value[i]=node.__data__;return value}function bind(group,groupData){var i,n=group.length,m=groupData.length,n0=Math.min(n,m),updateNodes=new Array(m),enterNodes=new Array(m),exitNodes=new Array(n),node,nodeData;if(key){var nodeByKeyValue=new d3_Map,keyValues=new Array(n),keyValue;for(i=-1;++i<n;)if(node=group[i]){if(nodeByKeyValue.has(keyValue=key.call(node,node.__data__,i)))exitNodes[i]=node;else nodeByKeyValue.set(keyValue,node);keyValues[i]=keyValue}for(i=-1;++i<m;){if(!(node=
nodeByKeyValue.get(keyValue=key.call(groupData,nodeData=groupData[i],i))))enterNodes[i]=d3_selection_dataNode(nodeData);else if(node!==true){updateNodes[i]=node;node.__data__=nodeData}nodeByKeyValue.set(keyValue,true)}for(i=-1;++i<n;)if(i in keyValues&&nodeByKeyValue.get(keyValues[i])!==true)exitNodes[i]=group[i]}else{for(i=-1;++i<n0;){node=group[i];nodeData=groupData[i];if(node){node.__data__=nodeData;updateNodes[i]=node}else enterNodes[i]=d3_selection_dataNode(nodeData)}for(;i<m;++i)enterNodes[i]=
d3_selection_dataNode(groupData[i]);for(;i<n;++i)exitNodes[i]=group[i]}enterNodes.update=updateNodes;enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode;enter.push(enterNodes);update.push(updateNodes);exit.push(exitNodes)}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if(typeof value==="function")while(++i<n)bind(group=this[i],value.call(group,group.parentNode.__data__,i));else while(++i<n)bind(group=this[i],value);update.enter=function(){return enter};
update.exit=function(){return exit};return update};function d3_selection_dataNode(data){return{__data__:data}}d3_selectionPrototype.datum=function(value){return arguments.length?this.property("__data__",value):this.property("__data__")};d3_selectionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function")filter=d3_selection_filter(filter);for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=
0,n=group.length;i<n;i++)if((node=group[i])&&filter.call(node,node.__data__,i,j))subgroup.push(node)}return d3_selection(subgroups)};function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=group.length-1,next=group[i],node;--i>=0;)if(node=group[i]){if(next&&next!==node.nextSibling)next.parentNode.insertBefore(node,next);next=node}return this};d3_selectionPrototype.sort=
function(comparator){comparator=d3_selection_sortComparator.apply(this,arguments);for(var j=-1,m=this.length;++j<m;)this[j].sort(comparator);return this.order()};function d3_selection_sortComparator(comparator){if(!arguments.length)comparator=d3_ascending;return function(a,b){return a&&b?comparator(a.__data__,b.__data__):!a-!b}}d3_selectionPrototype.each=function(callback){return d3_selection_each(this,function(node,i,j){callback.call(node,node.__data__,i,j)})};function d3_selection_each(groups,callback){for(var j=
0,m=groups.length;j<m;j++)for(var group=groups[j],i=0,n=group.length,node;i<n;i++)if(node=group[i])callback(node,i,j);return groups}d3_selectionPrototype.call=function(callback){var args=d3_array(arguments);callback.apply(args[0]=this,args);return this};d3_selectionPrototype.empty=function(){return!this.node()};d3_selectionPrototype.node=function(){for(var j=0,m=this.length;j<m;j++)for(var group=this[j],i=0,n=group.length;i<n;i++){var node=group[i];if(node)return node}return null};d3_selectionPrototype.size=
function(){var n=0;d3_selection_each(this,function(){++n});return n};function d3_selection_enter(selection){d3_subclass(selection,d3_selection_enterPrototype);return selection}var d3_selection_enterPrototype=[];d3.selection.enter=d3_selection_enter;d3.selection.enter.prototype=d3_selection_enterPrototype;d3_selection_enterPrototype.append=d3_selectionPrototype.append;d3_selection_enterPrototype.empty=d3_selectionPrototype.empty;d3_selection_enterPrototype.node=d3_selectionPrototype.node;d3_selection_enterPrototype.call=
d3_selectionPrototype.call;d3_selection_enterPrototype.size=d3_selectionPrototype.size;d3_selection_enterPrototype.select=function(selector){var subgroups=[],subgroup,subnode,upgroup,group,node;for(var j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update;subgroups.push(subgroup=[]);subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;)if(node=group[i]){subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i,j));subnode.__data__=node.__data__}else subgroup.push(null)}return d3_selection(subgroups)};
d3_selection_enterPrototype.insert=function(name,before){if(arguments.length<2)before=d3_selection_enterInsertBefore(this);return d3_selectionPrototype.insert.call(this,name,before)};function d3_selection_enterInsertBefore(enter){var i0,j0;return function(d,i,j){var group=enter[j].update,n=group.length,node;if(j!=j0)j0=j,i0=0;if(i>=i0)i0=i+1;while(!(node=group[i0])&&++i0<n);return node}}d3.select=function(node){var group;if(typeof node==="string"){group=[d3_select(node,d3_document)];group.parentNode=
d3_document.documentElement}else{group=[node];group.parentNode=d3_documentElement(node)}return d3_selection([group])};d3.selectAll=function(nodes){var group;if(typeof nodes==="string"){group=d3_array(d3_selectAll(nodes,d3_document));group.parentNode=d3_document.documentElement}else{group=d3_array(nodes);group.parentNode=null}return d3_selection([group])};d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(n<3){if(typeof type!=="string"){if(n<2)listener=false;for(capture in type)this.each(d3_selection_on(capture,
type[capture],listener));return this}if(n<2)return(n=this.node()["__on"+type])&&n._;capture=false}return this.each(d3_selection_on(type,listener,capture))};function d3_selection_on(type,listener,capture){var name="__on"+type,i=type.indexOf("."),wrap=d3_selection_onListener;if(i>0)type=type.slice(0,i);var filter=d3_selection_onFilters.get(type);if(filter)type=filter,wrap=d3_selection_onFilter;function onRemove(){var l=this[name];if(l){this.removeEventListener(type,l,l.$);delete this[name]}}function onAdd(){var l=
wrap(listener,d3_array(arguments));onRemove.call(this);this.addEventListener(type,this[name]=l,l.$=capture);l._=listener}function removeAll(){var re=new RegExp("^__on([^.]+)"+d3.requote(type)+"$"),match;for(var name in this)if(match=name.match(re)){var l=this[name];this.removeEventListener(match[1],l,l.$);delete this[name]}}return i?listener?onAdd:onRemove:listener?d3_noop:removeAll}var d3_selection_onFilters=d3.map({mouseenter:"mouseover",mouseleave:"mouseout"});if(d3_document)d3_selection_onFilters.forEach(function(k){if("on"+
k in d3_document)d3_selection_onFilters.remove(k)});function d3_selection_onListener(listener,argumentz){return function(e){var o=d3.event;d3.event=e;argumentz[0]=this.__data__;try{listener.apply(this,argumentz)}finally{d3.event=o}}}function d3_selection_onFilter(listener,argumentz){var l=d3_selection_onListener(listener,argumentz);return function(e){var target=this,related=e.relatedTarget;if(!related||related!==target&&!(related.compareDocumentPosition(target)&8))l.call(target,e)}}var d3_event_dragSelect,
d3_event_dragId=0;function d3_event_dragSuppress(node){var name=".dragsuppress-"+ ++d3_event_dragId,click="click"+name,w=d3.select(d3_window(node)).on("touchmove"+name,d3_eventPreventDefault).on("dragstart"+name,d3_eventPreventDefault).on("selectstart"+name,d3_eventPreventDefault);if(d3_event_dragSelect==null)d3_event_dragSelect="onselectstart"in node?false:d3_vendorSymbol(node.style,"userSelect");if(d3_event_dragSelect){var style=d3_documentElement(node).style,select=style[d3_event_dragSelect];style[d3_event_dragSelect]=
"none"}return function(suppressClick){w.on(name,null);if(d3_event_dragSelect)style[d3_event_dragSelect]=select;if(suppressClick){var off=function(){w.on(click,null)};w.on(click,function(){d3_eventPreventDefault();off()},true);setTimeout(off,0)}}}d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function d3_mousePoint(container,e){if(e.changedTouches)e=e.changedTouches[0];var svg=container.ownerSVGElement||
container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(d3_mouse_bug44083<0){var window=d3_window(container);if(window.scrollX||window.scrollY){svg=d3.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var ctm=svg[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e);svg.remove()}}if(d3_mouse_bug44083)point.x=e.pageX,point.y=e.pageY;else point.x=e.clientX,point.y=e.clientY;point=point.matrixTransform(container.getScreenCTM().inverse());
return[point.x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}d3.touch=function(container,touches,identifier){if(arguments.length<3)identifier=touches,touches=d3_eventSource().changedTouches;if(touches)for(var i=0,n=touches.length,touch;i<n;++i)if((touch=touches[i]).identifier===identifier)return d3_mousePoint(container,touch)};d3.behavior.drag=function(){var event=d3_eventDispatch(drag,"drag","dragstart",
"dragend"),origin=null,mousedown=dragstart(d3_noop,d3.mouse,d3_window,"mousemove","mouseup"),touchstart=dragstart(d3_behavior_dragTouchId,d3.touch,d3_identity,"touchmove","touchend");function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",touchstart)}function dragstart(id,position,subject,move,end){return function(){var that=this,target=d3.event.target.correspondingElement||d3.event.target,parent=that.parentNode,dispatch=event.of(that,arguments),dragged=0,dragId=id(),dragName=".drag"+
(dragId==null?"":"-"+dragId),dragOffset,dragSubject=d3.select(subject(target)).on(move+dragName,moved).on(end+dragName,ended),dragRestore=d3_event_dragSuppress(target),position0=position(parent,dragId);if(origin){dragOffset=origin.apply(that,arguments);dragOffset=[dragOffset.x-position0[0],dragOffset.y-position0[1]]}else dragOffset=[0,0];dispatch({type:"dragstart"});function moved(){var position1=position(parent,dragId),dx,dy;if(!position1)return;dx=position1[0]-position0[0];dy=position1[1]-position0[1];
dragged|=dx|dy;position0=position1;dispatch({type:"drag",x:position1[0]+dragOffset[0],y:position1[1]+dragOffset[1],dx:dx,dy:dy})}function ended(){if(!position(parent,dragId))return;dragSubject.on(move+dragName,null).on(end+dragName,null);dragRestore(dragged);dispatch({type:"dragend"})}}}drag.origin=function(x){if(!arguments.length)return origin;origin=x;return drag};return d3.rebind(drag,event,"on")};function d3_behavior_dragTouchId(){return d3.event.changedTouches[0].identifier}d3.touches=function(container,
touches){if(arguments.length<2)touches=d3_eventSource().touches;return touches?d3_array(touches).map(function(touch){var point=d3_mousePoint(container,touch);point.identifier=touch.identifier;return point}):[]};var \u03b5=1E-6,\u03b52=\u03b5*\u03b5,\u03c0=Math.PI,\u03c4=2*\u03c0,\u03c4\u03b5=\u03c4-\u03b5,half\u03c0=\u03c0/2,d3_radians=\u03c0/180,d3_degrees=180/\u03c0;function d3_sgn(x){return x>0?1:x<0?-1:0}function d3_cross2d(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(b[1]-a[1])*(c[0]-a[0])}function d3_acos(x){return x>
1?0:x<-1?\u03c0:Math.acos(x)}function d3_asin(x){return x>1?half\u03c0:x<-1?-half\u03c0:Math.asin(x)}function d3_sinh(x){return((x=Math.exp(x))-1/x)/2}function d3_cosh(x){return((x=Math.exp(x))+1/x)/2}function d3_tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}function d3_haversin(x){return(x=Math.sin(x/2))*x}var \u03c1=Math.SQRT2,\u03c12=2,\u03c14=4;d3.interpolateZoom=function(p0,p1){var ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy,i,S;if(d2<\u03b52){S=
Math.log(w1/w0)/\u03c1;i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(\u03c1*t*S)]}}else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+\u03c14*d2)/(2*w0*\u03c12*d1),b1=(w1*w1-w0*w0-\u03c14*d2)/(2*w1*\u03c12*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/\u03c1;i=function(t){var s=t*S,coshr0=d3_cosh(r0),u=w0/(\u03c12*d1)*(coshr0*d3_tanh(\u03c1*s+r0)-d3_sinh(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/d3_cosh(\u03c1*s+r0)]}}i.duration=S*1E3;return i};d3.behavior.zoom=function(){var view=
{x:0,y:0,k:1},translate0,center0,center,size=[960,500],scaleExtent=d3_behavior_zoomInfinity,duration=250,zooming=0,mousedown="mousedown.zoom",mousemove="mousemove.zoom",mouseup="mouseup.zoom",mousewheelTimer,touchstart="touchstart.zoom",touchtime,event=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend"),x0,x1,y0,y1;if(!d3_behavior_zoomWheel)d3_behavior_zoomWheel="onwheel"in d3_document?(d3_behavior_zoomDelta=function(){return-d3.event.deltaY*(d3.event.deltaMode?120:1)},"wheel"):"onmousewheel"in d3_document?
(d3_behavior_zoomDelta=function(){return d3.event.wheelDelta},"mousewheel"):(d3_behavior_zoomDelta=function(){return-d3.event.detail},"MozMousePixelScroll");function zoom(g){g.on(mousedown,mousedowned).on(d3_behavior_zoomWheel+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(touchstart,touchstarted)}zoom.event=function(g){g.each(function(){var dispatch=event.of(this,arguments),view1=view;if(d3_transitionInheritId)d3.select(this).transition().each("start.zoom",function(){view=this.__chart__||
{x:0,y:0,k:1};zoomstarted(dispatch)}).tween("zoom:zoom",function(){var dx=size[0],dy=size[1],cx=center0?center0[0]:dx/2,cy=center0?center0[1]:dy/2,i=d3.interpolateZoom([(cx-view.x)/view.k,(cy-view.y)/view.k,dx/view.k],[(cx-view1.x)/view1.k,(cy-view1.y)/view1.k,dx/view1.k]);return function(t){var l=i(t),k=dx/l[2];this.__chart__=view={x:cx-l[0]*k,y:cy-l[1]*k,k:k};zoomed(dispatch)}}).each("interrupt.zoom",function(){zoomended(dispatch)}).each("end.zoom",function(){zoomended(dispatch)});else{this.__chart__=
view;zoomstarted(dispatch);zoomed(dispatch);zoomended(dispatch)}})};zoom.translate=function(_){if(!arguments.length)return[view.x,view.y];view={x:+_[0],y:+_[1],k:view.k};rescale();return zoom};zoom.scale=function(_){if(!arguments.length)return view.k;view={x:view.x,y:view.y,k:null};scaleTo(+_);rescale();return zoom};zoom.scaleExtent=function(_){if(!arguments.length)return scaleExtent;scaleExtent=_==null?d3_behavior_zoomInfinity:[+_[0],+_[1]];return zoom};zoom.center=function(_){if(!arguments.length)return center;
center=_&&[+_[0],+_[1]];return zoom};zoom.size=function(_){if(!arguments.length)return size;size=_&&[+_[0],+_[1]];return zoom};zoom.duration=function(_){if(!arguments.length)return duration;duration=+_;return zoom};zoom.x=function(z){if(!arguments.length)return x1;x1=z;x0=z.copy();view={x:0,y:0,k:1};return zoom};zoom.y=function(z){if(!arguments.length)return y1;y1=z;y0=z.copy();view={x:0,y:0,k:1};return zoom};function location(p){return[(p[0]-view.x)/view.k,(p[1]-view.y)/view.k]}function point(l){return[l[0]*
view.k+view.x,l[1]*view.k+view.y]}function scaleTo(s){view.k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=point(l);view.x+=p[0]-l[0];view.y+=p[1]-l[1]}function zoomTo(that,p,l,k){that.__chart__={x:view.x,y:view.y,k:view.k};scaleTo(Math.pow(2,k));translateTo(center0=p,l);that=d3.select(that);if(duration>0)that=that.transition().duration(duration);that.call(zoom.event)}function rescale(){if(x1)x1.domain(x0.range().map(function(x){return(x-view.x)/view.k}).map(x0.invert));
if(y1)y1.domain(y0.range().map(function(y){return(y-view.y)/view.k}).map(y0.invert))}function zoomstarted(dispatch){if(!zooming++)dispatch({type:"zoomstart"})}function zoomed(dispatch){rescale();dispatch({type:"zoom",scale:view.k,translate:[view.x,view.y]})}function zoomended(dispatch){if(!--zooming)dispatch({type:"zoomend"}),center0=null}function mousedowned(){var that=this,dispatch=event.of(that,arguments),dragged=0,subject=d3.select(d3_window(that)).on(mousemove,moved).on(mouseup,ended),location0=
location(d3.mouse(that)),dragRestore=d3_event_dragSuppress(that);d3_selection_interrupt.call(that);zoomstarted(dispatch);function moved(){dragged=1;translateTo(d3.mouse(that),location0);zoomed(dispatch)}function ended(){subject.on(mousemove,null).on(mouseup,null);dragRestore(dragged);zoomended(dispatch)}}function touchstarted(){var that=this,dispatch=event.of(that,arguments),locations0={},distance0=0,scale0,zoomName=".zoom-"+d3.event.changedTouches[0].identifier,touchmove="touchmove"+zoomName,touchend=
"touchend"+zoomName,targets=[],subject=d3.select(that),dragRestore=d3_event_dragSuppress(that);started();zoomstarted(dispatch);subject.on(mousedown,null).on(touchstart,started);function relocate(){var touches=d3.touches(that);scale0=view.k;touches.forEach(function(t){if(t.identifier in locations0)locations0[t.identifier]=location(t)});return touches}function started(){var target=d3.event.target;d3.select(target).on(touchmove,moved).on(touchend,ended);targets.push(target);var changed=d3.event.changedTouches;
for(var i=0,n=changed.length;i<n;++i)locations0[changed[i].identifier]=null;var touches=relocate(),now=Date.now();if(touches.length===1){if(now-touchtime<500){var p=touches[0];zoomTo(that,p,locations0[p.identifier],Math.floor(Math.log(view.k)/Math.LN2)+1);d3_eventPreventDefault()}touchtime=now}else if(touches.length>1){var p=touches[0],q=touches[1],dx=p[0]-q[0],dy=p[1]-q[1];distance0=dx*dx+dy*dy}}function moved(){var touches=d3.touches(that),p0,l0,p1,l1;d3_selection_interrupt.call(that);for(var i=
0,n=touches.length;i<n;++i,l1=null){p1=touches[i];if(l1=locations0[p1.identifier]){if(l0)break;p0=p1,l0=l1}}if(l1){var distance1=(distance1=p1[0]-p0[0])*distance1+(distance1=p1[1]-p0[1])*distance1,scale1=distance0&&Math.sqrt(distance1/distance0);p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2];l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2];scaleTo(scale1*scale0)}touchtime=null;translateTo(p0,l0);zoomed(dispatch)}function ended(){if(d3.event.touches.length){var changed=d3.event.changedTouches;for(var i=0,n=changed.length;i<
n;++i)delete locations0[changed[i].identifier];for(var identifier in locations0)return void relocate()}d3.selectAll(targets).on(zoomName,null);subject.on(mousedown,mousedowned).on(touchstart,touchstarted);dragRestore();zoomended(dispatch)}}function mousewheeled(){var dispatch=event.of(this,arguments);if(mousewheelTimer)clearTimeout(mousewheelTimer);else d3_selection_interrupt.call(this),translate0=location(center0=center||d3.mouse(this)),zoomstarted(dispatch);mousewheelTimer=setTimeout(function(){mousewheelTimer=
null;zoomended(dispatch)},50);d3_eventPreventDefault();scaleTo(Math.pow(2,d3_behavior_zoomDelta()*.002)*view.k);translateTo(center0,translate0);zoomed(dispatch)}function dblclicked(){var p=d3.mouse(this),k=Math.log(view.k)/Math.LN2;zoomTo(this,p,location(p),d3.event.shiftKey?Math.ceil(k)-1:Math.floor(k)+1)}return d3.rebind(zoom,event,"on")};var d3_behavior_zoomInfinity=[0,Infinity],d3_behavior_zoomDelta,d3_behavior_zoomWheel;d3.color=d3_color;function d3_color(){}d3_color.prototype.toString=function(){return this.rgb()+
""};d3.hsl=d3_hsl;function d3_hsl(h,s,l){return this instanceof d3_hsl?void(this.h=+h,this.s=+s,this.l=+l):arguments.length<2?h instanceof d3_hsl?new d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):new d3_hsl(h,s,l)}var d3_hslPrototype=d3_hsl.prototype=new d3_color;d3_hslPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_hsl(this.h,this.s,this.l/k)};d3_hslPrototype.darker=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_hsl(this.h,this.s,k*this.l)};
d3_hslPrototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)};function d3_hsl_rgb(h,s,l){var m1,m2;h=isNaN(h)?0:(h%=360)<0?h+360:h;s=isNaN(s)?0:s<0?0:s>1?1:s;l=l<0?0:l>1?1:l;m2=l<=.5?l*(1+s):l+s-l*s;m1=2*l-m2;function v(h){if(h>360)h-=360;else if(h<0)h+=360;if(h<60)return m1+(m2-m1)*h/60;if(h<180)return m2;if(h<240)return m1+(m2-m1)*(240-h)/60;return m1}function vv(h){return Math.round(v(h)*255)}return new d3_rgb(vv(h+120),vv(h),vv(h-120))}d3.hcl=d3_hcl;function d3_hcl(h,c,l){return this instanceof
d3_hcl?void(this.h=+h,this.c=+c,this.l=+l):arguments.length<2?h instanceof d3_hcl?new d3_hcl(h.h,h.c,h.l):h instanceof d3_lab?d3_lab_hcl(h.l,h.a,h.b):d3_lab_hcl((h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):new d3_hcl(h,c,l)}var d3_hclPrototype=d3_hcl.prototype=new d3_color;d3_hclPrototype.brighter=function(k){return new d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))};d3_hclPrototype.darker=function(k){return new d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?
k:1)))};d3_hclPrototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()};function d3_hcl_lab(h,c,l){if(isNaN(h))h=0;if(isNaN(c))c=0;return new d3_lab(l,Math.cos(h*=d3_radians)*c,Math.sin(h)*c)}d3.lab=d3_lab;function d3_lab(l,a,b){return this instanceof d3_lab?void(this.l=+l,this.a=+a,this.b=+b):arguments.length<2?l instanceof d3_lab?new d3_lab(l.l,l.a,l.b):l instanceof d3_hcl?d3_hcl_lab(l.h,l.c,l.l):d3_rgb_lab((l=d3_rgb(l)).r,l.g,l.b):new d3_lab(l,a,b)}var d3_lab_K=18;var d3_lab_X=.95047,
d3_lab_Y=1,d3_lab_Z=1.08883;var d3_labPrototype=d3_lab.prototype=new d3_color;d3_labPrototype.brighter=function(k){return new d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.darker=function(k){return new d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)};function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;x=d3_lab_xyz(x)*d3_lab_X;y=d3_lab_xyz(y)*d3_lab_Y;
z=d3_lab_xyz(z)*d3_lab_Z;return new d3_rgb(d3_xyz_rgb(3.2404542*x-1.5371385*y-.4985314*z),d3_xyz_rgb(-.969266*x+1.8760108*y+.041556*z),d3_xyz_rgb(.0556434*x-.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return l>0?new d3_hcl(Math.atan2(b,a)*d3_degrees,Math.sqrt(a*a+b*b),l):new d3_hcl(NaN,NaN,l)}function d3_lab_xyz(x){return x>.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(r<=.00304?12.92*
r:1.055*Math.pow(r,1/2.4)-.055))}d3.rgb=d3_rgb;function d3_rgb(r,g,b){return this instanceof d3_rgb?void(this.r=~~r,this.g=~~g,this.b=~~b):arguments.length<2?r instanceof d3_rgb?new d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):new d3_rgb(r,g,b)}function d3_rgbNumber(value){return new d3_rgb(value>>16,value>>8&255,value&255)}function d3_rgbString(value){return d3_rgbNumber(value)+""}var d3_rgbPrototype=d3_rgb.prototype=new d3_color;d3_rgbPrototype.brighter=function(k){k=Math.pow(.7,arguments.length?
k:1);var r=this.r,g=this.g,b=this.b,i=30;if(!r&&!g&&!b)return new d3_rgb(i,i,i);if(r&&r<i)r=i;if(g&&g<i)g=i;if(b&&b<i)b=i;return new d3_rgb(Math.min(255,r/k),Math.min(255,g/k),Math.min(255,b/k))};d3_rgbPrototype.darker=function(k){k=Math.pow(.7,arguments.length?k:1);return new d3_rgb(k*this.r,k*this.g,k*this.b)};d3_rgbPrototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)};d3_rgbPrototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};function d3_rgb_hex(v){return v<
16?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var r=0,g=0,b=0,m1,m2,color;m1=/([a-z]+)\((.*)\)/.exec(format=format.toLowerCase());if(m1){m2=m1[2].split(",");switch(m1[1]){case "hsl":return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100);case "rgb":return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}}if(color=d3_rgb_names.get(format))return rgb(color.r,color.g,color.b);if(format!=null&&format.charAt(0)===
"#"&&!isNaN(color=parseInt(format.slice(1),16)))if(format.length===4){r=(color&3840)>>4;r=r>>4|r;g=color&240;g=g>>4|g;b=color&15;b=b<<4|b}else if(format.length===7){r=(color&16711680)>>16;g=(color&65280)>>8;b=color&255}return rgb(r,g,b)}function d3_rgb_hsl(r,g,b){var min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,h,s,l=(max+min)/2;if(d){s=l<.5?d/(max+min):d/(2-max-min);if(r==max)h=(g-b)/d+(g<b?6:0);else if(g==max)h=(b-r)/d+2;else h=(r-g)/d+4;h*=60}else{h=NaN;s=l>0&&l<1?0:h}return new d3_hsl(h,
s,l)}function d3_rgb_lab(r,g,b){r=d3_rgb_xyz(r);g=d3_rgb_xyz(g);b=d3_rgb_xyz(b);var x=d3_xyz_lab((.4124564*r+.3575761*g+.1804375*b)/d3_lab_X),y=d3_xyz_lab((.2126729*r+.7151522*g+.072175*b)/d3_lab_Y),z=d3_xyz_lab((.0193339*r+.119192*g+.9503041*b)/d3_lab_Z);return d3_lab(116*y-16,500*(x-y),200*(y-z))}function d3_rgb_xyz(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return c.charAt(c.length-1)==="%"?Math.round(f*2.55):f}var d3_rgb_names=
d3.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,
teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});d3_rgb_names.forEach(function(key,value){d3_rgb_names.set(key,d3_rgbNumber(value))});function d3_functor(v){return typeof v==="function"?v:function(){return v}}d3.functor=d3_functor;d3.xhr=d3_xhrType(d3_identity);function d3_xhrType(response){return function(url,mimeType,callback){if(arguments.length===2&&typeof mimeType==="function")callback=
mimeType,mimeType=null;return d3_xhr(url,mimeType,response,callback)}}function d3_xhr(url,mimeType,response,callback){var xhr={},dispatch=d3.dispatch("beforesend","progress","load","error"),headers={},request=new XMLHttpRequest,responseType=null;if(this.XDomainRequest&&!("withCredentials"in request)&&/^(http(s)?:)?\/\//.test(url))request=new XDomainRequest;"onload"in request?request.onload=request.onerror=respond:request.onreadystatechange=function(){request.readyState>3&&respond()};function respond(){var status=
request.status,result;if(!status&&d3_xhrHasResponse(request)||status>=200&&status<300||status===304){try{result=response.call(xhr,request)}catch(e){dispatch.error.call(xhr,e);return}dispatch.load.call(xhr,result)}else dispatch.error.call(xhr,request)}request.onprogress=function(event){var o=d3.event;d3.event=event;try{dispatch.progress.call(xhr,request)}finally{d3.event=o}};xhr.header=function(name,value){name=(name+"").toLowerCase();if(arguments.length<2)return headers[name];if(value==null)delete headers[name];
else headers[name]=value+"";return xhr};xhr.mimeType=function(value){if(!arguments.length)return mimeType;mimeType=value==null?null:value+"";return xhr};xhr.responseType=function(value){if(!arguments.length)return responseType;responseType=value;return xhr};xhr.response=function(value){response=value;return xhr};["get","post"].forEach(function(method){xhr[method]=function(){return xhr.send.apply(xhr,[method].concat(d3_array(arguments)))}});xhr.send=function(method,data,callback){if(arguments.length===
2&&typeof data==="function")callback=data,data=null;request.open(method,url,true);if(mimeType!=null&&!("accept"in headers))headers["accept"]=mimeType+",*/*";if(request.setRequestHeader)for(var name in headers)request.setRequestHeader(name,headers[name]);if(mimeType!=null&&request.overrideMimeType)request.overrideMimeType(mimeType);if(responseType!=null)request.responseType=responseType;if(callback!=null)xhr.on("error",callback).on("load",function(request){callback(null,request)});dispatch.beforesend.call(xhr,
request);request.send(data==null?null:data);return xhr};xhr.abort=function(){request.abort();return xhr};d3.rebind(xhr,dispatch,"on");return callback==null?xhr:xhr.get(d3_xhr_fixCallback(callback))}function d3_xhr_fixCallback(callback){return callback.length===1?function(error,request){callback(error==null?request:null)}:callback}function d3_xhrHasResponse(request){var type=request.responseType;return type&&type!=="text"?request.response:request.responseText}d3.dsv=function(delimiter,mimeType){var reFormat=
new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);function dsv(url,row,callback){if(arguments.length<3)callback=row,row=null;var xhr=d3_xhr(url,mimeType,row==null?response:typedResponse(row),callback);xhr.row=function(_){return arguments.length?xhr.response((row=_)==null?response:typedResponse(_)):row};return xhr}function response(request){return dsv.parse(request.responseText)}function typedResponse(f){return function(request){return dsv.parse(request.responseText,f)}}dsv.parse=
function(text,f){var o;return dsv.parseRows(text,function(row,i){if(o)return o(row,i-1);var a=new Function("d","return {"+row.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}");o=f?function(row,i){return f(a(row),i)}:a})};dsv.parseRows=function(text,f){var EOL={},EOF={},rows=[],N=text.length,I=0,n=0,t,eol;function token(){if(I>=N)return EOF;if(eol)return eol=false,EOL;var j=I;if(text.charCodeAt(j)===34){var i=j;while(i++<N)if(text.charCodeAt(i)===34){if(text.charCodeAt(i+
1)!==34)break;++i}I=i+2;var c=text.charCodeAt(i+1);if(c===13){eol=true;if(text.charCodeAt(i+2)===10)++I}else if(c===10)eol=true;return text.slice(j+1,i).replace(/""/g,'"')}while(I<N){var c=text.charCodeAt(I++),k=1;if(c===10)eol=true;else if(c===13){eol=true;if(text.charCodeAt(I)===10)++I,++k}else if(c!==delimiterCode)continue;return text.slice(j,I-k)}return text.slice(j)}while((t=token())!==EOF){var a=[];while(t!==EOL&&t!==EOF){a.push(t);t=token()}if(f&&(a=f(a,n++))==null)continue;rows.push(a)}return rows};
dsv.format=function(rows){if(Array.isArray(rows[0]))return dsv.formatRows(rows);var fieldSet=new d3_Set,fields=[];rows.forEach(function(row){for(var field in row)if(!fieldSet.has(field))fields.push(fieldSet.add(field))});return[fields.map(formatValue).join(delimiter)].concat(rows.map(function(row){return fields.map(function(field){return formatValue(row[field])}).join(delimiter)})).join("\n")};dsv.formatRows=function(rows){return rows.map(formatRow).join("\n")};function formatRow(row){return row.map(formatValue).join(delimiter)}
function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}return dsv};d3.csv=d3.dsv(",","text/csv");d3.tsv=d3.dsv("\t","text/tab-separated-values");var d3_timer_queueHead,d3_timer_queueTail,d3_timer_interval,d3_timer_timeout,d3_timer_frame=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(callback){setTimeout(callback,17)};d3.timer=function(){d3_timer.apply(this,arguments)};function d3_timer(callback,delay,then){var n=arguments.length;if(n<2)delay=0;if(n<
3)then=Date.now();var time=then+delay,timer={c:callback,t:time,n:null};if(d3_timer_queueTail)d3_timer_queueTail.n=timer;else d3_timer_queueHead=timer;d3_timer_queueTail=timer;if(!d3_timer_interval){d3_timer_timeout=clearTimeout(d3_timer_timeout);d3_timer_interval=1;d3_timer_frame(d3_timer_step)}return timer}function d3_timer_step(){var now=d3_timer_mark(),delay=d3_timer_sweep()-now;if(delay>24){if(isFinite(delay)){clearTimeout(d3_timer_timeout);d3_timer_timeout=setTimeout(d3_timer_step,delay)}d3_timer_interval=
0}else{d3_timer_interval=1;d3_timer_frame(d3_timer_step)}}d3.timer.flush=function(){d3_timer_mark();d3_timer_sweep()};function d3_timer_mark(){var now=Date.now(),timer=d3_timer_queueHead;while(timer){if(now>=timer.t&&timer.c(now-timer.t))timer.c=null;timer=timer.n}return now}function d3_timer_sweep(){var t0,t1=d3_timer_queueHead,time=Infinity;while(t1)if(t1.c){if(t1.t<time)time=t1.t;t1=(t0=t1).n}else t1=t0?t0.n=t1.n:d3_timer_queueHead=t1.n;d3_timer_queueTail=t0;return time}function d3_format_precision(x,
p){return p-(x?Math.ceil(Math.log(x)/Math.LN10):1)}d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};var d3_formatPrefixes=["y","z","a","f","p","n","\u00b5","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);d3.formatPrefix=function(value,precision){var i=0;if(value=+value){if(value<0)value*=-1;if(precision)value=d3.round(value,d3_format_precision(value,precision));i=1+Math.floor(1E-12+Math.log(value)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i-1)/
3)*3))}return d3_formatPrefixes[8+i/3]};function d3_formatPrefix(d,i){var k=Math.pow(10,abs(8-i)*3);return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}}function d3_locale_numberFormat(locale){var locale_decimal=locale.decimal,locale_thousands=locale.thousands,locale_grouping=locale.grouping,locale_currency=locale.currency,formatGroup=locale_grouping&&locale_thousands?function(value,width){var i=value.length,t=[],j=0,g=locale_grouping[0],length=0;while(i>0&&g>0){if(length+g+
1>width)g=Math.max(1,width-length);t.push(value.substring(i-=g,i+g));if((length+=g+1)>width)break;g=locale_grouping[j=(j+1)%locale_grouping.length]}return t.reverse().join(locale_thousands)}:d3_identity;return function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",align=match[2]||">",sign=match[3]||"-",symbol=match[4]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,prefix="",suffix="",integer=false,exponent=true;if(precision)precision=
+precision.substring(1);if(zfill||fill==="0"&&align==="="){zfill=fill="0";align="="}switch(type){case "n":comma=true;type="g";break;case "%":scale=100;suffix="%";type="f";break;case "p":scale=100;suffix="%";type="r";break;case "b":case "o":case "x":case "X":if(symbol==="#")prefix="0"+type.toLowerCase();case "c":exponent=false;case "d":integer=true;precision=0;break;case "s":scale=-1;type="r";break}if(symbol==="$")prefix=locale_currency[0],suffix=locale_currency[1];if(type=="r"&&!precision)type="g";
if(precision!=null)if(type=="g")precision=Math.max(1,Math.min(21,precision));else if(type=="e"||type=="f")precision=Math.max(0,Math.min(20,precision));type=d3_format_types.get(type)||d3_format_typeDefault;var zcomma=zfill&&comma;return function(value){var fullSuffix=suffix;if(integer&&value%1)return"";var negative=value<0||value===0&&1/value<0?(value=-value,"-"):sign==="-"?"":sign;if(scale<0){var unit=d3.formatPrefix(value,precision);value=unit.scale(value);fullSuffix=unit.symbol+suffix}else value*=
scale;value=type(value,precision);var i=value.lastIndexOf("."),before,after;if(i<0){var j=exponent?value.lastIndexOf("e"):-1;if(j<0)before=value,after="";else before=value.substring(0,j),after=value.substring(j)}else{before=value.substring(0,i);after=locale_decimal+value.substring(i+1)}if(!zfill&&comma)before=formatGroup(before,Infinity);var length=prefix.length+before.length+after.length+(zcomma?0:negative.length),padding=length<width?(new Array(length=width-length+1)).join(fill):"";if(zcomma)before=
formatGroup(padding+before,padding.length?width-after.length:Infinity);negative+=prefix;value=before+after;return(align==="<"?negative+value+padding:align===">"?padding+negative+value:align==="^"?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+fullSuffix}}}var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var d3_format_types=d3.map({b:function(x){return x.toString(2)},c:function(x){return String.fromCharCode(x)},
o:function(x){return x.toString(8)},x:function(x){return x.toString(16)},X:function(x){return x.toString(16).toUpperCase()},g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return(x=d3.round(x,d3_format_precision(x,p))).toFixed(Math.max(0,Math.min(20,d3_format_precision(x*(1+1E-15),p))))}});function d3_format_typeDefault(x){return x+""}var d3_time=d3.time={},d3_date=Date;function d3_date_utc(){this._=new Date(arguments.length>
1?Date.UTC.apply(this,arguments):arguments[0])}d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},
getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,
arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);return date-d0<d1-date?d0:d1}function ceil(date){step(date=local(new d3_date(date-1)),1);return date}function offset(date,k){step(date=
new d3_date(+date),k);return date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1)while(time<t1){if(!(number(time)%dt))times.push(new Date(+time));step(time,1)}else while(time<t1)times.push(new Date(+time)),step(time,1);return times}function range_utc(t0,t1,dt){try{d3_date=d3_date_utc;var utc=new d3_date_utc;utc._=t0;return range(utc,t1,dt)}finally{d3_date=Date}}local.floor=local;local.round=round;local.ceil=ceil;local.offset=offset;local.range=range;var utc=local.utc=d3_time_interval_utc(local);
utc.floor=utc;utc.round=d3_time_interval_utc(round);utc.ceil=d3_time_interval_utc(ceil);utc.offset=d3_time_interval_utc(offset);utc.range=range_utc;return local}function d3_time_interval_utc(method){return function(date,k){try{d3_date=d3_date_utc;var utc=new d3_date_utc;utc._=date;return method(utc,k)._}finally{d3_date=Date}}}d3_time.year=d3_time_interval(function(date){date=d3_time.day(date);date.setMonth(0,1);return date},function(date,offset){date.setFullYear(date.getFullYear()+offset)},function(date){return date.getFullYear()});
d3_time.years=d3_time.year.range;d3_time.years.utc=d3_time.year.utc.range;d3_time.day=d3_time_interval(function(date){var day=new d3_date(2E3,0);day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate());return day},function(date,offset){date.setDate(date.getDate()+offset)},function(date){return date.getDate()-1});d3_time.days=d3_time.day.range;d3_time.days.utc=d3_time.day.utc.range;d3_time.dayOfYear=function(date){var year=d3_time.year(date);return Math.floor((date-year-(date.getTimezoneOffset()-
year.getTimezoneOffset())*6E4)/864E5)};["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(day,i){i=7-i;var interval=d3_time[day]=d3_time_interval(function(date){(date=d3_time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7);return date},function(date,offset){date.setDate(date.getDate()+Math.floor(offset)*7)},function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)});d3_time[day+"s"]=interval.range;
d3_time[day+"s"].utc=interval.utc.range;d3_time[day+"OfYear"]=function(date){var day=d3_time.year(date).getDay();return Math.floor((d3_time.dayOfYear(date)+(day+i)%7)/7)}});d3_time.week=d3_time.sunday;d3_time.weeks=d3_time.sunday.range;d3_time.weeks.utc=d3_time.sunday.utc.range;d3_time.weekOfYear=d3_time.sundayOfYear;function d3_locale_timeFormat(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_days=locale.days,locale_shortDays=
locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths;function d3_time_format(template){var n=template.length;function format(date){var string=[],i=-1,j=0,c,p,f;while(++i<n)if(template.charCodeAt(i)===37){string.push(template.slice(j,i));if((p=d3_time_formatPads[c=template.charAt(++i)])!=null)c=template.charAt(++i);if(f=d3_time_formats[c])c=f(date,p==null?c==="e"?" ":"0":p);string.push(c);j=i+1}string.push(template.slice(j,i));return string.join("")}format.parse=function(string){var d=
{y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=d3_time_parse(d,template,string,0);if(i!=string.length)return null;if("p"in d)d.H=d.H%12+d.p*12;var localZ=d.Z!=null&&d3_date!==d3_date_utc,date=new (localZ?d3_date_utc:d3_date);if("j"in d)date.setFullYear(d.y,0,d.j);else if("W"in d||"U"in d){if(!("w"in d))d.w="W"in d?1:0;date.setFullYear(d.y,0,1);date.setFullYear(d.y,0,"W"in d?(d.w+6)%7+d.W*7-(date.getDay()+5)%7:d.w+d.U*7-(date.getDay()+6)%7)}else date.setFullYear(d.y,d.m,d.d);date.setHours(d.H+(d.Z/100|
0),d.M+d.Z%100,d.S,d.L);return localZ?date._:date};format.toString=function(){return template};return format}function d3_time_parse(date,template,string,j){var c,p,t,i=0,n=template.length,m=string.length;while(i<n){if(j>=m)return-1;c=template.charCodeAt(i++);if(c===37){t=template.charAt(i++);p=d3_time_parsers[t in d3_time_formatPads?template.charAt(i++):t];if(!p||(j=p(date,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}d3_time_format.utc=function(template){var local=d3_time_format(template);
function format(date){try{d3_date=d3_date_utc;var utc=new d3_date;utc._=date;return local(utc)}finally{d3_date=Date}}format.parse=function(string){try{d3_date=d3_date_utc;var date=local.parse(string);return date&&date._}finally{d3_date=Date}};format.toString=local.toString;return format};d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var d3_time_periodLookup=d3.map(),d3_time_dayRe=d3_time_formatRe(locale_days),d3_time_dayLookup=d3_time_formatLookup(locale_days),d3_time_dayAbbrevRe=
d3_time_formatRe(locale_shortDays),d3_time_dayAbbrevLookup=d3_time_formatLookup(locale_shortDays),d3_time_monthRe=d3_time_formatRe(locale_months),d3_time_monthLookup=d3_time_formatLookup(locale_months),d3_time_monthAbbrevRe=d3_time_formatRe(locale_shortMonths),d3_time_monthAbbrevLookup=d3_time_formatLookup(locale_shortMonths);locale_periods.forEach(function(p,i){d3_time_periodLookup.set(p.toLowerCase(),i)});var d3_time_formats={a:function(d){return locale_shortDays[d.getDay()]},A:function(d){return locale_days[d.getDay()]},
b:function(d){return locale_shortMonths[d.getMonth()]},B:function(d){return locale_months[d.getMonth()]},c:d3_time_format(locale_dateTime),d:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},e:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},H:function(d,p){return d3_time_formatPad(d.getHours(),p,2)},I:function(d,p){return d3_time_formatPad(d.getHours()%12||12,p,2)},j:function(d,p){return d3_time_formatPad(1+d3_time.dayOfYear(d),p,3)},L:function(d,p){return d3_time_formatPad(d.getMilliseconds(),
p,3)},m:function(d,p){return d3_time_formatPad(d.getMonth()+1,p,2)},M:function(d,p){return d3_time_formatPad(d.getMinutes(),p,2)},p:function(d){return locale_periods[+(d.getHours()>=12)]},S:function(d,p){return d3_time_formatPad(d.getSeconds(),p,2)},U:function(d,p){return d3_time_formatPad(d3_time.sundayOfYear(d),p,2)},w:function(d){return d.getDay()},W:function(d,p){return d3_time_formatPad(d3_time.mondayOfYear(d),p,2)},x:d3_time_format(locale_date),X:d3_time_format(locale_time),y:function(d,p){return d3_time_formatPad(d.getFullYear()%
100,p,2)},Y:function(d,p){return d3_time_formatPad(d.getFullYear()%1E4,p,4)},Z:d3_time_zone,"%":function(){return"%"}};var d3_time_parsers={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,
w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.slice(i));return n?(date.w=d3_time_dayAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=
d3_time_dayRe.exec(string.slice(i));return n?(date.w=d3_time_dayLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.slice(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+n[0].length):-1}function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.slice(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),
i+n[0].length):-1}function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)}function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)}function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)}function d3_time_parseAmPm(date,string,i){var n=d3_time_periodLookup.get(string.slice(i,i+=2).toLowerCase());return n==null?-1:(date.p=n,i)}return d3_time_format}
var d3_time_formatPads={"-":"",_:" ",0:"0"},d3_time_numberRe=/^\s*\d+/,d3_time_percentRe=/^%/;function d3_time_formatPad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?(new Array(width-length+1)).join(fill)+string:string)}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){var map=new d3_Map,i=-1,n=names.length;while(++i<n)map.set(names[i].toLowerCase(),
i);return map}function d3_time_parseWeekdayNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+1));return n?(date.w=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberSunday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.U=+n[0],i+n[0].length):-1}function d3_time_parseWeekNumberMonday(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i));return n?(date.W=+n[0],
i+n[0].length):-1}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+4));return n?(date.y=+n[0],i+n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.y=d3_time_expandYear(+n[0]),i+n[0].length):-1}function d3_time_parseZone(date,string,i){return/^[+-]\d{4}$/.test(string=string.slice(i,i+5))?(date.Z=-string,i+5):-1}function d3_time_expandYear(d){return d+
(d>68?1900:2E3)}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.m=n[0]-1,i+n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.d=+n[0],i+n[0].length):-1}function d3_time_parseDayOfYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.j=+n[0],i+n[0].length):
-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.H=+n[0],i+n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.M=+n[0],i+n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+2));return n?(date.S=+n[0],i+n[0].length):-1}function d3_time_parseMilliseconds(date,
string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.slice(i,i+3));return n?(date.L=+n[0],i+n[0].length):-1}function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=abs(z)/60|0,zm=abs(z)%60;return zs+d3_time_formatPad(zh,"0",2)+d3_time_formatPad(zm,"0",2)}function d3_time_parseLiteralPercent(date,string,i){d3_time_percentRe.lastIndex=0;var n=d3_time_percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function d3_time_formatMulti(formats){var n=formats.length,
i=-1;while(++i<n)formats[i][0]=this(formats[i][0]);return function(date){var i=0,f=formats[i];while(!f[1](date))f=formats[++i];return f[0](date)}}d3.locale=function(locale){return{numberFormat:d3_locale_numberFormat(locale),timeFormat:d3_locale_timeFormat(locale)}};var d3_locale_enUS=d3.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});d3.format=d3_locale_enUS.numberFormat;d3.geo={};function d3_adder(){}d3_adder.prototype={s:0,t:0,add:function(y){d3_adderSum(y,this.t,d3_adderTemp);d3_adderSum(d3_adderTemp.s,this.s,this);if(this.s)this.t+=d3_adderTemp.t;else this.s=d3_adderTemp.t},
reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var d3_adderTemp=new d3_adder;function d3_adderSum(a,b,o){var x=o.s=a+b,bv=x-a,av=x-bv;o.t=a-av+(b-bv)}d3.geo.stream=function(object,listener){if(object&&d3_geo_streamObjectType.hasOwnProperty(object.type))d3_geo_streamObjectType[object.type](object,listener);else d3_geo_streamGeometry(object,listener)};function d3_geo_streamGeometry(geometry,listener){if(geometry&&d3_geo_streamGeometryType.hasOwnProperty(geometry.type))d3_geo_streamGeometryType[geometry.type](geometry,
listener)}var d3_geo_streamObjectType={Feature:function(feature,listener){d3_geo_streamGeometry(feature.geometry,listener)},FeatureCollection:function(object,listener){var features=object.features,i=-1,n=features.length;while(++i<n)d3_geo_streamGeometry(features[i].geometry,listener)}};var d3_geo_streamGeometryType={Sphere:function(object,listener){listener.sphere()},Point:function(object,listener){object=object.coordinates;listener.point(object[0],object[1],object[2])},MultiPoint:function(object,
listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)object=coordinates[i],listener.point(object[0],object[1],object[2])},LineString:function(object,listener){d3_geo_streamLine(object.coordinates,listener,0)},MultiLineString:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)d3_geo_streamLine(coordinates[i],listener,0)},Polygon:function(object,listener){d3_geo_streamPolygon(object.coordinates,listener)},MultiPolygon:function(object,
listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n)d3_geo_streamPolygon(coordinates[i],listener)},GeometryCollection:function(object,listener){var geometries=object.geometries,i=-1,n=geometries.length;while(++i<n)d3_geo_streamGeometry(geometries[i],listener)}};function d3_geo_streamLine(coordinates,listener,closed){var i=-1,n=coordinates.length-closed,coordinate;listener.lineStart();while(++i<n)coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1],coordinate[2]);
listener.lineEnd()}function d3_geo_streamPolygon(coordinates,listener){var i=-1,n=coordinates.length;listener.polygonStart();while(++i<n)d3_geo_streamLine(coordinates[i],listener,1);listener.polygonEnd()}d3.geo.area=function(object){d3_geo_areaSum=0;d3.geo.stream(object,d3_geo_area);return d3_geo_areaSum};var d3_geo_areaSum,d3_geo_areaRingSum=new d3_adder;var d3_geo_area={sphere:function(){d3_geo_areaSum+=4*\u03c0},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_areaRingSum.reset();
d3_geo_area.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var area=2*d3_geo_areaRingSum;d3_geo_areaSum+=area<0?4*\u03c0+area:area;d3_geo_area.lineStart=d3_geo_area.lineEnd=d3_geo_area.point=d3_noop}};function d3_geo_areaRingStart(){var \u03bb00,\u03c600,\u03bb0,cos\u03c60,sin\u03c60;d3_geo_area.point=function(\u03bb,\u03c6){d3_geo_area.point=nextPoint;\u03bb0=(\u03bb00=\u03bb)*d3_radians,cos\u03c60=Math.cos(\u03c6=(\u03c600=\u03c6)*d3_radians/2+\u03c0/4),sin\u03c60=Math.sin(\u03c6)};function nextPoint(\u03bb,
\u03c6){\u03bb*=d3_radians;\u03c6=\u03c6*d3_radians/2+\u03c0/4;var d\u03bb=\u03bb-\u03bb0,sd\u03bb=d\u03bb>=0?1:-1,ad\u03bb=sd\u03bb*d\u03bb,cos\u03c6=Math.cos(\u03c6),sin\u03c6=Math.sin(\u03c6),k=sin\u03c60*sin\u03c6,u=cos\u03c60*cos\u03c6+k*Math.cos(ad\u03bb),v=k*sd\u03bb*Math.sin(ad\u03bb);d3_geo_areaRingSum.add(Math.atan2(v,u));\u03bb0=\u03bb,cos\u03c60=cos\u03c6,sin\u03c60=sin\u03c6}d3_geo_area.lineEnd=function(){nextPoint(\u03bb00,\u03c600)}}function d3_geo_cartesian(spherical){var \u03bb=spherical[0],
\u03c6=spherical[1],cos\u03c6=Math.cos(\u03c6);return[cos\u03c6*Math.cos(\u03bb),cos\u03c6*Math.sin(\u03bb),Math.sin(\u03c6)]}function d3_geo_cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function d3_geo_cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function d3_geo_cartesianAdd(a,b){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2]}function d3_geo_cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function d3_geo_cartesianNormalize(d){var l=Math.sqrt(d[0]*
d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l;d[1]/=l;d[2]/=l}function d3_geo_spherical(cartesian){return[Math.atan2(cartesian[1],cartesian[0]),d3_asin(cartesian[2])]}function d3_geo_sphericalEqual(a,b){return abs(a[0]-b[0])<\u03b5&&abs(a[1]-b[1])<\u03b5}d3.geo.bounds=function(){var \u03bb0,\u03c60,\u03bb1,\u03c61,\u03bb_,\u03bb__,\u03c6__,p0,d\u03bbSum,ranges,range;var bound={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){bound.point=ringPoint;bound.lineStart=ringStart;bound.lineEnd=
ringEnd;d\u03bbSum=0;d3_geo_area.polygonStart()},polygonEnd:function(){d3_geo_area.polygonEnd();bound.point=point;bound.lineStart=lineStart;bound.lineEnd=lineEnd;if(d3_geo_areaRingSum<0)\u03bb0=-(\u03bb1=180),\u03c60=-(\u03c61=90);else if(d\u03bbSum>\u03b5)\u03c61=90;else if(d\u03bbSum<-\u03b5)\u03c60=-90;range[0]=\u03bb0,range[1]=\u03bb1}};function point(\u03bb,\u03c6){ranges.push(range=[\u03bb0=\u03bb,\u03bb1=\u03bb]);if(\u03c6<\u03c60)\u03c60=\u03c6;if(\u03c6>\u03c61)\u03c61=\u03c6}function linePoint(\u03bb,
\u03c6){var p=d3_geo_cartesian([\u03bb*d3_radians,\u03c6*d3_radians]);if(p0){var normal=d3_geo_cartesianCross(p0,p),equatorial=[normal[1],-normal[0],0],inflection=d3_geo_cartesianCross(equatorial,normal);d3_geo_cartesianNormalize(inflection);inflection=d3_geo_spherical(inflection);var d\u03bb=\u03bb-\u03bb_,s=d\u03bb>0?1:-1,\u03bbi=inflection[0]*d3_degrees*s,antimeridian=abs(d\u03bb)>180;if(antimeridian^(s*\u03bb_<\u03bbi&&\u03bbi<s*\u03bb)){var \u03c6i=inflection[1]*d3_degrees;if(\u03c6i>\u03c61)\u03c61=
\u03c6i}else if(\u03bbi=(\u03bbi+360)%360-180,antimeridian^(s*\u03bb_<\u03bbi&&\u03bbi<s*\u03bb)){var \u03c6i=-inflection[1]*d3_degrees;if(\u03c6i<\u03c60)\u03c60=\u03c6i}else{if(\u03c6<\u03c60)\u03c60=\u03c6;if(\u03c6>\u03c61)\u03c61=\u03c6}if(antimeridian)if(\u03bb<\u03bb_){if(angle(\u03bb0,\u03bb)>angle(\u03bb0,\u03bb1))\u03bb1=\u03bb}else{if(angle(\u03bb,\u03bb1)>angle(\u03bb0,\u03bb1))\u03bb0=\u03bb}else if(\u03bb1>=\u03bb0){if(\u03bb<\u03bb0)\u03bb0=\u03bb;if(\u03bb>\u03bb1)\u03bb1=\u03bb}else if(\u03bb>
\u03bb_){if(angle(\u03bb0,\u03bb)>angle(\u03bb0,\u03bb1))\u03bb1=\u03bb}else if(angle(\u03bb,\u03bb1)>angle(\u03bb0,\u03bb1))\u03bb0=\u03bb}else point(\u03bb,\u03c6);p0=p,\u03bb_=\u03bb}function lineStart(){bound.point=linePoint}function lineEnd(){range[0]=\u03bb0,range[1]=\u03bb1;bound.point=point;p0=null}function ringPoint(\u03bb,\u03c6){if(p0){var d\u03bb=\u03bb-\u03bb_;d\u03bbSum+=abs(d\u03bb)>180?d\u03bb+(d\u03bb>0?360:-360):d\u03bb}else \u03bb__=\u03bb,\u03c6__=\u03c6;d3_geo_area.point(\u03bb,
\u03c6);linePoint(\u03bb,\u03c6)}function ringStart(){d3_geo_area.lineStart()}function ringEnd(){ringPoint(\u03bb__,\u03c6__);d3_geo_area.lineEnd();if(abs(d\u03bbSum)>\u03b5)\u03bb0=-(\u03bb1=180);range[0]=\u03bb0,range[1]=\u03bb1;p0=null}function angle(\u03bb0,\u03bb1){return(\u03bb1-=\u03bb0)<0?\u03bb1+360:\u03bb1}function compareRanges(a,b){return a[0]-b[0]}function withinRange(x,range){return range[0]<=range[1]?range[0]<=x&&x<=range[1]:x<range[0]||range[1]<x}return function(feature){\u03c61=\u03bb1=
-(\u03bb0=\u03c60=Infinity);ranges=[];d3.geo.stream(feature,bound);var n=ranges.length;if(n){ranges.sort(compareRanges);for(var i=1,a=ranges[0],b,merged=[a];i<n;++i){b=ranges[i];if(withinRange(b[0],a)||withinRange(b[1],a)){if(angle(a[0],b[1])>angle(a[0],a[1]))a[1]=b[1];if(angle(b[0],a[1])>angle(a[0],a[1]))a[0]=b[0]}else merged.push(a=b)}var best=-Infinity,d\u03bb;for(var n=merged.length-1,i=0,a=merged[n],b;i<=n;a=b,++i){b=merged[i];if((d\u03bb=angle(a[1],b[0]))>best)best=d\u03bb,\u03bb0=b[0],\u03bb1=
a[1]}}ranges=range=null;return \u03bb0===Infinity||\u03c60===Infinity?[[NaN,NaN],[NaN,NaN]]:[[\u03bb0,\u03c60],[\u03bb1,\u03c61]]}}();d3.geo.centroid=function(object){d3_geo_centroidW0=d3_geo_centroidW1=d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0;d3.geo.stream(object,d3_geo_centroid);var x=d3_geo_centroidX2,y=d3_geo_centroidY2,z=d3_geo_centroidZ2,m=x*x+y*y+z*z;if(m<\u03b52){x=d3_geo_centroidX1,
y=d3_geo_centroidY1,z=d3_geo_centroidZ1;if(d3_geo_centroidW1<\u03b5)x=d3_geo_centroidX0,y=d3_geo_centroidY0,z=d3_geo_centroidZ0;m=x*x+y*y+z*z;if(m<\u03b52)return[NaN,NaN]}return[Math.atan2(y,x)*d3_degrees,d3_asin(z/Math.sqrt(m))*d3_degrees]};var d3_geo_centroidW0,d3_geo_centroidW1,d3_geo_centroidX0,d3_geo_centroidY0,d3_geo_centroidZ0,d3_geo_centroidX1,d3_geo_centroidY1,d3_geo_centroidZ1,d3_geo_centroidX2,d3_geo_centroidY2,d3_geo_centroidZ2;var d3_geo_centroid={sphere:d3_noop,point:d3_geo_centroidPoint,
lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){d3_geo_centroid.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){d3_geo_centroid.lineStart=d3_geo_centroidLineStart}};function d3_geo_centroidPoint(\u03bb,\u03c6){\u03bb*=d3_radians;var cos\u03c6=Math.cos(\u03c6*=d3_radians);d3_geo_centroidPointXYZ(cos\u03c6*Math.cos(\u03bb),cos\u03c6*Math.sin(\u03bb),Math.sin(\u03c6))}function d3_geo_centroidPointXYZ(x,y,z){++d3_geo_centroidW0;d3_geo_centroidX0+=(x-
d3_geo_centroidX0)/d3_geo_centroidW0;d3_geo_centroidY0+=(y-d3_geo_centroidY0)/d3_geo_centroidW0;d3_geo_centroidZ0+=(z-d3_geo_centroidZ0)/d3_geo_centroidW0}function d3_geo_centroidLineStart(){var x0,y0,z0;d3_geo_centroid.point=function(\u03bb,\u03c6){\u03bb*=d3_radians;var cos\u03c6=Math.cos(\u03c6*=d3_radians);x0=cos\u03c6*Math.cos(\u03bb);y0=cos\u03c6*Math.sin(\u03bb);z0=Math.sin(\u03c6);d3_geo_centroid.point=nextPoint;d3_geo_centroidPointXYZ(x0,y0,z0)};function nextPoint(\u03bb,\u03c6){\u03bb*=
d3_radians;var cos\u03c6=Math.cos(\u03c6*=d3_radians),x=cos\u03c6*Math.cos(\u03bb),y=cos\u03c6*Math.sin(\u03bb),z=Math.sin(\u03c6),w=Math.atan2(Math.sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);d3_geo_centroidW1+=w;d3_geo_centroidX1+=w*(x0+(x0=x));d3_geo_centroidY1+=w*(y0+(y0=y));d3_geo_centroidZ1+=w*(z0+(z0=z));d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_centroidLineEnd(){d3_geo_centroid.point=d3_geo_centroidPoint}function d3_geo_centroidRingStart(){var \u03bb00,\u03c600,
x0,y0,z0;d3_geo_centroid.point=function(\u03bb,\u03c6){\u03bb00=\u03bb,\u03c600=\u03c6;d3_geo_centroid.point=nextPoint;\u03bb*=d3_radians;var cos\u03c6=Math.cos(\u03c6*=d3_radians);x0=cos\u03c6*Math.cos(\u03bb);y0=cos\u03c6*Math.sin(\u03bb);z0=Math.sin(\u03c6);d3_geo_centroidPointXYZ(x0,y0,z0)};d3_geo_centroid.lineEnd=function(){nextPoint(\u03bb00,\u03c600);d3_geo_centroid.lineEnd=d3_geo_centroidLineEnd;d3_geo_centroid.point=d3_geo_centroidPoint};function nextPoint(\u03bb,\u03c6){\u03bb*=d3_radians;
var cos\u03c6=Math.cos(\u03c6*=d3_radians),x=cos\u03c6*Math.cos(\u03bb),y=cos\u03c6*Math.sin(\u03bb),z=Math.sin(\u03c6),cx=y0*z-z0*y,cy=z0*x-x0*z,cz=x0*y-y0*x,m=Math.sqrt(cx*cx+cy*cy+cz*cz),u=x0*x+y0*y+z0*z,v=m&&-d3_acos(u)/m,w=Math.atan2(m,u);d3_geo_centroidX2+=v*cx;d3_geo_centroidY2+=v*cy;d3_geo_centroidZ2+=v*cz;d3_geo_centroidW1+=w;d3_geo_centroidX1+=w*(x0+(x0=x));d3_geo_centroidY1+=w*(y0+(y0=y));d3_geo_centroidZ1+=w*(z0+(z0=z));d3_geo_centroidPointXYZ(x0,y0,z0)}}function d3_geo_compose(a,b){function compose(x,
y){return x=a(x,y),b(x[0],x[1])}if(a.invert&&b.invert)compose.invert=function(x,y){return x=b.invert(x,y),x&&a.invert(x[0],x[1])};return compose}function d3_true(){return true}function d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener){var subject=[],clip=[];segments.forEach(function(segment){if((n=segment.length-1)<=0)return;var n,p0=segment[0],p1=segment[n];if(d3_geo_sphericalEqual(p0,p1)){listener.lineStart();for(var i=0;i<n;++i)listener.point((p0=segment[i])[0],p0[1]);listener.lineEnd();
return}var a=new d3_geo_clipPolygonIntersection(p0,segment,null,true),b=new d3_geo_clipPolygonIntersection(p0,null,a,false);a.o=b;subject.push(a);clip.push(b);a=new d3_geo_clipPolygonIntersection(p1,segment,null,false);b=new d3_geo_clipPolygonIntersection(p1,null,a,true);a.o=b;subject.push(a);clip.push(b)});clip.sort(compare);d3_geo_clipPolygonLinkCircular(subject);d3_geo_clipPolygonLinkCircular(clip);if(!subject.length)return;for(var i=0,entry=clipStartInside,n=clip.length;i<n;++i)clip[i].e=entry=
!entry;var start=subject[0],points,point;while(1){var current=start,isSubject=true;while(current.v)if((current=current.n)===start)return;points=current.z;listener.lineStart();do{current.v=current.o.v=true;if(current.e){if(isSubject)for(var i=0,n=points.length;i<n;++i)listener.point((point=points[i])[0],point[1]);else interpolate(current.x,current.n.x,1,listener);current=current.n}else{if(isSubject){points=current.p.z;for(var i=points.length-1;i>=0;--i)listener.point((point=points[i])[0],point[1])}else interpolate(current.x,
current.p.x,-1,listener);current=current.p}current=current.o;points=current.z;isSubject=!isSubject}while(!current.v);listener.lineEnd()}}function d3_geo_clipPolygonLinkCircular(array){if(!(n=array.length))return;var n,i=0,a=array[0],b;while(++i<n){a.n=b=array[i];b.p=a;a=b}a.n=b=array[0];b.p=a}function d3_geo_clipPolygonIntersection(point,points,other,entry){this.x=point;this.z=points;this.o=other;this.e=entry;this.v=false;this.n=this.p=null}function d3_geo_clip(pointVisible,clipLine,interpolate,clipStart){return function(rotate,
listener){var line=clipLine(listener),rotatedClipStart=rotate.invert(clipStart[0],clipStart[1]);var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing;clip.lineStart=ringStart;clip.lineEnd=ringEnd;segments=[];polygon=[]},polygonEnd:function(){clip.point=point;clip.lineStart=lineStart;clip.lineEnd=lineEnd;segments=d3.merge(segments);var clipStartInside=d3_geo_pointInPolygon(rotatedClipStart,polygon);if(segments.length){if(!polygonStarted)listener.polygonStart(),
polygonStarted=true;d3_geo_clipPolygon(segments,d3_geo_clipSort,clipStartInside,interpolate,listener)}else if(clipStartInside){if(!polygonStarted)listener.polygonStart(),polygonStarted=true;listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd()}if(polygonStarted)listener.polygonEnd(),polygonStarted=false;segments=polygon=null},sphere:function(){listener.polygonStart();listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd();listener.polygonEnd()}};function point(\u03bb,
\u03c6){var point=rotate(\u03bb,\u03c6);if(pointVisible(\u03bb=point[0],\u03c6=point[1]))listener.point(\u03bb,\u03c6)}function pointLine(\u03bb,\u03c6){var point=rotate(\u03bb,\u03c6);line.point(point[0],point[1])}function lineStart(){clip.point=pointLine;line.lineStart()}function lineEnd(){clip.point=point;line.lineEnd()}var segments;var buffer=d3_geo_clipBufferListener(),ringListener=clipLine(buffer),polygonStarted=false,polygon,ring;function pointRing(\u03bb,\u03c6){ring.push([\u03bb,\u03c6]);
var point=rotate(\u03bb,\u03c6);ringListener.point(point[0],point[1])}function ringStart(){ringListener.lineStart();ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]);ringListener.lineEnd();var clean=ringListener.clean(),ringSegments=buffer.buffer(),segment,n=ringSegments.length;ring.pop();polygon.push(ring);ring=null;if(!n)return;if(clean&1){segment=ringSegments[0];var n=segment.length-1,i=-1,point;if(n>0){if(!polygonStarted)listener.polygonStart(),polygonStarted=true;listener.lineStart();
while(++i<n)listener.point((point=segment[i])[0],point[1]);listener.lineEnd()}return}if(n>1&&clean&2)ringSegments.push(ringSegments.pop().concat(ringSegments.shift()));segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))}return clip}}function d3_geo_clipSegmentLength1(segment){return segment.length>1}function d3_geo_clipBufferListener(){var lines=[],line;return{lineStart:function(){lines.push(line=[])},point:function(\u03bb,\u03c6){line.push([\u03bb,\u03c6])},lineEnd:d3_noop,buffer:function(){var buffer=
lines;lines=[];line=null;return buffer},rejoin:function(){if(lines.length>1)lines.push(lines.pop().concat(lines.shift()))}}}function d3_geo_clipSort(a,b){return((a=a.x)[0]<0?a[1]-half\u03c0-\u03b5:half\u03c0-a[1])-((b=b.x)[0]<0?b[1]-half\u03c0-\u03b5:half\u03c0-b[1])}var d3_geo_clipAntimeridian=d3_geo_clip(d3_true,d3_geo_clipAntimeridianLine,d3_geo_clipAntimeridianInterpolate,[-\u03c0,-\u03c0/2]);function d3_geo_clipAntimeridianLine(listener){var \u03bb0=NaN,\u03c60=NaN,s\u03bb0=NaN,clean;return{lineStart:function(){listener.lineStart();
clean=1},point:function(\u03bb1,\u03c61){var s\u03bb1=\u03bb1>0?\u03c0:-\u03c0,d\u03bb=abs(\u03bb1-\u03bb0);if(abs(d\u03bb-\u03c0)<\u03b5){listener.point(\u03bb0,\u03c60=(\u03c60+\u03c61)/2>0?half\u03c0:-half\u03c0);listener.point(s\u03bb0,\u03c60);listener.lineEnd();listener.lineStart();listener.point(s\u03bb1,\u03c60);listener.point(\u03bb1,\u03c60);clean=0}else if(s\u03bb0!==s\u03bb1&&d\u03bb>=\u03c0){if(abs(\u03bb0-s\u03bb0)<\u03b5)\u03bb0-=s\u03bb0*\u03b5;if(abs(\u03bb1-s\u03bb1)<\u03b5)\u03bb1-=
s\u03bb1*\u03b5;\u03c60=d3_geo_clipAntimeridianIntersect(\u03bb0,\u03c60,\u03bb1,\u03c61);listener.point(s\u03bb0,\u03c60);listener.lineEnd();listener.lineStart();listener.point(s\u03bb1,\u03c60);clean=0}listener.point(\u03bb0=\u03bb1,\u03c60=\u03c61);s\u03bb0=s\u03bb1},lineEnd:function(){listener.lineEnd();\u03bb0=\u03c60=NaN},clean:function(){return 2-clean}}}function d3_geo_clipAntimeridianIntersect(\u03bb0,\u03c60,\u03bb1,\u03c61){var cos\u03c60,cos\u03c61,sin\u03bb0_\u03bb1=Math.sin(\u03bb0-
\u03bb1);return abs(sin\u03bb0_\u03bb1)>\u03b5?Math.atan((Math.sin(\u03c60)*(cos\u03c61=Math.cos(\u03c61))*Math.sin(\u03bb1)-Math.sin(\u03c61)*(cos\u03c60=Math.cos(\u03c60))*Math.sin(\u03bb0))/(cos\u03c60*cos\u03c61*sin\u03bb0_\u03bb1)):(\u03c60+\u03c61)/2}function d3_geo_clipAntimeridianInterpolate(from,to,direction,listener){var \u03c6;if(from==null){\u03c6=direction*half\u03c0;listener.point(-\u03c0,\u03c6);listener.point(0,\u03c6);listener.point(\u03c0,\u03c6);listener.point(\u03c0,0);listener.point(\u03c0,
-\u03c6);listener.point(0,-\u03c6);listener.point(-\u03c0,-\u03c6);listener.point(-\u03c0,0);listener.point(-\u03c0,\u03c6)}else if(abs(from[0]-to[0])>\u03b5){var s=from[0]<to[0]?\u03c0:-\u03c0;\u03c6=direction*s/2;listener.point(-s,\u03c6);listener.point(0,\u03c6);listener.point(s,\u03c6)}else listener.point(to[0],to[1])}function d3_geo_pointInPolygon(point,polygon){var meridian=point[0],parallel=point[1],meridianNormal=[Math.sin(meridian),-Math.cos(meridian),0],polarAngle=0,winding=0;d3_geo_areaRingSum.reset();
for(var i=0,n=polygon.length;i<n;++i){var ring=polygon[i],m=ring.length;if(!m)continue;var point0=ring[0],\u03bb0=point0[0],\u03c60=point0[1]/2+\u03c0/4,sin\u03c60=Math.sin(\u03c60),cos\u03c60=Math.cos(\u03c60),j=1;while(true){if(j===m)j=0;point=ring[j];var \u03bb=point[0],\u03c6=point[1]/2+\u03c0/4,sin\u03c6=Math.sin(\u03c6),cos\u03c6=Math.cos(\u03c6),d\u03bb=\u03bb-\u03bb0,sd\u03bb=d\u03bb>=0?1:-1,ad\u03bb=sd\u03bb*d\u03bb,antimeridian=ad\u03bb>\u03c0,k=sin\u03c60*sin\u03c6;d3_geo_areaRingSum.add(Math.atan2(k*
sd\u03bb*Math.sin(ad\u03bb),cos\u03c60*cos\u03c6+k*Math.cos(ad\u03bb)));polarAngle+=antimeridian?d\u03bb+sd\u03bb*\u03c4:d\u03bb;if(antimeridian^\u03bb0>=meridian^\u03bb>=meridian){var arc=d3_geo_cartesianCross(d3_geo_cartesian(point0),d3_geo_cartesian(point));d3_geo_cartesianNormalize(arc);var intersection=d3_geo_cartesianCross(meridianNormal,arc);d3_geo_cartesianNormalize(intersection);var \u03c6arc=(antimeridian^d\u03bb>=0?-1:1)*d3_asin(intersection[2]);if(parallel>\u03c6arc||parallel===\u03c6arc&&
(arc[0]||arc[1]))winding+=antimeridian^d\u03bb>=0?1:-1}if(!j++)break;\u03bb0=\u03bb,sin\u03c60=sin\u03c6,cos\u03c60=cos\u03c6,point0=point}}return(polarAngle<-\u03b5||polarAngle<\u03b5&&d3_geo_areaRingSum<0)^winding&1}function d3_geo_clipCircle(radius){var cr=Math.cos(radius),smallRadius=cr>0,notHemisphere=abs(cr)>\u03b5,interpolate=d3_geo_circleInterpolate(radius,6*d3_radians);return d3_geo_clip(visible,clipLine,interpolate,smallRadius?[0,-radius]:[-\u03c0,radius-\u03c0]);function visible(\u03bb,
\u03c6){return Math.cos(\u03bb)*Math.cos(\u03c6)>cr}function clipLine(listener){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=false;clean=1},point:function(\u03bb,\u03c6){var point1=[\u03bb,\u03c6],point2,v=visible(\u03bb,\u03c6),c=smallRadius?v?0:code(\u03bb,\u03c6):v?code(\u03bb+(\u03bb<0?\u03c0:-\u03c0),\u03c6):0;if(!point0&&(v00=v0=v))listener.lineStart();if(v!==v0){point2=intersect(point0,point1);if(d3_geo_sphericalEqual(point0,point2)||d3_geo_sphericalEqual(point1,point2)){point1[0]+=
\u03b5;point1[1]+=\u03b5;v=visible(point1[0],point1[1])}}if(v!==v0){clean=0;if(v){listener.lineStart();point2=intersect(point1,point0);listener.point(point2[0],point2[1])}else{point2=intersect(point0,point1);listener.point(point2[0],point2[1]);listener.lineEnd()}point0=point2}else if(notHemisphere&&point0&&smallRadius^v){var t;if(!(c&c0)&&(t=intersect(point1,point0,true))){clean=0;if(smallRadius){listener.lineStart();listener.point(t[0][0],t[0][1]);listener.point(t[1][0],t[1][1]);listener.lineEnd()}else{listener.point(t[1][0],
t[1][1]);listener.lineEnd();listener.lineStart();listener.point(t[0][0],t[0][1])}}}if(v&&(!point0||!d3_geo_sphericalEqual(point0,point1)))listener.point(point1[0],point1[1]);point0=point1,v0=v,c0=c},lineEnd:function(){if(v0)listener.lineEnd();point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=d3_geo_cartesian(a),pb=d3_geo_cartesian(b);var n1=[1,0,0],n2=d3_geo_cartesianCross(pa,pb),n2n2=d3_geo_cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant)return!two&&
a;var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=d3_geo_cartesianCross(n1,n2),A=d3_geo_cartesianScale(n1,c1),B=d3_geo_cartesianScale(n2,c2);d3_geo_cartesianAdd(A,B);var u=n1xn2,w=d3_geo_cartesianDot(A,u),uu=d3_geo_cartesianDot(u,u),t2=w*w-uu*(d3_geo_cartesianDot(A,A)-1);if(t2<0)return;var t=Math.sqrt(t2),q=d3_geo_cartesianScale(u,(-w-t)/uu);d3_geo_cartesianAdd(q,A);q=d3_geo_spherical(q);if(!two)return q;var \u03bb0=a[0],\u03bb1=b[0],\u03c60=a[1],\u03c61=b[1],z;if(\u03bb1<\u03bb0)z=\u03bb0,
\u03bb0=\u03bb1,\u03bb1=z;var \u03b4\u03bb=\u03bb1-\u03bb0,polar=abs(\u03b4\u03bb-\u03c0)<\u03b5,meridian=polar||\u03b4\u03bb<\u03b5;if(!polar&&\u03c61<\u03c60)z=\u03c60,\u03c60=\u03c61,\u03c61=z;if(meridian?polar?\u03c60+\u03c61>0^q[1]<(abs(q[0]-\u03bb0)<\u03b5?\u03c60:\u03c61):\u03c60<=q[1]&&q[1]<=\u03c61:\u03b4\u03bb>\u03c0^(\u03bb0<=q[0]&&q[0]<=\u03bb1)){var q1=d3_geo_cartesianScale(u,(-w+t)/uu);d3_geo_cartesianAdd(q1,A);return[q,d3_geo_spherical(q1)]}}function code(\u03bb,\u03c6){var r=smallRadius?
radius:\u03c0-radius,code=0;if(\u03bb<-r)code|=1;else if(\u03bb>r)code|=2;if(\u03c6<-r)code|=4;else if(\u03c6>r)code|=8;return code}}function d3_geom_clipLine(x0,y0,x1,y1){return function(line){var a=line.a,b=line.b,ax=a.x,ay=a.y,bx=b.x,by=b.y,t0=0,t1=1,dx=bx-ax,dy=by-ay,r;r=x0-ax;if(!dx&&r>0)return;r/=dx;if(dx<0){if(r<t0)return;if(r<t1)t1=r}else if(dx>0){if(r>t1)return;if(r>t0)t0=r}r=x1-ax;if(!dx&&r<0)return;r/=dx;if(dx<0){if(r>t1)return;if(r>t0)t0=r}else if(dx>0){if(r<t0)return;if(r<t1)t1=r}r=y0-
ay;if(!dy&&r>0)return;r/=dy;if(dy<0){if(r<t0)return;if(r<t1)t1=r}else if(dy>0){if(r>t1)return;if(r>t0)t0=r}r=y1-ay;if(!dy&&r<0)return;r/=dy;if(dy<0){if(r>t1)return;if(r>t0)t0=r}else if(dy>0){if(r<t0)return;if(r<t1)t1=r}if(t0>0)line.a={x:ax+t0*dx,y:ay+t0*dy};if(t1<1)line.b={x:ax+t1*dx,y:ay+t1*dy};return line}}var d3_geo_clipExtentMAX=1E9;d3.geo.clipExtent=function(){var x0,y0,x1,y1,stream,clip,clipExtent={stream:function(output){if(stream)stream.valid=false;stream=clip(output);stream.valid=true;return stream},
extent:function(_){if(!arguments.length)return[[x0,y0],[x1,y1]];clip=d3_geo_clipExtent(x0=+_[0][0],y0=+_[0][1],x1=+_[1][0],y1=+_[1][1]);if(stream)stream.valid=false,stream=null;return clipExtent}};return clipExtent.extent([[0,0],[960,500]])};function d3_geo_clipExtent(x0,y0,x1,y1){return function(listener){var listener_=listener,bufferListener=d3_geo_clipBufferListener(),clipLine=d3_geom_clipLine(x0,y0,x1,y1),segments,polygon,ring;var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){listener=
bufferListener;segments=[];polygon=[];clean=true},polygonEnd:function(){listener=listener_;segments=d3.merge(segments);var clipStartInside=insidePolygon([x0,y1]),inside=clean&&clipStartInside,visible=segments.length;if(inside||visible){listener.polygonStart();if(inside){listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd()}if(visible)d3_geo_clipPolygon(segments,compare,clipStartInside,interpolate,listener);listener.polygonEnd()}segments=polygon=ring=null}};function insidePolygon(p){var wn=
0,n=polygon.length,y=p[1];for(var i=0;i<n;++i)for(var j=1,v=polygon[i],m=v.length,a=v[0],b;j<m;++j){b=v[j];if(a[1]<=y){if(b[1]>y&&d3_cross2d(a,b,p)>0)++wn}else if(b[1]<=y&&d3_cross2d(a,b,p)<0)--wn;a=b}return wn!==0}function interpolate(from,to,direction,listener){var a=0,a1=0;if(from==null||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoints(from,to)<0^direction>0){do listener.point(a===0||a===3?x0:x1,a>1?y1:y0);while((a=(a+direction+4)%4)!==a1)}else listener.point(to[0],to[1])}
function pointVisible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function point(x,y){if(pointVisible(x,y))listener.point(x,y)}var x__,y__,v__,x_,y_,v_,first,clean;function lineStart(){clip.point=linePoint;if(polygon)polygon.push(ring=[]);first=true;v_=false;x_=y_=NaN}function lineEnd(){if(segments){linePoint(x__,y__);if(v__&&v_)bufferListener.rejoin();segments.push(bufferListener.buffer())}clip.point=point;if(v_)listener.lineEnd()}function linePoint(x,y){x=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,
x));y=Math.max(-d3_geo_clipExtentMAX,Math.min(d3_geo_clipExtentMAX,y));var v=pointVisible(x,y);if(polygon)ring.push([x,y]);if(first){x__=x,y__=y,v__=v;first=false;if(v){listener.lineStart();listener.point(x,y)}}else if(v&&v_)listener.point(x,y);else{var l={a:{x:x_,y:y_},b:{x:x,y:y}};if(clipLine(l)){if(!v_){listener.lineStart();listener.point(l.a.x,l.a.y)}listener.point(l.b.x,l.b.y);if(!v)listener.lineEnd();clean=false}else if(v){listener.lineStart();listener.point(x,y);clean=false}}x_=x,y_=y,v_=v}
return clip};function corner(p,direction){return abs(p[0]-x0)<\u03b5?direction>0?0:3:abs(p[0]-x1)<\u03b5?direction>0?2:1:abs(p[1]-y0)<\u03b5?direction>0?1:0:direction>0?3:2}function compare(a,b){return comparePoints(a.x,b.x)}function comparePoints(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:ca===0?b[1]-a[1]:ca===1?a[0]-b[0]:ca===2?a[1]-b[1]:b[0]-a[0]}}function d3_geo_conic(projectAt){var \u03c60=0,\u03c61=\u03c0/3,m=d3_geo_projectionMutator(projectAt),p=m(\u03c60,\u03c61);p.parallels=
function(_){if(!arguments.length)return[\u03c60/\u03c0*180,\u03c61/\u03c0*180];return m(\u03c60=_[0]*\u03c0/180,\u03c61=_[1]*\u03c0/180)};return p}function d3_geo_conicEqualArea(\u03c60,\u03c61){var sin\u03c60=Math.sin(\u03c60),n=(sin\u03c60+Math.sin(\u03c61))/2,C=1+sin\u03c60*(2*n-sin\u03c60),\u03c10=Math.sqrt(C)/n;function forward(\u03bb,\u03c6){var \u03c1=Math.sqrt(C-2*n*Math.sin(\u03c6))/n;return[\u03c1*Math.sin(\u03bb*=n),\u03c10-\u03c1*Math.cos(\u03bb)]}forward.invert=function(x,y){var \u03c10_y=
\u03c10-y;return[Math.atan2(x,\u03c10_y)/n,d3_asin((C-(x*x+\u03c10_y*\u03c10_y)*n*n)/(2*n))]};return forward}(d3.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea;d3.geo.albers=function(){return d3.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)};d3.geo.albersUsa=function(){var lower48=d3.geo.albers();var alaska=d3.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);var hawaii=d3.geo.conicEqualArea().rotate([157,
0]).center([-3,19.9]).parallels([8,18]);var point,pointStream={point:function(x,y){point=[x,y]}},lower48Point,alaskaPoint,hawaiiPoint;function albersUsa(coordinates){var x=coordinates[0],y=coordinates[1];point=null;(lower48Point(x,y),point)||(alaskaPoint(x,y),point)||hawaiiPoint(x,y);return point}albersUsa.invert=function(coordinates){var k=lower48.scale(),t=lower48.translate(),x=(coordinates[0]-t[0])/k,y=(coordinates[1]-t[1])/k;return(y>=.12&&y<.234&&x>=-.425&&x<-.214?alaska:y>=.166&&y<.234&&x>=
-.214&&x<-.115?hawaii:lower48).invert(coordinates)};albersUsa.stream=function(stream){var lower48Stream=lower48.stream(stream),alaskaStream=alaska.stream(stream),hawaiiStream=hawaii.stream(stream);return{point:function(x,y){lower48Stream.point(x,y);alaskaStream.point(x,y);hawaiiStream.point(x,y)},sphere:function(){lower48Stream.sphere();alaskaStream.sphere();hawaiiStream.sphere()},lineStart:function(){lower48Stream.lineStart();alaskaStream.lineStart();hawaiiStream.lineStart()},lineEnd:function(){lower48Stream.lineEnd();
alaskaStream.lineEnd();hawaiiStream.lineEnd()},polygonStart:function(){lower48Stream.polygonStart();alaskaStream.polygonStart();hawaiiStream.polygonStart()},polygonEnd:function(){lower48Stream.polygonEnd();alaskaStream.polygonEnd();hawaiiStream.polygonEnd()}}};albersUsa.precision=function(_){if(!arguments.length)return lower48.precision();lower48.precision(_);alaska.precision(_);hawaii.precision(_);return albersUsa};albersUsa.scale=function(_){if(!arguments.length)return lower48.scale();lower48.scale(_);
alaska.scale(_*.35);hawaii.scale(_);return albersUsa.translate(lower48.translate())};albersUsa.translate=function(_){if(!arguments.length)return lower48.translate();var k=lower48.scale(),x=+_[0],y=+_[1];lower48Point=lower48.translate(_).clipExtent([[x-.455*k,y-.238*k],[x+.455*k,y+.238*k]]).stream(pointStream).point;alaskaPoint=alaska.translate([x-.307*k,y+.201*k]).clipExtent([[x-.425*k+\u03b5,y+.12*k+\u03b5],[x-.214*k-\u03b5,y+.234*k-\u03b5]]).stream(pointStream).point;hawaiiPoint=hawaii.translate([x-
.205*k,y+.212*k]).clipExtent([[x-.214*k+\u03b5,y+.166*k+\u03b5],[x-.115*k-\u03b5,y+.234*k-\u03b5]]).stream(pointStream).point;return albersUsa};return albersUsa.scale(1070)};var d3_geo_pathAreaSum,d3_geo_pathAreaPolygon,d3_geo_pathArea={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_pathAreaPolygon=0;d3_geo_pathArea.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){d3_geo_pathArea.lineStart=d3_geo_pathArea.lineEnd=d3_geo_pathArea.point=d3_noop;d3_geo_pathAreaSum+=
abs(d3_geo_pathAreaPolygon/2)}};function d3_geo_pathAreaRingStart(){var x00,y00,x0,y0;d3_geo_pathArea.point=function(x,y){d3_geo_pathArea.point=nextPoint;x00=x0=x,y00=y0=y};function nextPoint(x,y){d3_geo_pathAreaPolygon+=y0*x-x0*y;x0=x,y0=y}d3_geo_pathArea.lineEnd=function(){nextPoint(x00,y00)}}var d3_geo_pathBoundsX0,d3_geo_pathBoundsY0,d3_geo_pathBoundsX1,d3_geo_pathBoundsY1;var d3_geo_pathBounds={point:d3_geo_pathBoundsPoint,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};
function d3_geo_pathBoundsPoint(x,y){if(x<d3_geo_pathBoundsX0)d3_geo_pathBoundsX0=x;if(x>d3_geo_pathBoundsX1)d3_geo_pathBoundsX1=x;if(y<d3_geo_pathBoundsY0)d3_geo_pathBoundsY0=y;if(y>d3_geo_pathBoundsY1)d3_geo_pathBoundsY1=y}function d3_geo_pathBuffer(){var pointCircle=d3_geo_pathBufferCircle(4.5),buffer=[];var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=
point},pointRadius:function(_){pointCircle=d3_geo_pathBufferCircle(_);return stream},result:function(){if(buffer.length){var result=buffer.join("");buffer=[];return result}}};function point(x,y){buffer.push("M",x,",",y,pointCircle)}function pointLineStart(x,y){buffer.push("M",x,",",y);stream.point=pointLine}function pointLine(x,y){buffer.push("L",x,",",y)}function lineEnd(){stream.point=point}function lineEndPolygon(){buffer.push("Z")}return stream}function d3_geo_pathBufferCircle(radius){return"m0,"+
radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+2*radius+"z"}var d3_geo_pathCentroid={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint;d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidLineStart;d3_geo_pathCentroid.lineEnd=d3_geo_pathCentroidLineEnd}};
function d3_geo_pathCentroidPoint(x,y){d3_geo_centroidX0+=x;d3_geo_centroidY0+=y;++d3_geo_centroidZ0}function d3_geo_pathCentroidLineStart(){var x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;d3_geo_pathCentroidPoint(x0=x,y0=y)};function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2;d3_geo_centroidY1+=z*(y0+y)/2;d3_geo_centroidZ1+=z;d3_geo_pathCentroidPoint(x0=x,y0=y)}}function d3_geo_pathCentroidLineEnd(){d3_geo_pathCentroid.point=
d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){var x00,y00,x0,y0;d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;d3_geo_pathCentroidPoint(x00=x0=x,y00=y0=y)};function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX1+=z*(x0+x)/2;d3_geo_centroidY1+=z*(y0+y)/2;d3_geo_centroidZ1+=z;z=y0*x-x0*y;d3_geo_centroidX2+=z*(x0+x);d3_geo_centroidY2+=z*(y0+y);d3_geo_centroidZ2+=z*3;d3_geo_pathCentroidPoint(x0=x,y0=y)}d3_geo_pathCentroid.lineEnd=
function(){nextPoint(x00,y00)}}function d3_geo_pathContext(context){var pointRadius=4.5;var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=point},pointRadius:function(_){pointRadius=_;return stream},result:d3_noop};function point(x,y){context.moveTo(x+pointRadius,y);context.arc(x,y,pointRadius,0,\u03c4)}function pointLineStart(x,y){context.moveTo(x,
y);stream.point=pointLine}function pointLine(x,y){context.lineTo(x,y)}function lineEnd(){stream.point=point}function lineEndPolygon(){context.closePath()}return stream}function d3_geo_resample(project){var \u03b42=.5,cosMinDistance=Math.cos(30*d3_radians),maxDepth=16;function resample(stream){return(maxDepth?resampleRecursive:resampleNone)(stream)}function resampleNone(stream){return d3_geo_transformPoint(stream,function(x,y){x=project(x,y);stream.point(x[0],x[1])})}function resampleRecursive(stream){var \u03bb00,
\u03c600,x00,y00,a00,b00,c00,\u03bb0,x0,y0,a0,b0,c0;var resample={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart();resample.lineStart=ringStart},polygonEnd:function(){stream.polygonEnd();resample.lineStart=lineStart}};function point(x,y){x=project(x,y);stream.point(x[0],x[1])}function lineStart(){x0=NaN;resample.point=linePoint;stream.lineStart()}function linePoint(\u03bb,\u03c6){var c=d3_geo_cartesian([\u03bb,\u03c6]),p=project(\u03bb,\u03c6);resampleLineTo(x0,
y0,\u03bb0,a0,b0,c0,x0=p[0],y0=p[1],\u03bb0=\u03bb,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream);stream.point(x0,y0)}function lineEnd(){resample.point=point;stream.lineEnd()}function ringStart(){lineStart();resample.point=ringPoint;resample.lineEnd=ringEnd}function ringPoint(\u03bb,\u03c6){linePoint(\u03bb00=\u03bb,\u03c600=\u03c6),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0;resample.point=linePoint}function ringEnd(){resampleLineTo(x0,y0,\u03bb0,a0,b0,c0,x00,y00,\u03bb00,a00,b00,c00,maxDepth,stream);resample.lineEnd=
lineEnd;lineEnd()}return resample}function resampleLineTo(x0,y0,\u03bb0,a0,b0,c0,x1,y1,\u03bb1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*\u03b42&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=Math.sqrt(a*a+b*b+c*c),\u03c62=Math.asin(c/=m),\u03bb2=abs(abs(c)-1)<\u03b5||abs(\u03bb0-\u03bb1)<\u03b5?(\u03bb0+\u03bb1)/2:Math.atan2(b,a),p=project(\u03bb2,\u03c62),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;if(dz*dz/d2>\u03b42||abs((dx*dx2+dy*dy2)/d2-.5)>.3||a0*a1+b0*b1+c0*c1<
cosMinDistance){resampleLineTo(x0,y0,\u03bb0,a0,b0,c0,x2,y2,\u03bb2,a/=m,b/=m,c,depth,stream);stream.point(x2,y2);resampleLineTo(x2,y2,\u03bb2,a,b,c,x1,y1,\u03bb1,a1,b1,c1,depth,stream)}}}resample.precision=function(_){if(!arguments.length)return Math.sqrt(\u03b42);maxDepth=(\u03b42=_*_)>0&&16;return resample};return resample}d3.geo.path=function(){var pointRadius=4.5,projection,context,projectStream,contextStream,cacheStream;function path(object){if(object){if(typeof pointRadius==="function")contextStream.pointRadius(+pointRadius.apply(this,
arguments));if(!cacheStream||!cacheStream.valid)cacheStream=projectStream(contextStream);d3.geo.stream(object,cacheStream)}return contextStream.result()}path.area=function(object){d3_geo_pathAreaSum=0;d3.geo.stream(object,projectStream(d3_geo_pathArea));return d3_geo_pathAreaSum};path.centroid=function(object){d3_geo_centroidX0=d3_geo_centroidY0=d3_geo_centroidZ0=d3_geo_centroidX1=d3_geo_centroidY1=d3_geo_centroidZ1=d3_geo_centroidX2=d3_geo_centroidY2=d3_geo_centroidZ2=0;d3.geo.stream(object,projectStream(d3_geo_pathCentroid));
return d3_geo_centroidZ2?[d3_geo_centroidX2/d3_geo_centroidZ2,d3_geo_centroidY2/d3_geo_centroidZ2]:d3_geo_centroidZ1?[d3_geo_centroidX1/d3_geo_centroidZ1,d3_geo_centroidY1/d3_geo_centroidZ1]:d3_geo_centroidZ0?[d3_geo_centroidX0/d3_geo_centroidZ0,d3_geo_centroidY0/d3_geo_centroidZ0]:[NaN,NaN]};path.bounds=function(object){d3_geo_pathBoundsX1=d3_geo_pathBoundsY1=-(d3_geo_pathBoundsX0=d3_geo_pathBoundsY0=Infinity);d3.geo.stream(object,projectStream(d3_geo_pathBounds));return[[d3_geo_pathBoundsX0,d3_geo_pathBoundsY0],
[d3_geo_pathBoundsX1,d3_geo_pathBoundsY1]]};path.projection=function(_){if(!arguments.length)return projection;projectStream=(projection=_)?_.stream||d3_geo_pathProjectStream(_):d3_identity;return reset()};path.context=function(_){if(!arguments.length)return context;contextStream=(context=_)==null?new d3_geo_pathBuffer:new d3_geo_pathContext(_);if(typeof pointRadius!=="function")contextStream.pointRadius(pointRadius);return reset()};path.pointRadius=function(_){if(!arguments.length)return pointRadius;
pointRadius=typeof _==="function"?_:(contextStream.pointRadius(+_),+_);return path};function reset(){cacheStream=null;return path}return path.projection(d3.geo.albersUsa()).context(null)};function d3_geo_pathProjectStream(project){var resample=d3_geo_resample(function(x,y){return project([x*d3_degrees,y*d3_degrees])});return function(stream){return d3_geo_projectionRadians(resample(stream))}}d3.geo.transform=function(methods){return{stream:function(stream){var transform=new d3_geo_transform(stream);
for(var k in methods)transform[k]=methods[k];return transform}}};function d3_geo_transform(stream){this.stream=stream}d3_geo_transform.prototype={point:function(x,y){this.stream.point(x,y)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function d3_geo_transformPoint(stream,point){return{point:point,sphere:function(){stream.sphere()},
lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}d3.geo.projection=d3_geo_projection;d3.geo.projectionMutator=d3_geo_projectionMutator;function d3_geo_projection(project){return d3_geo_projectionMutator(function(){return project})()}function d3_geo_projectionMutator(projectAt){var project,rotate,projectRotate,projectResample=d3_geo_resample(function(x,y){x=project(x,y);return[x[0]*
k+\u03b4x,\u03b4y-x[1]*k]}),k=150,x=480,y=250,\u03bb=0,\u03c6=0,\u03b4\u03bb=0,\u03b4\u03c6=0,\u03b4\u03b3=0,\u03b4x,\u03b4y,preclip=d3_geo_clipAntimeridian,postclip=d3_identity,clipAngle=null,clipExtent=null,stream;function projection(point){point=projectRotate(point[0]*d3_radians,point[1]*d3_radians);return[point[0]*k+\u03b4x,\u03b4y-point[1]*k]}function invert(point){point=projectRotate.invert((point[0]-\u03b4x)/k,(\u03b4y-point[1])/k);return point&&[point[0]*d3_degrees,point[1]*d3_degrees]}projection.stream=
function(output){if(stream)stream.valid=false;stream=d3_geo_projectionRadians(preclip(rotate,projectResample(postclip(output))));stream.valid=true;return stream};projection.clipAngle=function(_){if(!arguments.length)return clipAngle;preclip=_==null?(clipAngle=_,d3_geo_clipAntimeridian):d3_geo_clipCircle((clipAngle=+_)*d3_radians);return invalidate()};projection.clipExtent=function(_){if(!arguments.length)return clipExtent;clipExtent=_;postclip=_?d3_geo_clipExtent(_[0][0],_[0][1],_[1][0],_[1][1]):
d3_identity;return invalidate()};projection.scale=function(_){if(!arguments.length)return k;k=+_;return reset()};projection.translate=function(_){if(!arguments.length)return[x,y];x=+_[0];y=+_[1];return reset()};projection.center=function(_){if(!arguments.length)return[\u03bb*d3_degrees,\u03c6*d3_degrees];\u03bb=_[0]%360*d3_radians;\u03c6=_[1]%360*d3_radians;return reset()};projection.rotate=function(_){if(!arguments.length)return[\u03b4\u03bb*d3_degrees,\u03b4\u03c6*d3_degrees,\u03b4\u03b3*d3_degrees];
\u03b4\u03bb=_[0]%360*d3_radians;\u03b4\u03c6=_[1]%360*d3_radians;\u03b4\u03b3=_.length>2?_[2]%360*d3_radians:0;return reset()};d3.rebind(projection,projectResample,"precision");function reset(){projectRotate=d3_geo_compose(rotate=d3_geo_rotation(\u03b4\u03bb,\u03b4\u03c6,\u03b4\u03b3),project);var center=project(\u03bb,\u03c6);\u03b4x=x-center[0]*k;\u03b4y=y+center[1]*k;return invalidate()}function invalidate(){if(stream)stream.valid=false,stream=null;return projection}return function(){project=
projectAt.apply(this,arguments);projection.invert=project.invert&&invert;return reset()}}function d3_geo_projectionRadians(stream){return d3_geo_transformPoint(stream,function(x,y){stream.point(x*d3_radians,y*d3_radians)})}function d3_geo_equirectangular(\u03bb,\u03c6){return[\u03bb,\u03c6]}(d3.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular;d3.geo.rotation=function(rotate){rotate=d3_geo_rotation(rotate[0]%
360*d3_radians,rotate[1]*d3_radians,rotate.length>2?rotate[2]*d3_radians:0);function forward(coordinates){coordinates=rotate(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates}forward.invert=function(coordinates){coordinates=rotate.invert(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates};return forward};function d3_geo_identityRotation(\u03bb,\u03c6){return[\u03bb>
\u03c0?\u03bb-\u03c4:\u03bb<-\u03c0?\u03bb+\u03c4:\u03bb,\u03c6]}d3_geo_identityRotation.invert=d3_geo_equirectangular;function d3_geo_rotation(\u03b4\u03bb,\u03b4\u03c6,\u03b4\u03b3){return \u03b4\u03bb?\u03b4\u03c6||\u03b4\u03b3?d3_geo_compose(d3_geo_rotation\u03bb(\u03b4\u03bb),d3_geo_rotation\u03c6\u03b3(\u03b4\u03c6,\u03b4\u03b3)):d3_geo_rotation\u03bb(\u03b4\u03bb):\u03b4\u03c6||\u03b4\u03b3?d3_geo_rotation\u03c6\u03b3(\u03b4\u03c6,\u03b4\u03b3):d3_geo_identityRotation}function d3_geo_forwardRotation\u03bb(\u03b4\u03bb){return function(\u03bb,
\u03c6){return \u03bb+=\u03b4\u03bb,[\u03bb>\u03c0?\u03bb-\u03c4:\u03bb<-\u03c0?\u03bb+\u03c4:\u03bb,\u03c6]}}function d3_geo_rotation\u03bb(\u03b4\u03bb){var rotation=d3_geo_forwardRotation\u03bb(\u03b4\u03bb);rotation.invert=d3_geo_forwardRotation\u03bb(-\u03b4\u03bb);return rotation}function d3_geo_rotation\u03c6\u03b3(\u03b4\u03c6,\u03b4\u03b3){var cos\u03b4\u03c6=Math.cos(\u03b4\u03c6),sin\u03b4\u03c6=Math.sin(\u03b4\u03c6),cos\u03b4\u03b3=Math.cos(\u03b4\u03b3),sin\u03b4\u03b3=Math.sin(\u03b4\u03b3);
function rotation(\u03bb,\u03c6){var cos\u03c6=Math.cos(\u03c6),x=Math.cos(\u03bb)*cos\u03c6,y=Math.sin(\u03bb)*cos\u03c6,z=Math.sin(\u03c6),k=z*cos\u03b4\u03c6+x*sin\u03b4\u03c6;return[Math.atan2(y*cos\u03b4\u03b3-k*sin\u03b4\u03b3,x*cos\u03b4\u03c6-z*sin\u03b4\u03c6),d3_asin(k*cos\u03b4\u03b3+y*sin\u03b4\u03b3)]}rotation.invert=function(\u03bb,\u03c6){var cos\u03c6=Math.cos(\u03c6),x=Math.cos(\u03bb)*cos\u03c6,y=Math.sin(\u03bb)*cos\u03c6,z=Math.sin(\u03c6),k=z*cos\u03b4\u03b3-y*sin\u03b4\u03b3;
return[Math.atan2(y*cos\u03b4\u03b3+z*sin\u03b4\u03b3,x*cos\u03b4\u03c6+k*sin\u03b4\u03c6),d3_asin(k*cos\u03b4\u03c6-x*sin\u03b4\u03c6)]};return rotation}d3.geo.circle=function(){var origin=[0,0],angle,precision=6,interpolate;function circle(){var center=typeof origin==="function"?origin.apply(this,arguments):origin,rotate=d3_geo_rotation(-center[0]*d3_radians,-center[1]*d3_radians,0).invert,ring=[];interpolate(null,null,1,{point:function(x,y){ring.push(x=rotate(x,y));x[0]*=d3_degrees,x[1]*=d3_degrees}});
return{type:"Polygon",coordinates:[ring]}}circle.origin=function(x){if(!arguments.length)return origin;origin=x;return circle};circle.angle=function(x){if(!arguments.length)return angle;interpolate=d3_geo_circleInterpolate((angle=+x)*d3_radians,precision*d3_radians);return circle};circle.precision=function(_){if(!arguments.length)return precision;interpolate=d3_geo_circleInterpolate(angle*d3_radians,(precision=+_)*d3_radians);return circle};return circle.angle(90)};function d3_geo_circleInterpolate(radius,
precision){var cr=Math.cos(radius),sr=Math.sin(radius);return function(from,to,direction,listener){var step=direction*precision;if(from!=null){from=d3_geo_circleAngle(cr,from);to=d3_geo_circleAngle(cr,to);if(direction>0?from<to:from>to)from+=direction*\u03c4}else{from=radius+direction*\u03c4;to=radius-.5*step}for(var point,t=from;direction>0?t>to:t<to;t-=step)listener.point((point=d3_geo_spherical([cr,-sr*Math.cos(t),-sr*Math.sin(t)]))[0],point[1])}}function d3_geo_circleAngle(cr,point){var a=d3_geo_cartesian(point);
a[0]-=cr;d3_geo_cartesianNormalize(a);var angle=d3_acos(-a[1]);return((-a[2]<0?-angle:angle)+2*Math.PI-\u03b5)%(2*Math.PI)}d3.geo.distance=function(a,b){var \u0394\u03bb=(b[0]-a[0])*d3_radians,\u03c60=a[1]*d3_radians,\u03c61=b[1]*d3_radians,sin\u0394\u03bb=Math.sin(\u0394\u03bb),cos\u0394\u03bb=Math.cos(\u0394\u03bb),sin\u03c60=Math.sin(\u03c60),cos\u03c60=Math.cos(\u03c60),sin\u03c61=Math.sin(\u03c61),cos\u03c61=Math.cos(\u03c61),t;return Math.atan2(Math.sqrt((t=cos\u03c61*sin\u0394\u03bb)*t+(t=
cos\u03c60*sin\u03c61-sin\u03c60*cos\u03c61*cos\u0394\u03bb)*t),sin\u03c60*sin\u03c61+cos\u03c60*cos\u03c61*cos\u0394\u03bb)};d3.geo.graticule=function(){var x1,x0,X1,X0,y1,y0,Y1,Y0,dx=10,dy=dx,DX=90,DY=360,x,y,X,Y,precision=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3.range(Math.ceil(X0/DX)*DX,X1,DX).map(X).concat(d3.range(Math.ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3.range(Math.ceil(x0/dx)*dx,x1,dx).filter(function(x){return abs(x%DX)>\u03b5}).map(x)).concat(d3.range(Math.ceil(y0/
dy)*dy,y1,dy).filter(function(y){return abs(y%DY)>\u03b5}).map(y))}graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})};graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}};graticule.extent=function(_){if(!arguments.length)return graticule.minorExtent();return graticule.majorExtent(_).minorExtent(_)};graticule.majorExtent=function(_){if(!arguments.length)return[[X0,
Y0],[X1,Y1]];X0=+_[0][0],X1=+_[1][0];Y0=+_[0][1],Y1=+_[1][1];if(X0>X1)_=X0,X0=X1,X1=_;if(Y0>Y1)_=Y0,Y0=Y1,Y1=_;return graticule.precision(precision)};graticule.minorExtent=function(_){if(!arguments.length)return[[x0,y0],[x1,y1]];x0=+_[0][0],x1=+_[1][0];y0=+_[0][1],y1=+_[1][1];if(x0>x1)_=x0,x0=x1,x1=_;if(y0>y1)_=y0,y0=y1,y1=_;return graticule.precision(precision)};graticule.step=function(_){if(!arguments.length)return graticule.minorStep();return graticule.majorStep(_).minorStep(_)};graticule.majorStep=
function(_){if(!arguments.length)return[DX,DY];DX=+_[0],DY=+_[1];return graticule};graticule.minorStep=function(_){if(!arguments.length)return[dx,dy];dx=+_[0],dy=+_[1];return graticule};graticule.precision=function(_){if(!arguments.length)return precision;precision=+_;x=d3_geo_graticuleX(y0,y1,90);y=d3_geo_graticuleY(x0,x1,precision);X=d3_geo_graticuleX(Y0,Y1,90);Y=d3_geo_graticuleY(X0,X1,precision);return graticule};return graticule.majorExtent([[-180,-90+\u03b5],[180,90-\u03b5]]).minorExtent([[-180,
-80-\u03b5],[180,80+\u03b5]])};function d3_geo_graticuleX(y0,y1,dy){var y=d3.range(y0,y1-\u03b5,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function d3_geo_graticuleY(x0,x1,dx){var x=d3.range(x0,x1-\u03b5,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function d3_source(d){return d.source}function d3_target(d){return d.target}d3.geo.greatArc=function(){var source=d3_source,source_,target=d3_target,target_;function greatArc(){return{type:"LineString",
coordinates:[source_||source.apply(this,arguments),target_||target.apply(this,arguments)]}}greatArc.distance=function(){return d3.geo.distance(source_||source.apply(this,arguments),target_||target.apply(this,arguments))};greatArc.source=function(_){if(!arguments.length)return source;source=_,source_=typeof _==="function"?null:_;return greatArc};greatArc.target=function(_){if(!arguments.length)return target;target=_,target_=typeof _==="function"?null:_;return greatArc};greatArc.precision=function(){return arguments.length?
greatArc:0};return greatArc};d3.geo.interpolate=function(source,target){return d3_geo_interpolate(source[0]*d3_radians,source[1]*d3_radians,target[0]*d3_radians,target[1]*d3_radians)};function d3_geo_interpolate(x0,y0,x1,y1){var cy0=Math.cos(y0),sy0=Math.sin(y0),cy1=Math.cos(y1),sy1=Math.sin(y1),kx0=cy0*Math.cos(x0),ky0=cy0*Math.sin(x0),kx1=cy1*Math.cos(x1),ky1=cy1*Math.sin(x1),d=2*Math.asin(Math.sqrt(d3_haversin(y1-y0)+cy0*cy1*d3_haversin(x1-x0))),k=1/Math.sin(d);var interpolate=d?function(t){var B=
Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)*d3_degrees,Math.atan2(z,Math.sqrt(x*x+y*y))*d3_degrees]}:function(){return[x0*d3_degrees,y0*d3_degrees]};interpolate.distance=d;return interpolate}d3.geo.length=function(object){d3_geo_lengthSum=0;d3.geo.stream(object,d3_geo_length);return d3_geo_lengthSum};var d3_geo_lengthSum;var d3_geo_length={sphere:d3_noop,point:d3_noop,lineStart:d3_geo_lengthLineStart,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};
function d3_geo_lengthLineStart(){var \u03bb0,sin\u03c60,cos\u03c60;d3_geo_length.point=function(\u03bb,\u03c6){\u03bb0=\u03bb*d3_radians,sin\u03c60=Math.sin(\u03c6*=d3_radians),cos\u03c60=Math.cos(\u03c6);d3_geo_length.point=nextPoint};d3_geo_length.lineEnd=function(){d3_geo_length.point=d3_geo_length.lineEnd=d3_noop};function nextPoint(\u03bb,\u03c6){var sin\u03c6=Math.sin(\u03c6*=d3_radians),cos\u03c6=Math.cos(\u03c6),t=abs((\u03bb*=d3_radians)-\u03bb0),cos\u0394\u03bb=Math.cos(t);d3_geo_lengthSum+=
Math.atan2(Math.sqrt((t=cos\u03c6*Math.sin(t))*t+(t=cos\u03c60*sin\u03c6-sin\u03c60*cos\u03c6*cos\u0394\u03bb)*t),sin\u03c60*sin\u03c6+cos\u03c60*cos\u03c6*cos\u0394\u03bb);\u03bb0=\u03bb,sin\u03c60=sin\u03c6,cos\u03c60=cos\u03c6}}function d3_geo_azimuthal(scale,angle){function azimuthal(\u03bb,\u03c6){var cos\u03bb=Math.cos(\u03bb),cos\u03c6=Math.cos(\u03c6),k=scale(cos\u03bb*cos\u03c6);return[k*cos\u03c6*Math.sin(\u03bb),k*Math.sin(\u03c6)]}azimuthal.invert=function(x,y){var \u03c1=Math.sqrt(x*
x+y*y),c=angle(\u03c1),sinc=Math.sin(c),cosc=Math.cos(c);return[Math.atan2(x*sinc,\u03c1*cosc),Math.asin(\u03c1&&y*sinc/\u03c1)]};return azimuthal}var d3_geo_azimuthalEqualArea=d3_geo_azimuthal(function(cos\u03bbcos\u03c6){return Math.sqrt(2/(1+cos\u03bbcos\u03c6))},function(\u03c1){return 2*Math.asin(\u03c1/2)});(d3.geo.azimuthalEqualArea=function(){return d3_geo_projection(d3_geo_azimuthalEqualArea)}).raw=d3_geo_azimuthalEqualArea;var d3_geo_azimuthalEquidistant=d3_geo_azimuthal(function(cos\u03bbcos\u03c6){var c=
Math.acos(cos\u03bbcos\u03c6);return c&&c/Math.sin(c)},d3_identity);(d3.geo.azimuthalEquidistant=function(){return d3_geo_projection(d3_geo_azimuthalEquidistant)}).raw=d3_geo_azimuthalEquidistant;function d3_geo_conicConformal(\u03c60,\u03c61){var cos\u03c60=Math.cos(\u03c60),t=function(\u03c6){return Math.tan(\u03c0/4+\u03c6/2)},n=\u03c60===\u03c61?Math.sin(\u03c60):Math.log(cos\u03c60/Math.cos(\u03c61))/Math.log(t(\u03c61)/t(\u03c60)),F=cos\u03c60*Math.pow(t(\u03c60),n)/n;if(!n)return d3_geo_mercator;
function forward(\u03bb,\u03c6){if(F>0){if(\u03c6<-half\u03c0+\u03b5)\u03c6=-half\u03c0+\u03b5}else if(\u03c6>half\u03c0-\u03b5)\u03c6=half\u03c0-\u03b5;var \u03c1=F/Math.pow(t(\u03c6),n);return[\u03c1*Math.sin(n*\u03bb),F-\u03c1*Math.cos(n*\u03bb)]}forward.invert=function(x,y){var \u03c10_y=F-y,\u03c1=d3_sgn(n)*Math.sqrt(x*x+\u03c10_y*\u03c10_y);return[Math.atan2(x,\u03c10_y)/n,2*Math.atan(Math.pow(F/\u03c1,1/n))-half\u03c0]};return forward}(d3.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=
d3_geo_conicConformal;function d3_geo_conicEquidistant(\u03c60,\u03c61){var cos\u03c60=Math.cos(\u03c60),n=\u03c60===\u03c61?Math.sin(\u03c60):(cos\u03c60-Math.cos(\u03c61))/(\u03c61-\u03c60),G=cos\u03c60/n+\u03c60;if(abs(n)<\u03b5)return d3_geo_equirectangular;function forward(\u03bb,\u03c6){var \u03c1=G-\u03c6;return[\u03c1*Math.sin(n*\u03bb),G-\u03c1*Math.cos(n*\u03bb)]}forward.invert=function(x,y){var \u03c10_y=G-y;return[Math.atan2(x,\u03c10_y)/n,G-d3_sgn(n)*Math.sqrt(x*x+\u03c10_y*\u03c10_y)]};
return forward}(d3.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var d3_geo_gnomonic=d3_geo_azimuthal(function(cos\u03bbcos\u03c6){return 1/cos\u03bbcos\u03c6},Math.atan);(d3.geo.gnomonic=function(){return d3_geo_projection(d3_geo_gnomonic)}).raw=d3_geo_gnomonic;function d3_geo_mercator(\u03bb,\u03c6){return[\u03bb,Math.log(Math.tan(\u03c0/4+\u03c6/2))]}d3_geo_mercator.invert=function(x,y){return[x,2*Math.atan(Math.exp(y))-half\u03c0]};
function d3_geo_mercatorProjection(project){var m=d3_geo_projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent,clipAuto;m.scale=function(){var v=scale.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.translate=function(){var v=translate.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.clipExtent=function(_){var v=clipExtent.apply(m,arguments);if(v===m){if(clipAuto=_==null){var k=\u03c0*scale(),t=translate();clipExtent([[t[0]-k,t[1]-k],
[t[0]+k,t[1]+k]])}}else if(clipAuto)v=null;return v};return m.clipExtent(null)}(d3.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var d3_geo_orthographic=d3_geo_azimuthal(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return d3_geo_projection(d3_geo_orthographic)}).raw=d3_geo_orthographic;var d3_geo_stereographic=d3_geo_azimuthal(function(cos\u03bbcos\u03c6){return 1/(1+cos\u03bbcos\u03c6)},function(\u03c1){return 2*Math.atan(\u03c1)});
(d3.geo.stereographic=function(){return d3_geo_projection(d3_geo_stereographic)}).raw=d3_geo_stereographic;function d3_geo_transverseMercator(\u03bb,\u03c6){return[Math.log(Math.tan(\u03c0/4+\u03c6/2)),-\u03bb]}d3_geo_transverseMercator.invert=function(x,y){return[-y,2*Math.atan(Math.exp(x))-half\u03c0]};(d3.geo.transverseMercator=function(){var projection=d3_geo_mercatorProjection(d3_geo_transverseMercator),center=projection.center,rotate=projection.rotate;projection.center=function(_){return _?
center([-_[1],_[0]]):(_=center(),[_[1],-_[0]])};projection.rotate=function(_){return _?rotate([_[0],_[1],_.length>2?_[2]+90:90]):(_=rotate(),[_[0],_[1],_[2]-90])};return rotate([0,0,90])}).raw=d3_geo_transverseMercator;d3.geom={};function d3_geom_pointX(d){return d[0]}function d3_geom_pointY(d){return d[1]}d3.geom.hull=function(vertices){var x=d3_geom_pointX,y=d3_geom_pointY;if(arguments.length)return hull(vertices);function hull(data){if(data.length<3)return[];var fx=d3_functor(x),fy=d3_functor(y),
i,n=data.length,points=[],flippedPoints=[];for(i=0;i<n;i++)points.push([+fx.call(this,data[i],i),+fy.call(this,data[i],i),i]);points.sort(d3_geom_hullOrder);for(i=0;i<n;i++)flippedPoints.push([points[i][0],-points[i][1]]);var upper=d3_geom_hullUpper(points),lower=d3_geom_hullUpper(flippedPoints);var skipLeft=lower[0]===upper[0],skipRight=lower[lower.length-1]===upper[upper.length-1],polygon=[];for(i=upper.length-1;i>=0;--i)polygon.push(data[points[upper[i]][2]]);for(i=+skipLeft;i<lower.length-skipRight;++i)polygon.push(data[points[lower[i]][2]]);
return polygon}hull.x=function(_){return arguments.length?(x=_,hull):x};hull.y=function(_){return arguments.length?(y=_,hull):y};return hull};function d3_geom_hullUpper(points){var n=points.length,hull=[0,1],hs=2;for(var i=2;i<n;i++){while(hs>1&&d3_cross2d(points[hull[hs-2]],points[hull[hs-1]],points[i])<=0)--hs;hull[hs++]=i}return hull.slice(0,hs)}function d3_geom_hullOrder(a,b){return a[0]-b[0]||a[1]-b[1]}d3.geom.polygon=function(coordinates){d3_subclass(coordinates,d3_geom_polygonPrototype);return coordinates};
var d3_geom_polygonPrototype=d3.geom.polygon.prototype=[];d3_geom_polygonPrototype.area=function(){var i=-1,n=this.length,a,b=this[n-1],area=0;while(++i<n){a=b;b=this[i];area+=a[1]*b[0]-a[0]*b[1]}return area*.5};d3_geom_polygonPrototype.centroid=function(k){var i=-1,n=this.length,x=0,y=0,a,b=this[n-1],c;if(!arguments.length)k=-1/(6*this.area());while(++i<n){a=b;b=this[i];c=a[0]*b[1]-b[0]*a[1];x+=(a[0]+b[0])*c;y+=(a[1]+b[1])*c}return[x*k,y*k]};d3_geom_polygonPrototype.clip=function(subject){var input,
closed=d3_geom_polygonClosed(subject),i=-1,n=this.length-d3_geom_polygonClosed(this),j,m,a=this[n-1],b,c,d;while(++i<n){input=subject.slice();subject.length=0;b=this[i];c=input[(m=input.length-closed)-1];j=-1;while(++j<m){d=input[j];if(d3_geom_polygonInside(d,a,b)){if(!d3_geom_polygonInside(c,a,b))subject.push(d3_geom_polygonIntersect(c,d,a,b));subject.push(d)}else if(d3_geom_polygonInside(c,a,b))subject.push(d3_geom_polygonIntersect(c,d,a,b));c=d}if(closed)subject.push(subject[0]);a=b}return subject};
function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x3=a[0],x21=d[0]-x1,x43=b[0]-x3,y1=c[1],y3=a[1],y21=d[1]-y1,y43=b[1]-y3,ua=(x43*(y1-y3)-y43*(x1-x3))/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}function d3_geom_polygonClosed(coordinates){var a=coordinates[0],b=coordinates[coordinates.length-1];return!(a[0]-b[0]||a[1]-b[1])}var d3_geom_voronoiEdges,d3_geom_voronoiCells,d3_geom_voronoiBeaches,d3_geom_voronoiBeachPool=
[],d3_geom_voronoiFirstCircle,d3_geom_voronoiCircles,d3_geom_voronoiCirclePool=[];function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this);this.edge=this.site=this.circle=null}function d3_geom_voronoiCreateBeach(site){var beach=d3_geom_voronoiBeachPool.pop()||new d3_geom_voronoiBeach;beach.site=site;return beach}function d3_geom_voronoiDetachBeach(beach){d3_geom_voronoiDetachCircle(beach);d3_geom_voronoiBeaches.remove(beach);d3_geom_voronoiBeachPool.push(beach);d3_geom_voronoiRedBlackNode(beach)}
function d3_geom_voronoiRemoveBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex={x:x,y:y},previous=beach.P,next=beach.N,disappearing=[beach];d3_geom_voronoiDetachBeach(beach);var lArc=previous;while(lArc.circle&&abs(x-lArc.circle.x)<\u03b5&&abs(y-lArc.circle.cy)<\u03b5){previous=lArc.P;disappearing.unshift(lArc);d3_geom_voronoiDetachBeach(lArc);lArc=previous}disappearing.unshift(lArc);d3_geom_voronoiDetachCircle(lArc);var rArc=next;while(rArc.circle&&abs(x-rArc.circle.x)<\u03b5&&
abs(y-rArc.circle.cy)<\u03b5){next=rArc.N;disappearing.push(rArc);d3_geom_voronoiDetachBeach(rArc);rArc=next}disappearing.push(rArc);d3_geom_voronoiDetachCircle(rArc);var nArcs=disappearing.length,iArc;for(iArc=1;iArc<nArcs;++iArc){rArc=disappearing[iArc];lArc=disappearing[iArc-1];d3_geom_voronoiSetEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex)}lArc=disappearing[0];rArc=disappearing[nArcs-1];rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,rArc.site,null,vertex);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc)}
function d3_geom_voronoiAddBeach(site){var x=site.x,directrix=site.y,lArc,rArc,dxl,dxr,node=d3_geom_voronoiBeaches._;while(node){dxl=d3_geom_voronoiLeftBreakPoint(node,directrix)-x;if(dxl>\u03b5)node=node.L;else{dxr=x-d3_geom_voronoiRightBreakPoint(node,directrix);if(dxr>\u03b5){if(!node.R){lArc=node;break}node=node.R}else{if(dxl>-\u03b5){lArc=node.P;rArc=node}else if(dxr>-\u03b5){lArc=node;rArc=node.N}else lArc=rArc=node;break}}}var newArc=d3_geom_voronoiCreateBeach(site);d3_geom_voronoiBeaches.insert(lArc,
newArc);if(!lArc&&!rArc)return;if(lArc===rArc){d3_geom_voronoiDetachCircle(lArc);rArc=d3_geom_voronoiCreateBeach(lArc.site);d3_geom_voronoiBeaches.insert(newArc,rArc);newArc.edge=rArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc);return}if(!rArc){newArc.edge=d3_geom_voronoiCreateEdge(lArc.site,newArc.site);return}d3_geom_voronoiDetachCircle(lArc);d3_geom_voronoiDetachCircle(rArc);var lSite=lArc.site,ax=lSite.x,ay=lSite.y,
bx=site.x-ax,by=site.y-ay,rSite=rArc.site,cx=rSite.x-ax,cy=rSite.y-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex={x:(cy*hb-by*hc)/d+ax,y:(bx*hc-cx*hb)/d+ay};d3_geom_voronoiSetEdgeEnd(rArc.edge,lSite,rSite,vertex);newArc.edge=d3_geom_voronoiCreateEdge(lSite,site,null,vertex);rArc.edge=d3_geom_voronoiCreateEdge(site,rSite,null,vertex);d3_geom_voronoiAttachCircle(lArc);d3_geom_voronoiAttachCircle(rArc)}function d3_geom_voronoiLeftBreakPoint(arc,directrix){var site=arc.site,rfocx=site.x,rfocy=
site.y,pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-Infinity;site=lArc.site;var lfocx=site.x,lfocy=site.y,plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;if(aby2)return(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx;return(rfocx+lfocx)/2}function d3_geom_voronoiRightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return d3_geom_voronoiLeftBreakPoint(rArc,directrix);var site=arc.site;return site.y===
directrix?site.x:Infinity}function d3_geom_voronoiCell(site){this.site=site;this.edges=[]}d3_geom_voronoiCell.prototype.prepare=function(){var halfEdges=this.edges,iHalfEdge=halfEdges.length,edge;while(iHalfEdge--){edge=halfEdges[iHalfEdge].edge;if(!edge.b||!edge.a)halfEdges.splice(iHalfEdge,1)}halfEdges.sort(d3_geom_voronoiHalfEdgeOrder);return halfEdges.length};function d3_geom_voronoiCloseCells(extent){var x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],x2,y2,x3,y3,cells=d3_geom_voronoiCells,
iCell=cells.length,cell,iHalfEdge,halfEdges,nHalfEdges,start,end;while(iCell--){cell=cells[iCell];if(!cell||!cell.prepare())continue;halfEdges=cell.edges;nHalfEdges=halfEdges.length;iHalfEdge=0;while(iHalfEdge<nHalfEdges){end=halfEdges[iHalfEdge].end(),x3=end.x,y3=end.y;start=halfEdges[++iHalfEdge%nHalfEdges].start(),x2=start.x,y2=start.y;if(abs(x3-x2)>\u03b5||abs(y3-y2)>\u03b5){halfEdges.splice(iHalfEdge,0,new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(cell.site,end,abs(x3-x0)<\u03b5&&
y1-y3>\u03b5?{x:x0,y:abs(x2-x0)<\u03b5?y2:y1}:abs(y3-y1)<\u03b5&&x1-x3>\u03b5?{x:abs(y2-y1)<\u03b5?x2:x1,y:y1}:abs(x3-x1)<\u03b5&&y3-y0>\u03b5?{x:x1,y:abs(x2-x1)<\u03b5?y2:y0}:abs(y3-y0)<\u03b5&&x3-x0>\u03b5?{x:abs(y2-y0)<\u03b5?x2:x0,y:y0}:null),cell.site,null));++nHalfEdges}}}}function d3_geom_voronoiHalfEdgeOrder(a,b){return b.angle-a.angle}function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this);this.x=this.y=this.arc=this.site=this.cy=null}function d3_geom_voronoiAttachCircle(arc){var lArc=
arc.P,rArc=arc.N;if(!lArc||!rArc)return;var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite===rSite)return;var bx=cSite.x,by=cSite.y,ax=lSite.x-bx,ay=lSite.y-by,cx=rSite.x-bx,cy=rSite.y-by;var d=2*(ax*cy-ay*cx);if(d>=-\u03b52)return;var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,cy=y+by;var circle=d3_geom_voronoiCirclePool.pop()||new d3_geom_voronoiCircle;circle.arc=arc;circle.site=cSite;circle.x=x+bx;circle.y=cy+Math.sqrt(x*x+y*y);circle.cy=cy;arc.circle=circle;var before=
null,node=d3_geom_voronoiCircles._;while(node)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x)if(node.L)node=node.L;else{before=node.P;break}else if(node.R)node=node.R;else{before=node;break}d3_geom_voronoiCircles.insert(before,circle);if(!before)d3_geom_voronoiFirstCircle=circle}function d3_geom_voronoiDetachCircle(arc){var circle=arc.circle;if(circle){if(!circle.P)d3_geom_voronoiFirstCircle=circle.N;d3_geom_voronoiCircles.remove(circle);d3_geom_voronoiCirclePool.push(circle);d3_geom_voronoiRedBlackNode(circle);
arc.circle=null}}function d3_geom_voronoiClipEdges(extent){var edges=d3_geom_voronoiEdges,clip=d3_geom_clipLine(extent[0][0],extent[0][1],extent[1][0],extent[1][1]),i=edges.length,e;while(i--){e=edges[i];if(!d3_geom_voronoiConnectEdge(e,extent)||!clip(e)||abs(e.a.x-e.b.x)<\u03b5&&abs(e.a.y-e.b.y)<\u03b5){e.a=e.b=null;edges.splice(i,1)}}}function d3_geom_voronoiConnectEdge(edge,extent){var vb=edge.b;if(vb)return true;var va=edge.a,x0=extent[0][0],x1=extent[1][0],y0=extent[0][1],y1=extent[1][1],lSite=
edge.l,rSite=edge.r,lx=lSite.x,ly=lSite.y,rx=rSite.x,ry=rSite.y,fx=(lx+rx)/2,fy=(ly+ry)/2,fm,fb;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(!va)va={x:fx,y:y0};else if(va.y>=y1)return;vb={x:fx,y:y1}}else{if(!va)va={x:fx,y:y1};else if(va.y<y0)return;vb={x:fx,y:y0}}}else{fm=(lx-rx)/(ry-ly);fb=fy-fm*fx;if(fm<-1||fm>1)if(lx>rx){if(!va)va={x:(y0-fb)/fm,y:y0};else if(va.y>=y1)return;vb={x:(y1-fb)/fm,y:y1}}else{if(!va)va={x:(y1-fb)/fm,y:y1};else if(va.y<y0)return;vb={x:(y0-fb)/fm,y:y0}}else if(ly<ry){if(!va)va=
{x:x0,y:fm*x0+fb};else if(va.x>=x1)return;vb={x:x1,y:fm*x1+fb}}else{if(!va)va={x:x1,y:fm*x1+fb};else if(va.x<x0)return;vb={x:x0,y:fm*x0+fb}}}edge.a=va;edge.b=vb;return true}function d3_geom_voronoiEdge(lSite,rSite){this.l=lSite;this.r=rSite;this.a=this.b=null}function d3_geom_voronoiCreateEdge(lSite,rSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,rSite);d3_geom_voronoiEdges.push(edge);if(va)d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,va);if(vb)d3_geom_voronoiSetEdgeEnd(edge,rSite,lSite,vb);d3_geom_voronoiCells[lSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,
lSite,rSite));d3_geom_voronoiCells[rSite.i].edges.push(new d3_geom_voronoiHalfEdge(edge,rSite,lSite));return edge}function d3_geom_voronoiCreateBorderEdge(lSite,va,vb){var edge=new d3_geom_voronoiEdge(lSite,null);edge.a=va;edge.b=vb;d3_geom_voronoiEdges.push(edge);return edge}function d3_geom_voronoiSetEdgeEnd(edge,lSite,rSite,vertex){if(!edge.a&&!edge.b){edge.a=vertex;edge.l=lSite;edge.r=rSite}else if(edge.l===rSite)edge.b=vertex;else edge.a=vertex}function d3_geom_voronoiHalfEdge(edge,lSite,rSite){var va=
edge.a,vb=edge.b;this.edge=edge;this.site=lSite;this.angle=rSite?Math.atan2(rSite.y-lSite.y,rSite.x-lSite.x):edge.l===lSite?Math.atan2(vb.x-va.x,va.y-vb.y):Math.atan2(va.x-vb.x,vb.y-va.y)}d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=
null}d3_geom_voronoiRedBlackTree.prototype={insert:function(after,node){var parent,grandpa,uncle;if(after){node.P=after;node.N=after.N;if(after.N)after.N.P=node;after.N=node;if(after.R){after=after.R;while(after.L)after=after.L;after.L=node}else after.R=node;parent=after}else if(this._){after=d3_geom_voronoiRedBlackFirst(this._);node.P=null;node.N=after;after.P=after.L=node;parent=after}else{node.P=node.N=null;this._=node;parent=null}node.L=node.R=null;node.U=parent;node.C=true;after=node;while(parent&&
parent.C){grandpa=parent.U;if(parent===grandpa.L){uncle=grandpa.R;if(uncle&&uncle.C){parent.C=uncle.C=false;grandpa.C=true;after=grandpa}else{if(after===parent.R){d3_geom_voronoiRedBlackRotateLeft(this,parent);after=parent;parent=after.U}parent.C=false;grandpa.C=true;d3_geom_voronoiRedBlackRotateRight(this,grandpa)}}else{uncle=grandpa.L;if(uncle&&uncle.C){parent.C=uncle.C=false;grandpa.C=true;after=grandpa}else{if(after===parent.L){d3_geom_voronoiRedBlackRotateRight(this,parent);after=parent;parent=
after.U}parent.C=false;grandpa.C=true;d3_geom_voronoiRedBlackRotateLeft(this,grandpa)}}parent=after.U}this._.C=false},remove:function(node){if(node.N)node.N.P=node.P;if(node.P)node.P.N=node.N;node.N=node.P=null;var parent=node.U,sibling,left=node.L,right=node.R,next,red;if(!left)next=right;else if(!right)next=left;else next=d3_geom_voronoiRedBlackFirst(right);if(parent)if(parent.L===node)parent.L=next;else parent.R=next;else this._=next;if(left&&right){red=next.C;next.C=node.C;next.L=left;left.U=
next;if(next!==right){parent=next.U;next.U=node.U;node=next.R;parent.L=node;next.R=right;right.U=next}else{next.U=parent;parent=next;node=next.R}}else{red=node.C;node=next}if(node)node.U=parent;if(red)return;if(node&&node.C){node.C=false;return}do{if(node===this._)break;if(node===parent.L){sibling=parent.R;if(sibling.C){sibling.C=false;parent.C=true;d3_geom_voronoiRedBlackRotateLeft(this,parent);sibling=parent.R}if(sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){if(!sibling.R||!sibling.R.C){sibling.L.C=
false;sibling.C=true;d3_geom_voronoiRedBlackRotateRight(this,sibling);sibling=parent.R}sibling.C=parent.C;parent.C=sibling.R.C=false;d3_geom_voronoiRedBlackRotateLeft(this,parent);node=this._;break}}else{sibling=parent.L;if(sibling.C){sibling.C=false;parent.C=true;d3_geom_voronoiRedBlackRotateRight(this,parent);sibling=parent.L}if(sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){if(!sibling.L||!sibling.L.C){sibling.R.C=false;sibling.C=true;d3_geom_voronoiRedBlackRotateLeft(this,sibling);sibling=parent.L}sibling.C=
parent.C;parent.C=sibling.L.C=false;d3_geom_voronoiRedBlackRotateRight(this,parent);node=this._;break}}sibling.C=true;node=parent;parent=parent.U}while(!node.C);if(node)node.C=false}};function d3_geom_voronoiRedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;if(parent)if(parent.L===p)parent.L=q;else parent.R=q;else tree._=q;q.U=parent;p.U=q;p.R=q.L;if(p.R)p.R.U=p;q.L=p}function d3_geom_voronoiRedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;if(parent)if(parent.L===p)parent.L=
q;else parent.R=q;else tree._=q;q.U=parent;p.U=q;p.L=q.R;if(p.L)p.L.U=p;q.R=p}function d3_geom_voronoiRedBlackFirst(node){while(node.L)node=node.L;return node}function d3_geom_voronoi(sites,bbox){var site=sites.sort(d3_geom_voronoiVertexOrder).pop(),x0,y0,circle;d3_geom_voronoiEdges=[];d3_geom_voronoiCells=new Array(sites.length);d3_geom_voronoiBeaches=new d3_geom_voronoiRedBlackTree;d3_geom_voronoiCircles=new d3_geom_voronoiRedBlackTree;while(true){circle=d3_geom_voronoiFirstCircle;if(site&&(!circle||
site.y<circle.y||site.y===circle.y&&site.x<circle.x)){if(site.x!==x0||site.y!==y0){d3_geom_voronoiCells[site.i]=new d3_geom_voronoiCell(site);d3_geom_voronoiAddBeach(site);x0=site.x,y0=site.y}site=sites.pop()}else if(circle)d3_geom_voronoiRemoveBeach(circle.arc);else break}if(bbox)d3_geom_voronoiClipEdges(bbox),d3_geom_voronoiCloseCells(bbox);var diagram={cells:d3_geom_voronoiCells,edges:d3_geom_voronoiEdges};d3_geom_voronoiBeaches=d3_geom_voronoiCircles=d3_geom_voronoiEdges=d3_geom_voronoiCells=
null;return diagram}function d3_geom_voronoiVertexOrder(a,b){return b.y-a.y||b.x-a.x}d3.geom.voronoi=function(points){var x=d3_geom_pointX,y=d3_geom_pointY,fx=x,fy=y,clipExtent=d3_geom_voronoiClipExtent;if(points)return voronoi(points);function voronoi(data){var polygons=new Array(data.length),x0=clipExtent[0][0],y0=clipExtent[0][1],x1=clipExtent[1][0],y1=clipExtent[1][1];d3_geom_voronoi(sites(data),clipExtent).cells.forEach(function(cell,i){var edges=cell.edges,site=cell.site,polygon=polygons[i]=
edges.length?edges.map(function(e){var s=e.start();return[s.x,s.y]}):site.x>=x0&&site.x<=x1&&site.y>=y0&&site.y<=y1?[[x0,y1],[x1,y1],[x1,y0],[x0,y0]]:[];polygon.point=data[i]});return polygons}function sites(data){return data.map(function(d,i){return{x:Math.round(fx(d,i)/\u03b5)*\u03b5,y:Math.round(fy(d,i)/\u03b5)*\u03b5,i:i}})}voronoi.links=function(data){return d3_geom_voronoi(sites(data)).edges.filter(function(edge){return edge.l&&edge.r}).map(function(edge){return{source:data[edge.l.i],target:data[edge.r.i]}})};
voronoi.triangles=function(data){var triangles=[];d3_geom_voronoi(sites(data)).cells.forEach(function(cell,i){var site=cell.site,edges=cell.edges.sort(d3_geom_voronoiHalfEdgeOrder),j=-1,m=edges.length,e0,s0,e1=edges[m-1].edge,s1=e1.l===site?e1.r:e1.l;while(++j<m){e0=e1;s0=s1;e1=edges[j].edge;s1=e1.l===site?e1.r:e1.l;if(i<s0.i&&i<s1.i&&d3_geom_voronoiTriangleArea(site,s0,s1)<0)triangles.push([data[i],data[s0.i],data[s1.i]])}});return triangles};voronoi.x=function(_){return arguments.length?(fx=d3_functor(x=
_),voronoi):x};voronoi.y=function(_){return arguments.length?(fy=d3_functor(y=_),voronoi):y};voronoi.clipExtent=function(_){if(!arguments.length)return clipExtent===d3_geom_voronoiClipExtent?null:clipExtent;clipExtent=_==null?d3_geom_voronoiClipExtent:_;return voronoi};voronoi.size=function(_){if(!arguments.length)return clipExtent===d3_geom_voronoiClipExtent?null:clipExtent&&clipExtent[1];return voronoi.clipExtent(_&&[[0,0],_])};return voronoi};var d3_geom_voronoiClipExtent=[[-1E6,-1E6],[1E6,1E6]];
function d3_geom_voronoiTriangleArea(a,b,c){return(a.x-c.x)*(b.y-a.y)-(a.x-b.x)*(c.y-a.y)}d3.geom.delaunay=function(vertices){return d3.geom.voronoi().triangles(vertices)};d3.geom.quadtree=function(points,x1,y1,x2,y2){var x=d3_geom_pointX,y=d3_geom_pointY,compat;if(compat=arguments.length){x=d3_geom_quadtreeCompatX;y=d3_geom_quadtreeCompatY;if(compat===3){y2=y1;x2=x1;y1=x1=0}return quadtree(points)}function quadtree(data){var d,fx=d3_functor(x),fy=d3_functor(y),xs,ys,i,n,x1_,y1_,x2_,y2_;if(x1!=null)x1_=
x1,y1_=y1,x2_=x2,y2_=y2;else{x2_=y2_=-(x1_=y1_=Infinity);xs=[],ys=[];n=data.length;if(compat)for(i=0;i<n;++i){d=data[i];if(d.x<x1_)x1_=d.x;if(d.y<y1_)y1_=d.y;if(d.x>x2_)x2_=d.x;if(d.y>y2_)y2_=d.y;xs.push(d.x);ys.push(d.y)}else for(i=0;i<n;++i){var x_=+fx(d=data[i],i),y_=+fy(d,i);if(x_<x1_)x1_=x_;if(y_<y1_)y1_=y_;if(x_>x2_)x2_=x_;if(y_>y2_)y2_=y_;xs.push(x_);ys.push(y_)}}var dx=x2_-x1_,dy=y2_-y1_;if(dx>dy)y2_=y1_+dx;else x2_=x1_+dy;function insert(n,d,x,y,x1,y1,x2,y2){if(isNaN(x)||isNaN(y))return;
if(n.leaf){var nx=n.x,ny=n.y;if(nx!=null)if(abs(nx-x)+abs(ny-y)<.01)insertChild(n,d,x,y,x1,y1,x2,y2);else{var nPoint=n.point;n.x=n.y=n.point=null;insertChild(n,nPoint,nx,ny,x1,y1,x2,y2);insertChild(n,d,x,y,x1,y1,x2,y2)}else n.x=x,n.y=y,n.point=d}else insertChild(n,d,x,y,x1,y1,x2,y2)}function insertChild(n,d,x,y,x1,y1,x2,y2){var xm=(x1+x2)*.5,ym=(y1+y2)*.5,right=x>=xm,below=y>=ym,i=below<<1|right;n.leaf=false;n=n.nodes[i]||(n.nodes[i]=d3_geom_quadtreeNode());if(right)x1=xm;else x2=xm;if(below)y1=ym;
else y2=ym;insert(n,d,x,y,x1,y1,x2,y2)}var root=d3_geom_quadtreeNode();root.add=function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)};root.visit=function(f){d3_geom_quadtreeVisit(f,root,x1_,y1_,x2_,y2_)};root.find=function(point){return d3_geom_quadtreeFind(root,point[0],point[1],x1_,y1_,x2_,y2_)};i=-1;if(x1==null){while(++i<n)insert(root,data[i],xs[i],ys[i],x1_,y1_,x2_,y2_);--i}else data.forEach(root.add);xs=ys=data=d=null;return root}quadtree.x=function(_){return arguments.length?(x=_,
quadtree):x};quadtree.y=function(_){return arguments.length?(y=_,quadtree):y};quadtree.extent=function(_){if(!arguments.length)return x1==null?null:[[x1,y1],[x2,y2]];if(_==null)x1=y1=x2=y2=null;else x1=+_[0][0],y1=+_[0][1],x2=+_[1][0],y2=+_[1][1];return quadtree};quadtree.size=function(_){if(!arguments.length)return x1==null?null:[x2-x1,y2-y1];if(_==null)x1=y1=x2=y2=null;else x1=y1=0,x2=+_[0],y2=+_[1];return quadtree};return quadtree};function d3_geom_quadtreeCompatX(d){return d.x}function d3_geom_quadtreeCompatY(d){return d.y}
function d3_geom_quadtreeNode(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=(x1+x2)*.5,sy=(y1+y2)*.5,children=node.nodes;if(children[0])d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy);if(children[1])d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy);if(children[2])d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2);if(children[3])d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}function d3_geom_quadtreeFind(root,
x,y,x0,y0,x3,y3){var minDistance2=Infinity,closestPoint;(function find(node,x1,y1,x2,y2){if(x1>x3||y1>y3||x2<x0||y2<y0)return;if(point=node.point){var point,dx=x-node.x,dy=y-node.y,distance2=dx*dx+dy*dy;if(distance2<minDistance2){var distance=Math.sqrt(minDistance2=distance2);x0=x-distance,y0=y-distance;x3=x+distance,y3=y+distance;closestPoint=point}}var children=node.nodes,xm=(x1+x2)*.5,ym=(y1+y2)*.5,right=x>=xm,below=y>=ym;for(var i=below<<1|right,j=i+4;i<j;++i)if(node=children[i&3])switch(i&3){case 0:find(node,
x1,y1,xm,ym);break;case 1:find(node,xm,y1,x2,ym);break;case 2:find(node,x1,ym,xm,y2);break;case 3:find(node,xm,ym,x2,y2);break}})(root,x0,y0,x3,y3);return closestPoint}d3.interpolateRgb=d3_interpolateRgb;function d3_interpolateRgb(a,b){a=d3.rgb(a);b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}}d3.interpolateObject=d3_interpolateObject;function d3_interpolateObject(a,
b){var i={},c={},k;for(k in a)if(k in b)i[k]=d3_interpolate(a[k],b[k]);else c[k]=a[k];for(k in b)if(!(k in a))c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}}d3.interpolateNumber=d3_interpolateNumber;function d3_interpolateNumber(a,b){a=+a,b=+b;return function(t){return a*(1-t)+b*t}}d3.interpolateString=d3_interpolateString;function d3_interpolateString(a,b){var bi=d3_interpolate_numberA.lastIndex=d3_interpolate_numberB.lastIndex=0,am,bm,bs,i=-1,s=[],q=[];a=a+"",b=b+"";while((am=d3_interpolate_numberA.exec(a))&&
(bm=d3_interpolate_numberB.exec(b))){if((bs=bm.index)>bi){bs=b.slice(bi,bs);if(s[i])s[i]+=bs;else s[++i]=bs}if((am=am[0])===(bm=bm[0]))if(s[i])s[i]+=bm;else s[++i]=bm;else{s[++i]=null;q.push({i:i,x:d3_interpolateNumber(am,bm)})}bi=d3_interpolate_numberB.lastIndex}if(bi<b.length){bs=b.slice(bi);if(s[i])s[i]+=bs;else s[++i]=bs}return s.length<2?q[0]?(b=q[0].x,function(t){return b(t)+""}):function(){return b}:(b=q.length,function(t){for(var i=0,o;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}var d3_interpolate_numberA=
/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,d3_interpolate_numberB=new RegExp(d3_interpolate_numberA.source,"g");d3.interpolate=d3_interpolate;function d3_interpolate(a,b){var i=d3.interpolators.length,f;while(--i>=0&&!(f=d3.interpolators[i](a,b)));return f}d3.interpolators=[function(a,b){var t=typeof b;return(t==="string"?d3_rgb_names.has(b.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(b)?d3_interpolateRgb:d3_interpolateString:b instanceof d3_color?d3_interpolateRgb:Array.isArray(b)?d3_interpolateArray:
t==="object"&&isNaN(b)?d3_interpolateObject:d3_interpolateNumber)(a,b)}];d3.interpolateArray=d3_interpolateArray;function d3_interpolateArray(a,b){var x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length),i;for(i=0;i<n0;++i)x.push(d3_interpolate(a[i],b[i]));for(;i<na;++i)c[i]=a[i];for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<n0;++i)c[i]=x[i](t);return c}}var d3_ease_default=function(){return d3_identity};var d3_ease=d3.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},
cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}});var d3_ease_mode=d3.map({"in":d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.slice(0,i):name,m=i>=0?name.slice(i+1):"in";t=d3_ease.get(t)||
d3_ease_default;m=d3_ease_mode.get(m)||d3_identity;return d3_ease_clamp(m(t.apply(null,d3_arraySlice.call(arguments,1))))};function d3_ease_clamp(f){return function(t){return t<=0?0:t>=1?1:f(t)}}function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return.5*(t<.5?f(2*t):2-f(2-2*t))}}function d3_ease_quad(t){return t*t}function d3_ease_cubic(t){return t*t*t}function d3_ease_cubicInOut(t){if(t<=0)return 0;if(t>=1)return 1;var t2=t*t,t3=t2*t;return 4*
(t<.5?t3:3*(t-t2)+t3-.75)}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(t){return 1-Math.cos(t*half\u03c0)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_elastic(a,p){var s;if(arguments.length<2)p=.45;if(arguments.length)s=p/\u03c4*Math.asin(1/a);else a=1,s=p/4;return function(t){return 1+a*Math.pow(2,-10*t)*Math.sin((t-s)*\u03c4/p)}}function d3_ease_back(s){if(!s)s=1.70158;return function(t){return t*
t*((s+1)*t-s)}}function d3_ease_bounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}d3.interpolateHcl=d3_interpolateHcl;function d3_interpolateHcl(a,b){a=d3.hcl(a);b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;if(isNaN(bc))bc=0,ac=isNaN(ac)?b.c:ac;if(isNaN(bh))bh=0,ah=isNaN(ah)?b.h:ah;else if(bh>180)bh-=360;else if(bh<-180)bh+=360;return function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,
al+bl*t)+""}}d3.interpolateHsl=d3_interpolateHsl;function d3_interpolateHsl(a,b){a=d3.hsl(a);b=d3.hsl(b);var ah=a.h,as=a.s,al=a.l,bh=b.h-ah,bs=b.s-as,bl=b.l-al;if(isNaN(bs))bs=0,as=isNaN(as)?b.s:as;if(isNaN(bh))bh=0,ah=isNaN(ah)?b.h:ah;else if(bh>180)bh-=360;else if(bh<-180)bh+=360;return function(t){return d3_hsl_rgb(ah+bh*t,as+bs*t,al+bl*t)+""}}d3.interpolateLab=d3_interpolateLab;function d3_interpolateLab(a,b){a=d3.lab(a);b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+
bl*t,aa+ba*t,ab+bb*t)+""}}d3.interpolateRound=d3_interpolateRound;function d3_interpolateRound(a,b){b-=a;return function(t){return Math.round(a+b*t)}}d3.transform=function(string){var g=d3_document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){if(string!=null){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate()}return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)};function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),
kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(d3_transformCombine(r1,r0,-kz))||0;if(r0[0]*r1[1]<r1[0]*r0[1]){r0[0]*=-1;r0[1]*=-1;kx*=-1;kz*=-1}this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_degrees;this.translate=[m.e,m.f];this.scale=[kx,ky];this.skew=ky?Math.atan2(kz,ky)*d3_degrees:0}d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function d3_transformDot(a,b){return a[0]*
b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));if(k){a[0]/=k;a[1]/=k}return k}function d3_transformCombine(a,b,k){a[0]+=k*b[0];a[1]+=k*b[1];return a}var d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolateTransform=d3_interpolateTransform;function d3_interpolateTransformPop(s){return s.length?s.pop()+",":""}function d3_interpolateTranslate(ta,tb,s,q){if(ta[0]!==tb[0]||ta[1]!==tb[1]){var i=s.push("translate(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ta[0],
tb[0])},{i:i-2,x:d3_interpolateNumber(ta[1],tb[1])})}else if(tb[0]||tb[1])s.push("translate("+tb+")")}function d3_interpolateRotate(ra,rb,s,q){if(ra!==rb){if(ra-rb>180)rb+=360;else if(rb-ra>180)ra+=360;q.push({i:s.push(d3_interpolateTransformPop(s)+"rotate(",null,")")-2,x:d3_interpolateNumber(ra,rb)})}else if(rb)s.push(d3_interpolateTransformPop(s)+"rotate("+rb+")")}function d3_interpolateSkew(wa,wb,s,q){if(wa!==wb)q.push({i:s.push(d3_interpolateTransformPop(s)+"skewX(",null,")")-2,x:d3_interpolateNumber(wa,
wb)});else if(wb)s.push(d3_interpolateTransformPop(s)+"skewX("+wb+")")}function d3_interpolateScale(ka,kb,s,q){if(ka[0]!==kb[0]||ka[1]!==kb[1]){var i=s.push(d3_interpolateTransformPop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:d3_interpolateNumber(ka[0],kb[0])},{i:i-2,x:d3_interpolateNumber(ka[1],kb[1])})}else if(kb[0]!==1||kb[1]!==1)s.push(d3_interpolateTransformPop(s)+"scale("+kb+")")}function d3_interpolateTransform(a,b){var s=[],q=[];a=d3.transform(a),b=d3.transform(b);d3_interpolateTranslate(a.translate,
b.translate,s,q);d3_interpolateRotate(a.rotate,b.rotate,s,q);d3_interpolateSkew(a.skew,b.skew,s,q);d3_interpolateScale(a.scale,b.scale,s,q);a=b=null;return function(t){var i=-1,n=q.length,o;while(++i<n)s[(o=q[i]).i]=o.x(t);return s.join("")}}function d3_uninterpolateNumber(a,b){b=(b-=a=+a)||1/b;return function(x){return(x-a)/b}}function d3_uninterpolateClamp(a,b){b=(b-=a=+a)||1/b;return function(x){return Math.max(0,Math.min(1,(x-a)/b))}}d3.layout={};d3.layout.bundle=function(){return function(links){var paths=
[],i=-1,n=links.length;while(++i<n)paths.push(d3_layout_bundlePath(links[i]));return paths}};function d3_layout_bundlePath(link){var start=link.source,end=link.target,lca=d3_layout_bundleLeastCommonAncestor(start,end),points=[start];while(start!==lca){start=start.parent;points.push(start)}var k=points.length;while(end!==lca){points.splice(k,0,end);end=end.parent}return points}function d3_layout_bundleAncestors(node){var ancestors=[],parent=node.parent;while(parent!=null){ancestors.push(node);node=
parent;parent=parent.parent}ancestors.push(node);return ancestors}function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b)return a;var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;while(aNode===bNode){sharedNode=aNode;aNode=aNodes.pop();bNode=bNodes.pop()}return sharedNode}d3.layout.chord=function(){var chord={},chords,groups,matrix,n,padding=0,sortGroups,sortSubgroups,sortChords;function relayout(){var subgroups=
{},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[],k,x,x0,i,j;chords=[];groups=[];k=0,i=-1;while(++i<n){x=0,j=-1;while(++j<n)x+=matrix[i][j];groupSums.push(x);subgroupIndex.push(d3.range(n));k+=x}if(sortGroups)groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])});if(sortSubgroups)subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})});k=(\u03c4-padding*n)/k;x=0,i=-1;while(++i<n){x0=x,j=-1;while(++j<n){var di=groupIndex[i],
dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:groupSums[di]};x+=padding}i=-1;while(++i<n){j=i-1;while(++j<n){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];if(source.value||target.value)chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}}if(sortChords)resort()}function resort(){chords.sort(function(a,b){return sortChords((a.source.value+
a.target.value)/2,(b.source.value+b.target.value)/2)})}chord.matrix=function(x){if(!arguments.length)return matrix;n=(matrix=x)&&matrix.length;chords=groups=null;return chord};chord.padding=function(x){if(!arguments.length)return padding;padding=x;chords=groups=null;return chord};chord.sortGroups=function(x){if(!arguments.length)return sortGroups;sortGroups=x;chords=groups=null;return chord};chord.sortSubgroups=function(x){if(!arguments.length)return sortSubgroups;sortSubgroups=x;chords=null;return chord};
chord.sortChords=function(x){if(!arguments.length)return sortChords;sortChords=x;if(chords)resort();return chord};chord.chords=function(){if(!chords)relayout();return chords};chord.groups=function(){if(!groups)relayout();return groups};return chord};d3.layout.force=function(){var force={},event=d3.dispatch("start","tick","end"),timer,size=[1,1],drag,alpha,friction=.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,chargeDistance2=d3_layout_forceChargeDistance2,
gravity=.1,theta2=.64,nodes=[],links=[],distances,strengths,charges;function repulse(node){return function(quad,x1,_,x2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dw=x2-x1,dn=dx*dx+dy*dy;if(dw*dw/theta2<dn){if(dn<chargeDistance2){var k=quad.charge/dn;node.px-=dx*k;node.py-=dy*k}return true}if(quad.point&&dn&&dn<chargeDistance2){var k=quad.pointCharge/dn;node.px-=dx*k;node.py-=dy*k}}return!quad.charge}}force.tick=function(){if((alpha*=.99)<.005){timer=null;event.end({type:"end",
alpha:alpha=0});return true}var n=nodes.length,m=links.length,q,i,o,s,t,l,k,x,y;for(i=0;i<m;++i){o=links[i];s=o.source;t=o.target;x=t.x-s.x;y=t.y-s.y;if(l=x*x+y*y){l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l;x*=l;y*=l;t.x-=x*(k=s.weight+t.weight?s.weight/(s.weight+t.weight):.5);t.y-=y*k;s.x+=x*(k=1-k);s.y+=y*k}}if(k=alpha*gravity){x=size[0]/2;y=size[1]/2;i=-1;if(k)while(++i<n){o=nodes[i];o.x+=(x-o.x)*k;o.y+=(y-o.y)*k}}if(charge){d3_layout_forceAccumulate(q=d3.geom.quadtree(nodes),alpha,
charges);i=-1;while(++i<n)if(!(o=nodes[i]).fixed)q.visit(repulse(o))}i=-1;while(++i<n){o=nodes[i];if(o.fixed){o.x=o.px;o.y=o.py}else{o.x-=(o.px-(o.px=o.x))*friction;o.y-=(o.py-(o.py=o.y))*friction}}event.tick({type:"tick",alpha:alpha})};force.nodes=function(x){if(!arguments.length)return nodes;nodes=x;return force};force.links=function(x){if(!arguments.length)return links;links=x;return force};force.size=function(x){if(!arguments.length)return size;size=x;return force};force.linkDistance=function(x){if(!arguments.length)return linkDistance;
linkDistance=typeof x==="function"?x:+x;return force};force.distance=force.linkDistance;force.linkStrength=function(x){if(!arguments.length)return linkStrength;linkStrength=typeof x==="function"?x:+x;return force};force.friction=function(x){if(!arguments.length)return friction;friction=+x;return force};force.charge=function(x){if(!arguments.length)return charge;charge=typeof x==="function"?x:+x;return force};force.chargeDistance=function(x){if(!arguments.length)return Math.sqrt(chargeDistance2);chargeDistance2=
x*x;return force};force.gravity=function(x){if(!arguments.length)return gravity;gravity=+x;return force};force.theta=function(x){if(!arguments.length)return Math.sqrt(theta2);theta2=x*x;return force};force.alpha=function(x){if(!arguments.length)return alpha;x=+x;if(alpha)if(x>0)alpha=x;else{timer.c=null,timer.t=NaN,timer=null;event.end({type:"end",alpha:alpha=0})}else if(x>0){event.start({type:"start",alpha:alpha=x});timer=d3_timer(force.tick)}return force};force.start=function(){var i,n=nodes.length,
m=links.length,w=size[0],h=size[1],neighbors,o;for(i=0;i<n;++i){(o=nodes[i]).index=i;o.weight=0}for(i=0;i<m;++i){o=links[i];if(typeof o.source=="number")o.source=nodes[o.source];if(typeof o.target=="number")o.target=nodes[o.target];++o.source.weight;++o.target.weight}for(i=0;i<n;++i){o=nodes[i];if(isNaN(o.x))o.x=position("x",w);if(isNaN(o.y))o.y=position("y",h);if(isNaN(o.px))o.px=o.x;if(isNaN(o.py))o.py=o.y}distances=[];if(typeof linkDistance==="function")for(i=0;i<m;++i)distances[i]=+linkDistance.call(this,
links[i],i);else for(i=0;i<m;++i)distances[i]=linkDistance;strengths=[];if(typeof linkStrength==="function")for(i=0;i<m;++i)strengths[i]=+linkStrength.call(this,links[i],i);else for(i=0;i<m;++i)strengths[i]=linkStrength;charges=[];if(typeof charge==="function")for(i=0;i<n;++i)charges[i]=+charge.call(this,nodes[i],i);else for(i=0;i<n;++i)charges[i]=charge;function position(dimension,size){if(!neighbors){neighbors=new Array(n);for(j=0;j<n;++j)neighbors[j]=[];for(j=0;j<m;++j){var o=links[j];neighbors[o.source.index].push(o.target);
neighbors[o.target.index].push(o.source)}}var candidates=neighbors[i],j=-1,l=candidates.length,x;while(++j<l)if(!isNaN(x=candidates[j][dimension]))return x;return Math.random()*size}return force.resume()};force.resume=function(){return force.alpha(.1)};force.stop=function(){return force.alpha(0)};force.drag=function(){if(!drag)drag=d3.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend);if(!arguments.length)return drag;
this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag)};function dragmove(d){d.px=d3.event.x,d.py=d3.event.y;force.resume()}return d3.rebind(force,event,"on")};function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=~6}function d3_layout_forceMouseover(d){d.fixed|=4;d.px=d.x,d.py=d.y}function d3_layout_forceMouseout(d){d.fixed&=~4}function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;quad.charge=
0;if(!quad.leaf){var nodes=quad.nodes,n=nodes.length,i=-1,c;while(++i<n){c=nodes[i];if(c==null)continue;d3_layout_forceAccumulate(c,alpha,charges);quad.charge+=c.charge;cx+=c.charge*c.cx;cy+=c.charge*c.cy}}if(quad.point){if(!quad.leaf){quad.point.x+=Math.random()-.5;quad.point.y+=Math.random()-.5}var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k;cx+=k*quad.point.x;cy+=k*quad.point.y}quad.cx=cx/quad.charge;quad.cy=cy/quad.charge}var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=
1,d3_layout_forceChargeDistance2=Infinity;d3.layout.hierarchy=function(){var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;function hierarchy(root){var stack=[root],nodes=[],node;root.depth=0;while((node=stack.pop())!=null){nodes.push(node);if((childs=children.call(hierarchy,node,node.depth))&&(n=childs.length)){var n,childs,child;while(--n>=0){stack.push(child=childs[n]);child.parent=node;child.depth=node.depth+1}if(value)node.value=0;node.children=
childs}else{if(value)node.value=+value.call(hierarchy,node,node.depth)||0;delete node.children}}d3_layout_hierarchyVisitAfter(root,function(node){var childs,parent;if(sort&&(childs=node.children))childs.sort(sort);if(value&&(parent=node.parent))parent.value+=node.value});return nodes}hierarchy.sort=function(x){if(!arguments.length)return sort;sort=x;return hierarchy};hierarchy.children=function(x){if(!arguments.length)return children;children=x;return hierarchy};hierarchy.value=function(x){if(!arguments.length)return value;
value=x;return hierarchy};hierarchy.revalue=function(root){if(value){d3_layout_hierarchyVisitBefore(root,function(node){if(node.children)node.value=0});d3_layout_hierarchyVisitAfter(root,function(node){var parent;if(!node.children)node.value=+value.call(hierarchy,node,node.depth)||0;if(parent=node.parent)parent.value+=node.value})}return root};return hierarchy};function d3_layout_hierarchyRebind(object,hierarchy){d3.rebind(object,hierarchy,"sort","children","value");object.nodes=object;object.links=
d3_layout_hierarchyLinks;return object}function d3_layout_hierarchyVisitBefore(node,callback){var nodes=[node];while((node=nodes.pop())!=null){callback(node);if((children=node.children)&&(n=children.length)){var n,children;while(--n>=0)nodes.push(children[n])}}}function d3_layout_hierarchyVisitAfter(node,callback){var nodes=[node],nodes2=[];while((node=nodes.pop())!=null){nodes2.push(node);if((children=node.children)&&(n=children.length)){var i=-1,n,children;while(++i<n)nodes.push(children[i])}}while((node=
nodes2.pop())!=null)callback(node)}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map(function(parent){return(parent.children||[]).map(function(child){return{source:parent,target:child}})}))}d3.layout.partition=function(){var hierarchy=d3.layout.hierarchy(),size=[1,1];function position(node,x,dx,dy){var children=
node.children;node.x=x;node.y=node.depth*dy;node.dx=dx;node.dy=dy;if(children&&(n=children.length)){var i=-1,n,c,d;dx=node.value?dx/node.value:0;while(++i<n){position(c=children[i],x,d=c.value*dx,dy);x+=d}}}function depth(node){var children=node.children,d=0;if(children&&(n=children.length)){var i=-1,n;while(++i<n)d=Math.max(d,depth(children[i]))}return 1+d}function partition(d,i){var nodes=hierarchy.call(this,d,i);position(nodes[0],0,size[0],size[1]/depth(nodes[0]));return nodes}partition.size=function(x){if(!arguments.length)return size;
size=x;return partition};return d3_layout_hierarchyRebind(partition,hierarchy)};d3.layout.pie=function(){var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=\u03c4,padAngle=0;function pie(data){var n=data.length,values=data.map(function(d,i){return+value.call(pie,d,i)}),a=+(typeof startAngle==="function"?startAngle.apply(this,arguments):startAngle),da=(typeof endAngle==="function"?endAngle.apply(this,arguments):endAngle)-a,p=Math.min(Math.abs(da)/n,+(typeof padAngle==="function"?
padAngle.apply(this,arguments):padAngle)),pa=p*(da<0?-1:1),sum=d3.sum(values),k=sum?(da-n*pa)/sum:0,index=d3.range(n),arcs=[],v;if(sort!=null)index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])});index.forEach(function(i){arcs[i]={data:data[i],value:v=values[i],startAngle:a,endAngle:a+=v*k+pa,padAngle:p}});return arcs}pie.value=function(_){if(!arguments.length)return value;value=_;return pie};pie.sort=function(_){if(!arguments.length)return sort;
sort=_;return pie};pie.startAngle=function(_){if(!arguments.length)return startAngle;startAngle=_;return pie};pie.endAngle=function(_){if(!arguments.length)return endAngle;endAngle=_;return pie};pie.padAngle=function(_){if(!arguments.length)return padAngle;padAngle=_;return pie};return pie};var d3_layout_pieSortByValue={};d3.layout.stack=function(){var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;
function stack(data,index){if(!(n=data.length))return data;var series=data.map(function(d,i){return values.call(stack,d,i)});var points=series.map(function(d){return d.map(function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]})});var orders=order.call(stack,points,index);series=d3.permute(series,orders);points=d3.permute(points,orders);var offsets=offset.call(stack,points,index);var m=series[0].length,n,i,j,o;for(j=0;j<m;++j){out.call(stack,series[0][j],o=offsets[j],points[0][j][1]);for(i=1;i<
n;++i)out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1])}return data}stack.values=function(x){if(!arguments.length)return values;values=x;return stack};stack.order=function(x){if(!arguments.length)return order;order=typeof x==="function"?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault;return stack};stack.offset=function(x){if(!arguments.length)return offset;offset=typeof x==="function"?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero;return stack};stack.x=function(z){if(!arguments.length)return x;
x=z;return stack};stack.y=function(z){if(!arguments.length)return y;y=z;return stack};stack.out=function(z){if(!arguments.length)return out;out=z;return stack};return stack};function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0;d.y=y}var d3_layout_stackOrders=d3.map({"inside-out":function(data){var n=data.length,i,j,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort(function(a,b){return max[a]-
max[b]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i){j=index[i];if(top<bottom){top+=sums[j];tops.push(j)}else{bottom+=sums[j];bottoms.push(j)}}return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},"default":d3_layout_stackOrderDefault});var d3_layout_stackOffsets=d3.map({silhouette:function(data){var n=data.length,m=data[0].length,sums=[],max=0,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];if(o>max)max=o;sums.push(o)}for(j=
0;j<m;++j)y0[j]=(max-sums[j])/2;return y0},wiggle:function(data){var n=data.length,x=data[0],m=x.length,i,j,k,s1,s2,s3,dx,o,o0,y0=[];y0[0]=o=o0=0;for(j=1;j<m;++j){for(i=0,s1=0;i<n;++i)s1+=data[i][j][1];for(i=0,s2=0,dx=x[j][0]-x[j-1][0];i<n;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);k<i;++k)s3+=(data[k][j][1]-data[k][j-1][1])/dx;s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0;if(o<o0)o0=o}for(j=0;j<m;++j)y0[j]-=o0;return y0},expand:function(data){var n=data.length,m=data[0].length,k=1/n,i,
j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++)o+=data[i][j][1];if(o)for(i=0;i<n;i++)data[i][j][1]/=o;else for(i=0;i<n;i++)data[i][j][1]=k}for(j=0;j<m;++j)y0[j]=0;return y0},zero:d3_layout_stackOffsetZero});function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){var j=-1,m=data[0].length,y0=[];while(++j<m)y0[j]=0;return y0}function d3_layout_stackMaxIndex(array){var i=1,j=0,v=array[0][1],k,n=array.length;for(;i<n;++i)if((k=array[i][1])>v){j=
i;v=k}return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}d3.layout.histogram=function(){var frequency=true,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;function histogram(data,i){var bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),bin,i=-1,n=values.length,m=thresholds.length-1,k=frequency?1:1/n,x;while(++i<m){bin=bins[i]=
[];bin.dx=thresholds[i+1]-(bin.x=thresholds[i]);bin.y=0}if(m>0){i=-1;while(++i<n){x=values[i];if(x>=range[0]&&x<=range[1]){bin=bins[d3.bisect(thresholds,x,1,m)-1];bin.y+=k;bin.push(data[i])}}}return bins}histogram.value=function(x){if(!arguments.length)return valuer;valuer=x;return histogram};histogram.range=function(x){if(!arguments.length)return ranger;ranger=d3_functor(x);return histogram};histogram.bins=function(x){if(!arguments.length)return binner;binner=typeof x==="number"?function(range){return d3_layout_histogramBinFixed(range,
x)}:d3_functor(x);return histogram};histogram.frequency=function(x){if(!arguments.length)return frequency;frequency=!!x;return histogram};return histogram};function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];while(++x<=n)f[x]=m*x+b;return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}d3.layout.pack=
function(){var hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1],radius;function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],w=size[0],h=size[1],r=radius==null?Math.sqrt:typeof radius==="function"?radius:function(){return radius};root.x=root.y=0;d3_layout_hierarchyVisitAfter(root,function(d){d.r=+r(d.value)});d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings);if(padding){var dr=padding*(radius?1:Math.max(2*root.r/w,2*root.r/h))/2;d3_layout_hierarchyVisitAfter(root,
function(d){d.r+=dr});d3_layout_hierarchyVisitAfter(root,d3_layout_packSiblings);d3_layout_hierarchyVisitAfter(root,function(d){d.r-=dr})}d3_layout_packTransform(root,w/2,h/2,radius?1:1/Math.max(2*root.r/w,2*root.r/h));return nodes}pack.size=function(_){if(!arguments.length)return size;size=_;return pack};pack.radius=function(_){if(!arguments.length)return radius;radius=_==null||typeof _==="function"?_:+_;return pack};pack.padding=function(_){if(!arguments.length)return padding;padding=+_;return pack};
return d3_layout_hierarchyRebind(pack,hierarchy)};function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b;b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return.999*dr*dr>dx*dx+dy*dy}function d3_layout_packSiblings(node){if(!(nodes=node.children)||!(n=nodes.length))return;var nodes,xMin=Infinity,
xMax=-Infinity,yMin=Infinity,yMax=-Infinity,a,b,c,i,j,k,n;function bound(node){xMin=Math.min(node.x-node.r,xMin);xMax=Math.max(node.x+node.r,xMax);yMin=Math.min(node.y-node.r,yMin);yMax=Math.max(node.y+node.r,yMax)}nodes.forEach(d3_layout_packLink);a=nodes[0];a.x=-a.r;a.y=0;bound(a);if(n>1){b=nodes[1];b.x=b.r;b.y=0;bound(b);if(n>2){c=nodes[2];d3_layout_packPlace(a,b,c);bound(c);d3_layout_packInsert(a,c);a._pack_prev=c;d3_layout_packInsert(c,b);b=a._pack_next;for(i=3;i<n;i++){d3_layout_packPlace(a,
b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++)if(d3_layout_packIntersects(j,c)){isect=1;break}if(isect==1)for(k=a._pack_prev;k!==j._pack_prev;k=k._pack_prev,s2++)if(d3_layout_packIntersects(k,c))break;if(isect){if(s1<s2||s1==s2&&b.r<a.r)d3_layout_packSplice(a,b=j);else d3_layout_packSplice(a=k,b);i--}else{d3_layout_packInsert(a,c);b=c;bound(c)}}}}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;i<n;i++){c=nodes[i];c.x-=cx;c.y-=cy;cr=Math.max(cr,c.r+Math.sqrt(c.x*
c.x+c.y*c.y))}node.r=cr;nodes.forEach(d3_layout_packUnlink)}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next;delete node._pack_prev}function d3_layout_packTransform(node,x,y,k){var children=node.children;node.x=x+=k*node.x;node.y=y+=k*node.y;node.r*=k;if(children){var i=-1,n=children.length;while(++i<n)d3_layout_packTransform(children[i],x,y,k)}}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;
if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy;da*=da;db*=db;var x=.5+(db-da)/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy;c.y=a.y+x*dy-y*dx}else{c.x=a.x+db;c.y=a.y}}d3.layout.tree=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=null;function tree(d,i){var nodes=hierarchy.call(this,d,i),root0=nodes[0],root1=wrapTree(root0);d3_layout_hierarchyVisitAfter(root1,firstWalk),root1.parent.m=
-root1.z;d3_layout_hierarchyVisitBefore(root1,secondWalk);if(nodeSize)d3_layout_hierarchyVisitBefore(root0,sizeNode);else{var left=root0,right=root0,bottom=root0;d3_layout_hierarchyVisitBefore(root0,function(node){if(node.x<left.x)left=node;if(node.x>right.x)right=node;if(node.depth>bottom.depth)bottom=node});var tx=separation(left,right)/2-left.x,kx=size[0]/(right.x+separation(right,left)/2+tx),ky=size[1]/(bottom.depth||1);d3_layout_hierarchyVisitBefore(root0,function(node){node.x=(node.x+tx)*kx;
node.y=node.depth*ky})}return nodes}function wrapTree(root0){var root1={A:null,children:[root0]},queue=[root1],node1;while((node1=queue.pop())!=null)for(var children=node1.children,child,i=0,n=children.length;i<n;++i)queue.push((children[i]=child={_:children[i],parent:node1,children:(child=children[i].children)&&child.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:i}).a=child);return root1.children[0]}function firstWalk(v){var children=v.children,siblings=v.parent.children,w=v.i?siblings[v.i-
1]:null;if(children.length){d3_layout_treeShift(v);var midpoint=(children[0].z+children[children.length-1].z)/2;if(w){v.z=w.z+separation(v._,w._);v.m=v.z-midpoint}else v.z=midpoint}else if(w)v.z=w.z+separation(v._,w._);v.parent.A=apportion(v,w,v.parent.A||siblings[0])}function secondWalk(v){v._.x=v.z+v.parent.m;v.m+=v.parent.m}function apportion(v,w,ancestor){if(w){var vip=v,vop=v,vim=w,vom=vip.parent.children[0],sip=vip.m,sop=vop.m,sim=vim.m,som=vom.m,shift;while(vim=d3_layout_treeRight(vim),vip=
d3_layout_treeLeft(vip),vim&&vip){vom=d3_layout_treeLeft(vom);vop=d3_layout_treeRight(vop);vop.a=v;shift=vim.z+sim-vip.z-sip+separation(vim._,vip._);if(shift>0){d3_layout_treeMove(d3_layout_treeAncestor(vim,v,ancestor),v,shift);sip+=shift;sop+=shift}sim+=vim.m;sip+=vip.m;som+=vom.m;sop+=vop.m}if(vim&&!d3_layout_treeRight(vop)){vop.t=vim;vop.m+=sim-sop}if(vip&&!d3_layout_treeLeft(vom)){vom.t=vip;vom.m+=sip-som;ancestor=v}}return ancestor}function sizeNode(node){node.x*=size[0];node.y=node.depth*size[1]}
tree.separation=function(x){if(!arguments.length)return separation;separation=x;return tree};tree.size=function(x){if(!arguments.length)return nodeSize?null:size;nodeSize=(size=x)==null?sizeNode:null;return tree};tree.nodeSize=function(x){if(!arguments.length)return nodeSize?size:null;nodeSize=(size=x)==null?null:sizeNode;return tree};return d3_layout_hierarchyRebind(tree,hierarchy)};function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(v){var children=v.children;
return children.length?children[0]:v.t}function d3_layout_treeRight(v){var children=v.children,n;return(n=children.length)?children[n-1]:v.t}function d3_layout_treeMove(wm,wp,shift){var change=shift/(wp.i-wm.i);wp.c-=change;wp.s+=shift;wm.c+=change;wp.z+=shift;wp.m+=shift}function d3_layout_treeShift(v){var shift=0,change=0,children=v.children,i=children.length,w;while(--i>=0){w=children[i];w.z+=shift;w.m+=shift;shift+=w.s+(change+=w.c)}}function d3_layout_treeAncestor(vim,v,ancestor){return vim.a.parent===
v.parent?vim.a:ancestor}d3.layout.cluster=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1],nodeSize=false;function cluster(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],previousNode,x=0;d3_layout_hierarchyVisitAfter(root,function(node){var children=node.children;if(children&&children.length){node.x=d3_layout_clusterX(children);node.y=d3_layout_clusterY(children)}else{node.x=previousNode?x+=separation(node,previousNode):0;
node.y=0;previousNode=node}});var left=d3_layout_clusterLeft(root),right=d3_layout_clusterRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;d3_layout_hierarchyVisitAfter(root,nodeSize?function(node){node.x=(node.x-root.x)*size[0];node.y=(root.y-node.y)*size[1]}:function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=(1-(root.y?node.y/root.y:1))*size[1]});return nodes}cluster.separation=function(x){if(!arguments.length)return separation;separation=x;return cluster};
cluster.size=function(x){if(!arguments.length)return nodeSize?null:size;nodeSize=(size=x)==null;return cluster};cluster.nodeSize=function(x){if(!arguments.length)return nodeSize?size:null;nodeSize=(size=x)!=null;return cluster};return d3_layout_hierarchyRebind(cluster,hierarchy)};function d3_layout_clusterY(children){return 1+d3.max(children,function(child){return child.y})}function d3_layout_clusterX(children){return children.reduce(function(x,child){return x+child.x},0)/children.length}function d3_layout_clusterLeft(node){var children=
node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}function d3_layout_clusterRight(node){var children=node.children,n;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}d3.layout.treemap=function(){var hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=false,stickies,mode="squarify",ratio=.5*(1+Math.sqrt(5));function scale(children,k){var i=-1,n=children.length,child,area;while(++i<
n){area=(child=children[i]).value*(k<0?0:k);child.area=isNaN(area)||area<=0?0:area}}function squarify(node){var children=node.children;if(children&&children.length){var rect=pad(node),row=[],remaining=children.slice(),child,best=Infinity,score,u=mode==="slice"?rect.dx:mode==="dice"?rect.dy:mode==="slice-dice"?node.depth&1?rect.dy:rect.dx:Math.min(rect.dx,rect.dy),n;scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while((n=remaining.length)>0){row.push(child=remaining[n-1]);row.area+=child.area;
if(mode!=="squarify"||(score=worst(row,u))<=best){remaining.pop();best=score}else{row.area-=row.pop().area;position(row,u,rect,false);u=Math.min(rect.dx,rect.dy);row.length=row.area=0;best=Infinity}}if(row.length){position(row,u,rect,true);row.length=row.area=0}children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var rect=pad(node),remaining=children.slice(),child,row=[];scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while(child=remaining.pop()){row.push(child);
row.area+=child.area;if(child.z!=null){position(row,child.z?rect.dx:rect.dy,rect,!remaining.length);row.length=row.area=0}}children.forEach(stickify)}}function worst(row,u){var s=row.area,r,rmax=0,rmin=Infinity,i=-1,n=row.length;while(++i<n){if(!(r=row[i].area))continue;if(r<rmin)rmin=r;if(r>rmax)rmax=r}s*=s;u*=u;return s?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):Infinity}function position(row,u,rect,flush){var i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0,o;if(u==rect.dx){if(flush||
v>rect.dy)v=rect.dy;while(++i<n){o=row[i];o.x=x;o.y=y;o.dy=v;x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0)}o.z=true;o.dx+=rect.x+rect.dx-x;rect.y+=v;rect.dy-=v}else{if(flush||v>rect.dx)v=rect.dx;while(++i<n){o=row[i];o.x=x;o.y=y;o.dx=v;y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0)}o.z=false;o.dy+=rect.y+rect.dy-y;rect.x+=v;rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];root.x=root.y=0;if(root.value)root.dx=size[0],root.dy=size[1];else root.dx=root.dy=
0;if(stickies)hierarchy.revalue(root);scale([root],root.dx*root.dy/root.value);(stickies?stickify:squarify)(root);if(sticky)stickies=nodes;return nodes}treemap.size=function(x){if(!arguments.length)return size;size=x;return treemap};treemap.padding=function(x){if(!arguments.length)return padding;function padFunction(node){var p=x.call(treemap,node,node.depth);return p==null?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,typeof p==="number"?[p,p,p,p]:p)}function padConstant(node){return d3_layout_treemapPad(node,
x)}var type;pad=(padding=x)==null?d3_layout_treemapPadNull:(type=typeof x)==="function"?padFunction:type==="number"?(x=[x,x,x,x],padConstant):padConstant;return treemap};treemap.round=function(x){if(!arguments.length)return round!=Number;round=x?Math.round:Number;return treemap};treemap.sticky=function(x){if(!arguments.length)return sticky;sticky=x;stickies=null;return treemap};treemap.ratio=function(x){if(!arguments.length)return ratio;ratio=x;return treemap};treemap.mode=function(x){if(!arguments.length)return mode;
mode=x+"";return treemap};return d3_layout_hierarchyRebind(treemap,hierarchy)};function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];if(dx<0){x+=dx/2;dx=0}if(dy<0){y+=dy/2;dy=0}return{x:x,y:y,dx:dx,dy:dy}}d3.random={normal:function(\u00b5,\u03c3){var n=arguments.length;if(n<2)\u03c3=1;if(n<1)\u00b5=0;return function(){var x,
y,r;do{x=Math.random()*2-1;y=Math.random()*2-1;r=x*x+y*y}while(!r||r>1);return \u00b5+\u03c3*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var random=d3.random.normal.apply(d3,arguments);return function(){return Math.exp(random())}},bates:function(m){var random=d3.random.irwinHall(m);return function(){return random()/m}},irwinHall:function(m){return function(){for(var s=0,j=0;j<m;j++)s+=Math.random();return s}}};d3.scale={};function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-
1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_nice(domain,nice){var i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1],dx;if(x1<x0){dx=i0,i0=i1,i1=dx;dx=x0,x0=x1,x1=dx}domain[i0]=nice.floor(x0);domain[i1]=
nice.ceil(x1);return domain}function d3_scale_niceStep(step){return step?{floor:function(x){return Math.floor(x/step)*step},ceil:function(x){return Math.ceil(x/step)*step}}:d3_scale_niceIdentity}var d3_scale_niceIdentity={floor:d3_identity,ceil:d3_identity};function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;if(domain[k]<domain[0]){domain=domain.slice().reverse();range=range.slice().reverse()}while(++j<=k){u.push(uninterpolate(domain[j-
1],domain[j]));i.push(interpolate(range[j-1],range[j]))}return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}d3.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,false)};function d3_scale_linear(domain,range,interpolate,clamp){var output,input;function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;output=linear(domain,range,uninterpolate,
interpolate);input=linear(range,domain,uninterpolate,d3_interpolate);return scale}function scale(x){return output(x)}scale.invert=function(y){return input(y)};scale.domain=function(x){if(!arguments.length)return domain;domain=x.map(Number);return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.rangeRound=function(x){return scale.range(x).interpolate(d3_interpolateRound)};scale.clamp=function(x){if(!arguments.length)return clamp;clamp=x;return rescale()};
scale.interpolate=function(x){if(!arguments.length)return interpolate;interpolate=x;return rescale()};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(m){d3_scale_linearNice(domain,m);return rescale()};scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)};return rescale()}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range",
"rangeRound","interpolate","clamp")}function d3_scale_linearNice(domain,m){d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2]));d3_scale_nice(domain,d3_scale_niceStep(d3_scale_linearTickRange(domain,m)[2]));return domain}function d3_scale_linearTickRange(domain,m){if(m==null)m=10;var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;if(err<=.15)step*=10;else if(err<=.35)step*=5;else if(err<=.75)step*=
2;extent[0]=Math.ceil(extent[0]/step)*step;extent[1]=Math.floor(extent[1]/step)*step+step*.5;extent[2]=step;return extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m,format){var range=d3_scale_linearTickRange(domain,m);if(format){var match=d3_format_re.exec(format);match.shift();if(match[8]==="s"){var prefix=d3.formatPrefix(Math.max(abs(range[0]),abs(range[1])));if(!match[7])match[7]="."+d3_scale_linearPrecision(prefix.scale(range[2]));
match[8]="f";format=d3.format(match.join(""));return function(d){return format(prefix.scale(d))+prefix.symbol}}if(!match[7])match[7]="."+d3_scale_linearFormatPrecision(match[8],range);format=match.join("")}else format=",."+d3_scale_linearPrecision(range[2])+"f";return d3.format(format)}var d3_scale_linearFormatSignificant={s:1,g:1,p:1,r:1,e:1};function d3_scale_linearPrecision(value){return-Math.floor(Math.log(value)/Math.LN10+.01)}function d3_scale_linearFormatPrecision(type,range){var p=d3_scale_linearPrecision(range[2]);
return type in d3_scale_linearFormatSignificant?Math.abs(p-d3_scale_linearPrecision(Math.max(abs(range[0]),abs(range[1]))))+ +(type!=="e"):p-(type==="%")*2}d3.scale.log=function(){return d3_scale_log(d3.scale.linear().domain([0,1]),10,true,[1,10])};function d3_scale_log(linear,base,positive,domain){function log(x){return(positive?Math.log(x<0?0:x):-Math.log(x>0?0:-x))/Math.log(base)}function pow(x){return positive?Math.pow(base,x):-Math.pow(base,-x)}function scale(x){return linear(log(x))}scale.invert=
function(x){return pow(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return domain;positive=x[0]>=0;linear.domain((domain=x.map(Number)).map(log));return scale};scale.base=function(_){if(!arguments.length)return base;base=+_;linear.domain(domain.map(log));return scale};scale.nice=function(){var niced=d3_scale_nice(domain.map(log),positive?Math:d3_scale_logNiceNegative);linear.domain(niced);domain=niced.map(pow);return scale};scale.ticks=function(){var extent=d3_scaleExtent(domain),
ticks=[],u=extent[0],v=extent[1],i=Math.floor(log(u)),j=Math.ceil(log(v)),n=base%1?2:base;if(isFinite(j-i)){if(positive){for(;i<j;i++)for(var k=1;k<n;k++)ticks.push(pow(i)*k);ticks.push(pow(i))}else{ticks.push(pow(i));for(;i++<j;)for(var k=n-1;k>0;k--)ticks.push(pow(i)*k)}for(i=0;ticks[i]<u;i++);for(j=ticks.length;ticks[j-1]>v;j--);ticks=ticks.slice(i,j)}return ticks};scale.tickFormat=function(n,format){if(!arguments.length)return d3_scale_logFormat;if(arguments.length<2)format=d3_scale_logFormat;
else if(typeof format!=="function")format=d3.format(format);var k=Math.max(1,base*n/scale.ticks().length);return function(d){var i=d/pow(Math.round(log(d)));if(i*base<base-.5)i*=base;return i<=k?format(d):""}};scale.copy=function(){return d3_scale_log(linear.copy(),base,positive,domain)};return d3_scale_linearRebind(scale,linear)}var d3_scale_logFormat=d3.format(".0e"),d3_scale_logNiceNegative={floor:function(x){return-Math.ceil(-x)},ceil:function(x){return-Math.floor(-x)}};d3.scale.pow=function(){return d3_scale_pow(d3.scale.linear(),
1,[0,1])};function d3_scale_pow(linear,exponent,domain){var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);function scale(x){return linear(powp(x))}scale.invert=function(x){return powb(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return domain;linear.domain((domain=x.map(Number)).map(powp));return scale};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=
function(m){return scale.domain(d3_scale_linearNice(domain,m))};scale.exponent=function(x){if(!arguments.length)return exponent;powp=d3_scale_powPow(exponent=x);powb=d3_scale_powPow(1/exponent);linear.domain(domain.map(powp));return scale};scale.copy=function(){return d3_scale_pow(linear.copy(),exponent,domain)};return d3_scale_linearRebind(scale,linear)}function d3_scale_powPow(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)};
d3.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})};function d3_scale_ordinal(domain,ranger){var index,range,rangeBand;function scale(x){return range[((index.get(x)||(ranger.t==="range"?index.set(x,domain.push(x)):NaN))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map(function(i){return start+step*i})}scale.domain=function(x){if(!arguments.length)return domain;domain=[];index=new d3_Map;var i=-1,n=x.length,xi;while(++i<n)if(!index.has(xi=x[i]))index.set(xi,
domain.push(xi));return scale[ranger.t].apply(scale,ranger.a)};scale.range=function(x){if(!arguments.length)return range;range=x;rangeBand=0;ranger={t:"range",a:arguments};return scale};scale.rangePoints=function(x,padding){if(arguments.length<2)padding=0;var start=x[0],stop=x[1],step=domain.length<2?(start=(start+stop)/2,0):(stop-start)/(domain.length-1+padding);range=steps(start+step*padding/2,step);rangeBand=0;ranger={t:"rangePoints",a:arguments};return scale};scale.rangeRoundPoints=function(x,
padding){if(arguments.length<2)padding=0;var start=x[0],stop=x[1],step=domain.length<2?(start=stop=Math.round((start+stop)/2),0):(stop-start)/(domain.length-1+padding)|0;range=steps(start+Math.round(step*padding/2+(stop-start-(domain.length-1+padding)*step)/2),step);rangeBand=0;ranger={t:"rangeRoundPoints",a:arguments};return scale};scale.rangeBands=function(x,padding,outerPadding){if(arguments.length<2)padding=0;if(arguments.length<3)outerPadding=padding;var reverse=x[1]<x[0],start=x[reverse-0],
stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);range=steps(start+step*outerPadding,step);if(reverse)range.reverse();rangeBand=step*(1-padding);ranger={t:"rangeBands",a:arguments};return scale};scale.rangeRoundBands=function(x,padding,outerPadding){if(arguments.length<2)padding=0;if(arguments.length<3)outerPadding=padding;var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding));range=steps(start+Math.round((stop-
start-(domain.length-padding)*step)/2),step);if(reverse)range.reverse();rangeBand=Math.round(step*(1-padding));ranger={t:"rangeRoundBands",a:arguments};return scale};scale.rangeBand=function(){return rangeBand};scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])};scale.copy=function(){return d3_scale_ordinal(domain,ranger)};return scale.domain(domain)}d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)};d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)};
d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)};d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(d3_rgbString);var d3_category20=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(d3_rgbString);var d3_category20b=
[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(d3_rgbString);var d3_category20c=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(d3_rgbString);d3.scale.quantile=function(){return d3_scale_quantile([],[])};function d3_scale_quantile(domain,range){var thresholds;
function rescale(){var k=0,q=range.length;thresholds=[];while(++k<q)thresholds[k-1]=d3.quantile(domain,k/q);return scale}function scale(x){if(!isNaN(x=+x))return range[d3.bisect(thresholds,x)]}scale.domain=function(x){if(!arguments.length)return domain;domain=x.map(d3_number).filter(d3_numeric).sort(d3_ascending);return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.quantiles=function(){return thresholds};scale.invertExtent=function(y){y=range.indexOf(y);
return y<0?[NaN,NaN]:[y>0?thresholds[y-1]:domain[0],y<thresholds.length?thresholds[y]:domain[domain.length-1]]};scale.copy=function(){return d3_scale_quantile(domain,range)};return rescale()}d3.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])};function d3_scale_quantize(x0,x1,range){var kx,i;function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){kx=range.length/(x1-x0);i=range.length-1;return scale}scale.domain=function(x){if(!arguments.length)return[x0,
x1];x0=+x[0];x1=+x[x.length-1];return rescale()};scale.range=function(x){if(!arguments.length)return range;range=x;return rescale()};scale.invertExtent=function(y){y=range.indexOf(y);y=y<0?NaN:y/kx+x0;return[y,y+1/kx]};scale.copy=function(){return d3_scale_quantize(x0,x1,range)};return rescale()}d3.scale.threshold=function(){return d3_scale_threshold([.5],[0,1])};function d3_scale_threshold(domain,range){function scale(x){if(x<=x)return range[d3.bisect(domain,x)]}scale.domain=function(_){if(!arguments.length)return domain;
domain=_;return scale};scale.range=function(_){if(!arguments.length)return range;range=_;return scale};scale.invertExtent=function(y){y=range.indexOf(y);return[domain[y-1],domain[y]]};scale.copy=function(){return d3_scale_threshold(domain,range)};return scale}d3.scale.identity=function(){return d3_scale_identity([0,1])};function d3_scale_identity(domain){function identity(x){return+x}identity.invert=identity;identity.domain=identity.range=function(x){if(!arguments.length)return domain;domain=x.map(identity);
return identity};identity.ticks=function(m){return d3_scale_linearTicks(domain,m)};identity.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};identity.copy=function(){return d3_scale_identity(domain)};return identity}d3.svg={};function d3_zero(){return 0}d3.svg.arc=function(){var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,cornerRadius=d3_zero,padRadius=d3_svg_arcAuto,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle,padAngle=d3_svg_arcPadAngle;
function arc(){var r0=Math.max(0,+innerRadius.apply(this,arguments)),r1=Math.max(0,+outerRadius.apply(this,arguments)),a0=startAngle.apply(this,arguments)-half\u03c0,a1=endAngle.apply(this,arguments)-half\u03c0,da=Math.abs(a1-a0),cw=a0>a1?0:1;if(r1<r0)rc=r1,r1=r0,r0=rc;if(da>=\u03c4\u03b5)return circleSegment(r1,cw)+(r0?circleSegment(r0,1-cw):"")+"Z";var rc,cr,rp,ap,p0=0,p1=0,x0,y0,x1,y1,x2,y2,x3,y3,path=[];if(ap=(+padAngle.apply(this,arguments)||0)/2){rp=padRadius===d3_svg_arcAuto?Math.sqrt(r0*r0+
r1*r1):+padRadius.apply(this,arguments);if(!cw)p1*=-1;if(r1)p1=d3_asin(rp/r1*Math.sin(ap));if(r0)p0=d3_asin(rp/r0*Math.sin(ap))}if(r1){x0=r1*Math.cos(a0+p1);y0=r1*Math.sin(a0+p1);x1=r1*Math.cos(a1-p1);y1=r1*Math.sin(a1-p1);var l1=Math.abs(a1-a0-2*p1)<=\u03c0?0:1;if(p1&&d3_svg_arcSweep(x0,y0,x1,y1)===cw^l1){var h1=(a0+a1)/2;x0=r1*Math.cos(h1);y0=r1*Math.sin(h1);x1=y1=null}}else x0=y0=0;if(r0){x2=r0*Math.cos(a1-p0);y2=r0*Math.sin(a1-p0);x3=r0*Math.cos(a0+p0);y3=r0*Math.sin(a0+p0);var l0=Math.abs(a0-
a1+2*p0)<=\u03c0?0:1;if(p0&&d3_svg_arcSweep(x2,y2,x3,y3)===1-cw^l0){var h0=(a0+a1)/2;x2=r0*Math.cos(h0);y2=r0*Math.sin(h0);x3=y3=null}}else x2=y2=0;if(da>\u03b5&&(rc=Math.min(Math.abs(r1-r0)/2,+cornerRadius.apply(this,arguments)))>.001){cr=r0<r1^cw?0:1;var rc1=rc,rc0=rc;if(da<\u03c0){var oc=x3==null?[x2,y2]:x1==null?[x0,y0]:d3_geom_polygonIntersect([x0,y0],[x3,y3],[x1,y1],[x2,y2]),ax=x0-oc[0],ay=y0-oc[1],bx=x1-oc[0],by=y1-oc[1],kc=1/Math.sin(Math.acos((ax*bx+ay*by)/(Math.sqrt(ax*ax+ay*ay)*Math.sqrt(bx*
bx+by*by)))/2),lc=Math.sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=Math.min(rc,(r0-lc)/(kc-1));rc1=Math.min(rc,(r1-lc)/(kc+1))}if(x1!=null){var t30=d3_svg_arcCornerTangents(x3==null?[x2,y2]:[x3,y3],[x0,y0],r1,rc1,cw),t12=d3_svg_arcCornerTangents([x1,y1],[x2,y2],r1,rc1,cw);if(rc===rc1)path.push("M",t30[0],"A",rc1,",",rc1," 0 0,",cr," ",t30[1],"A",r1,",",r1," 0 ",1-cw^d3_svg_arcSweep(t30[1][0],t30[1][1],t12[1][0],t12[1][1]),",",cw," ",t12[1],"A",rc1,",",rc1," 0 0,",cr," ",t12[0]);else path.push("M",t30[0],"A",
rc1,",",rc1," 0 1,",cr," ",t12[0])}else path.push("M",x0,",",y0);if(x3!=null){var t03=d3_svg_arcCornerTangents([x0,y0],[x3,y3],r0,-rc0,cw),t21=d3_svg_arcCornerTangents([x2,y2],x1==null?[x0,y0]:[x1,y1],r0,-rc0,cw);if(rc===rc0)path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t21[1],"A",r0,",",r0," 0 ",cw^d3_svg_arcSweep(t21[1][0],t21[1][1],t03[1][0],t03[1][1]),",",1-cw," ",t03[1],"A",rc0,",",rc0," 0 0,",cr," ",t03[0]);else path.push("L",t21[0],"A",rc0,",",rc0," 0 0,",cr," ",t03[0])}else path.push("L",
x2,",",y2)}else{path.push("M",x0,",",y0);if(x1!=null)path.push("A",r1,",",r1," 0 ",l1,",",cw," ",x1,",",y1);path.push("L",x2,",",y2);if(x3!=null)path.push("A",r0,",",r0," 0 ",l0,",",1-cw," ",x3,",",y3)}path.push("Z");return path.join("")}function circleSegment(r1,cw){return"M0,"+r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+-r1+"A"+r1+","+r1+" 0 1,"+cw+" 0,"+r1}arc.innerRadius=function(v){if(!arguments.length)return innerRadius;innerRadius=d3_functor(v);return arc};arc.outerRadius=function(v){if(!arguments.length)return outerRadius;
outerRadius=d3_functor(v);return arc};arc.cornerRadius=function(v){if(!arguments.length)return cornerRadius;cornerRadius=d3_functor(v);return arc};arc.padRadius=function(v){if(!arguments.length)return padRadius;padRadius=v==d3_svg_arcAuto?d3_svg_arcAuto:d3_functor(v);return arc};arc.startAngle=function(v){if(!arguments.length)return startAngle;startAngle=d3_functor(v);return arc};arc.endAngle=function(v){if(!arguments.length)return endAngle;endAngle=d3_functor(v);return arc};arc.padAngle=function(v){if(!arguments.length)return padAngle;
padAngle=d3_functor(v);return arc};arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-half\u03c0;return[Math.cos(a)*r,Math.sin(a)*r]};return arc};var d3_svg_arcAuto="auto";function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}
function d3_svg_arcPadAngle(d){return d&&d.padAngle}function d3_svg_arcSweep(x0,y0,x1,y1){return(x0-x1)*y0-(y0-y1)*x0>0?0:1}function d3_svg_arcCornerTangents(p0,p1,r1,rc,cw){var x01=p0[0]-p1[0],y01=p0[1]-p1[1],lo=(cw?rc:-rc)/Math.sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x1=p0[0]+ox,y1=p0[1]+oy,x2=p1[0]+ox,y2=p1[1]+oy,x3=(x1+x2)/2,y3=(y1+y2)/2,dx=x2-x1,dy=y2-y1,d2=dx*dx+dy*dy,r=r1-rc,D=x1*y2-x2*y1,d=(dy<0?-1:1)*Math.sqrt(Math.max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*
d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x3,dy0=cy0-y3,dx1=cx1-x3,dy1=cy1-y3;if(dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1)cx0=cx1,cy0=cy1;return[[cx0-ox,cy0-oy],[cx0*r1/r,cy0*r1/r]]}function d3_svg_line(projection){var x=d3_geom_pointX,y=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=.7;function line(data){var segments=[],points=[],i=-1,n=data.length,d,fx=d3_functor(x),fy=d3_functor(y);function segment(){segments.push("M",interpolate(projection(points),tension))}
while(++i<n)if(defined.call(this,d=data[i],i))points.push([+fx.call(this,d,i),+fy.call(this,d,i)]);else if(points.length){segment();points=[]}if(points.length)segment();return segments.length?segments.join(""):null}line.x=function(_){if(!arguments.length)return x;x=_;return line};line.y=function(_){if(!arguments.length)return y;y=_;return line};line.defined=function(_){if(!arguments.length)return defined;defined=_;return line};line.interpolate=function(_){if(!arguments.length)return interpolateKey;
if(typeof _==="function")interpolateKey=interpolate=_;else interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key;return line};line.tension=function(_){if(!arguments.length)return tension;tension=_;return line};return line}d3.svg.line=function(){return d3_svg_line(d3_identity)};var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,step:d3_svg_lineStep,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,
basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});d3_svg_lineInterpolators.forEach(function(key,value){value.key=key;value.closed=/-closed$/.test(key)});function d3_svg_lineLinear(points){return points.length>1?points.join("L"):points+"Z"}function d3_svg_lineLinearClosed(points){return points.join("L")+
"Z"}function d3_svg_lineStep(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("H",(p[0]+(p=points[i])[0])/2,"V",p[1]);if(n>1)path.push("H",p[0]);return path.join("")}function d3_svg_lineStepBefore(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("V",(p=points[i])[1],"H",p[0]);return path.join("")}function d3_svg_lineStepAfter(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n)path.push("H",(p=points[i])[0],
"V",p[1]);return path.join("")}function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,-1),d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinearClosed(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))}function d3_svg_lineCardinal(points,
tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2)return d3_svg_lineLinear(points);var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad){path+="Q"+(p[0]-t0[0]*2/3)+","+(p[1]-t0[1]*2/3)+","+p[0]+","+p[1];p0=points[1];pi=2}if(tangents.length>
1){t=tangents[1];p=points[pi];pi++;path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++){p=points[pi];t=tangents[i];path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}}if(quad){var lp=points[pi];path+="Q"+(p[0]+t[0]*2/3)+","+(p[1]+t[1]*2/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){var tangents=[],a=(1-tension)/2,p0,p1=points[0],p2=points[1],i=1,n=points.length;while(++i<n){p0=
p1;p1=p2;p2=points[i];tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])])}return tangents}function d3_svg_lineBasis(points){if(points.length<3)return d3_svg_lineLinear(points);var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0,"L",d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];points.push(points[n-1]);while(++i<=n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,
px,py)}points.pop();path.push("L",pi);return path.join("")}function d3_svg_lineBasisOpen(points){if(points.length<4)return d3_svg_lineLinear(points);var path=[],i=-1,n=points.length,pi,px=[0],py=[0];while(++i<3){pi=points[i];px.push(pi[0]);py.push(pi[1])}path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py));--i;while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisClosed(points){var path,
i=-1,n=points.length,m=n+4,pi,px=[],py=[];while(++i<4){pi=points[i%n];px.push(pi[0]);py.push(pi[1])}path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];--i;while(++i<m){pi=points[i%n];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n){var x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1,p,t;while(++i<=
n){p=points[i];t=i/n;p[0]=tension*p[0]+(1-tension)*(x0+t*dx);p[1]=tension*p[1]+(1-tension)*(y0+t*dy)}}return d3_svg_lineBasis(points)}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,
x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineFiniteDifferences(points){var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);while(++i<j)m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2;m[i]=d;return m}function d3_svg_lineMonotoneTangents(points){var tangents=[],d,a,b,s,m=d3_svg_lineFiniteDifferences(points),
i=-1,j=points.length-1;while(++i<j){d=d3_svg_lineSlope(points[i],points[i+1]);if(abs(d)<\u03b5)m[i]=m[i+1]=0;else{a=m[i]/d;b=m[i+1]/d;s=a*a+b*b;if(s>9){s=d*3/Math.sqrt(s);m[i]=s*a;m[i+1]=s*b}}}i=-1;while(++i<=j){s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i]));tangents.push([s||0,m[i]*s||0])}return tangents}function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineMonotoneTangents(points))}d3.svg.line.radial=
function(){var line=d3_svg_line(d3_svg_lineRadial);line.radius=line.x,delete line.x;line.angle=line.y,delete line.y;return line};function d3_svg_lineRadial(points){var point,i=-1,n=points.length,r,a;while(++i<n){point=points[i];r=point[0];a=point[1]-half\u03c0;point[0]=r*Math.cos(a);point[1]=r*Math.sin(a)}return points}function d3_svg_area(projection){var x0=d3_geom_pointX,x1=d3_geom_pointX,y0=0,y1=d3_geom_pointY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=
interpolate,L="L",tension=.7;function area(data){var segments=[],points0=[],points1=[],i=-1,n=data.length,d,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1),x,y;function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}while(++i<n)if(defined.call(this,d=data[i],i)){points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]);points1.push([+fx1.call(this,
d,i),+fy1.call(this,d,i)])}else if(points0.length){segment();points0=[];points1=[]}if(points0.length)segment();return segments.length?segments.join(""):null}area.x=function(_){if(!arguments.length)return x1;x0=x1=_;return area};area.x0=function(_){if(!arguments.length)return x0;x0=_;return area};area.x1=function(_){if(!arguments.length)return x1;x1=_;return area};area.y=function(_){if(!arguments.length)return y1;y0=y1=_;return area};area.y0=function(_){if(!arguments.length)return y0;y0=_;return area};
area.y1=function(_){if(!arguments.length)return y1;y1=_;return area};area.defined=function(_){if(!arguments.length)return defined;defined=_;return area};area.interpolate=function(_){if(!arguments.length)return interpolateKey;if(typeof _==="function")interpolateKey=interpolate=_;else interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key;interpolateReverse=interpolate.reverse||interpolate;L=interpolate.closed?"M":"L";return area};area.tension=function(_){if(!arguments.length)return tension;
tension=_;return area};return area}d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter;d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore;d3.svg.area=function(){return d3_svg_area(d3_identity)};d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);area.radius=area.x,delete area.x;area.innerRadius=area.x0,delete area.x0;area.outerRadius=area.x1,delete area.x1;area.angle=area.y,delete area.y;area.startAngle=area.y0,delete area.y0;area.endAngle=area.y1,delete area.y1;return area};d3.svg.chord=
function(){var source=d3_source,target=d3_target,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(equals(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)-half\u03c0,
a1=endAngle.call(self,subgroup,i)-half\u03c0;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>\u03c0)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}chord.radius=function(v){if(!arguments.length)return radius;radius=d3_functor(v);return chord};chord.source=function(v){if(!arguments.length)return source;source=d3_functor(v);return chord};chord.target=
function(v){if(!arguments.length)return target;target=d3_functor(v);return chord};chord.startAngle=function(v){if(!arguments.length)return startAngle;startAngle=d3_functor(v);return chord};chord.endAngle=function(v){if(!arguments.length)return endAngle;endAngle=d3_functor(v);return chord};return chord};function d3_svg_chordRadius(d){return d.radius}d3.svg.diagonal=function(){var source=d3_source,target=d3_target,projection=d3_svg_diagonalProjection;function diagonal(d,i){var p0=source.call(this,d,
i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];p=p.map(projection);return"M"+p[0]+"C"+p[1]+" "+p[2]+" "+p[3]}diagonal.source=function(x){if(!arguments.length)return source;source=d3_functor(x);return diagonal};diagonal.target=function(x){if(!arguments.length)return target;target=d3_functor(x);return diagonal};diagonal.projection=function(x){if(!arguments.length)return projection;projection=x;return diagonal};return diagonal};function d3_svg_diagonalProjection(d){return[d.x,
d.y]}d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;diagonal.projection=function(x){return arguments.length?projection_(d3_svg_diagonalRadialProjection(projection=x)):projection};return diagonal};function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]-half\u03c0;return[r*Math.cos(a),r*Math.sin(a)]}}d3.svg.symbol=function(){var type=d3_svg_symbolType,
size=d3_svg_symbolSize;function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}symbol.type=function(x){if(!arguments.length)return type;type=d3_functor(x);return symbol};symbol.size=function(x){if(!arguments.length)return size;size=d3_functor(x);return symbol};return symbol};function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/\u03c0);return"M0,"+r+"A"+r+","+
r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0"+" 0,"+ry+" "+-rx+",0"+"Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+
","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*d3_radians);d3_selectionPrototype.transition=function(name){var id=d3_transitionInheritId||
++d3_transitionId,ns=d3_transitionNamespace(name),subgroups=[],subgroup,node,transition=d3_transitionInherit||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250};for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i])d3_transitionNode(node,i,ns,id,transition);subgroup.push(node)}}return d3_transition(subgroups,ns,id)};d3_selectionPrototype.interrupt=function(name){return this.each(name==null?d3_selection_interrupt:
d3_selection_interruptNS(d3_transitionNamespace(name)))};var d3_selection_interrupt=d3_selection_interruptNS(d3_transitionNamespace());function d3_selection_interruptNS(ns){return function(){var lock,activeId,active;if((lock=this[ns])&&(active=lock[activeId=lock.active])){active.timer.c=null;active.timer.t=NaN;if(--lock.count)delete lock[activeId];else delete this[ns];lock.active+=.5;active.event&&active.event.interrupt.call(this,this.__data__,active.index)}}}function d3_transition(groups,ns,id){d3_subclass(groups,
d3_transitionPrototype);groups.namespace=ns;groups.id=id;return groups}var d3_transitionPrototype=[],d3_transitionId=0,d3_transitionInheritId,d3_transitionInherit;d3_transitionPrototype.call=d3_selectionPrototype.call;d3_transitionPrototype.empty=d3_selectionPrototype.empty;d3_transitionPrototype.node=d3_selectionPrototype.node;d3_transitionPrototype.size=d3_selectionPrototype.size;d3.transition=function(selection,name){return selection&&selection.transition?d3_transitionInheritId?selection.transition(name):
selection:d3.selection().transition(selection)};d3.transition.prototype=d3_transitionPrototype;d3_transitionPrototype.select=function(selector){var id=this.id,ns=this.namespace,subgroups=[],subgroup,subnode,node;selector=d3_selection_selector(selector);for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;)if((node=group[i])&&(subnode=selector.call(node,node.__data__,i,j))){if("__data__"in node)subnode.__data__=node.__data__;d3_transitionNode(subnode,
i,ns,id,node[ns][id]);subgroup.push(subnode)}else subgroup.push(null)}return d3_transition(subgroups,ns,id)};d3_transitionPrototype.selectAll=function(selector){var id=this.id,ns=this.namespace,subgroups=[],subgroup,subnodes,node,subnode,transition;selector=d3_selection_selectorAll(selector);for(var j=-1,m=this.length;++j<m;)for(var group=this[j],i=-1,n=group.length;++i<n;)if(node=group[i]){transition=node[ns][id];subnodes=selector.call(node,node.__data__,i,j);subgroups.push(subgroup=[]);for(var k=
-1,o=subnodes.length;++k<o;){if(subnode=subnodes[k])d3_transitionNode(subnode,k,ns,id,transition);subgroup.push(subnode)}}return d3_transition(subgroups,ns,id)};d3_transitionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function")filter=d3_selection_filter(filter);for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++)if((node=group[i])&&filter.call(node,node.__data__,i,j))subgroup.push(node)}return d3_transition(subgroups,
this.namespace,this.id)};d3_transitionPrototype.tween=function(name,tween){var id=this.id,ns=this.namespace;if(arguments.length<2)return this.node()[ns][id].tween.get(name);return d3_selection_each(this,tween==null?function(node){node[ns][id].tween.remove(name)}:function(node){node[ns][id].tween.set(name,tween)})};function d3_transition_tween(groups,name,value,tween){var id=groups.id,ns=groups.namespace;return d3_selection_each(groups,typeof value==="function"?function(node,i,j){node[ns][id].tween.set(name,
tween(value.call(node,node.__data__,i,j)))}:(value=tween(value),function(node){node[ns][id].tween.set(name,value)}))}d3_transitionPrototype.attr=function(nameNS,value){if(arguments.length<2){for(value in nameNS)this.attr(value,nameNS[value]);return this}var interpolate=nameNS=="transform"?d3_interpolateTransform:d3_interpolate,name=d3.ns.qualify(nameNS);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrTween(b){return b==
null?attrNull:(b+="",function(){var a=this.getAttribute(name),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttribute(name,i(t))})})}function attrTweenNS(b){return b==null?attrNullNS:(b+="",function(){var a=this.getAttributeNS(name.space,name.local),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttributeNS(name.space,name.local,i(t))})})}return d3_transition_tween(this,"attr."+nameNS,value,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.attrTween=function(nameNS,tween){var name=
d3.ns.qualify(nameNS);function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f&&function(t){this.setAttribute(name,f(t))}}function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}return this.tween("attr."+nameNS,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<
2)value="";for(priority in name)this.style(priority,name[priority],value);return this}priority=""}function styleNull(){this.style.removeProperty(name)}function styleString(b){return b==null?styleNull:(b+="",function(){var a=d3_window(this).getComputedStyle(this,null).getPropertyValue(name),i;return a!==b&&(i=d3_interpolate(a,b),function(t){this.style.setProperty(name,i(t),priority)})})}return d3_transition_tween(this,"style."+name,value,styleString)};d3_transitionPrototype.styleTween=function(name,
tween,priority){if(arguments.length<3)priority="";function styleTween(d,i){var f=tween.call(this,d,i,d3_window(this).getComputedStyle(this,null).getPropertyValue(name));return f&&function(t){this.style.setProperty(name,f(t),priority)}}return this.tween("style."+name,styleTween)};d3_transitionPrototype.text=function(value){return d3_transition_tween(this,"text",value,d3_transition_text)};function d3_transition_text(b){if(b==null)b="";return function(){this.textContent=b}}d3_transitionPrototype.remove=
function(){var ns=this.namespace;return this.each("end.transition",function(){var p;if(this[ns].count<2&&(p=this.parentNode))p.removeChild(this)})};d3_transitionPrototype.ease=function(value){var id=this.id,ns=this.namespace;if(arguments.length<1)return this.node()[ns][id].ease;if(typeof value!=="function")value=d3.ease.apply(d3,arguments);return d3_selection_each(this,function(node){node[ns][id].ease=value})};d3_transitionPrototype.delay=function(value){var id=this.id,ns=this.namespace;if(arguments.length<
1)return this.node()[ns][id].delay;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node[ns][id].delay=+value.call(node,node.__data__,i,j)}:(value=+value,function(node){node[ns][id].delay=value}))};d3_transitionPrototype.duration=function(value){var id=this.id,ns=this.namespace;if(arguments.length<1)return this.node()[ns][id].duration;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node[ns][id].duration=Math.max(1,value.call(node,node.__data__,
i,j))}:(value=Math.max(1,value),function(node){node[ns][id].duration=value}))};d3_transitionPrototype.each=function(type,listener){var id=this.id,ns=this.namespace;if(arguments.length<2){var inherit=d3_transitionInherit,inheritId=d3_transitionInheritId;try{d3_transitionInheritId=id;d3_selection_each(this,function(node,i,j){d3_transitionInherit=node[ns][id];type.call(node,node.__data__,i,j)})}finally{d3_transitionInherit=inherit;d3_transitionInheritId=inheritId}}else d3_selection_each(this,function(node){var transition=
node[ns][id];(transition.event||(transition.event=d3.dispatch("start","end","interrupt"))).on(type,listener)});return this};d3_transitionPrototype.transition=function(){var id0=this.id,id1=++d3_transitionId,ns=this.namespace,subgroups=[],subgroup,group,node,transition;for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if(node=group[i]){transition=node[ns][id0];d3_transitionNode(node,i,ns,id1,{time:transition.time,ease:transition.ease,delay:transition.delay+
transition.duration,duration:transition.duration})}subgroup.push(node)}}return d3_transition(subgroups,ns,id1)};function d3_transitionNamespace(name){return name==null?"__transition__":"__transition_"+name+"__"}function d3_transitionNode(node,i,ns,id,inherit){var lock=node[ns]||(node[ns]={active:0,count:0}),transition=lock[id],time,timer,duration,ease,tweens;function schedule(elapsed){var delay=transition.delay;timer.t=delay+time;if(delay<=elapsed)return start(elapsed-delay);timer.c=start}function start(elapsed){var activeId=
lock.active,active=lock[activeId];if(active){active.timer.c=null;active.timer.t=NaN;--lock.count;delete lock[activeId];active.event&&active.event.interrupt.call(node,node.__data__,active.index)}for(var cancelId in lock)if(+cancelId<id){var cancel=lock[cancelId];cancel.timer.c=null;cancel.timer.t=NaN;--lock.count;delete lock[cancelId]}timer.c=tick;d3_timer(function(){if(timer.c&&tick(elapsed||1)){timer.c=null;timer.t=NaN}return 1},0,time);lock.active=id;transition.event&&transition.event.start.call(node,
node.__data__,i);tweens=[];transition.tween.forEach(function(key,value){if(value=value.call(node,node.__data__,i))tweens.push(value)});ease=transition.ease;duration=transition.duration}function tick(elapsed){var t=elapsed/duration,e=ease(t),n=tweens.length;while(n>0)tweens[--n].call(node,e);if(t>=1){transition.event&&transition.event.end.call(node,node.__data__,i);if(--lock.count)delete lock[id];else delete node[ns];return 1}}if(!transition){time=inherit.time;timer=d3_timer(schedule,0,time);transition=
lock[id]={tween:new d3_Map,time:time,timer:timer,delay:inherit.delay,duration:inherit.duration,ease:inherit.ease,index:i};inherit=null;++lock.count}}d3.svg.axis=function(){var scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,innerTickSize=6,outerTickSize=6,tickPadding=3,tickArguments_=[10],tickValues=null,tickFormat_;function axis(g){g.each(function(){var g=d3.select(this);var scale0=this.__chart__||scale,scale1=this.__chart__=scale.copy();var ticks=tickValues==null?scale1.ticks?scale1.ticks.apply(scale1,
tickArguments_):scale1.domain():tickValues,tickFormat=tickFormat_==null?scale1.tickFormat?scale1.tickFormat.apply(scale1,tickArguments_):d3_identity:tickFormat_,tick=g.selectAll(".tick").data(ticks,scale1),tickEnter=tick.enter().insert("g",".domain").attr("class","tick").style("opacity",\u03b5),tickExit=d3.transition(tick.exit()).style("opacity",\u03b5).remove(),tickUpdate=d3.transition(tick.order()).style("opacity",1),tickSpacing=Math.max(innerTickSize,0)+tickPadding,tickTransform;var range=d3_scaleRange(scale1),
path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),d3.transition(path));tickEnter.append("line");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text"),sign=orient==="top"||orient==="left"?-1:1,x1,x2,y1,y2;if(orient==="bottom"||orient==="top"){tickTransform=d3_svg_axisX,x1="x",y1="y",x2="x2",
y2="y2";text.attr("dy",sign<0?"0em":".71em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+sign*outerTickSize+"V0H"+range[1]+"V"+sign*outerTickSize)}else{tickTransform=d3_svg_axisY,x1="y",y1="x",x2="y2",y2="x2";text.attr("dy",".32em").style("text-anchor",sign<0?"end":"start");pathUpdate.attr("d","M"+sign*outerTickSize+","+range[0]+"H0V"+range[1]+"H"+sign*outerTickSize)}lineEnter.attr(y2,sign*innerTickSize);textEnter.attr(y1,sign*tickSpacing);lineUpdate.attr(x2,0).attr(y2,sign*
innerTickSize);textUpdate.attr(x1,0).attr(y1,sign*tickSpacing);if(scale1.rangeBand){var x=scale1,dx=x.rangeBand()/2;scale0=scale1=function(d){return x(d)+dx}}else if(scale0.rangeBand)scale0=scale1;else tickExit.call(tickTransform,scale1,scale0);tickEnter.call(tickTransform,scale0,scale1);tickUpdate.call(tickTransform,scale1,scale1)})}axis.scale=function(x){if(!arguments.length)return scale;scale=x;return axis};axis.orient=function(x){if(!arguments.length)return orient;orient=x in d3_svg_axisOrients?
x+"":d3_svg_axisDefaultOrient;return axis};axis.ticks=function(){if(!arguments.length)return tickArguments_;tickArguments_=d3_array(arguments);return axis};axis.tickValues=function(x){if(!arguments.length)return tickValues;tickValues=x;return axis};axis.tickFormat=function(x){if(!arguments.length)return tickFormat_;tickFormat_=x;return axis};axis.tickSize=function(x){var n=arguments.length;if(!n)return innerTickSize;innerTickSize=+x;outerTickSize=+arguments[n-1];return axis};axis.innerTickSize=function(x){if(!arguments.length)return innerTickSize;
innerTickSize=+x;return axis};axis.outerTickSize=function(x){if(!arguments.length)return outerTickSize;outerTickSize=+x;return axis};axis.tickPadding=function(x){if(!arguments.length)return tickPadding;tickPadding=+x;return axis};axis.tickSubdivide=function(){return arguments.length&&axis};return axis};var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};function d3_svg_axisX(selection,x0,x1){selection.attr("transform",function(d){var v0=x0(d);return"translate("+
(isFinite(v0)?v0:x1(d))+",0)"})}function d3_svg_axisY(selection,y0,y1){selection.attr("transform",function(d){var v0=y0(d);return"translate(0,"+(isFinite(v0)?v0:y1(d))+")"})}d3.svg.brush=function(){var event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,xExtent=[0,0],yExtent=[0,0],xExtentDomain,yExtentDomain,xClamp=true,yClamp=true,resizes=d3_svg_brushResizes[0];function brush(g){g.each(function(){var g=d3.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color",
"rgba(0,0,0,0)").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart);var background=g.selectAll(".background").data([0]);background.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");g.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var resize=g.selectAll(".resize").data(resizes,d3_identity);resize.exit().remove();resize.enter().append("g").attr("class",function(d){return"resize "+
d}).style("cursor",function(d){return d3_svg_brushCursor[d]}).append("rect").attr("x",function(d){return/[ew]$/.test(d)?-3:null}).attr("y",function(d){return/^[ns]/.test(d)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");resize.style("display",brush.empty()?"none":null);var gUpdate=d3.transition(g),backgroundUpdate=d3.transition(background),range;if(x){range=d3_scaleRange(x);backgroundUpdate.attr("x",range[0]).attr("width",range[1]-range[0]);redrawX(gUpdate)}if(y){range=d3_scaleRange(y);
backgroundUpdate.attr("y",range[0]).attr("height",range[1]-range[0]);redrawY(gUpdate)}redraw(gUpdate)})}brush.event=function(g){g.each(function(){var event_=event.of(this,arguments),extent1={x:xExtent,y:yExtent,i:xExtentDomain,j:yExtentDomain},extent0=this.__chart__||extent1;this.__chart__=extent1;if(d3_transitionInheritId)d3.select(this).transition().each("start.brush",function(){xExtentDomain=extent0.i;yExtentDomain=extent0.j;xExtent=extent0.x;yExtent=extent0.y;event_({type:"brushstart"})}).tween("brush:brush",
function(){var xi=d3_interpolateArray(xExtent,extent1.x),yi=d3_interpolateArray(yExtent,extent1.y);xExtentDomain=yExtentDomain=null;return function(t){xExtent=extent1.x=xi(t);yExtent=extent1.y=yi(t);event_({type:"brush",mode:"resize"})}}).each("end.brush",function(){xExtentDomain=extent1.i;yExtentDomain=extent1.j;event_({type:"brush",mode:"resize"});event_({type:"brushend"})});else{event_({type:"brushstart"});event_({type:"brush",mode:"resize"});event_({type:"brushend"})}})};function redraw(g){g.selectAll(".resize").attr("transform",
function(d){return"translate("+xExtent[+/e$/.test(d)]+","+yExtent[+/^s/.test(d)]+")"})}function redrawX(g){g.select(".extent").attr("x",xExtent[0]);g.selectAll(".extent,.n>rect,.s>rect").attr("width",xExtent[1]-xExtent[0])}function redrawY(g){g.select(".extent").attr("y",yExtent[0]);g.selectAll(".extent,.e>rect,.w>rect").attr("height",yExtent[1]-yExtent[0])}function brushstart(){var target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),
resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),dragRestore=d3_event_dragSuppress(target),center,origin=d3.mouse(target),offset;var w=d3.select(d3_window(target)).on("keydown.brush",keydown).on("keyup.brush",keyup);if(d3.event.changedTouches)w.on("touchmove.brush",brushmove).on("touchend.brush",brushend);else w.on("mousemove.brush",brushmove).on("mouseup.brush",brushend);g.interrupt().selectAll("*").interrupt();if(dragging){origin[0]=
xExtent[0]-origin[0];origin[1]=yExtent[0]-origin[1]}else if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[xExtent[1-ex]-origin[0],yExtent[1-ey]-origin[1]];origin[0]=xExtent[ex];origin[1]=yExtent[ey]}else if(d3.event.altKey)center=origin.slice();g.style("pointer-events","none").selectAll(".resize").style("display",null);d3.select("body").style("cursor",eventTarget.style("cursor"));event_({type:"brushstart"});brushmove();function keydown(){if(d3.event.keyCode==32){if(!dragging){center=
null;origin[0]-=xExtent[1];origin[1]-=yExtent[1];dragging=2}d3_eventPreventDefault()}}function keyup(){if(d3.event.keyCode==32&&dragging==2){origin[0]+=xExtent[1];origin[1]+=yExtent[1];dragging=0;d3_eventPreventDefault()}}function brushmove(){var point=d3.mouse(target),moved=false;if(offset){point[0]+=offset[0];point[1]+=offset[1]}if(!dragging)if(d3.event.altKey){if(!center)center=[(xExtent[0]+xExtent[1])/2,(yExtent[0]+yExtent[1])/2];origin[0]=xExtent[+(point[0]<center[0])];origin[1]=yExtent[+(point[1]<
center[1])]}else center=null;if(resizingX&&move1(point,x,0)){redrawX(g);moved=true}if(resizingY&&move1(point,y,1)){redrawY(g);moved=true}if(moved){redraw(g);event_({type:"brush",mode:dragging?"move":"resize"})}}function move1(point,scale,i){var range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],extent=i?yExtent:xExtent,size=extent[1]-extent[0],min,max;if(dragging){r0-=position;r1-=size+position}min=(i?yClamp:xClamp)?Math.max(r0,Math.min(r1,point[i])):point[i];if(dragging)max=(min+=
position)+size;else{if(center)position=Math.max(r0,Math.min(r1,2*center[i]-min));if(position<min){max=min;min=position}else max=position}if(extent[0]!=min||extent[1]!=max){if(i)yExtentDomain=null;else xExtentDomain=null;extent[0]=min;extent[1]=max;return true}}function brushend(){brushmove();g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null);d3.select("body").style("cursor",null);w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",
null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);dragRestore();event_({type:"brushend"})}}brush.x=function(z){if(!arguments.length)return x;x=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.y=function(z){if(!arguments.length)return y;y=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.clamp=function(z){if(!arguments.length)return x&&y?[xClamp,yClamp]:x?xClamp:y?yClamp:null;if(x&&y)xClamp=!!z[0],yClamp=!!z[1];else if(x)xClamp=!!z;else if(y)yClamp=
!!z;return brush};brush.extent=function(z){var x0,x1,y0,y1,t;if(!arguments.length){if(x)if(xExtentDomain)x0=xExtentDomain[0],x1=xExtentDomain[1];else{x0=xExtent[0],x1=xExtent[1];if(x.invert)x0=x.invert(x0),x1=x.invert(x1);if(x1<x0)t=x0,x0=x1,x1=t}if(y)if(yExtentDomain)y0=yExtentDomain[0],y1=yExtentDomain[1];else{y0=yExtent[0],y1=yExtent[1];if(y.invert)y0=y.invert(y0),y1=y.invert(y1);if(y1<y0)t=y0,y0=y1,y1=t}return x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1]}if(x){x0=z[0],x1=z[1];if(y)x0=x0[0],x1=
x1[0];xExtentDomain=[x0,x1];if(x.invert)x0=x(x0),x1=x(x1);if(x1<x0)t=x0,x0=x1,x1=t;if(x0!=xExtent[0]||x1!=xExtent[1])xExtent=[x0,x1]}if(y){y0=z[0],y1=z[1];if(x)y0=y0[1],y1=y1[1];yExtentDomain=[y0,y1];if(y.invert)y0=y(y0),y1=y(y1);if(y1<y0)t=y0,y0=y1,y1=t;if(y0!=yExtent[0]||y1!=yExtent[1])yExtent=[y0,y1]}return brush};brush.clear=function(){if(!brush.empty()){xExtent=[0,0],yExtent=[0,0];xExtentDomain=yExtentDomain=null}return brush};brush.empty=function(){return!!x&&xExtent[0]==xExtent[1]||!!y&&yExtent[0]==
yExtent[1]};return d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];var d3_time_format=d3_time.format=d3_locale_enUS.timeFormat;var d3_time_formatUtc=d3_time_format.utc;var d3_time_formatIso=d3_time_formatUtc("%Y-%m-%dT%H:%M:%S.%LZ");d3_time_format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?
d3_time_formatIsoNative:d3_time_formatIso;function d3_time_formatIsoNative(date){return date.toISOString()}d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date};d3_time_formatIsoNative.toString=d3_time_formatIso.toString;d3_time.second=d3_time_interval(function(date){return new d3_date(Math.floor(date/1E3)*1E3)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*1E3)},function(date){return date.getSeconds()});d3_time.seconds=d3_time.second.range;
d3_time.seconds.utc=d3_time.second.utc.range;d3_time.minute=d3_time_interval(function(date){return new d3_date(Math.floor(date/6E4)*6E4)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*6E4)},function(date){return date.getMinutes()});d3_time.minutes=d3_time.minute.range;d3_time.minutes.utc=d3_time.minute.utc.range;d3_time.hour=d3_time_interval(function(date){var timezone=date.getTimezoneOffset()/60;return new d3_date((Math.floor(date/36E5-timezone)+timezone)*36E5)},function(date,
offset){date.setTime(date.getTime()+Math.floor(offset)*36E5)},function(date){return date.getHours()});d3_time.hours=d3_time.hour.range;d3_time.hours.utc=d3_time.hour.utc.range;d3_time.month=d3_time_interval(function(date){date=d3_time.day(date);date.setDate(1);return date},function(date,offset){date.setMonth(date.getMonth()+offset)},function(date){return date.getMonth()});d3_time.months=d3_time.month.range;d3_time.months.utc=d3_time.month.utc.range;function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}
scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))};scale.domain=function(x){if(!arguments.length)return linear.domain().map(d3_time_scaleDate);linear.domain(x);return scale};function tickMethod(extent,count){var span=extent[1]-extent[0],target=span/count,i=d3.bisect(d3_time_scaleSteps,target);return i==d3_time_scaleSteps.length?[methods.year,d3_scale_linearTickRange(extent.map(function(d){return d/31536E6}),count)[2]]:!i?[d3_time_scaleMilliseconds,d3_scale_linearTickRange(extent,
count)[2]]:methods[target/d3_time_scaleSteps[i-1]<d3_time_scaleSteps[i]/target?i-1:i]}scale.nice=function(interval,skip){var domain=scale.domain(),extent=d3_scaleExtent(domain),method=interval==null?tickMethod(extent,10):typeof interval==="number"&&tickMethod(extent,interval);if(method)interval=method[0],skip=method[1];function skipped(date){return!isNaN(date)&&!interval.range(date,d3_time_scaleDate(+date+1),skip).length}return scale.domain(d3_scale_nice(domain,skip>1?{floor:function(date){while(skipped(date=
interval.floor(date)))date=d3_time_scaleDate(date-1);return date},ceil:function(date){while(skipped(date=interval.ceil(date)))date=d3_time_scaleDate(+date+1);return date}}:interval))};scale.ticks=function(interval,skip){var extent=d3_scaleExtent(scale.domain()),method=interval==null?tickMethod(extent,10):typeof interval==="number"?tickMethod(extent,interval):!interval.range&&[{range:interval},skip];if(method)interval=method[0],skip=method[1];return interval.range(extent[0],d3_time_scaleDate(+extent[1]+
1),skip<1?1:skip)};scale.tickFormat=function(){return format};scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)};return d3_scale_linearRebind(scale,linear)}function d3_time_scaleDate(t){return new Date(t)}var d3_time_scaleSteps=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6];var d3_time_scaleLocalMethods=[[d3_time.second,1],[d3_time.second,5],[d3_time.second,15],[d3_time.second,30],[d3_time.minute,1],[d3_time.minute,5],[d3_time.minute,
15],[d3_time.minute,30],[d3_time.hour,1],[d3_time.hour,3],[d3_time.hour,6],[d3_time.hour,12],[d3_time.day,1],[d3_time.day,2],[d3_time.week,1],[d3_time.month,1],[d3_time.month,3],[d3_time.year,1]];var d3_time_scaleLocalFormat=d3_time_format.multi([[".%L",function(d){return d.getMilliseconds()}],[":%S",function(d){return d.getSeconds()}],["%I:%M",function(d){return d.getMinutes()}],["%I %p",function(d){return d.getHours()}],["%a %d",function(d){return d.getDay()&&d.getDate()!=1}],["%b %d",function(d){return d.getDate()!=
1}],["%B",function(d){return d.getMonth()}],["%Y",d3_true]]);var d3_time_scaleMilliseconds={range:function(start,stop,step){return d3.range(Math.ceil(start/step)*step,+stop,step).map(d3_time_scaleDate)},floor:d3_identity,ceil:d3_identity};d3_time_scaleLocalMethods.year=d3_time.year;d3_time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUtcMethods=d3_time_scaleLocalMethods.map(function(m){return[m[0].utc,m[1]]});var d3_time_scaleUtcFormat=
d3_time_formatUtc.multi([[".%L",function(d){return d.getUTCMilliseconds()}],[":%S",function(d){return d.getUTCSeconds()}],["%I:%M",function(d){return d.getUTCMinutes()}],["%I %p",function(d){return d.getUTCHours()}],["%a %d",function(d){return d.getUTCDay()&&d.getUTCDate()!=1}],["%b %d",function(d){return d.getUTCDate()!=1}],["%B",function(d){return d.getUTCMonth()}],["%Y",d3_true]]);d3_time_scaleUtcMethods.year=d3_time.year.utc;d3_time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),
d3_time_scaleUtcMethods,d3_time_scaleUtcFormat)};d3.text=d3_xhrType(function(request){return request.responseText});d3.json=function(url,callback){return d3_xhr(url,"application/json",d3_json,callback)};function d3_json(request){return JSON.parse(request.responseText)}d3.html=function(url,callback){return d3_xhr(url,"text/html",d3_html,callback)};function d3_html(request){var range=d3_document.createRange();range.selectNode(d3_document.body);return range.createContextualFragment(request.responseText)}
d3.xml=d3_xhrType(function(request){return request.responseXML});if(typeof define==="function"&&define.amd)this.d3=d3,define(d3);else if(typeof module==="object"&&module.exports)module.exports=d3;else this.d3=d3}();(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f;}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){(function(global){var base64=
require("base64-js");var ieee754=require("ieee754");var isArray=require("isarray");exports.Buffer=Buffer;exports.SlowBuffer=SlowBuffer;exports.INSPECT_MAX_BYTES=50;Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=global.TYPED_ARRAY_SUPPORT!==undefined?global.TYPED_ARRAY_SUPPORT:typedArraySupport();function typedArraySupport(){try{var arr=new Uint8Array(1);arr.foo=function(){return 42};return arr.foo()===42&&typeof arr.subarray==="function"&&arr.subarray(1,1).byteLength===0}catch(e){return false}}
function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){if(!(this instanceof Buffer)){if(arguments.length>1)return new Buffer(arg,arguments[1]);return new Buffer(arg)}if(!Buffer.TYPED_ARRAY_SUPPORT){this.length=0;this.parent=undefined}if(typeof arg==="number")return fromNumber(this,arg);if(typeof arg==="string")return fromString(this,arg,arguments.length>1?arguments[1]:"utf8");return fromObject(this,arg)}Buffer._augment=function(arr){arr.__proto__=Buffer.prototype;
return arr};function fromNumber(that,length){that=allocate(that,length<0?0:checked(length)|0);if(!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<length;i++)that[i]=0;return that}function fromString(that,string,encoding){if(typeof encoding!=="string"||encoding==="")encoding="utf8";var length=byteLength(string,encoding)|0;that=allocate(that,length);that.write(string,encoding);return that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,
object);if(object==null)throw new TypeError("must start with number, buffer, array or string");if(typeof ArrayBuffer!=="undefined"){if(object.buffer instanceof ArrayBuffer)return fromTypedArray(that,object);if(object instanceof ArrayBuffer)return fromArrayBuffer(that,object)}if(object.length)return fromArrayLike(that,object);return fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=checked(buffer.length)|0;that=allocate(that,length);buffer.copy(that,0,0,length);return that}function fromArray(that,
array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=array[i]&255;return that}function fromTypedArray(that,array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=array[i]&255;return that}function fromArrayBuffer(that,array){array.byteLength;if(Buffer.TYPED_ARRAY_SUPPORT){that=new Uint8Array(array);that.__proto__=Buffer.prototype}else that=fromTypedArray(that,new Uint8Array(array));return that}function fromArrayLike(that,
array){var length=checked(array.length)|0;that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=array[i]&255;return that}function fromJsonObject(that,object){var array;var length=0;if(object.type==="Buffer"&&isArray(object.data)){array=object.data;length=checked(array.length)|0}that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=array[i]&255;return that}if(Buffer.TYPED_ARRAY_SUPPORT){Buffer.prototype.__proto__=Uint8Array.prototype;Buffer.__proto__=Uint8Array}else{Buffer.prototype.length=
undefined;Buffer.prototype.parent=undefined}function allocate(that,length){if(Buffer.TYPED_ARRAY_SUPPORT){that=new Uint8Array(length);that.__proto__=Buffer.prototype}else that.length=length;var fromPool=length!==0&&length<=Buffer.poolSize>>>1;if(fromPool)that.parent=rootParent;return that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+kMaxLength().toString(16)+" bytes");return length|0}function SlowBuffer(subject,
encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);delete buf.parent;return buf}Buffer.isBuffer=function isBuffer(b){return!!(b!=null&&b._isBuffer)};Buffer.compare=function compare(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;var x=a.length;var y=b.length;var i=0;var len=Math.min(x,y);while(i<len){if(a[i]!==b[i])break;++i}if(i!==len){x=a[i];y=b[i]}if(x<y)return-1;
if(y<x)return 1;return 0};Buffer.isEncoding=function isEncoding(encoding){switch(String(encoding).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "binary":case "base64":case "raw":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return true;default:return false}};Buffer.concat=function concat(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(list.length===0)return new Buffer(0);var i;if(length===undefined){length=0;for(i=
0;i<list.length;i++)length+=list[i].length}var buf=new Buffer(length);var pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos);pos+=item.length}return buf};function byteLength(string,encoding){if(typeof string!=="string")string=""+string;var len=string.length;if(len===0)return 0;var loweredCase=false;for(;;)switch(encoding){case "ascii":case "binary":case "raw":case "raws":return len;case "utf8":case "utf-8":return utf8ToBytes(string).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return len*
2;case "hex":return len>>>1;case "base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase();loweredCase=true}}Buffer.byteLength=byteLength;function slowToString(encoding,start,end){var loweredCase=false;start=start|0;end=end===undefined||end===Infinity?this.length:end|0;if(!encoding)encoding="utf8";if(start<0)start=0;if(end>this.length)end=this.length;if(end<=start)return"";while(true)switch(encoding){case "hex":return hexSlice(this,
start,end);case "utf8":case "utf-8":return utf8Slice(this,start,end);case "ascii":return asciiSlice(this,start,end);case "binary":return binarySlice(this,start,end);case "base64":return base64Slice(this,start,end);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase();loweredCase=true}}Buffer.prototype._isBuffer=true;Buffer.prototype.toString=function toString(){var length=
this.length|0;if(length===0)return"";if(arguments.length===0)return utf8Slice(this,0,length);return slowToString.apply(this,arguments)};Buffer.prototype.equals=function equals(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return true;return Buffer.compare(this,b)===0};Buffer.prototype.inspect=function inspect(){var str="";var max=exports.INSPECT_MAX_BYTES;if(this.length>0){str=this.toString("hex",0,max).match(/.{2}/g).join(" ");if(this.length>max)str+=" ... "}return"<Buffer "+
str+">"};Buffer.prototype.compare=function compare(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");if(this===b)return 0;return Buffer.compare(this,b)};Buffer.prototype.indexOf=function indexOf(val,byteOffset){if(byteOffset>2147483647)byteOffset=2147483647;else if(byteOffset<-2147483648)byteOffset=-2147483648;byteOffset>>=0;if(this.length===0)return-1;if(byteOffset>=this.length)return-1;if(byteOffset<0)byteOffset=Math.max(this.length+byteOffset,0);if(typeof val==="string"){if(val.length===
0)return-1;return String.prototype.indexOf.call(this,val,byteOffset)}if(Buffer.isBuffer(val))return arrayIndexOf(this,val,byteOffset);if(typeof val==="number"){if(Buffer.TYPED_ARRAY_SUPPORT&&Uint8Array.prototype.indexOf==="function")return Uint8Array.prototype.indexOf.call(this,val,byteOffset);return arrayIndexOf(this,[val],byteOffset)}function arrayIndexOf(arr,val,byteOffset){var foundIndex=-1;for(var i=0;byteOffset+i<arr.length;i++)if(arr[byteOffset+i]===val[foundIndex===-1?0:i-foundIndex]){if(foundIndex===
-1)foundIndex=i;if(i-foundIndex+1===val.length)return byteOffset+foundIndex}else foundIndex=-1;return-1}throw new TypeError("val must be string, number or Buffer");};function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;if(!length)length=remaining;else{length=Number(length);if(length>remaining)length=remaining}var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");if(length>strLen/2)length=strLen/2;for(var i=0;i<length;i++){var parsed=
parseInt(string.substr(i*2,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),
buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}Buffer.prototype.write=function write(string,offset,length,encoding){if(offset===undefined){encoding="utf8";length=this.length;offset=0}else if(length===undefined&&typeof offset==="string"){encoding=offset;length=this.length;offset=0}else if(isFinite(offset)){offset=offset|0;if(isFinite(length)){length=length|0;if(encoding===undefined)encoding="utf8"}else{encoding=
length;length=undefined}}else{var swap=encoding;encoding=offset;offset=length|0;length=swap}var remaining=this.length-offset;if(length===undefined||length>remaining)length=remaining;if(string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");if(!encoding)encoding="utf8";var loweredCase=false;for(;;)switch(encoding){case "hex":return hexWrite(this,string,offset,length);case "utf8":case "utf-8":return utf8Write(this,string,offset,length);
case "ascii":return asciiWrite(this,string,offset,length);case "binary":return binaryWrite(this,string,offset,length);case "base64":return base64Write(this,string,offset,length);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase();loweredCase=true}};Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||
this,0)}};function base64Slice(buf,start,end){if(start===0&&end===buf.length)return base64.fromByteArray(buf);else return base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);var res=[];var i=start;while(i<end){var firstByte=buf[i];var codePoint=null;var bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:if(firstByte<128)codePoint=
firstByte;break;case 2:secondByte=buf[i+1];if((secondByte&192)===128){tempCodePoint=(firstByte&31)<<6|secondByte&63;if(tempCodePoint>127)codePoint=tempCodePoint}break;case 3:secondByte=buf[i+1];thirdByte=buf[i+2];if((secondByte&192)===128&&(thirdByte&192)===128){tempCodePoint=(firstByte&15)<<12|(secondByte&63)<<6|thirdByte&63;if(tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343))codePoint=tempCodePoint}break;case 4:secondByte=buf[i+1];thirdByte=buf[i+2];fourthByte=buf[i+3];if((secondByte&
192)===128&&(thirdByte&192)===128&&(fourthByte&192)===128){tempCodePoint=(firstByte&15)<<18|(secondByte&63)<<12|(thirdByte&63)<<6|fourthByte&63;if(tempCodePoint>65535&&tempCodePoint<1114112)codePoint=tempCodePoint}}}if(codePoint===null){codePoint=65533;bytesPerSequence=1}else if(codePoint>65535){codePoint-=65536;res.push(codePoint>>>10&1023|55296);codePoint=56320|codePoint&1023}res.push(codePoint);i+=bytesPerSequence}return decodeCodePointsArray(res)}var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(codePoints){var len=
codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);var res="";var i=0;while(i<len)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]&127);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);
return ret}function hexSlice(buf,start,end){var len=buf.length;if(!start||start<0)start=0;if(!end||end<0||end>len)end=len;var out="";for(var i=start;i<end;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){var bytes=buf.slice(start,end);var res="";for(var i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+bytes[i+1]*256);return res}Buffer.prototype.slice=function slice(start,end){var len=this.length;start=~~start;end=end===undefined?len:~~end;if(start<0){start+=len;if(start<
0)start=0}else if(start>len)start=len;if(end<0){end+=len;if(end<0)end=0}else if(end>len)end=len;if(end<start)end=start;var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT){newBuf=this.subarray(start,end);newBuf.__proto__=Buffer.prototype}else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,undefined);for(var i=0;i<sliceLen;i++)newBuf[i]=this[i+start]}if(newBuf.length)newBuf.parent=this.parent||this;return newBuf};function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");
if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length");}Buffer.prototype.readUIntLE=function readUIntLE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256))val+=this[offset+i]*mul;return val};Buffer.prototype.readUIntBE=function readUIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,
byteLength,this.length);var val=this[offset+--byteLength];var mul=1;while(byteLength>0&&(mul*=256))val+=this[offset+--byteLength]*mul;return val};Buffer.prototype.readUInt8=function readUInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);return this[offset]};Buffer.prototype.readUInt16LE=function readUInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);return this[offset]|this[offset+1]<<8};Buffer.prototype.readUInt16BE=function readUInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,
2,this.length);return this[offset]<<8|this[offset+1]};Buffer.prototype.readUInt32LE=function readUInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+this[offset+3]*16777216};Buffer.prototype.readUInt32BE=function readUInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]*16777216+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])};Buffer.prototype.readIntLE=function readIntLE(offset,
byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var val=this[offset];var mul=1;var i=0;while(++i<byteLength&&(mul*=256))val+=this[offset+i]*mul;mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readIntBE=function readIntBE(offset,byteLength,noAssert){offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkOffset(offset,byteLength,this.length);var i=byteLength;var mul=1;var val=this[offset+--i];while(i>
0&&(mul*=256))val+=this[offset+--i]*mul;mul*=128;if(val>=mul)val-=Math.pow(2,8*byteLength);return val};Buffer.prototype.readInt8=function readInt8(offset,noAssert){if(!noAssert)checkOffset(offset,1,this.length);if(!(this[offset]&128))return this[offset];return(255-this[offset]+1)*-1};Buffer.prototype.readInt16LE=function readInt16LE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt16BE=
function readInt16BE(offset,noAssert){if(!noAssert)checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return val&32768?val|4294901760:val};Buffer.prototype.readInt32LE=function readInt32LE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24};Buffer.prototype.readInt32BE=function readInt32BE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return this[offset]<<24|this[offset+
1]<<16|this[offset+2]<<8|this[offset+3]};Buffer.prototype.readFloatLE=function readFloatLE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,true,23,4)};Buffer.prototype.readFloatBE=function readFloatBE(offset,noAssert){if(!noAssert)checkOffset(offset,4,this.length);return ieee754.read(this,offset,false,23,4)};Buffer.prototype.readDoubleLE=function readDoubleLE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,
true,52,8)};Buffer.prototype.readDoubleBE=function readDoubleBE(offset,noAssert){if(!noAssert)checkOffset(offset,8,this.length);return ieee754.read(this,offset,false,52,8)};function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");}Buffer.prototype.writeUIntLE=function writeUIntLE(value,offset,
byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1;var i=0;this[offset]=value&255;while(++i<byteLength&&(mul*=256))this[offset+i]=value/mul&255;return offset+byteLength};Buffer.prototype.writeUIntBE=function writeUIntBE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;byteLength=byteLength|0;if(!noAssert)checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=
byteLength-1;var mul=1;this[offset+i]=value&255;while(--i>=0&&(mul*=256))this[offset+i]=value/mul&255;return offset+byteLength};Buffer.prototype.writeUInt8=function writeUInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,255,0);if(!Buffer.TYPED_ARRAY_SUPPORT)value=Math.floor(value);this[offset]=value&255;return offset+1};function objectWriteUInt16(buf,value,offset,littleEndian){if(value<0)value=65535+value+1;for(var i=0,j=Math.min(buf.length-offset,
2);i<j;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>(littleEndian?i:1-i)*8}Buffer.prototype.writeUInt16LE=function writeUInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else objectWriteUInt16(this,value,offset,true);return offset+2};Buffer.prototype.writeUInt16BE=function writeUInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,
value,offset,2,65535,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else objectWriteUInt16(this,value,offset,false);return offset+2};function objectWriteUInt32(buf,value,offset,littleEndian){if(value<0)value=4294967295+value+1;for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++)buf[offset+i]=value>>>(littleEndian?i:3-i)*8&255}Buffer.prototype.writeUInt32LE=function writeUInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,
offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset+3]=value>>>24;this[offset+2]=value>>>16;this[offset+1]=value>>>8;this[offset]=value&255}else objectWriteUInt32(this,value,offset,true);return offset+4};Buffer.prototype.writeUInt32BE=function writeUInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,4294967295,0);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=
value&255}else objectWriteUInt32(this,value,offset,false);return offset+4};Buffer.prototype.writeIntLE=function writeIntLE(value,offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0;var mul=1;var sub=value<0?1:0;this[offset]=value&255;while(++i<byteLength&&(mul*=256))this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength};Buffer.prototype.writeIntBE=function writeIntBE(value,
offset,byteLength,noAssert){value=+value;offset=offset|0;if(!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1;var mul=1;var sub=value<0?1:0;this[offset+i]=value&255;while(--i>=0&&(mul*=256))this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength};Buffer.prototype.writeInt8=function writeInt8(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,1,127,-128);if(!Buffer.TYPED_ARRAY_SUPPORT)value=
Math.floor(value);if(value<0)value=255+value+1;this[offset]=value&255;return offset+1};Buffer.prototype.writeInt16LE=function writeInt16LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8}else objectWriteUInt16(this,value,offset,true);return offset+2};Buffer.prototype.writeInt16BE=function writeInt16BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,
value,offset,2,32767,-32768);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>8;this[offset+1]=value&255}else objectWriteUInt16(this,value,offset,false);return offset+2};Buffer.prototype.writeInt32LE=function writeInt32LE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value&255;this[offset+1]=value>>>8;this[offset+2]=value>>>16;this[offset+3]=value>>>24}else objectWriteUInt32(this,
value,offset,true);return offset+4};Buffer.prototype.writeInt32BE=function writeInt32BE(value,offset,noAssert){value=+value;offset=offset|0;if(!noAssert)checkInt(this,value,offset,4,2147483647,-2147483648);if(value<0)value=4294967295+value+1;if(Buffer.TYPED_ARRAY_SUPPORT){this[offset]=value>>>24;this[offset+1]=value>>>16;this[offset+2]=value>>>8;this[offset+3]=value&255}else objectWriteUInt32(this,value,offset,false);return offset+4};function checkIEEE754(buf,value,offset,ext,max,min){if(offset+ext>
buf.length)throw new RangeError("index out of range");if(offset<0)throw new RangeError("index out of range");}function writeFloat(buf,value,offset,littleEndian,noAssert){if(!noAssert)checkIEEE754(buf,value,offset,4,3.4028234663852886E38,-3.4028234663852886E38);ieee754.write(buf,value,offset,littleEndian,23,4);return offset+4}Buffer.prototype.writeFloatLE=function writeFloatLE(value,offset,noAssert){return writeFloat(this,value,offset,true,noAssert)};Buffer.prototype.writeFloatBE=function writeFloatBE(value,
offset,noAssert){return writeFloat(this,value,offset,false,noAssert)};function writeDouble(buf,value,offset,littleEndian,noAssert){if(!noAssert)checkIEEE754(buf,value,offset,8,1.7976931348623157E308,-1.7976931348623157E308);ieee754.write(buf,value,offset,littleEndian,52,8);return offset+8}Buffer.prototype.writeDoubleLE=function writeDoubleLE(value,offset,noAssert){return writeDouble(this,value,offset,true,noAssert)};Buffer.prototype.writeDoubleBE=function writeDoubleBE(value,offset,noAssert){return writeDouble(this,
value,offset,false,noAssert)};Buffer.prototype.copy=function copy(target,targetStart,start,end){if(!start)start=0;if(!end&&end!==0)end=this.length;if(targetStart>=target.length)targetStart=target.length;if(!targetStart)targetStart=0;if(end>0&&end<start)end=start;if(end===start)return 0;if(target.length===0||this.length===0)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");
if(end>this.length)end=this.length;if(target.length-targetStart<end-start)end=target.length-targetStart+start;var len=end-start;var i;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;i--)target[i+targetStart]=this[i+start];else if(len<1E3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;i++)target[i+targetStart]=this[i+start];else Uint8Array.prototype.set.call(target,this.subarray(start,start+len),targetStart);return len};Buffer.prototype.fill=function fill(value,start,end){if(!value)value=
0;if(!start)start=0;if(!end)end=this.length;if(end<start)throw new RangeError("end < start");if(end===start)return;if(this.length===0)return;if(start<0||start>=this.length)throw new RangeError("start out of bounds");if(end<0||end>this.length)throw new RangeError("end out of bounds");var i;if(typeof value==="number")for(i=start;i<end;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString());var len=bytes.length;for(i=start;i<end;i++)this[i]=bytes[i%len]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;
function base64clean(str){str=stringtrim(str).replace(INVALID_BASE64_RE,"");if(str.length<2)return"";while(str.length%4!==0)str=str+"=";return str}function stringtrim(str){if(str.trim)return str.trim();return str.replace(/^\s+|\s+$/g,"")}function toHex(n){if(n<16)return"0"+n.toString(16);return n.toString(16)}function utf8ToBytes(string,units){units=units||Infinity;var codePoint;var length=string.length;var leadSurrogate=null;var bytes=[];for(var i=0;i<length;i++){codePoint=string.charCodeAt(i);if(codePoint>
55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){if((units-=3)>-1)bytes.push(239,191,189);continue}else if(i+1===length){if((units-=3)>-1)bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else if(leadSurrogate)if((units-=3)>-1)bytes.push(239,191,189);leadSurrogate=null;if(codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<
2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,codePoint&63|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,codePoint&63|128)}else if(codePoint<1114112){if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,codePoint&63|128)}else throw new Error("Invalid code point");}return bytes}function asciiToBytes(str){var byteArray=[];for(var i=0;i<str.length;i++)byteArray.push(str.charCodeAt(i)&255);return byteArray}
function utf16leToBytes(str,units){var c,hi,lo;var byteArray=[];for(var i=0;i<str.length;i++){if((units-=2)<0)break;c=str.charCodeAt(i);hi=c>>8;lo=c%256;byteArray.push(lo);byteArray.push(hi)}return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length;i++){if(i+offset>=dst.length||i>=src.length)break;dst[i+offset]=src[i]}return i}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:
typeof window!=="undefined"?window:{})},{"base64-js":2,"ieee754":3,"isarray":4}],2:[function(require,module,exports){(function(exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Arr=typeof Uint8Array!=="undefined"?Uint8Array:Array;var PLUS="+".charCodeAt(0);var SLASH="/".charCodeAt(0);var NUMBER="0".charCodeAt(0);var LOWER="a".charCodeAt(0);var UPPER="A".charCodeAt(0);var PLUS_URL_SAFE="-".charCodeAt(0);var SLASH_URL_SAFE="_".charCodeAt(0);function decode(elt){var code=
elt.charCodeAt(0);if(code===PLUS||code===PLUS_URL_SAFE)return 62;if(code===SLASH||code===SLASH_URL_SAFE)return 63;if(code<NUMBER)return-1;if(code<NUMBER+10)return code-NUMBER+26+26;if(code<UPPER+26)return code-UPPER;if(code<LOWER+26)return code-LOWER+26}function b64ToByteArray(b64){var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders=b64.charAt(len-2)==="="?2:b64.charAt(len-1)==="="?1:0;arr=new Arr(b64.length*
3/4-placeHolders);l=placeHolders>0?b64.length-4:b64.length;var L=0;function push(v){arr[L++]=v}for(i=0,j=0;i<l;i+=4,j+=3){tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3));push((tmp&16711680)>>16);push((tmp&65280)>>8);push(tmp&255)}if(placeHolders===2){tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4;push(tmp&255)}else if(placeHolders===1){tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2;push(tmp>>
8&255);push(tmp&255)}return arr}function uint8ToBase64(uint8){var i;var extraBytes=uint8.length%3;var output="";var temp,length;function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(num&63)}for(i=0,length=uint8.length-extraBytes;i<length;i+=3){temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2];output+=tripletToBase64(temp)}switch(extraBytes){case 1:temp=uint8[uint8.length-1];output+=encode(temp>>2);output+=encode(temp<<
4&63);output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1];output+=encode(temp>>10);output+=encode(temp>>4&63);output+=encode(temp<<2&63);output+="=";break;default:break}return output}exports.toByteArray=b64ToByteArray;exports.fromByteArray=uint8ToBase64})(typeof exports==="undefined"?this.base64js={}:exports)},{}],3:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m;var eLen=nBytes*8-mLen-1;var eMax=(1<<eLen)-1;var eBias=eMax>>
1;var nBits=-7;var i=isLE?nBytes-1:0;var d=isLE?-1:1;var s=buffer[offset+i];i+=d;e=s&(1<<-nBits)-1;s>>=-nBits;nBits+=eLen;for(;nBits>0;e=e*256+buffer[offset+i],i+=d,nBits-=8);m=e&(1<<-nBits)-1;e>>=-nBits;nBits+=mLen;for(;nBits>0;m=m*256+buffer[offset+i],i+=d,nBits-=8);if(e===0)e=1-eBias;else if(e===eMax)return m?NaN:(s?-1:1)*Infinity;else{m=m+Math.pow(2,mLen);e=e-eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)};exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c;var eLen=nBytes*8-mLen-
1;var eMax=(1<<eLen)-1;var eBias=eMax>>1;var rt=mLen===23?Math.pow(2,-24)-Math.pow(2,-77):0;var i=isLE?0:nBytes-1;var d=isLE?1:-1;var s=value<0||value===0&&1/value<0?1:0;value=Math.abs(value);if(isNaN(value)||value===Infinity){m=isNaN(value)?1:0;e=eMax}else{e=Math.floor(Math.log(value)/Math.LN2);if(value*(c=Math.pow(2,-e))<1){e--;c*=2}if(e+eBias>=1)value+=rt/c;else value+=rt*Math.pow(2,1-eBias);if(value*c>=2){e++;c/=2}if(e+eBias>=eMax){m=0;e=eMax}else if(e+eBias>=1){m=(value*c-1)*Math.pow(2,mLen);
e=e+eBias}else{m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen);e=0}}for(;mLen>=8;buffer[offset+i]=m&255,i+=d,m/=256,mLen-=8);e=e<<mLen|m;eLen+=mLen;for(;eLen>0;buffer[offset+i]=e&255,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=s*128}},{}],4:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return toString.call(arr)=="[object Array]"}},{}],5:[function(require,module,exports){module.exports=require("./lib/heap")},{"./lib/heap":6}],6:[function(require,module,
exports){(function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min;defaultCmp=function(x,y){if(x<y)return-1;if(x>y)return 1;return 0};insort=function(a,x,lo,hi,cmp){var mid;if(lo==null)lo=0;if(cmp==null)cmp=defaultCmp;if(lo<0)throw new Error("lo must be non-negative");if(hi==null)hi=a.length;while(lo<hi){mid=floor((lo+hi)/2);if(cmp(x,a[mid])<0)hi=mid;else lo=mid+1}return[].splice.apply(a,
[lo,lo-lo].concat(x)),x};heappush=function(array,item,cmp){if(cmp==null)cmp=defaultCmp;array.push(item);return _siftdown(array,0,array.length-1,cmp)};heappop=function(array,cmp){var lastelt,returnitem;if(cmp==null)cmp=defaultCmp;lastelt=array.pop();if(array.length){returnitem=array[0];array[0]=lastelt;_siftup(array,0,cmp)}else returnitem=lastelt;return returnitem};heapreplace=function(array,item,cmp){var returnitem;if(cmp==null)cmp=defaultCmp;returnitem=array[0];array[0]=item;_siftup(array,0,cmp);
return returnitem};heappushpop=function(array,item,cmp){var _ref;if(cmp==null)cmp=defaultCmp;if(array.length&&cmp(array[0],item)<0){_ref=[array[0],item],item=_ref[0],array[0]=_ref[1];_siftup(array,0,cmp)}return item};heapify=function(array,cmp){var i,_i,_j,_len,_ref,_ref1,_results,_results1;if(cmp==null)cmp=defaultCmp;_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse();_results=[];
for(_i=0,_len=_ref1.length;_i<_len;_i++){i=_ref1[_i];_results.push(_siftup(array,i,cmp))}return _results};updateItem=function(array,item,cmp){var pos;if(cmp==null)cmp=defaultCmp;pos=array.indexOf(item);if(pos===-1)return;_siftdown(array,0,pos,cmp);return _siftup(array,pos,cmp)};nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(cmp==null)cmp=defaultCmp;result=array.slice(0,n);if(!result.length)return result;heapify(result,cmp);_ref=array.slice(n);for(_i=0,_len=_ref.length;_i<_len;_i++){elem=
_ref[_i];heappushpop(result,elem,cmp)}return result.sort(cmp).reverse()};nsmallest=function(array,n,cmp){var elem,i,los,result,_i,_j,_len,_ref,_ref1,_results;if(cmp==null)cmp=defaultCmp;if(n*10<=array.length){result=array.slice(0,n).sort(cmp);if(!result.length)return result;los=result[result.length-1];_ref=array.slice(n);for(_i=0,_len=_ref.length;_i<_len;_i++){elem=_ref[_i];if(cmp(elem,los)<0){insort(result,elem,0,null,cmp);result.pop();los=result[result.length-1]}}return result}heapify(array,cmp);
_results=[];for(i=_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;i=0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results};_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;if(cmp==null)cmp=defaultCmp;newitem=array[pos];while(pos>startpos){parentpos=pos-1>>1;parent=array[parentpos];if(cmp(newitem,parent)<0){array[pos]=parent;pos=parentpos;continue}break}return array[pos]=newitem};_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;
if(cmp==null)cmp=defaultCmp;endpos=array.length;startpos=pos;newitem=array[pos];childpos=2*pos+1;while(childpos<endpos){rightpos=childpos+1;if(rightpos<endpos&&!(cmp(array[childpos],array[rightpos])<0))childpos=rightpos;array[pos]=array[childpos];pos=childpos;childpos=2*pos+1}array[pos]=newitem;return _siftdown(array,startpos,pos,cmp)};Heap=function(){Heap.push=heappush;Heap.pop=heappop;Heap.replace=heapreplace;Heap.pushpop=heappushpop;Heap.heapify=heapify;Heap.updateItem=updateItem;Heap.nlargest=
nlargest;Heap.nsmallest=nsmallest;function Heap(cmp){this.cmp=cmp!=null?cmp:defaultCmp;this.nodes=[]}Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)};Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)};Heap.prototype.peek=function(){return this.nodes[0]};Heap.prototype.contains=function(x){return this.nodes.indexOf(x)!==-1};Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)};Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,
x,this.cmp)};Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)};Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)};Heap.prototype.clear=function(){return this.nodes=[]};Heap.prototype.empty=function(){return this.nodes.length===0};Heap.prototype.size=function(){return this.nodes.length};Heap.prototype.clone=function(){var heap;heap=new Heap;heap.nodes=this.nodes.slice(0);return heap};Heap.prototype.toArray=function(){return this.nodes.slice(0)};Heap.prototype.insert=
Heap.prototype.push;Heap.prototype.top=Heap.prototype.peek;Heap.prototype.front=Heap.prototype.peek;Heap.prototype.has=Heap.prototype.contains;Heap.prototype.copy=Heap.prototype.clone;return Heap}();(function(root,factory){if(typeof define==="function"&&define.amd)return define([],factory);else if(typeof exports==="object")return module.exports=factory();else return root.Heap=factory()})(this,function(){return Heap})}).call(this)},{}],7:[function(require,module,exports){(function(global){var numeric=
typeof exports==="undefined"?function numeric(){}:exports;if(typeof global!=="undefined")global.numeric=numeric;numeric.version="1.2.6";numeric.bench=function bench(f,interval){var t1,t2,n,i;if(typeof interval==="undefined")interval=15;n=.5;t1=new Date;while(1){n*=2;for(i=n;i>3;i-=4){f();f();f();f()}while(i>0){f();i--}t2=new Date;if(t2-t1>interval)break}for(i=n;i>3;i-=4){f();f();f();f()}while(i>0){f();i--}t2=new Date;return 1E3*(3*n-1)/(t2-t1)};numeric._myIndexOf=function _myIndexOf(w){var n=this.length,
k;for(k=0;k<n;++k)if(this[k]===w)return k;return-1};numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf;numeric.Function=Function;numeric.precision=4;numeric.largeArray=50;numeric.prettyPrint=function prettyPrint(x){function fmtnum(x){if(x===0)return"0";if(isNaN(x))return"NaN";if(x<0)return"-"+fmtnum(-x);if(isFinite(x)){var scale=Math.floor(Math.log(x)/Math.log(10));var normalized=x/Math.pow(10,scale);var basic=normalized.toPrecision(numeric.precision);if(parseFloat(basic)===
10){scale++;normalized=1;basic=normalized.toPrecision(numeric.precision)}return parseFloat(basic).toString()+"e"+scale.toString()}return"Infinity"}var ret=[];function foo(x){var k;if(typeof x==="undefined"){ret.push(Array(numeric.precision+8).join(" "));return false}if(typeof x==="string"){ret.push('"'+x+'"');return false}if(typeof x==="boolean"){ret.push(x.toString());return false}if(typeof x==="number"){var a=fmtnum(x);var b=x.toPrecision(numeric.precision);var c=parseFloat(x.toString()).toString();
var d=[a,b,c,parseFloat(b).toString(),parseFloat(c).toString()];for(k=1;k<d.length;k++)if(d[k].length<a.length)a=d[k];ret.push(Array(numeric.precision+8-a.length).join(" ")+a);return false}if(x===null){ret.push("null");return false}if(typeof x==="function"){ret.push(x.toString());var flag=false;for(k in x)if(x.hasOwnProperty(k)){if(flag)ret.push(",\n");else ret.push("\n{");flag=true;ret.push(k);ret.push(": \n");foo(x[k])}if(flag)ret.push("}\n");return true}if(x instanceof Array){if(x.length>numeric.largeArray){ret.push("...Large Array...");
return true}var flag=false;ret.push("[");for(k=0;k<x.length;k++){if(k>0){ret.push(",");if(flag)ret.push("\n ")}flag=foo(x[k])}ret.push("]");return true}ret.push("{");var flag=false;for(k in x)if(x.hasOwnProperty(k)){if(flag)ret.push(",\n");flag=true;ret.push(k);ret.push(": \n");foo(x[k])}ret.push("}");return true}foo(x);return ret.join("")};numeric.parseDate=function parseDate(d){function foo(d){if(typeof d==="string")return Date.parse(d.replace(/-/g,"/"));if(!(d instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");
var ret=[],k;for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}return foo(d)};numeric.parseFloat=function parseFloat_(d){function foo(d){if(typeof d==="string")return parseFloat(d);if(!(d instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var ret=[],k;for(k=0;k<d.length;k++)ret[k]=foo(d[k]);return ret}return foo(d)};numeric.parseCSV=function parseCSV(t){var foo=t.split("\n");var j,k;var ret=[];var pat=/(([^'",]*)|('[^']*')|("[^"]*")),/g;var patnum=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/;
var stripper=function(n){return n.substr(0,n.length-1)};var count=0;for(k=0;k<foo.length;k++){var bar=(foo[k]+",").match(pat),baz;if(bar.length>0){ret[count]=[];for(j=0;j<bar.length;j++){baz=stripper(bar[j]);if(patnum.test(baz))ret[count][j]=parseFloat(baz);else ret[count][j]=baz}count++}}return ret};numeric.toCSV=function toCSV(A){var s=numeric.dim(A);var i,j,m,n,row,ret;m=s[0];n=s[1];ret=[];for(i=0;i<m;i++){row=[];for(j=0;j<m;j++)row[j]=A[i][j].toString();ret[i]=row.join(", ")}return ret.join("\n")+
"\n"};numeric.getURL=function getURL(url){var client=new XMLHttpRequest;client.open("GET",url,false);client.send();return client};numeric.imageURL=function imageURL(img){function base64(A){var n=A.length,i,x,y,z,p,q,r,s;var key="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var ret="";for(i=0;i<n;i+=3){x=A[i];y=A[i+1];z=A[i+2];p=x>>2;q=((x&3)<<4)+(y>>4);r=((y&15)<<2)+(z>>6);s=z&63;if(i+1>=n)r=s=64;else if(i+2>=n)s=64;ret+=key.charAt(p)+key.charAt(q)+key.charAt(r)+key.charAt(s)}return ret}
function crc32Array(a,from,to){if(typeof from==="undefined")from=0;if(typeof to==="undefined")to=a.length;var table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,
1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,
1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,
1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,
628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,
3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];var crc=-1,y=0,n=a.length,i;for(i=from;i<to;i++){y=(crc^a[i])&255;crc=crc>>>8^table[y]}return crc^-1}var h=img[0].length,w=img[0][0].length,s1,s2,next,k,length,a,b,i,j,
adler32,crc32;var stream=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,w>>24&255,w>>16&255,w>>8&255,w&255,h>>24&255,h>>16&255,h>>8&255,h&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];crc32=crc32Array(stream,12,29);stream[29]=crc32>>24&255;stream[30]=crc32>>16&255;stream[31]=crc32>>8&255;stream[32]=crc32&255;s1=1;s2=0;for(i=0;i<h;i++){if(i<h-1)stream.push(0);else stream.push(1);a=3*w+1+(i===0)&255;b=3*w+1+(i===0)>>8&255;stream.push(a);stream.push(b);stream.push(~a&255);stream.push(~b&255);
if(i===0)stream.push(0);for(j=0;j<w;j++)for(k=0;k<3;k++){a=img[k][i][j];if(a>255)a=255;else if(a<0)a=0;else a=Math.round(a);s1=(s1+a)%65521;s2=(s2+s1)%65521;stream.push(a)}stream.push(0)}adler32=(s2<<16)+s1;stream.push(adler32>>24&255);stream.push(adler32>>16&255);stream.push(adler32>>8&255);stream.push(adler32&255);length=stream.length-41;stream[33]=length>>24&255;stream[34]=length>>16&255;stream[35]=length>>8&255;stream[36]=length&255;crc32=crc32Array(stream,37);stream.push(crc32>>24&255);stream.push(crc32>>
16&255);stream.push(crc32>>8&255);stream.push(crc32&255);stream.push(0);stream.push(0);stream.push(0);stream.push(0);stream.push(73);stream.push(69);stream.push(78);stream.push(68);stream.push(174);stream.push(66);stream.push(96);stream.push(130);return"data:image/png;base64,"+base64(stream)};numeric._dim=function _dim(x){var ret=[];while(typeof x==="object"){ret.push(x.length);x=x[0]}return ret};numeric.dim=function dim(x){var y,z;if(typeof x==="object"){y=x[0];if(typeof y==="object"){z=y[0];if(typeof z===
"object")return numeric._dim(x);return[x.length,y.length]}return[x.length]}return[]};numeric.mapreduce=function mapreduce(body,init){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+init+";\n"+'if(typeof x === "number") { var xi = x; '+body+"; return accum; }\n"+'if(typeof _s === "undefined") _s = numeric.dim(x);\n'+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i,xi;\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) {\n"+"        accum = arguments.callee(x[i],accum,_s,_k+1);\n"+
"    }"+"    return accum;\n"+"}\n"+"for(i=_n-1;i>=1;i-=2) { \n"+"    xi = x[i];\n"+"    "+body+";\n"+"    xi = x[i-1];\n"+"    "+body+";\n"+"}\n"+"if(i === 0) {\n"+"    xi = x[i];\n"+"    "+body+"\n"+"}\n"+"return accum;")};numeric.mapreduce2=function mapreduce2(body,setup){return Function("x","var n = x.length;\n"+"var i,xi;\n"+setup+";\n"+"for(i=n-1;i!==-1;--i) { \n"+"    xi = x[i];\n"+"    "+body+";\n"+"}\n"+"return accum;")};numeric.same=function same(x,y){var i,n;if(!(x instanceof Array)||!(y instanceof
Array))return false;n=x.length;if(n!==y.length)return false;for(i=0;i<n;i++){if(x[i]===y[i])continue;if(typeof x[i]==="object"){if(!same(x[i],y[i]))return false}else return false}return true};numeric.rep=function rep(s,v,k){if(typeof k==="undefined")k=0;var n=s[k],ret=Array(n),i;if(k===s.length-1){for(i=n-2;i>=0;i-=2){ret[i+1]=v;ret[i]=v}if(i===-1)ret[0]=v;return ret}for(i=n-1;i>=0;i--)ret[i]=numeric.rep(s,v,k+1);return ret};numeric.dotMMsmall=function dotMMsmall(x,y){var i,j,k,p,q,r,ret,foo,bar,
woo,i0,k0,p0,r0;p=x.length;q=y.length;r=y[0].length;ret=Array(p);for(i=p-1;i>=0;i--){foo=Array(r);bar=x[i];for(k=r-1;k>=0;k--){woo=bar[q-1]*y[q-1][k];for(j=q-2;j>=1;j-=2){i0=j-1;woo+=bar[j]*y[j][k]+bar[i0]*y[i0][k]}if(j===0)woo+=bar[0]*y[0][k];foo[k]=woo}ret[i]=foo}return ret};numeric._getCol=function _getCol(A,j,x){var n=A.length,i;for(i=n-1;i>0;--i){x[i]=A[i][j];--i;x[i]=A[i][j]}if(i===0)x[0]=A[0][j]};numeric.dotMMbig=function dotMMbig(x,y){var gc=numeric._getCol,p=y.length,v=Array(p);var m=x.length,
n=y[0].length,A=new Array(m),xj;var VV=numeric.dotVV;var i,j,k,z;--p;--m;for(i=m;i!==-1;--i)A[i]=Array(n);--n;for(i=n;i!==-1;--i){gc(y,i,v);for(j=m;j!==-1;--j){z=0;xj=x[j];A[j][i]=VV(xj,v)}}return A};numeric.dotMV=function dotMV(x,y){var p=x.length,q=y.length,i;var ret=Array(p),dotVV=numeric.dotVV;for(i=p-1;i>=0;i--)ret[i]=dotVV(x[i],y);return ret};numeric.dotVM=function dotVM(x,y){var i,j,k,p,q,r,ret,foo,bar,woo,i0,k0,p0,r0,s1,s2,s3,baz,accum;p=x.length;q=y[0].length;ret=Array(q);for(k=q-1;k>=0;k--){woo=
x[p-1]*y[p-1][k];for(j=p-2;j>=1;j-=2){i0=j-1;woo+=x[j]*y[j][k]+x[i0]*y[i0][k]}if(j===0)woo+=x[0]*y[0][k];ret[k]=woo}return ret};numeric.dotVV=function dotVV(x,y){var i,n=x.length,i1,ret=x[n-1]*y[n-1];for(i=n-2;i>=1;i-=2){i1=i-1;ret+=x[i]*y[i]+x[i1]*y[i1]}if(i===0)ret+=x[0]*y[0];return ret};numeric.dot=function dot(x,y){var d=numeric.dim;switch(d(x).length*1E3+d(y).length){case 2002:if(y.length<10)return numeric.dotMMsmall(x,y);else return numeric.dotMMbig(x,y);case 2001:return numeric.dotMV(x,y);
case 1002:return numeric.dotVM(x,y);case 1001:return numeric.dotVV(x,y);case 1E3:return numeric.mulVS(x,y);case 1:return numeric.mulSV(x,y);case 0:return x*y;default:throw new Error("numeric.dot only works on vectors and matrices");}};numeric.diag=function diag(d){var i,i1,j,n=d.length,A=Array(n),Ai;for(i=n-1;i>=0;i--){Ai=Array(n);i1=i+2;for(j=n-1;j>=i1;j-=2){Ai[j]=0;Ai[j-1]=0}if(j>i)Ai[j]=0;Ai[i]=d[i];for(j=i-1;j>=1;j-=2){Ai[j]=0;Ai[j-1]=0}if(j===0)Ai[0]=0;A[i]=Ai}return A};numeric.getDiag=function(A){var n=
Math.min(A.length,A[0].length),i,ret=Array(n);for(i=n-1;i>=1;--i){ret[i]=A[i][i];--i;ret[i]=A[i][i]}if(i===0)ret[0]=A[0][0];return ret};numeric.identity=function identity(n){return numeric.diag(numeric.rep([n],1))};numeric.pointwise=function pointwise(params,body,setup){if(typeof setup==="undefined")setup="";var fun=[];var k;var avec=/\[i\]$/,p,thevec="";var haveret=false;for(k=0;k<params.length;k++){if(avec.test(params[k])){p=params[k].substring(0,params[k].length-3);thevec=p}else p=params[k];if(p===
"ret")haveret=true;fun.push(p)}fun[params.length]="_s";fun[params.length+1]="_k";fun[params.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+thevec+");\n"+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i"+(haveret?"":", ret = Array(_n)")+";\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+params.join(",")+",_s,_k+1);\n"+"    return ret;\n"+"}\n"+setup+"\n"+"for(i=_n-1;i!==-1;--i) {\n"+"    "+body+"\n"+"}\n"+"return ret;";return Function.apply(null,
fun)};numeric.pointwise2=function pointwise2(params,body,setup){if(typeof setup==="undefined")setup="";var fun=[];var k;var avec=/\[i\]$/,p,thevec="";var haveret=false;for(k=0;k<params.length;k++){if(avec.test(params[k])){p=params[k].substring(0,params[k].length-3);thevec=p}else p=params[k];if(p==="ret")haveret=true;fun.push(p)}fun[params.length]="var _n = "+thevec+".length;\n"+"var i"+(haveret?"":", ret = Array(_n)")+";\n"+setup+"\n"+"for(i=_n-1;i!==-1;--i) {\n"+body+"\n"+"}\n"+"return ret;";return Function.apply(null,
fun)};numeric._biforeach=function _biforeach(x,y,s,k,f){if(k===s.length-1){f(x,y);return}var i,n=s[k];for(i=n-1;i>=0;i--)_biforeach(typeof x==="object"?x[i]:x,typeof y==="object"?y[i]:y,s,k+1,f)};numeric._biforeach2=function _biforeach2(x,y,s,k,f){if(k===s.length-1)return f(x,y);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;--i)ret[i]=_biforeach2(typeof x==="object"?x[i]:x,typeof y==="object"?y[i]:y,s,k+1,f);return ret};numeric._foreach=function _foreach(x,s,k,f){if(k===s.length-1){f(x);return}var i,n=
s[k];for(i=n-1;i>=0;i--)_foreach(x[i],s,k+1,f)};numeric._foreach2=function _foreach2(x,s,k,f){if(k===s.length-1)return f(x);var i,n=s[k],ret=Array(n);for(i=n-1;i>=0;i--)ret[i]=_foreach2(x[i],s,k+1,f);return ret};numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",
bandeq:"&=",boreq:"|=",bxoreq:"^="};numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];numeric.mathfuns2=["atan2","pow","max","min"];numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""};numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],
norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};(function(){var i,o;for(i=0;i<numeric.mathfuns2.length;++i){o=numeric.mathfuns2[i];numeric.ops2[o]=o}for(i in numeric.ops2)if(numeric.ops2.hasOwnProperty(i)){o=numeric.ops2[i];var code,codeeq,setup="";if(numeric.myIndexOf.call(numeric.mathfuns2,
i)!==-1){setup="var "+o+" = Math."+o+";\n";code=function(r,x,y){return r+" = "+o+"("+x+","+y+")"};codeeq=function(x,y){return x+" = "+o+"("+x+","+y+")"}}else{code=function(r,x,y){return r+" = "+x+" "+o+" "+y};if(numeric.opseq.hasOwnProperty(i+"eq"))codeeq=function(x,y){return x+" "+o+"= "+y};else codeeq=function(x,y){return x+" = "+x+" "+o+" "+y}}numeric[i+"VV"]=numeric.pointwise2(["x[i]","y[i]"],code("ret[i]","x[i]","y[i]"),setup);numeric[i+"SV"]=numeric.pointwise2(["x","y[i]"],code("ret[i]","x",
"y[i]"),setup);numeric[i+"VS"]=numeric.pointwise2(["x[i]","y"],code("ret[i]","x[i]","y"),setup);numeric[i]=Function("var n = arguments.length, i, x = arguments[0], y;\n"+"var VV = numeric."+i+"VV, VS = numeric."+i+"VS, SV = numeric."+i+"SV;\n"+"var dim = numeric.dim;\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];\n"+'  if(typeof x === "object") {\n'+'      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n'+"      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n"+'  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n'+
"  else "+codeeq("x","y")+"\n"+"}\nreturn x;\n");numeric[o]=numeric[i];numeric[i+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],codeeq("ret[i]","x[i]"),setup);numeric[i+"eqS"]=numeric.pointwise2(["ret[i]","x"],codeeq("ret[i]","x"),setup);numeric[i+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\n"+"var V = numeric."+i+"eqV, S = numeric."+i+"eqS\n"+"var s = numeric.dim(x);\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];\n"+'  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n'+
"  else numeric._biforeach(x,y,s,0,S);\n"+"}\nreturn x;\n")}for(i=0;i<numeric.mathfuns2.length;++i){o=numeric.mathfuns2[i];delete numeric.ops2[o]}for(i=0;i<numeric.mathfuns.length;++i){o=numeric.mathfuns[i];numeric.ops1[o]=o}for(i in numeric.ops1)if(numeric.ops1.hasOwnProperty(i)){setup="";o=numeric.ops1[i];if(numeric.myIndexOf.call(numeric.mathfuns,i)!==-1)if(Math.hasOwnProperty(o))setup="var "+o+" = Math."+o+";\n";numeric[i+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+o+"(ret[i]);",setup);numeric[i+
"eq"]=Function("x",'if(typeof x !== "object") return '+o+"x\n"+"var i;\n"+"var V = numeric."+i+"eqV;\n"+"var s = numeric.dim(x);\n"+"numeric._foreach(x,s,0,V);\n"+"return x;\n");numeric[i+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+o+"(x[i]);",setup);numeric[i]=Function("x",'if(typeof x !== "object") return '+o+"(x)\n"+"var i;\n"+"var V = numeric."+i+"V;\n"+"var s = numeric.dim(x);\n"+"return numeric._foreach2(x,s,0,V);\n")}for(i=0;i<numeric.mathfuns.length;++i){o=numeric.mathfuns[i];delete numeric.ops1[o]}for(i in numeric.mapreducers)if(numeric.mapreducers.hasOwnProperty(i)){o=
numeric.mapreducers[i];numeric[i+"V"]=numeric.mapreduce2(o[0],o[1]);numeric[i]=Function("x","s","k",o[1]+'if(typeof x !== "object") {'+"    xi = x;\n"+o[0]+";\n"+"    return accum;\n"+"}"+'if(typeof s === "undefined") s = numeric.dim(x);\n'+'if(typeof k === "undefined") k = 0;\n'+"if(k === s.length-1) return numeric."+i+"V(x);\n"+"var xi;\n"+"var n = x.length, i;\n"+"for(i=n-1;i!==-1;--i) {\n"+"   xi = arguments.callee(x[i]);\n"+o[0]+";\n"+"}\n"+"return accum;\n")}})();numeric.truncVV=numeric.pointwise(["x[i]",
"y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;");numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;");numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;");numeric.trunc=function trunc(x,y){if(typeof x==="object"){if(typeof y==="object")return numeric.truncVV(x,y);return numeric.truncVS(x,y)}if(typeof y==="object")return numeric.truncSV(x,y);return Math.round(x/y)*y};numeric.inv=
function inv(x){var s=numeric.dim(x),abs=Math.abs,m=s[0],n=s[1];var A=numeric.clone(x),Ai,Aj;var I=numeric.identity(m),Ii,Ij;var i,j,k,x;for(j=0;j<n;++j){var i0=-1;var v0=-1;for(i=j;i!==m;++i){k=abs(A[i][j]);if(k>v0){i0=i;v0=k}}Aj=A[i0];A[i0]=A[j];A[j]=Aj;Ij=I[i0];I[i0]=I[j];I[j]=Ij;x=Aj[j];for(k=j;k!==n;++k)Aj[k]/=x;for(k=n-1;k!==-1;--k)Ij[k]/=x;for(i=m-1;i!==-1;--i)if(i!==j){Ai=A[i];Ii=I[i];x=Ai[j];for(k=j+1;k!==n;++k)Ai[k]-=Aj[k]*x;for(k=n-1;k>0;--k){Ii[k]-=Ij[k]*x;--k;Ii[k]-=Ij[k]*x}if(k===0)Ii[0]-=
Ij[0]*x}}return I};numeric.det=function det(x){var s=numeric.dim(x);if(s.length!==2||s[0]!==s[1])throw new Error("numeric: det() only works on square matrices");var n=s[0],ret=1,i,j,k,A=numeric.clone(x),Aj,Ai,alpha,temp,k1,k2,k3;for(j=0;j<n-1;j++){k=j;for(i=j+1;i<n;i++)if(Math.abs(A[i][j])>Math.abs(A[k][j]))k=i;if(k!==j){temp=A[k];A[k]=A[j];A[j]=temp;ret*=-1}Aj=A[j];for(i=j+1;i<n;i++){Ai=A[i];alpha=Ai[j]/Aj[j];for(k=j+1;k<n-1;k+=2){k1=k+1;Ai[k]-=Aj[k]*alpha;Ai[k1]-=Aj[k1]*alpha}if(k!==n)Ai[k]-=Aj[k]*
alpha}if(Aj[j]===0)return 0;ret*=Aj[j]}return ret*A[j][j]};numeric.transpose=function transpose(x){var i,j,m=x.length,n=x[0].length,ret=Array(n),A0,A1,Bj;for(j=0;j<n;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){A1=x[i];A0=x[i-1];for(j=n-1;j>=1;--j){Bj=ret[j];Bj[i]=A1[j];Bj[i-1]=A0[j];--j;Bj=ret[j];Bj[i]=A1[j];Bj[i-1]=A0[j]}if(j===0){Bj=ret[0];Bj[i]=A1[0];Bj[i-1]=A0[0]}}if(i===0){A0=x[0];for(j=n-1;j>=1;--j){ret[j][0]=A0[j];--j;ret[j][0]=A0[j]}if(j===0)ret[0][0]=A0[0]}return ret};numeric.negtranspose=function negtranspose(x){var i,
j,m=x.length,n=x[0].length,ret=Array(n),A0,A1,Bj;for(j=0;j<n;j++)ret[j]=Array(m);for(i=m-1;i>=1;i-=2){A1=x[i];A0=x[i-1];for(j=n-1;j>=1;--j){Bj=ret[j];Bj[i]=-A1[j];Bj[i-1]=-A0[j];--j;Bj=ret[j];Bj[i]=-A1[j];Bj[i-1]=-A0[j]}if(j===0){Bj=ret[0];Bj[i]=-A1[0];Bj[i-1]=-A0[0]}}if(i===0){A0=x[0];for(j=n-1;j>=1;--j){ret[j][0]=-A0[j];--j;ret[j][0]=-A0[j]}if(j===0)ret[0][0]=-A0[0]}return ret};numeric._random=function _random(s,k){var i,n=s[k],ret=Array(n),rnd;if(k===s.length-1){rnd=Math.random;for(i=n-1;i>=1;i-=
2){ret[i]=rnd();ret[i-1]=rnd()}if(i===0)ret[0]=rnd();return ret}for(i=n-1;i>=0;i--)ret[i]=_random(s,k+1);return ret};numeric.random=function random(s){return numeric._random(s,0)};numeric.norm2=function norm2(x){return Math.sqrt(numeric.norm2Squared(x))};numeric.linspace=function linspace(a,b,n){if(typeof n==="undefined")n=Math.max(Math.round(b-a)+1,1);if(n<2)return n===1?[a]:[];var i,ret=Array(n);n--;for(i=n;i>=0;i--)ret[i]=(i*b+(n-i)*a)/n;return ret};numeric.getBlock=function getBlock(x,from,to){var s=
numeric.dim(x);function foo(x,k){var i,a=from[k],n=to[k]-a,ret=Array(n);if(k===s.length-1){for(i=n;i>=0;i--)ret[i]=x[i+a];return ret}for(i=n;i>=0;i--)ret[i]=foo(x[i+a],k+1);return ret}return foo(x,0)};numeric.setBlock=function setBlock(x,from,to,B){var s=numeric.dim(x);function foo(x,y,k){var i,a=from[k],n=to[k]-a;if(k===s.length-1)for(i=n;i>=0;i--)x[i+a]=y[i];for(i=n;i>=0;i--)foo(x[i+a],y[i],k+1)}foo(x,B,0);return x};numeric.getRange=function getRange(A,I,J){var m=I.length,n=J.length;var i,j;var B=
Array(m),Bi,AI;for(i=m-1;i!==-1;--i){B[i]=Array(n);Bi=B[i];AI=A[I[i]];for(j=n-1;j!==-1;--j)Bi[j]=AI[J[j]]}return B};numeric.blockMatrix=function blockMatrix(X){var s=numeric.dim(X);if(s.length<4)return numeric.blockMatrix([X]);var m=s[0],n=s[1],M,N,i,j,Xij;M=0;N=0;for(i=0;i<m;++i)M+=X[i][0].length;for(j=0;j<n;++j)N+=X[0][j][0].length;var Z=Array(M);for(i=0;i<M;++i)Z[i]=Array(N);var I=0,J,ZI,k,l,Xijk;for(i=0;i<m;++i){J=N;for(j=n-1;j!==-1;--j){Xij=X[i][j];J-=Xij[0].length;for(k=Xij.length-1;k!==-1;--k){Xijk=
Xij[k];ZI=Z[I+k];for(l=Xijk.length-1;l!==-1;--l)ZI[J+l]=Xijk[l]}}I+=X[i][0].length}return Z};numeric.tensor=function tensor(x,y){if(typeof x==="number"||typeof y==="number")return numeric.mul(x,y);var s1=numeric.dim(x),s2=numeric.dim(y);if(s1.length!==1||s2.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var m=s1[0],n=s2[0],A=Array(m),Ai,i,j,xi;for(i=m-1;i>=0;i--){Ai=Array(n);xi=x[i];for(j=n-1;j>=3;--j){Ai[j]=xi*y[j];--j;Ai[j]=xi*y[j];--j;Ai[j]=xi*y[j];--j;Ai[j]=
xi*y[j]}while(j>=0){Ai[j]=xi*y[j];--j}A[i]=Ai}return A};numeric.T=function T(x,y){this.x=x;this.y=y};numeric.t=function t(x,y){return new numeric.T(x,y)};numeric.Tbinop=function Tbinop(rr,rc,cr,cc,setup){var io=numeric.indexOf;if(typeof setup!=="string"){var k;setup="";for(k in numeric)if(numeric.hasOwnProperty(k)&&(rr.indexOf(k)>=0||rc.indexOf(k)>=0||cr.indexOf(k)>=0||cc.indexOf(k)>=0)&&k.length>1)setup+="var "+k+" = numeric."+k+";\n"}return Function(["y"],"var x = this;\n"+"if(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+
setup+"\n"+"if(x.y) {"+"  if(y.y) {"+"    return new numeric.T("+cc+");\n"+"  }\n"+"  return new numeric.T("+cr+");\n"+"}\n"+"if(y.y) {\n"+"  return new numeric.T("+rc+");\n"+"}\n"+"return new numeric.T("+rr+");\n")};numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)");numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)");numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)",
"mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))");numeric.T.prototype.reciprocal=function reciprocal(){var mul=numeric.mul,div=numeric.div;if(this.y){var d=numeric.add(mul(this.x,this.x),mul(this.y,this.y));return new numeric.T(div(this.x,d),div(numeric.neg(this.y),d))}return new T(div(1,this.x))};numeric.T.prototype.div=function div(y){if(!(y instanceof numeric.T))y=new numeric.T(y);if(y.y)return this.mul(y.reciprocal());var div=
numeric.div;if(this.y)return new numeric.T(div(this.x,y.x),div(this.y,y.x));return new numeric.T(div(this.x,y.x))};numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))");numeric.T.prototype.transpose=function transpose(){var t=numeric.transpose,x=this.x,y=this.y;if(y)return new numeric.T(t(x),t(y));return new numeric.T(t(x))};numeric.T.prototype.transjugate=function transjugate(){var t=
numeric.transpose,x=this.x,y=this.y;if(y)return new numeric.T(t(x),numeric.negtranspose(y));return new numeric.T(t(x))};numeric.Tunop=function Tunop(r,c,s){if(typeof s!=="string")s="";return Function("var x = this;\n"+s+"\n"+"if(x.y) {"+"  "+c+";\n"+"}\n"+r+";\n")};numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;");numeric.T.prototype.conj=
numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));");numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;");numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));");numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);");numeric.T.prototype.abs=
numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;");numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\n"+"return new numeric.T(numeric.log(r.x),theta.x);");numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\n"+"return Math.sqrt(f(x.x)+f(x.y));");numeric.T.prototype.inv=
function inv(){var A=this;if(typeof A.y==="undefined")return new numeric.T(numeric.inv(A.x));var n=A.x.length,i,j,k;var Rx=numeric.identity(n),Ry=numeric.rep([n,n],0);var Ax=numeric.clone(A.x),Ay=numeric.clone(A.y);var Aix,Aiy,Ajx,Ajy,Rix,Riy,Rjx,Rjy;var i,j,k,d,d1,ax,ay,bx,by,temp;for(i=0;i<n;i++){ax=Ax[i][i];ay=Ay[i][i];d=ax*ax+ay*ay;k=i;for(j=i+1;j<n;j++){ax=Ax[j][i];ay=Ay[j][i];d1=ax*ax+ay*ay;if(d1>d){k=j;d=d1}}if(k!==i){temp=Ax[i];Ax[i]=Ax[k];Ax[k]=temp;temp=Ay[i];Ay[i]=Ay[k];Ay[k]=temp;temp=
Rx[i];Rx[i]=Rx[k];Rx[k]=temp;temp=Ry[i];Ry[i]=Ry[k];Ry[k]=temp}Aix=Ax[i];Aiy=Ay[i];Rix=Rx[i];Riy=Ry[i];ax=Aix[i];ay=Aiy[i];for(j=i+1;j<n;j++){bx=Aix[j];by=Aiy[j];Aix[j]=(bx*ax+by*ay)/d;Aiy[j]=(by*ax-bx*ay)/d}for(j=0;j<n;j++){bx=Rix[j];by=Riy[j];Rix[j]=(bx*ax+by*ay)/d;Riy[j]=(by*ax-bx*ay)/d}for(j=i+1;j<n;j++){Ajx=Ax[j];Ajy=Ay[j];Rjx=Rx[j];Rjy=Ry[j];ax=Ajx[i];ay=Ajy[i];for(k=i+1;k<n;k++){bx=Aix[k];by=Aiy[k];Ajx[k]-=bx*ax-by*ay;Ajy[k]-=by*ax+bx*ay}for(k=0;k<n;k++){bx=Rix[k];by=Riy[k];Rjx[k]-=bx*ax-by*
ay;Rjy[k]-=by*ax+bx*ay}}}for(i=n-1;i>0;i--){Rix=Rx[i];Riy=Ry[i];for(j=i-1;j>=0;j--){Rjx=Rx[j];Rjy=Ry[j];ax=Ax[j][i];ay=Ay[j][i];for(k=n-1;k>=0;k--){bx=Rix[k];by=Riy[k];Rjx[k]-=ax*bx-ay*by;Rjy[k]-=ax*by+ay*bx}}}return new numeric.T(Rx,Ry)};numeric.T.prototype.get=function get(i){var x=this.x,y=this.y,k=0,ik,n=i.length;if(y){while(k<n){ik=i[k];x=x[ik];y=y[ik];k++}return new numeric.T(x,y)}while(k<n){ik=i[k];x=x[ik];k++}return new numeric.T(x)};numeric.T.prototype.set=function set(i,v){var x=this.x,
y=this.y,k=0,ik,n=i.length,vx=v.x,vy=v.y;if(n===0){if(vy)this.y=vy;else if(y)this.y=undefined;this.x=x;return this}if(vy){if(y);else{y=numeric.rep(numeric.dim(x),0);this.y=y}while(k<n-1){ik=i[k];x=x[ik];y=y[ik];k++}ik=i[k];x[ik]=vx;y[ik]=vy;return this}if(y){while(k<n-1){ik=i[k];x=x[ik];y=y[ik];k++}ik=i[k];x[ik]=vx;if(vx instanceof Array)y[ik]=numeric.rep(numeric.dim(vx),0);else y[ik]=0;return this}while(k<n-1){ik=i[k];x=x[ik];k++}ik=i[k];x[ik]=vx;return this};numeric.T.prototype.getRows=function getRows(i0,
i1){var n=i1-i0+1,j;var rx=Array(n),ry,x=this.x,y=this.y;for(j=i0;j<=i1;j++)rx[j-i0]=x[j];if(y){ry=Array(n);for(j=i0;j<=i1;j++)ry[j-i0]=y[j];return new numeric.T(rx,ry)}return new numeric.T(rx)};numeric.T.prototype.setRows=function setRows(i0,i1,A){var j;var rx=this.x,ry=this.y,x=A.x,y=A.y;for(j=i0;j<=i1;j++)rx[j]=x[j-i0];if(y){if(!ry){ry=numeric.rep(numeric.dim(rx),0);this.y=ry}for(j=i0;j<=i1;j++)ry[j]=y[j-i0]}else if(ry)for(j=i0;j<=i1;j++)ry[j]=numeric.rep([x[j-i0].length],0);return this};numeric.T.prototype.getRow=
function getRow(k){var x=this.x,y=this.y;if(y)return new numeric.T(x[k],y[k]);return new numeric.T(x[k])};numeric.T.prototype.setRow=function setRow(i,v){var rx=this.x,ry=this.y,x=v.x,y=v.y;rx[i]=x;if(y){if(!ry){ry=numeric.rep(numeric.dim(rx),0);this.y=ry}ry[i]=y}else if(ry)ry=numeric.rep([x.length],0);return this};numeric.T.prototype.getBlock=function getBlock(from,to){var x=this.x,y=this.y,b=numeric.getBlock;if(y)return new numeric.T(b(x,from,to),b(y,from,to));return new numeric.T(b(x,from,to))};
numeric.T.prototype.setBlock=function setBlock(from,to,A){if(!(A instanceof numeric.T))A=new numeric.T(A);var x=this.x,y=this.y,b=numeric.setBlock,Ax=A.x,Ay=A.y;if(Ay){if(!y){this.y=numeric.rep(numeric.dim(this),0);y=this.y}b(x,from,to,Ax);b(y,from,to,Ay);return this}b(x,from,to,Ax);if(y)b(y,from,to,numeric.rep(numeric.dim(Ax),0))};numeric.T.rep=function rep(s,v){var T=numeric.T;if(!(v instanceof T))v=new T(v);var x=v.x,y=v.y,r=numeric.rep;if(y)return new T(r(s,x),r(s,y));return new T(r(s,x))};numeric.T.diag=
function diag(d){if(!(d instanceof numeric.T))d=new numeric.T(d);var x=d.x,y=d.y,diag=numeric.diag;if(y)return new numeric.T(diag(x),diag(y));return new numeric.T(diag(x))};numeric.T.eig=function eig(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)};numeric.T.identity=function identity(n){return new numeric.T(numeric.identity(n))};numeric.T.prototype.getDiag=function getDiag(){var n=numeric;var x=this.x,y=this.y;if(y)return new n.T(n.getDiag(x),
n.getDiag(y));return new n.T(n.getDiag(x))};numeric.house=function house(x){var v=numeric.clone(x);var s=x[0]>=0?1:-1;var alpha=s*numeric.norm2(x);v[0]+=alpha;var foo=numeric.norm2(v);if(foo===0)throw new Error("eig: internal error");return numeric.div(v,foo)};numeric.toUpperHessenberg=function toUpperHessenberg(me){var s=numeric.dim(me);if(s.length!==2||s[0]!==s[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var m=s[0],i,j,k,x,v,A=numeric.clone(me),B,C,Ai,Ci,Q=numeric.identity(m),
Qi;for(j=0;j<m-2;j++){x=Array(m-j-1);for(i=j+1;i<m;i++)x[i-j-1]=A[i][j];if(numeric.norm2(x)>0){v=numeric.house(x);B=numeric.getBlock(A,[j+1,j],[m-1,m-1]);C=numeric.tensor(v,numeric.dot(v,B));for(i=j+1;i<m;i++){Ai=A[i];Ci=C[i-j-1];for(k=j;k<m;k++)Ai[k]-=2*Ci[k-j]}B=numeric.getBlock(A,[0,j+1],[m-1,m-1]);C=numeric.tensor(numeric.dot(B,v),v);for(i=0;i<m;i++){Ai=A[i];Ci=C[i];for(k=j+1;k<m;k++)Ai[k]-=2*Ci[k-j-1]}B=Array(m-j-1);for(i=j+1;i<m;i++)B[i-j-1]=Q[i];C=numeric.tensor(v,numeric.dot(v,B));for(i=j+
1;i<m;i++){Qi=Q[i];Ci=C[i-j-1];for(k=0;k<m;k++)Qi[k]-=2*Ci[k]}}}return{H:A,Q:Q}};numeric.epsilon=2.220446049250313E-16;numeric.QRFrancis=function(H,maxiter){if(typeof maxiter==="undefined")maxiter=1E4;H=numeric.clone(H);var H0=numeric.clone(H);var s=numeric.dim(H),m=s[0],x,v,a,b,c,d,det,tr,Hloc,Q=numeric.identity(m),Qi,Hi,B,C,Ci,i,j,k,iter;if(m<3)return{Q:Q,B:[[0,m-1]]};var epsilon=numeric.epsilon;for(iter=0;iter<maxiter;iter++){for(j=0;j<m-1;j++)if(Math.abs(H[j+1][j])<epsilon*(Math.abs(H[j][j])+
Math.abs(H[j+1][j+1]))){var QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[j,j]),maxiter);var QH2=numeric.QRFrancis(numeric.getBlock(H,[j+1,j+1],[m-1,m-1]),maxiter);B=Array(j+1);for(i=0;i<=j;i++)B[i]=Q[i];C=numeric.dot(QH1.Q,B);for(i=0;i<=j;i++)Q[i]=C[i];B=Array(m-j-1);for(i=j+1;i<m;i++)B[i-j-1]=Q[i];C=numeric.dot(QH2.Q,B);for(i=j+1;i<m;i++)Q[i]=C[i-j-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,j+1))}}a=H[m-2][m-2];b=H[m-2][m-1];c=H[m-1][m-2];d=H[m-1][m-1];tr=a+d;det=a*d-b*c;Hloc=numeric.getBlock(H,
[0,0],[2,2]);if(tr*tr>=4*det){var s1,s2;s1=.5*(tr+Math.sqrt(tr*tr-4*det));s2=.5*(tr-Math.sqrt(tr*tr-4*det));Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,s1+s2)),numeric.diag(numeric.rep([3],s1*s2)))}else Hloc=numeric.add(numeric.sub(numeric.dot(Hloc,Hloc),numeric.mul(Hloc,tr)),numeric.diag(numeric.rep([3],det)));x=[Hloc[0][0],Hloc[1][0],Hloc[2][0]];v=numeric.house(x);B=[H[0],H[1],H[2]];C=numeric.tensor(v,numeric.dot(v,B));for(i=0;i<3;i++){Hi=H[i];Ci=C[i];for(k=0;k<m;k++)Hi[k]-=
2*Ci[k]}B=numeric.getBlock(H,[0,0],[m-1,2]);C=numeric.tensor(numeric.dot(B,v),v);for(i=0;i<m;i++){Hi=H[i];Ci=C[i];for(k=0;k<3;k++)Hi[k]-=2*Ci[k]}B=[Q[0],Q[1],Q[2]];C=numeric.tensor(v,numeric.dot(v,B));for(i=0;i<3;i++){Qi=Q[i];Ci=C[i];for(k=0;k<m;k++)Qi[k]-=2*Ci[k]}var J;for(j=0;j<m-2;j++){for(k=j;k<=j+1;k++)if(Math.abs(H[k+1][k])<epsilon*(Math.abs(H[k][k])+Math.abs(H[k+1][k+1]))){var QH1=numeric.QRFrancis(numeric.getBlock(H,[0,0],[k,k]),maxiter);var QH2=numeric.QRFrancis(numeric.getBlock(H,[k+1,k+
1],[m-1,m-1]),maxiter);B=Array(k+1);for(i=0;i<=k;i++)B[i]=Q[i];C=numeric.dot(QH1.Q,B);for(i=0;i<=k;i++)Q[i]=C[i];B=Array(m-k-1);for(i=k+1;i<m;i++)B[i-k-1]=Q[i];C=numeric.dot(QH2.Q,B);for(i=k+1;i<m;i++)Q[i]=C[i-k-1];return{Q:Q,B:QH1.B.concat(numeric.add(QH2.B,k+1))}}J=Math.min(m-1,j+3);x=Array(J-j);for(i=j+1;i<=J;i++)x[i-j-1]=H[i][j];v=numeric.house(x);B=numeric.getBlock(H,[j+1,j],[J,m-1]);C=numeric.tensor(v,numeric.dot(v,B));for(i=j+1;i<=J;i++){Hi=H[i];Ci=C[i-j-1];for(k=j;k<m;k++)Hi[k]-=2*Ci[k-j]}B=
numeric.getBlock(H,[0,j+1],[m-1,J]);C=numeric.tensor(numeric.dot(B,v),v);for(i=0;i<m;i++){Hi=H[i];Ci=C[i];for(k=j+1;k<=J;k++)Hi[k]-=2*Ci[k-j-1]}B=Array(J-j);for(i=j+1;i<=J;i++)B[i-j-1]=Q[i];C=numeric.tensor(v,numeric.dot(v,B));for(i=j+1;i<=J;i++){Qi=Q[i];Ci=C[i-j-1];for(k=0;k<m;k++)Qi[k]-=2*Ci[k]}}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?");};numeric.eig=function eig(A,maxiter){var QH=numeric.toUpperHessenberg(A);var QB=numeric.QRFrancis(QH.H,maxiter);
var T=numeric.T;var n=A.length,i,k,flag=false,B=QB.B,H=numeric.dot(QB.Q,numeric.dot(QH.H,numeric.transpose(QB.Q)));var Q=new T(numeric.dot(QB.Q,QH.Q)),Q0;var m=B.length,j;var a,b,c,d,p1,p2,disc,x,y,p,q,n1,n2;var sqrt=Math.sqrt;for(k=0;k<m;k++){i=B[k][0];if(i===B[k][1]);else{j=i+1;a=H[i][i];b=H[i][j];c=H[j][i];d=H[j][j];if(b===0&&c===0)continue;p1=-a-d;p2=a*d-b*c;disc=p1*p1-4*p2;if(disc>=0){if(p1<0)x=-.5*(p1-sqrt(disc));else x=-.5*(p1+sqrt(disc));n1=(a-x)*(a-x)+b*b;n2=c*c+(d-x)*(d-x);if(n1>n2){n1=
sqrt(n1);p=(a-x)/n1;q=b/n1}else{n2=sqrt(n2);p=c/n2;q=(d-x)/n2}Q0=new T([[q,-p],[p,q]]);Q.setRows(i,j,Q0.dot(Q.getRows(i,j)))}else{x=-.5*p1;y=.5*sqrt(-disc);n1=(a-x)*(a-x)+b*b;n2=c*c+(d-x)*(d-x);if(n1>n2){n1=sqrt(n1+y*y);p=(a-x)/n1;q=b/n1;x=0;y/=n1}else{n2=sqrt(n2+y*y);p=c/n2;q=(d-x)/n2;x=y/n2;y=0}Q0=new T([[q,-p],[p,q]],[[x,y],[y,-x]]);Q.setRows(i,j,Q0.dot(Q.getRows(i,j)))}}}var R=Q.dot(A).dot(Q.transjugate()),n=A.length,E=numeric.T.identity(n);for(j=0;j<n;j++)if(j>0)for(k=j-1;k>=0;k--){var Rk=R.get([k,
k]),Rj=R.get([j,j]);if(numeric.neq(Rk.x,Rj.x)||numeric.neq(Rk.y,Rj.y)){x=R.getRow(k).getBlock([k],[j-1]);y=E.getRow(j).getBlock([k],[j-1]);E.set([j,k],R.get([k,j]).neg().sub(x.dot(y)).div(Rk.sub(Rj)))}else{E.setRow(j,E.getRow(k));continue}}for(j=0;j<n;j++){x=E.getRow(j);E.setRow(j,x.div(x.norm2()))}E=E.transpose();E=Q.transjugate().dot(E);return{lambda:R.getDiag(),E:E}};numeric.ccsSparse=function ccsSparse(A){var m=A.length,n,foo,i,j,counts=[];for(i=m-1;i!==-1;--i){foo=A[i];for(j in foo){j=parseInt(j);
while(j>=counts.length)counts[counts.length]=0;if(foo[j]!==0)counts[j]++}}var n=counts.length;var Ai=Array(n+1);Ai[0]=0;for(i=0;i<n;++i)Ai[i+1]=Ai[i]+counts[i];var Aj=Array(Ai[n]),Av=Array(Ai[n]);for(i=m-1;i!==-1;--i){foo=A[i];for(j in foo)if(foo[j]!==0){counts[j]--;Aj[Ai[j]+counts[j]]=i;Av[Ai[j]+counts[j]]=foo[j]}}return[Ai,Aj,Av]};numeric.ccsFull=function ccsFull(A){var Ai=A[0],Aj=A[1],Av=A[2],s=numeric.ccsDim(A),m=s[0],n=s[1],i,j,j0,j1,k;var B=numeric.rep([m,n],0);for(i=0;i<n;i++){j0=Ai[i];j1=
Ai[i+1];for(j=j0;j<j1;++j)B[Aj[j]][i]=Av[j]}return B};numeric.ccsTSolve=function ccsTSolve(A,b,x,bj,xj){var Ai=A[0],Aj=A[1],Av=A[2],m=Ai.length-1,max=Math.max,n=0;if(typeof bj==="undefined")x=numeric.rep([m],0);if(typeof bj==="undefined")bj=numeric.linspace(0,x.length-1);if(typeof xj==="undefined")xj=[];function dfs(j){var k;if(x[j]!==0)return;x[j]=1;for(k=Ai[j];k<Ai[j+1];++k)dfs(Aj[k]);xj[n]=j;++n}var i,j,j0,j1,k,l,l0,l1,a;for(i=bj.length-1;i!==-1;--i)dfs(bj[i]);xj.length=n;for(i=xj.length-1;i!==
-1;--i)x[xj[i]]=0;for(i=bj.length-1;i!==-1;--i){j=bj[i];x[j]=b[j]}for(i=xj.length-1;i!==-1;--i){j=xj[i];j0=Ai[j];j1=max(Ai[j+1],j0);for(k=j0;k!==j1;++k)if(Aj[k]===j){x[j]/=Av[k];break}a=x[j];for(k=j0;k!==j1;++k){l=Aj[k];if(l!==j)x[l]-=a*Av[k]}}return x};numeric.ccsDFS=function ccsDFS(n){this.k=Array(n);this.k1=Array(n);this.j=Array(n)};numeric.ccsDFS.prototype.dfs=function dfs(J,Ai,Aj,x,xj,Pinv){var m=0,foo,n=xj.length;var k=this.k,k1=this.k1,j=this.j,km,k11;if(x[J]!==0)return;x[J]=1;j[0]=J;k[0]=
km=Ai[J];k1[0]=k11=Ai[J+1];while(1)if(km>=k11){xj[n]=j[m];if(m===0)return;++n;--m;km=k[m];k11=k1[m]}else{foo=Pinv[Aj[km]];if(x[foo]===0){x[foo]=1;k[m]=km;++m;j[m]=foo;km=Ai[foo];k1[m]=k11=Ai[foo+1]}else++km}};numeric.ccsLPSolve=function ccsLPSolve(A,B,x,xj,I,Pinv,dfs){var Ai=A[0],Aj=A[1],Av=A[2],m=Ai.length-1,n=0;var Bi=B[0],Bj=B[1],Bv=B[2];var i,i0,i1,j,J,j0,j1,k,l,l0,l1,a;i0=Bi[I];i1=Bi[I+1];xj.length=0;for(i=i0;i<i1;++i)dfs.dfs(Pinv[Bj[i]],Ai,Aj,x,xj,Pinv);for(i=xj.length-1;i!==-1;--i)x[xj[i]]=
0;for(i=i0;i!==i1;++i){j=Pinv[Bj[i]];x[j]=Bv[i]}for(i=xj.length-1;i!==-1;--i){j=xj[i];j0=Ai[j];j1=Ai[j+1];for(k=j0;k<j1;++k)if(Pinv[Aj[k]]===j){x[j]/=Av[k];break}a=x[j];for(k=j0;k<j1;++k){l=Pinv[Aj[k]];if(l!==j)x[l]-=a*Av[k]}}return x};numeric.ccsLUP1=function ccsLUP1(A,threshold){var m=A[0].length-1;var L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]];var Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2];var x=numeric.rep([m],0),xj=numeric.rep([m],0);var i,j,k,j0,j1,a,e,c,d,K;var sol=
numeric.ccsLPSolve,max=Math.max,abs=Math.abs;var P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1);var dfs=new numeric.ccsDFS(m);if(typeof threshold==="undefined")threshold=1;for(i=0;i<m;++i){sol(L,A,x,xj,i,Pinv,dfs);a=-1;e=-1;for(j=xj.length-1;j!==-1;--j){k=xj[j];if(k<=i)continue;c=abs(x[k]);if(c>a){e=k;a=c}}if(abs(x[i])<threshold*a){j=P[i];a=P[e];P[i]=a;Pinv[a]=i;P[e]=j;Pinv[j]=e;a=x[i];x[i]=x[e];x[e]=a}a=Li[i];e=Ui[i];d=x[i];Lj[a]=P[i];Lv[a]=1;++a;for(j=xj.length-1;j!==-1;--j){k=xj[j];c=x[k];
xj[j]=0;x[k]=0;if(k<=i){Uj[e]=k;Uv[e]=c;++e}else{Lj[a]=P[k];Lv[a]=c/d;++a}}Li[i+1]=a;Ui[i+1]=e}for(j=Lj.length-1;j!==-1;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}};numeric.ccsDFS0=function ccsDFS0(n){this.k=Array(n);this.k1=Array(n);this.j=Array(n)};numeric.ccsDFS0.prototype.dfs=function dfs(J,Ai,Aj,x,xj,Pinv,P){var m=0,foo,n=xj.length;var k=this.k,k1=this.k1,j=this.j,km,k11;if(x[J]!==0)return;x[J]=1;j[0]=J;k[0]=km=Ai[Pinv[J]];k1[0]=k11=Ai[Pinv[J]+1];while(1){if(isNaN(km))throw new Error("Ow!");
if(km>=k11){xj[n]=Pinv[j[m]];if(m===0)return;++n;--m;km=k[m];k11=k1[m]}else{foo=Aj[km];if(x[foo]===0){x[foo]=1;k[m]=km;++m;j[m]=foo;foo=Pinv[foo];km=Ai[foo];k1[m]=k11=Ai[foo+1]}else++km}}};numeric.ccsLPSolve0=function ccsLPSolve0(A,B,y,xj,I,Pinv,P,dfs){var Ai=A[0],Aj=A[1],Av=A[2],m=Ai.length-1,n=0;var Bi=B[0],Bj=B[1],Bv=B[2];var i,i0,i1,j,J,j0,j1,k,l,l0,l1,a;i0=Bi[I];i1=Bi[I+1];xj.length=0;for(i=i0;i<i1;++i)dfs.dfs(Bj[i],Ai,Aj,y,xj,Pinv,P);for(i=xj.length-1;i!==-1;--i){j=xj[i];y[P[j]]=0}for(i=i0;i!==
i1;++i){j=Bj[i];y[j]=Bv[i]}for(i=xj.length-1;i!==-1;--i){j=xj[i];l=P[j];j0=Ai[j];j1=Ai[j+1];for(k=j0;k<j1;++k)if(Aj[k]===l){y[l]/=Av[k];break}a=y[l];for(k=j0;k<j1;++k)y[Aj[k]]-=a*Av[k];y[l]=a}};numeric.ccsLUP0=function ccsLUP0(A,threshold){var m=A[0].length-1;var L=[numeric.rep([m+1],0),[],[]],U=[numeric.rep([m+1],0),[],[]];var Li=L[0],Lj=L[1],Lv=L[2],Ui=U[0],Uj=U[1],Uv=U[2];var y=numeric.rep([m],0),xj=numeric.rep([m],0);var i,j,k,j0,j1,a,e,c,d,K;var sol=numeric.ccsLPSolve0,max=Math.max,abs=Math.abs;
var P=numeric.linspace(0,m-1),Pinv=numeric.linspace(0,m-1);var dfs=new numeric.ccsDFS0(m);if(typeof threshold==="undefined")threshold=1;for(i=0;i<m;++i){sol(L,A,y,xj,i,Pinv,P,dfs);a=-1;e=-1;for(j=xj.length-1;j!==-1;--j){k=xj[j];if(k<=i)continue;c=abs(y[P[k]]);if(c>a){e=k;a=c}}if(abs(y[P[i]])<threshold*a){j=P[i];a=P[e];P[i]=a;Pinv[a]=i;P[e]=j;Pinv[j]=e}a=Li[i];e=Ui[i];d=y[P[i]];Lj[a]=P[i];Lv[a]=1;++a;for(j=xj.length-1;j!==-1;--j){k=xj[j];c=y[P[k]];xj[j]=0;y[P[k]]=0;if(k<=i){Uj[e]=k;Uv[e]=c;++e}else{Lj[a]=
P[k];Lv[a]=c/d;++a}}Li[i+1]=a;Ui[i+1]=e}for(j=Lj.length-1;j!==-1;--j)Lj[j]=Pinv[Lj[j]];return{L:L,U:U,P:P,Pinv:Pinv}};numeric.ccsLUP=numeric.ccsLUP0;numeric.ccsDim=function ccsDim(A){return[numeric.sup(A[1])+1,A[0].length-1]};numeric.ccsGetBlock=function ccsGetBlock(A,i,j){var s=numeric.ccsDim(A),m=s[0],n=s[1];if(typeof i==="undefined")i=numeric.linspace(0,m-1);else if(typeof i==="number")i=[i];if(typeof j==="undefined")j=numeric.linspace(0,n-1);else if(typeof j==="number")j=[j];var p,p0,p1,P=i.length,
q,Q=j.length,r,jq,ip;var Bi=numeric.rep([n],0),Bj=[],Bv=[],B=[Bi,Bj,Bv];var Ai=A[0],Aj=A[1],Av=A[2];var x=numeric.rep([m],0),count=0,flags=numeric.rep([m],0);for(q=0;q<Q;++q){jq=j[q];var q0=Ai[jq];var q1=Ai[jq+1];for(p=q0;p<q1;++p){r=Aj[p];flags[r]=1;x[r]=Av[p]}for(p=0;p<P;++p){ip=i[p];if(flags[ip]){Bj[count]=p;Bv[count]=x[i[p]];++count}}for(p=q0;p<q1;++p){r=Aj[p];flags[r]=0}Bi[q+1]=count}return B};numeric.ccsDot=function ccsDot(A,B){var Ai=A[0],Aj=A[1],Av=A[2];var Bi=B[0],Bj=B[1],Bv=B[2];var sA=
numeric.ccsDim(A),sB=numeric.ccsDim(B);var m=sA[0],n=sA[1],o=sB[1];var x=numeric.rep([m],0),flags=numeric.rep([m],0),xj=Array(m);var Ci=numeric.rep([o],0),Cj=[],Cv=[],C=[Ci,Cj,Cv];var i,j,k,j0,j1,i0,i1,l,p,a,b;for(k=0;k!==o;++k){j0=Bi[k];j1=Bi[k+1];p=0;for(j=j0;j<j1;++j){a=Bj[j];b=Bv[j];i0=Ai[a];i1=Ai[a+1];for(i=i0;i<i1;++i){l=Aj[i];if(flags[l]===0){xj[p]=l;flags[l]=1;p=p+1}x[l]=x[l]+Av[i]*b}}j0=Ci[k];j1=j0+p;Ci[k+1]=j1;for(j=p-1;j!==-1;--j){b=j0+j;i=xj[j];Cj[b]=i;Cv[b]=x[i];flags[i]=0;x[i]=0}Ci[k+
1]=Ci[k]+p}return C};numeric.ccsLUPSolve=function ccsLUPSolve(LUP,B){var L=LUP.L,U=LUP.U,P=LUP.P;var Bi=B[0];var flag=false;if(typeof Bi!=="object"){B=[[0,B.length],numeric.linspace(0,B.length-1),B];Bi=B[0];flag=true}var Bj=B[1],Bv=B[2];var n=L[0].length-1,m=Bi.length-1;var x=numeric.rep([n],0),xj=Array(n);var b=numeric.rep([n],0),bj=Array(n);var Xi=numeric.rep([m+1],0),Xj=[],Xv=[];var sol=numeric.ccsTSolve;var i,j,j0,j1,k,J,N=0;for(i=0;i<m;++i){k=0;j0=Bi[i];j1=Bi[i+1];for(j=j0;j<j1;++j){J=LUP.Pinv[Bj[j]];
bj[k]=J;b[J]=Bv[j];++k}bj.length=k;sol(L,b,x,bj,xj);for(j=bj.length-1;j!==-1;--j)b[bj[j]]=0;sol(U,x,b,xj,bj);if(flag)return b;for(j=xj.length-1;j!==-1;--j)x[xj[j]]=0;for(j=bj.length-1;j!==-1;--j){J=bj[j];Xj[N]=J;Xv[N]=b[J];b[J]=0;++N}Xi[i+1]=N}return[Xi,Xj,Xv]};numeric.ccsbinop=function ccsbinop(body,setup){if(typeof setup==="undefined")setup="";return Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\n"+"var Yi = Y[0], Yj = Y[1], Yv = Y[2];\n"+"var n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\n"+
"var Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\n"+"var x = numeric.rep([m],0),y = numeric.rep([m],0);\n"+"var xk,yk,zk;\n"+"var i,j,j0,j1,k,p=0;\n"+setup+"for(i=0;i<n;++i) {\n"+"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Xj[j];\n"+"    x[k] = 1;\n"+"    Zj[p] = k;\n"+"    ++p;\n"+"  }\n"+"  j0 = Yi[i]; j1 = Yi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Yj[j];\n"+"    y[k] = Yv[j];\n"+"    if(x[k] === 0) {\n"+"      Zj[p] = k;\n"+"      ++p;\n"+"    }\n"+"  }\n"+"  Zi[i+1] = p;\n"+
"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n"+"  j0 = Zi[i]; j1 = Zi[i+1];\n"+"  for(j=j0;j!==j1;++j) {\n"+"    k = Zj[j];\n"+"    xk = x[k];\n"+"    yk = y[k];\n"+body+"\n"+"    Zv[j] = zk;\n"+"  }\n"+"  j0 = Xi[i]; j1 = Xi[i+1];\n"+"  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n"+"  j0 = Yi[i]; j1 = Yi[i+1];\n"+"  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n"+"}\n"+"return [Zi,Zj,Zv];")};(function(){var k,A,B,C;for(k in numeric.ops2){if(isFinite(eval("1"+numeric.ops2[k]+"0")))A="[Y[0],Y[1],numeric."+
k+"(X,Y[2])]";else A="NaN";if(isFinite(eval("0"+numeric.ops2[k]+"1")))B="[X[0],X[1],numeric."+k+"(X[2],Y)]";else B="NaN";if(isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1")))C="numeric.ccs"+k+"MM(X,Y)";else C="NaN";numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;");numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+";\n"+'if(typeof Y === "number") return '+B+";\n"+"return "+C+";\n")}})();numeric.ccsScatter=function ccsScatter(A){var Ai=
A[0],Aj=A[1],Av=A[2];var n=numeric.sup(Aj)+1,m=Ai.length;var Ri=numeric.rep([n],0),Rj=Array(m),Rv=Array(m);var counts=numeric.rep([n],0),i;for(i=0;i<m;++i)counts[Aj[i]]++;for(i=0;i<n;++i)Ri[i+1]=Ri[i]+counts[i];var ptr=Ri.slice(0),k,Aii;for(i=0;i<m;++i){Aii=Aj[i];k=ptr[Aii];Rj[k]=Ai[i];Rv[k]=Av[i];ptr[Aii]=ptr[Aii]+1}return[Ri,Rj,Rv]};numeric.ccsGather=function ccsGather(A){var Ai=A[0],Aj=A[1],Av=A[2];var n=Ai.length-1,m=Aj.length;var Ri=Array(m),Rj=Array(m),Rv=Array(m);var i,j,j0,j1,p;p=0;for(i=
0;i<n;++i){j0=Ai[i];j1=Ai[i+1];for(j=j0;j!==j1;++j){Rj[p]=i;Ri[p]=Aj[j];Rv[p]=Av[j];++p}}return[Ri,Rj,Rv]};numeric.sdim=function dim(A,ret,k){if(typeof ret==="undefined")ret=[];if(typeof A!=="object")return ret;if(typeof k==="undefined")k=0;if(!(k in ret))ret[k]=0;if(A.length>ret[k])ret[k]=A.length;var i;for(i in A)if(A.hasOwnProperty(i))dim(A[i],ret,k+1);return ret};numeric.sclone=function clone(A,k,n){if(typeof k==="undefined")k=0;if(typeof n==="undefined")n=numeric.sdim(A).length;var i,ret=Array(A.length);
if(k===n-1){for(i in A)if(A.hasOwnProperty(i))ret[i]=A[i];return ret}for(i in A)if(A.hasOwnProperty(i))ret[i]=clone(A[i],k+1,n);return ret};numeric.sdiag=function diag(d){var n=d.length,i,ret=Array(n),i1,i2,i3;for(i=n-1;i>=1;i-=2){i1=i-1;ret[i]=[];ret[i][i]=d[i];ret[i1]=[];ret[i1][i1]=d[i1]}if(i===0){ret[0]=[];ret[0][0]=d[i]}return ret};numeric.sidentity=function identity(n){return numeric.sdiag(numeric.rep([n],1))};numeric.stranspose=function transpose(A){var ret=[],n=A.length,i,j,Ai;for(i in A){if(!A.hasOwnProperty(i))continue;
Ai=A[i];for(j in Ai){if(!Ai.hasOwnProperty(j))continue;if(typeof ret[j]!=="object")ret[j]=[];ret[j][i]=Ai[j]}}return ret};numeric.sLUP=function LUP(A,tol){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.");};numeric.sdotMM=function dotMM(A,B){var p=A.length,q=B.length,BT=numeric.stranspose(B),r=BT.length,Ai,BTk;var i,j,k,accum;var ret=Array(p),reti;for(i=p-1;i>=0;i--){reti=[];Ai=A[i];for(k=r-1;k>=0;k--){accum=0;BTk=
BT[k];for(j in Ai){if(!Ai.hasOwnProperty(j))continue;if(j in BTk)accum+=Ai[j]*BTk[j]}if(accum)reti[k]=accum}ret[i]=reti}return ret};numeric.sdotMV=function dotMV(A,x){var p=A.length,Ai,i,j;var ret=Array(p),accum;for(i=p-1;i>=0;i--){Ai=A[i];accum=0;for(j in Ai){if(!Ai.hasOwnProperty(j))continue;if(x[j])accum+=Ai[j]*x[j]}if(accum)ret[i]=accum}return ret};numeric.sdotVM=function dotMV(x,A){var i,j,Ai,alpha;var ret=[],accum;for(i in x){if(!x.hasOwnProperty(i))continue;Ai=A[i];alpha=x[i];for(j in Ai){if(!Ai.hasOwnProperty(j))continue;
if(!ret[j])ret[j]=0;ret[j]+=alpha*Ai[j]}}return ret};numeric.sdotVV=function dotVV(x,y){var i,ret=0;for(i in x)if(x[i]&&y[i])ret+=x[i]*y[i];return ret};numeric.sdot=function dot(A,B){var m=numeric.sdim(A).length,n=numeric.sdim(B).length;var k=m*1E3+n;switch(k){case 0:return A*B;case 1001:return numeric.sdotVV(A,B);case 2001:return numeric.sdotMV(A,B);case 1002:return numeric.sdotVM(A,B);case 2002:return numeric.sdotMM(A,B);default:throw new Error("numeric.sdot not implemented for tensors of order "+
m+" and "+n);}};numeric.sscatter=function scatter(V){var n=V[0].length,Vij,i,j,m=V.length,A=[],Aj;for(i=n-1;i>=0;--i){if(!V[m-1][i])continue;Aj=A;for(j=0;j<m-2;j++){Vij=V[j][i];if(!Aj[Vij])Aj[Vij]=[];Aj=Aj[Vij]}Aj[V[j][i]]=V[j+1][i]}return A};numeric.sgather=function gather(A,ret,k){if(typeof ret==="undefined")ret=[];if(typeof k==="undefined")k=[];var n,i,Ai;n=k.length;for(i in A)if(A.hasOwnProperty(i)){k[n]=parseInt(i);Ai=A[i];if(typeof Ai==="number"){if(Ai){if(ret.length===0)for(i=n+1;i>=0;--i)ret[i]=
[];for(i=n;i>=0;--i)ret[i].push(k[i]);ret[n+1].push(Ai)}}else gather(Ai,ret,k)}if(k.length>n)k.pop();return ret};numeric.cLU=function LU(A){var I=A[0],J=A[1],V=A[2];var p=I.length,m=0,i,j,k,a,b,c;for(i=0;i<p;i++)if(I[i]>m)m=I[i];m++;var L=Array(m),U=Array(m),left=numeric.rep([m],Infinity),right=numeric.rep([m],-Infinity);var Ui,Uj,alpha;for(k=0;k<p;k++){i=I[k];j=J[k];if(j<left[i])left[i]=j;if(j>right[i])right[i]=j}for(i=0;i<m-1;i++)if(right[i]>right[i+1])right[i+1]=right[i];for(i=m-1;i>=1;i--)if(left[i]<
left[i-1])left[i-1]=left[i];var countL=0,countU=0;for(i=0;i<m;i++){U[i]=numeric.rep([right[i]-left[i]+1],0);L[i]=numeric.rep([i-left[i]],0);countL+=i-left[i]+1;countU+=right[i]-i+1}for(k=0;k<p;k++){i=I[k];U[i][J[k]-left[i]]=V[k]}for(i=0;i<m-1;i++){a=i-left[i];Ui=U[i];for(j=i+1;left[j]<=i&&j<m;j++){b=i-left[j];c=right[i]-i;Uj=U[j];alpha=Uj[b]/Ui[a];if(alpha){for(k=1;k<=c;k++)Uj[k+b]-=alpha*Ui[k+a];L[j][i-left[j]]=alpha}}}var Ui=[],Uj=[],Uv=[],Li=[],Lj=[],Lv=[];var p,q,foo;p=0;q=0;for(i=0;i<m;i++){a=
left[i];b=right[i];foo=U[i];for(j=i;j<=b;j++)if(foo[j-a]){Ui[p]=i;Uj[p]=j;Uv[p]=foo[j-a];p++}foo=L[i];for(j=a;j<i;j++)if(foo[j-a]){Li[q]=i;Lj[q]=j;Lv[q]=foo[j-a];q++}Li[q]=i;Lj[q]=i;Lv[q]=1;q++}return{U:[Ui,Uj,Uv],L:[Li,Lj,Lv]}};numeric.cLUsolve=function LUsolve(lu,b){var L=lu.L,U=lu.U,ret=numeric.clone(b);var Li=L[0],Lj=L[1],Lv=L[2];var Ui=U[0],Uj=U[1],Uv=U[2];var p=Ui.length,q=Li.length;var m=ret.length,i,j,k;k=0;for(i=0;i<m;i++){while(Lj[k]<i){ret[i]-=Lv[k]*ret[Lj[k]];k++}k++}k=p-1;for(i=m-1;i>=
0;i--){while(Uj[k]>i){ret[i]-=Uv[k]*ret[Uj[k]];k--}ret[i]/=Uv[k];k--}return ret};numeric.cgrid=function grid(n,shape){if(typeof n==="number")n=[n,n];var ret=numeric.rep(n,-1);var i,j,count;if(typeof shape!=="function")switch(shape){case "L":shape=function(i,j){return i>=n[0]/2||j<n[1]/2};break;default:shape=function(i,j){return true};break}count=0;for(i=1;i<n[0]-1;i++)for(j=1;j<n[1]-1;j++)if(shape(i,j)){ret[i][j]=count;count++}return ret};numeric.cdelsq=function delsq(g){var dir=[[-1,0],[0,-1],[0,
1],[1,0]];var s=numeric.dim(g),m=s[0],n=s[1],i,j,k,p,q;var Li=[],Lj=[],Lv=[];for(i=1;i<m-1;i++)for(j=1;j<n-1;j++){if(g[i][j]<0)continue;for(k=0;k<4;k++){p=i+dir[k][0];q=j+dir[k][1];if(g[p][q]<0)continue;Li.push(g[i][j]);Lj.push(g[p][q]);Lv.push(-1)}Li.push(g[i][j]);Lj.push(g[i][j]);Lv.push(4)}return[Li,Lj,Lv]};numeric.cdotMV=function dotMV(A,x){var ret,Ai=A[0],Aj=A[1],Av=A[2],k,p=Ai.length,N;N=0;for(k=0;k<p;k++)if(Ai[k]>N)N=Ai[k];N++;ret=numeric.rep([N],0);for(k=0;k<p;k++)ret[Ai[k]]+=Av[k]*x[Aj[k]];
return ret};numeric.Spline=function Spline(x,yl,yr,kl,kr){this.x=x;this.yl=yl;this.yr=yr;this.kl=kl;this.kr=kr};numeric.Spline.prototype._at=function _at(x1,p){var x=this.x;var yl=this.yl;var yr=this.yr;var kl=this.kl;var kr=this.kr;var x1,a,b,t;var add=numeric.add,sub=numeric.sub,mul=numeric.mul;a=sub(mul(kl[p],x[p+1]-x[p]),sub(yr[p+1],yl[p]));b=add(mul(kr[p+1],x[p]-x[p+1]),sub(yr[p+1],yl[p]));t=(x1-x[p])/(x[p+1]-x[p]);var s=t*(1-t);return add(add(add(mul(1-t,yl[p]),mul(t,yr[p+1])),mul(a,s*(1-t))),
mul(b,s*t))};numeric.Spline.prototype.at=function at(x0){if(typeof x0==="number"){var x=this.x;var n=x.length;var p,q,mid,floor=Math.floor,a,b,t;p=0;q=n-1;while(q-p>1){mid=floor((p+q)/2);if(x[mid]<=x0)p=mid;else q=mid}return this._at(x0,p)}var n=x0.length,i,ret=Array(n);for(i=n-1;i!==-1;--i)ret[i]=this.at(x0[i]);return ret};numeric.Spline.prototype.diff=function diff(){var x=this.x;var yl=this.yl;var yr=this.yr;var kl=this.kl;var kr=this.kr;var n=yl.length;var i,dx,dy;var zl=kl,zr=kr,pl=Array(n),
pr=Array(n);var add=numeric.add,mul=numeric.mul,div=numeric.div,sub=numeric.sub;for(i=n-1;i!==-1;--i){dx=x[i+1]-x[i];dy=sub(yr[i+1],yl[i]);pl[i]=div(add(mul(dy,6),mul(kl[i],-4*dx),mul(kr[i+1],-2*dx)),dx*dx);pr[i+1]=div(add(mul(dy,-6),mul(kl[i],2*dx),mul(kr[i+1],4*dx)),dx*dx)}return new numeric.Spline(x,zl,zr,pl,pr)};numeric.Spline.prototype.roots=function roots(){function sqr(x){return x*x}function heval(y0,y1,k0,k1,x){var A=k0*2-(y1-y0);var B=-k1*2+(y1-y0);var t=(x+1)*.5;var s=t*(1-t);return(1-t)*
y0+t*y1+A*s*(1-t)+B*s*t}var ret=[];var x=this.x,yl=this.yl,yr=this.yr,kl=this.kl,kr=this.kr;if(typeof yl[0]==="number"){yl=[yl];yr=[yr];kl=[kl];kr=[kr]}var m=yl.length,n=x.length-1,i,j,k,y,s,t;var ai,bi,ci,di,ret=Array(m),ri,k0,k1,y0,y1,A,B,D,dx,cx,stops,z0,z1,zm,t0,t1,tm;var sqrt=Math.sqrt;for(i=0;i!==m;++i){ai=yl[i];bi=yr[i];ci=kl[i];di=kr[i];ri=[];for(j=0;j!==n;j++){if(j>0&&bi[j]*ai[j]<0)ri.push(x[j]);dx=x[j+1]-x[j];cx=x[j];y0=ai[j];y1=bi[j+1];k0=ci[j]/dx;k1=di[j+1]/dx;D=sqr(k0-k1+3*(y0-y1))+12*
k1*y0;A=k1+3*y0+2*k0-3*y1;B=3*(k1+k0+2*(y0-y1));if(D<=0){z0=A/B;if(z0>x[j]&&z0<x[j+1])stops=[x[j],z0,x[j+1]];else stops=[x[j],x[j+1]]}else{z0=(A-sqrt(D))/B;z1=(A+sqrt(D))/B;stops=[x[j]];if(z0>x[j]&&z0<x[j+1])stops.push(z0);if(z1>x[j]&&z1<x[j+1])stops.push(z1);stops.push(x[j+1])}t0=stops[0];z0=this._at(t0,j);for(k=0;k<stops.length-1;k++){t1=stops[k+1];z1=this._at(t1,j);if(z0===0){ri.push(t0);t0=t1;z0=z1;continue}if(z1===0||z0*z1>0){t0=t1;z0=z1;continue}var side=0;while(1){tm=(z0*t1-z1*t0)/(z0-z1);
if(tm<=t0||tm>=t1)break;zm=this._at(tm,j);if(zm*z1>0){t1=tm;z1=zm;if(side===-1)z0*=.5;side=-1}else if(zm*z0>0){t0=tm;z0=zm;if(side===1)z1*=.5;side=1}else break}ri.push(tm);t0=stops[k+1];z0=this._at(t0,j)}if(z1===0)ri.push(t1)}ret[i]=ri}if(typeof this.yl[0]==="number")return ret[0];return ret};numeric.spline=function spline(x,y,k1,kn){var n=x.length,b=[],dx=[],dy=[];var i;var sub=numeric.sub,mul=numeric.mul,add=numeric.add;for(i=n-2;i>=0;i--){dx[i]=x[i+1]-x[i];dy[i]=sub(y[i+1],y[i])}if(typeof k1===
"string"||typeof kn==="string")k1=kn="periodic";var T=[[],[],[]];switch(typeof k1){case "undefined":b[0]=mul(3/(dx[0]*dx[0]),dy[0]);T[0].push(0,0);T[1].push(0,1);T[2].push(2/dx[0],1/dx[0]);break;case "string":b[0]=add(mul(3/(dx[n-2]*dx[n-2]),dy[n-2]),mul(3/(dx[0]*dx[0]),dy[0]));T[0].push(0,0,0);T[1].push(n-2,0,1);T[2].push(1/dx[n-2],2/dx[n-2]+2/dx[0],1/dx[0]);break;default:b[0]=k1;T[0].push(0);T[1].push(0);T[2].push(1);break}for(i=1;i<n-1;i++){b[i]=add(mul(3/(dx[i-1]*dx[i-1]),dy[i-1]),mul(3/(dx[i]*
dx[i]),dy[i]));T[0].push(i,i,i);T[1].push(i-1,i,i+1);T[2].push(1/dx[i-1],2/dx[i-1]+2/dx[i],1/dx[i])}switch(typeof kn){case "undefined":b[n-1]=mul(3/(dx[n-2]*dx[n-2]),dy[n-2]);T[0].push(n-1,n-1);T[1].push(n-2,n-1);T[2].push(1/dx[n-2],2/dx[n-2]);break;case "string":T[1][T[1].length-1]=0;break;default:b[n-1]=kn;T[0].push(n-1);T[1].push(n-1);T[2].push(1);break}if(typeof b[0]!=="number")b=numeric.transpose(b);else b=[b];var k=Array(b.length);if(typeof k1==="string")for(i=k.length-1;i!==-1;--i){k[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(T)),
b[i]);k[i][n-1]=k[i][0]}else for(i=k.length-1;i!==-1;--i)k[i]=numeric.cLUsolve(numeric.cLU(T),b[i]);if(typeof y[0]==="number")k=k[0];else k=numeric.transpose(k);return new numeric.Spline(x,y,y,k,k)};numeric.fftpow2=function fftpow2(x,y){var n=x.length;if(n===1)return;var cos=Math.cos,sin=Math.sin,i,j;var xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);j=n/2;for(i=n-1;i!==-1;--i){--j;xo[j]=x[i];yo[j]=y[i];--i;xe[j]=x[i];ye[j]=y[i]}fftpow2(xe,ye);fftpow2(xo,yo);j=n/2;var t,k=-6.283185307179586/
n,ci,si;for(i=n-1;i!==-1;--i){--j;if(j===-1)j=n/2-1;t=k*i;ci=cos(t);si=sin(t);x[i]=xe[j]+ci*xo[j]-si*yo[j];y[i]=ye[j]+ci*yo[j]+si*xo[j]}};numeric._ifftpow2=function _ifftpow2(x,y){var n=x.length;if(n===1)return;var cos=Math.cos,sin=Math.sin,i,j;var xe=Array(n/2),ye=Array(n/2),xo=Array(n/2),yo=Array(n/2);j=n/2;for(i=n-1;i!==-1;--i){--j;xo[j]=x[i];yo[j]=y[i];--i;xe[j]=x[i];ye[j]=y[i]}_ifftpow2(xe,ye);_ifftpow2(xo,yo);j=n/2;var t,k=6.283185307179586/n,ci,si;for(i=n-1;i!==-1;--i){--j;if(j===-1)j=n/2-
1;t=k*i;ci=cos(t);si=sin(t);x[i]=xe[j]+ci*xo[j]-si*yo[j];y[i]=ye[j]+ci*yo[j]+si*xo[j]}};numeric.ifftpow2=function ifftpow2(x,y){numeric._ifftpow2(x,y);numeric.diveq(x,x.length);numeric.diveq(y,y.length)};numeric.convpow2=function convpow2(ax,ay,bx,by){numeric.fftpow2(ax,ay);numeric.fftpow2(bx,by);var i,n=ax.length,axi,bxi,ayi,byi;for(i=n-1;i!==-1;--i){axi=ax[i];ayi=ay[i];bxi=bx[i];byi=by[i];ax[i]=axi*bxi-ayi*byi;ay[i]=axi*byi+ayi*bxi}numeric.ifftpow2(ax,ay)};numeric.T.prototype.fft=function fft(){var x=
this.x,y=this.y;var n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p);var cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin;var k,c=-3.141592653589793/n,t;var a=numeric.rep([m],0),b=numeric.rep([m],0),nhalf=Math.floor(n/2);for(k=0;k<n;k++)a[k]=x[k];if(typeof y!=="undefined")for(k=0;k<n;k++)b[k]=y[k];cx[0]=1;for(k=1;k<=m/2;k++){t=c*k*k;cx[k]=cos(t);cy[k]=sin(t);cx[m-k]=cos(t);cy[m-k]=sin(t)}var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);X=X.mul(Y);
numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y));X=X.mul(Y);X.x.length=n;X.y.length=n;return X};numeric.T.prototype.ifft=function ifft(){var x=this.x,y=this.y;var n=x.length,log=Math.log,log2=log(2),p=Math.ceil(log(2*n-1)/log2),m=Math.pow(2,p);var cx=numeric.rep([m],0),cy=numeric.rep([m],0),cos=Math.cos,sin=Math.sin;var k,c=3.141592653589793/n,t;var a=numeric.rep([m],0),b=numeric.rep([m],0),nhalf=Math.floor(n/2);for(k=0;k<n;k++)a[k]=x[k];if(typeof y!=="undefined")for(k=0;k<n;k++)b[k]=
y[k];cx[0]=1;for(k=1;k<=m/2;k++){t=c*k*k;cx[k]=cos(t);cy[k]=sin(t);cx[m-k]=cos(t);cy[m-k]=sin(t)}var X=new numeric.T(a,b),Y=new numeric.T(cx,cy);X=X.mul(Y);numeric.convpow2(X.x,X.y,numeric.clone(Y.x),numeric.neg(Y.y));X=X.mul(Y);X.x.length=n;X.y.length=n;return X.div(n)};numeric.gradient=function gradient(f,x){var n=x.length;var f0=f(x);if(isNaN(f0))throw new Error("gradient: f(x) is a NaN!");var max=Math.max;var i,x0=numeric.clone(x),f1,f2,J=Array(n);var div=numeric.div,sub=numeric.sub,errest,roundoff,
max=Math.max,eps=.001,abs=Math.abs,min=Math.min;var t0,t1,t2,it=0,d1,d2,N;for(i=0;i<n;i++){var h=max(1E-6*f0,1E-8);while(1){++it;if(it>20)throw new Error("Numerical gradient fails");x0[i]=x[i]+h;f1=f(x0);x0[i]=x[i]-h;f2=f(x0);x0[i]=x[i];if(isNaN(f1)||isNaN(f2)){h/=16;continue}J[i]=(f1-f2)/(2*h);t0=x[i]-h;t1=x[i];t2=x[i]+h;d1=(f1-f0)/h;d2=(f0-f2)/h;N=max(abs(J[i]),abs(f0),abs(f1),abs(f2),abs(t0),abs(t1),abs(t2),1E-8);errest=min(max(abs(d1-J[i]),abs(d2-J[i]),abs(d1-d2))/N,h/N);if(errest>eps)h/=16;else break}}return J};
numeric.uncmin=function uncmin(f,x0,tol,gradient,maxit,callback,options){var grad=numeric.gradient;if(typeof options==="undefined")options={};if(typeof tol==="undefined")tol=1E-8;if(typeof gradient==="undefined")gradient=function(x){return grad(f,x)};if(typeof maxit==="undefined")maxit=1E3;x0=numeric.clone(x0);var n=x0.length;var f0=f(x0),f1,df0;if(isNaN(f0))throw new Error("uncmin: f(x0) is a NaN!");var max=Math.max,norm2=numeric.norm2;tol=max(tol,numeric.epsilon);var step,g0,g1,H1=options.Hinv||
numeric.identity(n);var dot=numeric.dot,inv=numeric.inv,sub=numeric.sub,add=numeric.add,ten=numeric.tensor,div=numeric.div,mul=numeric.mul;var all=numeric.all,isfinite=numeric.isFinite,neg=numeric.neg;var it=0,i,s,x1,y,Hy,Hs,ys,i0,t,nstep,t1,t2;var msg="";g0=gradient(x0);while(it<maxit){if(typeof callback==="function")if(callback(it,x0,f0,g0,H1)){msg="Callback returned true";break}if(!all(isfinite(g0))){msg="Gradient has Infinity or NaN";break}step=neg(dot(H1,g0));if(!all(isfinite(step))){msg="Search direction has Infinity or NaN";
break}nstep=norm2(step);if(nstep<tol){msg="Newton step smaller than tol";break}t=1;df0=dot(g0,step);x1=x0;while(it<maxit){if(t*nstep<tol)break;s=mul(step,t);x1=add(x0,s);f1=f(x1);if(f1-f0>=.1*t*df0||isNaN(f1)){t*=.5;++it;continue}break}if(t*nstep<tol){msg="Line search step size smaller than tol";break}if(it===maxit){msg="maxit reached during line search";break}g1=gradient(x1);y=sub(g1,g0);ys=dot(y,s);Hy=dot(H1,y);H1=sub(add(H1,mul((ys+dot(y,Hy))/(ys*ys),ten(s,s))),div(add(ten(Hy,s),ten(s,Hy)),ys));
x0=x1;f0=f1;g0=g1;++it}return{solution:x0,f:f0,gradient:g0,invHessian:H1,iterations:it,message:msg}};numeric.Dopri=function Dopri(x,y,f,ymid,iterations,msg,events){this.x=x;this.y=y;this.f=f;this.ymid=ymid;this.iterations=iterations;this.events=events;this.message=msg};numeric.Dopri.prototype._at=function _at(xi,j){function sqr(x){return x*x}var sol=this;var xs=sol.x;var ys=sol.y;var k1=sol.f;var ymid=sol.ymid;var n=xs.length;var x0,x1,xh,y0,y1,yh,xi;var floor=Math.floor,h;var c=.5;var add=numeric.add,
mul=numeric.mul,sub=numeric.sub,p,q,w;x0=xs[j];x1=xs[j+1];y0=ys[j];y1=ys[j+1];h=x1-x0;xh=x0+c*h;yh=ymid[j];p=sub(k1[j],mul(y0,1/(x0-xh)+2/(x0-x1)));q=sub(k1[j+1],mul(y1,1/(x1-xh)+2/(x1-x0)));w=[sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),sqr(xi-x0)*sqr(xi-x1)/sqr(x0-xh)/sqr(x1-xh),sqr(xi-x0)*(xi-xh)/sqr(x1-x0)/(x1-xh),(xi-x0)*sqr(xi-x1)*(xi-xh)/sqr(x0-x1)/(x0-xh),(xi-x1)*sqr(xi-x0)*(xi-xh)/sqr(x0-x1)/(x1-xh)];return add(add(add(add(mul(y0,w[0]),mul(yh,w[1])),mul(y1,w[2])),mul(p,w[3])),mul(q,w[4]))};numeric.Dopri.prototype.at=
function at(x){var i,j,k,floor=Math.floor;if(typeof x!=="number"){var n=x.length,ret=Array(n);for(i=n-1;i!==-1;--i)ret[i]=this.at(x[i]);return ret}var x0=this.x;i=0;j=x0.length-1;while(j-i>1){k=floor(.5*(i+j));if(x0[k]<=x)i=k;else j=k}return this._at(x,i)};numeric.dopri=function dopri(x0,x1,y0,f,tol,maxit,event){if(typeof tol==="undefined")tol=1E-6;if(typeof maxit==="undefined")maxit=1E3;var xs=[x0],ys=[y0],k1=[f(x0,y0)],k2,k3,k4,k5,k6,k7,ymid=[];var A2=1/5;var A3=[3/40,9/40];var A4=[44/45,-56/15,
32/9];var A5=[19372/6561,-25360/2187,64448/6561,-212/729];var A6=[9017/3168,-355/33,46732/5247,49/176,-5103/18656];var b=[35/384,0,500/1113,125/192,-2187/6784,11/84];var bm=[.5*6025192743/30085553152,0,.5*51252292925/65400821598,.5*-2691868925/45128329728,.5*187940372067/1594534317056,.5*-1776094331/19743644256,.5*11237099/235043384];var c=[1/5,3/10,4/5,8/9,1,1];var e=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40];var i=0,er,j;var h=(x1-x0)/10;var it=0;var add=numeric.add,mul=numeric.mul,
y1,erinf;var max=Math.max,min=Math.min,abs=Math.abs,norminf=numeric.norminf,pow=Math.pow;var any=numeric.any,lt=numeric.lt,and=numeric.and,sub=numeric.sub;var e0,e1,ev;var ret=new numeric.Dopri(xs,ys,k1,ymid,-1,"");if(typeof event==="function")e0=event(x0,y0);while(x0<x1&&it<maxit){++it;if(x0+h>x1)h=x1-x0;k2=f(x0+c[0]*h,add(y0,mul(A2*h,k1[i])));k3=f(x0+c[1]*h,add(add(y0,mul(A3[0]*h,k1[i])),mul(A3[1]*h,k2)));k4=f(x0+c[2]*h,add(add(add(y0,mul(A4[0]*h,k1[i])),mul(A4[1]*h,k2)),mul(A4[2]*h,k3)));k5=f(x0+
c[3]*h,add(add(add(add(y0,mul(A5[0]*h,k1[i])),mul(A5[1]*h,k2)),mul(A5[2]*h,k3)),mul(A5[3]*h,k4)));k6=f(x0+c[4]*h,add(add(add(add(add(y0,mul(A6[0]*h,k1[i])),mul(A6[1]*h,k2)),mul(A6[2]*h,k3)),mul(A6[3]*h,k4)),mul(A6[4]*h,k5)));y1=add(add(add(add(add(y0,mul(k1[i],h*b[0])),mul(k3,h*b[2])),mul(k4,h*b[3])),mul(k5,h*b[4])),mul(k6,h*b[5]));k7=f(x0+h,y1);er=add(add(add(add(add(mul(k1[i],h*e[0]),mul(k3,h*e[2])),mul(k4,h*e[3])),mul(k5,h*e[4])),mul(k6,h*e[5])),mul(k7,h*e[6]));if(typeof er==="number")erinf=abs(er);
else erinf=norminf(er);if(erinf>tol){h=.2*h*pow(tol/erinf,.25);if(x0+h===x0){ret.msg="Step size became too small";break}continue}ymid[i]=add(add(add(add(add(add(y0,mul(k1[i],h*bm[0])),mul(k3,h*bm[2])),mul(k4,h*bm[3])),mul(k5,h*bm[4])),mul(k6,h*bm[5])),mul(k7,h*bm[6]));++i;xs[i]=x0+h;ys[i]=y1;k1[i]=k7;if(typeof event==="function"){var yi,xl=x0,xr=x0+.5*h,xi;e1=event(xr,ymid[i-1]);ev=and(lt(e0,0),lt(0,e1));if(!any(ev)){xl=xr;xr=x0+h;e0=e1;e1=event(xr,y1);ev=and(lt(e0,0),lt(0,e1))}if(any(ev)){var xc,
yc,en,ei;var side=0,sl=1,sr=1;while(1){if(typeof e0==="number")xi=(sr*e1*xl-sl*e0*xr)/(sr*e1-sl*e0);else{xi=xr;for(j=e0.length-1;j!==-1;--j)if(e0[j]<0&&e1[j]>0)xi=min(xi,(sr*e1[j]*xl-sl*e0[j]*xr)/(sr*e1[j]-sl*e0[j]))}if(xi<=xl||xi>=xr)break;yi=ret._at(xi,i-1);ei=event(xi,yi);en=and(lt(e0,0),lt(0,ei));if(any(en)){xr=xi;e1=ei;ev=en;sr=1;if(side===-1)sl*=.5;else sl=1;side=-1}else{xl=xi;e0=ei;sl=1;if(side===1)sr*=.5;else sr=1;side=1}}y1=ret._at(.5*(x0+xi),i-1);ret.f[i]=f(xi,yi);ret.x[i]=xi;ret.y[i]=yi;
ret.ymid[i-1]=y1;ret.events=ev;ret.iterations=it;return ret}}x0+=h;y0=y1;e0=e1;h=min(.8*h*pow(tol/erinf,.25),4*h)}ret.iterations=it;return ret};numeric.LU=function(A,fast){fast=fast||false;var abs=Math.abs;var i,j,k,absAjk,Akk,Ak,Pk,Ai;var max;var n=A.length,n1=n-1;var P=new Array(n);if(!fast)A=numeric.clone(A);for(k=0;k<n;++k){Pk=k;Ak=A[k];max=abs(Ak[k]);for(j=k+1;j<n;++j){absAjk=abs(A[j][k]);if(max<absAjk){max=absAjk;Pk=j}}P[k]=Pk;if(Pk!=k){A[k]=A[Pk];A[Pk]=Ak;Ak=A[k]}Akk=Ak[k];for(i=k+1;i<n;++i)A[i][k]/=
Akk;for(i=k+1;i<n;++i){Ai=A[i];for(j=k+1;j<n1;++j){Ai[j]-=Ai[k]*Ak[j];++j;Ai[j]-=Ai[k]*Ak[j]}if(j===n1)Ai[j]-=Ai[k]*Ak[j]}}return{LU:A,P:P}};numeric.LUsolve=function LUsolve(LUP,b){var i,j;var LU=LUP.LU;var n=LU.length;var x=numeric.clone(b);var P=LUP.P;var Pi,LUi,LUii,tmp;for(i=n-1;i!==-1;--i)x[i]=b[i];for(i=0;i<n;++i){Pi=P[i];if(P[i]!==i){tmp=x[i];x[i]=x[Pi];x[Pi]=tmp}LUi=LU[i];for(j=0;j<i;++j)x[i]-=x[j]*LUi[j]}for(i=n-1;i>=0;--i){LUi=LU[i];for(j=i+1;j<n;++j)x[i]-=x[j]*LUi[j];x[i]/=LUi[i]}return x};
numeric.solve=function solve(A,b,fast){return numeric.LUsolve(numeric.LU(A,fast),b)};numeric.echelonize=function echelonize(A){var s=numeric.dim(A),m=s[0],n=s[1];var I=numeric.identity(m);var P=Array(m);var i,j,k,l,Ai,Ii,Z,a;var abs=Math.abs;var diveq=numeric.diveq;A=numeric.clone(A);for(i=0;i<m;++i){k=0;Ai=A[i];Ii=I[i];for(j=1;j<n;++j)if(abs(Ai[k])<abs(Ai[j]))k=j;P[i]=k;diveq(Ii,Ai[k]);diveq(Ai,Ai[k]);for(j=0;j<m;++j)if(j!==i){Z=A[j];a=Z[k];for(l=n-1;l!==-1;--l)Z[l]-=Ai[l]*a;Z=I[j];for(l=m-1;l!==
-1;--l)Z[l]-=Ii[l]*a}}return{I:I,A:A,P:P}};numeric.__solveLP=function __solveLP(c,A,b,tol,maxit,x,flag){var sum=numeric.sum,log=numeric.log,mul=numeric.mul,sub=numeric.sub,dot=numeric.dot,div=numeric.div,add=numeric.add;var m=c.length,n=b.length,y;var unbounded=false,cb,i0=0;var alpha=1;var f0,df0,AT=numeric.transpose(A),svd=numeric.svd,transpose=numeric.transpose,leq=numeric.leq,sqrt=Math.sqrt,abs=Math.abs;var muleq=numeric.muleq;var norm=numeric.norminf,any=numeric.any,min=Math.min;var all=numeric.all,
gt=numeric.gt;var p=Array(m),A0=Array(n),e=numeric.rep([n],1),H;var solve=numeric.solve,z=sub(b,dot(A,x)),count;var dotcc=dot(c,c);var g;for(count=i0;count<maxit;++count){var i,j,d;for(i=n-1;i!==-1;--i)A0[i]=div(A[i],z[i]);var A1=transpose(A0);for(i=m-1;i!==-1;--i)p[i]=sum(A1[i]);alpha=.25*abs(dotcc/dot(c,p));var a1=100*sqrt(dotcc/dot(p,p));if(!isFinite(alpha)||alpha>a1)alpha=a1;g=add(c,mul(alpha,p));H=dot(A1,A0);for(i=m-1;i!==-1;--i)H[i][i]+=1;d=solve(H,div(g,alpha),true);var t0=div(z,dot(A,d));
var t=1;for(i=n-1;i!==-1;--i)if(t0[i]<0)t=min(t,-.999*t0[i]);y=sub(x,mul(d,t));z=sub(b,dot(A,y));if(!all(gt(z,0)))return{solution:x,message:"",iterations:count};x=y;if(alpha<tol)return{solution:y,message:"",iterations:count};if(flag){var s=dot(c,g),Ag=dot(A,g);unbounded=true;for(i=n-1;i!==-1;--i)if(s*Ag[i]<0){unbounded=false;break}}else if(x[m-1]>=0)unbounded=false;else unbounded=true;if(unbounded)return{solution:y,message:"Unbounded",iterations:count}}return{solution:x,message:"maximum iteration count exceeded",
iterations:count}};numeric._solveLP=function _solveLP(c,A,b,tol,maxit){var m=c.length,n=b.length,y;var sum=numeric.sum,log=numeric.log,mul=numeric.mul,sub=numeric.sub,dot=numeric.dot,div=numeric.div,add=numeric.add;var c0=numeric.rep([m],0).concat([1]);var J=numeric.rep([n,1],-1);var A0=numeric.blockMatrix([[A,J]]);var b0=b;var y=numeric.rep([m],0).concat(Math.max(0,numeric.sup(numeric.neg(b)))+1);var x0=numeric.__solveLP(c0,A0,b0,tol,maxit,y,false);var x=numeric.clone(x0.solution);x.length=m;var foo=
numeric.inf(sub(b,dot(A,x)));if(foo<0)return{solution:NaN,message:"Infeasible",iterations:x0.iterations};var ret=numeric.__solveLP(c,A,b,tol,maxit-x0.iterations,x,true);ret.iterations+=x0.iterations;return ret};numeric.solveLP=function solveLP(c,A,b,Aeq,beq,tol,maxit){if(typeof maxit==="undefined")maxit=1E3;if(typeof tol==="undefined")tol=numeric.epsilon;if(typeof Aeq==="undefined")return numeric._solveLP(c,A,b,tol,maxit);var m=Aeq.length,n=Aeq[0].length,o=A.length;var B=numeric.echelonize(Aeq);var flags=
numeric.rep([n],0);var P=B.P;var Q=[];var i;for(i=P.length-1;i!==-1;--i)flags[P[i]]=1;for(i=n-1;i!==-1;--i)if(flags[i]===0)Q.push(i);var g=numeric.getRange;var I=numeric.linspace(0,m-1),J=numeric.linspace(0,o-1);var Aeq2=g(Aeq,I,Q),A1=g(A,J,P),A2=g(A,J,Q),dot=numeric.dot,sub=numeric.sub;var A3=dot(A1,B.I);var A4=sub(A2,dot(A3,Aeq2)),b4=sub(b,dot(A3,beq));var c1=Array(P.length),c2=Array(Q.length);for(i=P.length-1;i!==-1;--i)c1[i]=c[P[i]];for(i=Q.length-1;i!==-1;--i)c2[i]=c[Q[i]];var c4=sub(c2,dot(c1,
dot(B.I,Aeq2)));var S=numeric._solveLP(c4,A4,b4,tol,maxit);var x2=S.solution;if(x2!==x2)return S;var x1=dot(B.I,sub(beq,dot(Aeq2,x2)));var x=Array(c.length);for(i=P.length-1;i!==-1;--i)x[P[i]]=x1[i];for(i=Q.length-1;i!==-1;--i)x[Q[i]]=x2[i];return{solution:x,message:S.message,iterations:S.iterations}};numeric.MPStoLP=function MPStoLP(MPS){if(MPS instanceof String)MPS.split("\n");var state=0;var states=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"];var n=MPS.length;var i,j,z,N=0,
rows={},sign=[],rl=0,vars={},nv=0;var name;var c=[],A=[],b=[];function err(e){throw new Error("MPStoLP: "+e+"\nLine "+i+": "+MPS[i]+"\nCurrent state: "+states[state]+"\n");}for(i=0;i<n;++i){z=MPS[i];var w0=z.match(/\S*/g);var w=[];for(j=0;j<w0.length;++j)if(w0[j]!=="")w.push(w0[j]);if(w.length===0)continue;for(j=0;j<states.length;++j)if(z.substr(0,states[j].length)===states[j])break;if(j<states.length){state=j;if(j===1)name=w[1];if(j===6)return{name:name,c:c,A:numeric.transpose(A),b:b,rows:rows,vars:vars};
continue}switch(state){case 0:case 1:err("Unexpected line");case 2:switch(w[0]){case "N":if(N===0)N=w[1];else err("Two or more N rows");break;case "L":rows[w[1]]=rl;sign[rl]=1;b[rl]=0;++rl;break;case "G":rows[w[1]]=rl;sign[rl]=-1;b[rl]=0;++rl;break;case "E":rows[w[1]]=rl;sign[rl]=0;b[rl]=0;++rl;break;default:err("Parse error "+numeric.prettyPrint(w))}break;case 3:if(!vars.hasOwnProperty(w[0])){vars[w[0]]=nv;c[nv]=0;A[nv]=numeric.rep([rl],0);++nv}var p=vars[w[0]];for(j=1;j<w.length;j+=2){if(w[j]===
N){c[p]=parseFloat(w[j+1]);continue}var q=rows[w[j]];A[p][q]=(sign[q]<0?-1:1)*parseFloat(w[j+1])}break;case 4:for(j=1;j<w.length;j+=2)b[rows[w[j]]]=(sign[rows[w[j]]]<0?-1:1)*parseFloat(w[j+1]);break;case 5:break;case 6:err("Internal error")}}err("Reached end of file without ENDATA")};numeric.seedrandom={pow:Math.pow,random:Math.random};(function(pool,math,width,chunks,significance,overflow,startdenom){math["seedrandom"]=function seedrandom(seed,use_entropy){var key=[];var arc4;seed=mixkey(flatten(use_entropy?
[seed,pool]:arguments.length?seed:[(new Date).getTime(),pool,window],3),key);arc4=new ARC4(key);mixkey(arc4.S,pool);math["random"]=function random(){var n=arc4.g(chunks);var d=startdenom;var x=0;while(n<significance){n=(n+x)*width;d*=width;x=arc4.g(1)}while(n>=overflow){n/=2;d/=2;x>>>=1}return(n+x)/d};return seed};function ARC4(key){var t,u,me=this,keylen=key.length;var i=0,j=me.i=me.j=me.m=0;me.S=[];me.c=[];if(!keylen)key=[keylen++];while(i<width)me.S[i]=i++;for(i=0;i<width;i++){t=me.S[i];j=lowbits(j+
t+key[i%keylen]);u=me.S[j];me.S[i]=u;me.S[j]=t}me.g=function getnext(count){var s=me.S;var i=lowbits(me.i+1);var t=s[i];var j=lowbits(me.j+t);var u=s[j];s[i]=u;s[j]=t;var r=s[lowbits(t+u)];while(--count){i=lowbits(i+1);t=s[i];j=lowbits(j+t);u=s[j];s[i]=u;s[j]=t;r=r*width+s[lowbits(t+u)]}me.i=i;me.j=j;return r};me.g(width)}function flatten(obj,depth,result,prop,typ){result=[];typ=typeof obj;if(depth&&typ=="object")for(prop in obj)if(prop.indexOf("S")<5)try{result.push(flatten(obj[prop],depth-1))}catch(e){}return result.length?
result:obj+(typ!="string"?"\x00":"")}function mixkey(seed,key,smear,j){seed+="";smear=0;for(j=0;j<seed.length;j++)key[lowbits(j)]=lowbits((smear^=key[lowbits(j)]*19)+seed.charCodeAt(j));seed="";for(j in key)seed+=String.fromCharCode(key[j]);return seed}function lowbits(n){return n&width-1}startdenom=math.pow(width,chunks);significance=math.pow(2,significance);overflow=significance*2;mixkey(math.random(),pool)})([],numeric.seedrandom,256,6,52);(function(exports){function base0to1(A){if(typeof A!==
"object")return A;var ret=[],i,n=A.length;for(i=0;i<n;i++)ret[i+1]=base0to1(A[i]);return ret}function base1to0(A){if(typeof A!=="object")return A;var ret=[],i,n=A.length;for(i=1;i<n;i++)ret[i-1]=base1to0(A[i]);return ret}function dpori(a,lda,n){var i,j,k,kp1,t;for(k=1;k<=n;k=k+1){a[k][k]=1/a[k][k];t=-a[k][k];for(i=1;i<k;i=i+1)a[i][k]=t*a[i][k];kp1=k+1;if(n<kp1)break;for(j=kp1;j<=n;j=j+1){t=a[k][j];a[k][j]=0;for(i=1;i<=k;i=i+1)a[i][j]=a[i][j]+t*a[i][k]}}}function dposl(a,lda,n,b){var i,k,kb,t;for(k=
1;k<=n;k=k+1){t=0;for(i=1;i<k;i=i+1)t=t+a[i][k]*b[i];b[k]=(b[k]-t)/a[k][k]}for(kb=1;kb<=n;kb=kb+1){k=n+1-kb;b[k]=b[k]/a[k][k];t=-b[k];for(i=1;i<k;i=i+1)b[i]=b[i]+t*a[i][k]}}function dpofa(a,lda,n,info){var i,j,jm1,k,t,s;for(j=1;j<=n;j=j+1){info[1]=j;s=0;jm1=j-1;if(jm1<1){s=a[j][j]-s;if(s<=0)break;a[j][j]=Math.sqrt(s)}else{for(k=1;k<=jm1;k=k+1){t=a[k][j];for(i=1;i<k;i=i+1)t=t-a[i][j]*a[i][k];t=t/a[k][k];a[k][j]=t;s=s+t*t}s=a[j][j]-s;if(s<=0)break;a[j][j]=Math.sqrt(s)}info[1]=0}}function qpgen2(dmat,
dvec,fddmat,n,sol,crval,amat,bvec,fdamat,q,meq,iact,nact,iter,work,ierr){var i,j,l,l1,info,it1,iwzv,iwrv,iwrm,iwsv,iwuv,nvl,r,iwnbv,temp,sum,t1,tt,gc,gs,nu,t1inf,t2min,vsmall,tmpa,tmpb,go;r=Math.min(n,q);l=2*n+r*(r+5)/2+2*q+1;vsmall=1E-60;do{vsmall=vsmall+vsmall;tmpa=1+.1*vsmall;tmpb=1+.2*vsmall}while(tmpa<=1||tmpb<=1);for(i=1;i<=n;i=i+1)work[i]=dvec[i];for(i=n+1;i<=l;i=i+1)work[i]=0;for(i=1;i<=q;i=i+1)iact[i]=0;info=[];if(ierr[1]===0){dpofa(dmat,fddmat,n,info);if(info[1]!==0){ierr[1]=2;return}dposl(dmat,
fddmat,n,dvec);dpori(dmat,fddmat,n)}else{for(j=1;j<=n;j=j+1){sol[j]=0;for(i=1;i<=j;i=i+1)sol[j]=sol[j]+dmat[i][j]*dvec[i]}for(j=1;j<=n;j=j+1){dvec[j]=0;for(i=j;i<=n;i=i+1)dvec[j]=dvec[j]+dmat[j][i]*sol[i]}}crval[1]=0;for(j=1;j<=n;j=j+1){sol[j]=dvec[j];crval[1]=crval[1]+work[j]*sol[j];work[j]=0;for(i=j+1;i<=n;i=i+1)dmat[i][j]=0}crval[1]=-crval[1]/2;ierr[1]=0;iwzv=n;iwrv=iwzv+n;iwuv=iwrv+r;iwrm=iwuv+r+1;iwsv=iwrm+r*(r+1)/2;iwnbv=iwsv+q;for(i=1;i<=q;i=i+1){sum=0;for(j=1;j<=n;j=j+1)sum=sum+amat[j][i]*
amat[j][i];work[iwnbv+i]=Math.sqrt(sum)}nact=0;iter[1]=0;iter[2]=0;function fn_goto_50(){iter[1]=iter[1]+1;l=iwsv;for(i=1;i<=q;i=i+1){l=l+1;sum=-bvec[i];for(j=1;j<=n;j=j+1)sum=sum+amat[j][i]*sol[j];if(Math.abs(sum)<vsmall)sum=0;if(i>meq)work[l]=sum;else{work[l]=-Math.abs(sum);if(sum>0){for(j=1;j<=n;j=j+1)amat[j][i]=-amat[j][i];bvec[i]=-bvec[i]}}}for(i=1;i<=nact;i=i+1)work[iwsv+iact[i]]=0;nvl=0;temp=0;for(i=1;i<=q;i=i+1)if(work[iwsv+i]<temp*work[iwnbv+i]){nvl=i;temp=work[iwsv+i]/work[iwnbv+i]}if(nvl===
0)return 999;return 0}function fn_goto_55(){for(i=1;i<=n;i=i+1){sum=0;for(j=1;j<=n;j=j+1)sum=sum+dmat[j][i]*amat[j][nvl];work[i]=sum}l1=iwzv;for(i=1;i<=n;i=i+1)work[l1+i]=0;for(j=nact+1;j<=n;j=j+1)for(i=1;i<=n;i=i+1)work[l1+i]=work[l1+i]+dmat[i][j]*work[j];t1inf=true;for(i=nact;i>=1;i=i-1){sum=work[i];l=iwrm+i*(i+3)/2;l1=l-i;for(j=i+1;j<=nact;j=j+1){sum=sum-work[l]*work[iwrv+j];l=l+j}sum=sum/work[l1];work[iwrv+i]=sum;if(iact[i]<meq)break;if(sum<0)break;t1inf=false;it1=i}if(!t1inf){t1=work[iwuv+it1]/
work[iwrv+it1];for(i=1;i<=nact;i=i+1){if(iact[i]<meq)break;if(work[iwrv+i]<0)break;temp=work[iwuv+i]/work[iwrv+i];if(temp<t1){t1=temp;it1=i}}}sum=0;for(i=iwzv+1;i<=iwzv+n;i=i+1)sum=sum+work[i]*work[i];if(Math.abs(sum)<=vsmall)if(t1inf){ierr[1]=1;return 999}else{for(i=1;i<=nact;i=i+1)work[iwuv+i]=work[iwuv+i]-t1*work[iwrv+i];work[iwuv+nact+1]=work[iwuv+nact+1]+t1;return 700}else{sum=0;for(i=1;i<=n;i=i+1)sum=sum+work[iwzv+i]*amat[i][nvl];tt=-work[iwsv+nvl]/sum;t2min=true;if(!t1inf)if(t1<tt){tt=t1;t2min=
false}for(i=1;i<=n;i=i+1){sol[i]=sol[i]+tt*work[iwzv+i];if(Math.abs(sol[i])<vsmall)sol[i]=0}crval[1]=crval[1]+tt*sum*(tt/2+work[iwuv+nact+1]);for(i=1;i<=nact;i=i+1)work[iwuv+i]=work[iwuv+i]-tt*work[iwrv+i];work[iwuv+nact+1]=work[iwuv+nact+1]+tt;if(t2min){nact=nact+1;iact[nact]=nvl;l=iwrm+(nact-1)*nact/2+1;for(i=1;i<=nact-1;i=i+1){work[l]=work[i];l=l+1}if(nact===n)work[l]=work[n];else{for(i=n;i>=nact+1;i=i-1){if(work[i]===0)break;gc=Math.max(Math.abs(work[i-1]),Math.abs(work[i]));gs=Math.min(Math.abs(work[i-
1]),Math.abs(work[i]));if(work[i-1]>=0)temp=Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc)));else temp=-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc)));gc=work[i-1]/temp;gs=work[i]/temp;if(gc===1)break;if(gc===0){work[i-1]=gs*temp;for(j=1;j<=n;j=j+1){temp=dmat[j][i-1];dmat[j][i-1]=dmat[j][i];dmat[j][i]=temp}}else{work[i-1]=temp;nu=gs/(1+gc);for(j=1;j<=n;j=j+1){temp=gc*dmat[j][i-1]+gs*dmat[j][i];dmat[j][i]=nu*(dmat[j][i-1]+temp)-dmat[j][i];dmat[j][i-1]=temp}}}work[l]=work[nact]}}else{sum=-bvec[nvl];for(j=1;j<=n;j=
j+1)sum=sum+sol[j]*amat[j][nvl];if(nvl>meq)work[iwsv+nvl]=sum;else{work[iwsv+nvl]=-Math.abs(sum);if(sum>0){for(j=1;j<=n;j=j+1)amat[j][nvl]=-amat[j][nvl];bvec[nvl]=-bvec[nvl]}}return 700}}return 0}function fn_goto_797(){l=iwrm+it1*(it1+1)/2+1;l1=l+it1;if(work[l1]===0)return 798;gc=Math.max(Math.abs(work[l1-1]),Math.abs(work[l1]));gs=Math.min(Math.abs(work[l1-1]),Math.abs(work[l1]));if(work[l1-1]>=0)temp=Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc)));else temp=-Math.abs(gc*Math.sqrt(1+gs*gs/(gc*gc)));gc=work[l1-
1]/temp;gs=work[l1]/temp;if(gc===1)return 798;if(gc===0){for(i=it1+1;i<=nact;i=i+1){temp=work[l1-1];work[l1-1]=work[l1];work[l1]=temp;l1=l1+i}for(i=1;i<=n;i=i+1){temp=dmat[i][it1];dmat[i][it1]=dmat[i][it1+1];dmat[i][it1+1]=temp}}else{nu=gs/(1+gc);for(i=it1+1;i<=nact;i=i+1){temp=gc*work[l1-1]+gs*work[l1];work[l1]=nu*(work[l1-1]+temp)-work[l1];work[l1-1]=temp;l1=l1+i}for(i=1;i<=n;i=i+1){temp=gc*dmat[i][it1]+gs*dmat[i][it1+1];dmat[i][it1+1]=nu*(dmat[i][it1]+temp)-dmat[i][it1+1];dmat[i][it1]=temp}}return 0}
function fn_goto_798(){l1=l-it1;for(i=1;i<=it1;i=i+1){work[l1]=work[l];l=l+1;l1=l1+1}work[iwuv+it1]=work[iwuv+it1+1];iact[it1]=iact[it1+1];it1=it1+1;if(it1<nact)return 797;return 0}function fn_goto_799(){work[iwuv+nact]=work[iwuv+nact+1];work[iwuv+nact+1]=0;iact[nact]=0;nact=nact-1;iter[2]=iter[2]+1;return 0}go=0;while(true){go=fn_goto_50();if(go===999)return;while(true){go=fn_goto_55();if(go===0)break;if(go===999)return;if(go===700)if(it1===nact)fn_goto_799();else{while(true){fn_goto_797();go=fn_goto_798();
if(go!==797)break}fn_goto_799()}}}}function solveQP(Dmat,dvec,Amat,bvec,meq,factorized){Dmat=base0to1(Dmat);dvec=base0to1(dvec);Amat=base0to1(Amat);var i,n,q,nact,r,crval=[],iact=[],sol=[],work=[],iter=[],message;meq=meq||0;factorized=factorized?base0to1(factorized):[undefined,0];bvec=bvec?base0to1(bvec):[];n=Dmat.length-1;q=Amat[1].length-1;if(!bvec)for(i=1;i<=q;i=i+1)bvec[i]=0;for(i=1;i<=q;i=i+1)iact[i]=0;nact=0;r=Math.min(n,q);for(i=1;i<=n;i=i+1)sol[i]=0;crval[1]=0;for(i=1;i<=2*n+r*(r+5)/2+2*q+
1;i=i+1)work[i]=0;for(i=1;i<=2;i=i+1)iter[i]=0;qpgen2(Dmat,dvec,n,n,sol,crval,Amat,bvec,n,q,meq,iact,nact,iter,work,factorized);message="";if(factorized[1]===1)message="constraints are inconsistent, no solution!";if(factorized[1]===2)message="matrix D in quadratic function is not positive definite!";return{solution:base1to0(sol),value:base1to0(crval),unconstrained_solution:base1to0(dvec),iterations:base1to0(iter),iact:base1to0(iact),message:message}}exports.solveQP=solveQP})(numeric);numeric.svd=
function svd(A){var temp;var prec=numeric.epsilon;var tolerance=1E-64/prec;var itmax=50;var c=0;var i=0;var j=0;var k=0;var l=0;var u=numeric.clone(A);var m=u.length;var n=u[0].length;if(m<n)throw"Need more rows than columns";var e=new Array(n);var q=new Array(n);for(i=0;i<n;i++)e[i]=q[i]=0;var v=numeric.rep([n,n],0);function pythag(a,b){a=Math.abs(a);b=Math.abs(b);if(a>b)return a*Math.sqrt(1+b*b/a/a);else if(b==0)return a;return b*Math.sqrt(1+a*a/b/b)}var f=0;var g=0;var h=0;var x=0;var y=0;var z=
0;var s=0;for(i=0;i<n;i++){e[i]=g;s=0;l=i+1;for(j=i;j<m;j++)s+=u[j][i]*u[j][i];if(s<=tolerance)g=0;else{f=u[i][i];g=Math.sqrt(s);if(f>=0)g=-g;h=f*g-s;u[i][i]=f-g;for(j=l;j<n;j++){s=0;for(k=i;k<m;k++)s+=u[k][i]*u[k][j];f=s/h;for(k=i;k<m;k++)u[k][j]+=f*u[k][i]}}q[i]=g;s=0;for(j=l;j<n;j++)s=s+u[i][j]*u[i][j];if(s<=tolerance)g=0;else{f=u[i][i+1];g=Math.sqrt(s);if(f>=0)g=-g;h=f*g-s;u[i][i+1]=f-g;for(j=l;j<n;j++)e[j]=u[i][j]/h;for(j=l;j<m;j++){s=0;for(k=l;k<n;k++)s+=u[j][k]*u[i][k];for(k=l;k<n;k++)u[j][k]+=
s*e[k]}}y=Math.abs(q[i])+Math.abs(e[i]);if(y>x)x=y}for(i=n-1;i!=-1;i+=-1){if(g!=0){h=g*u[i][i+1];for(j=l;j<n;j++)v[j][i]=u[i][j]/h;for(j=l;j<n;j++){s=0;for(k=l;k<n;k++)s+=u[i][k]*v[k][j];for(k=l;k<n;k++)v[k][j]+=s*v[k][i]}}for(j=l;j<n;j++){v[i][j]=0;v[j][i]=0}v[i][i]=1;g=e[i];l=i}for(i=n-1;i!=-1;i+=-1){l=i+1;g=q[i];for(j=l;j<n;j++)u[i][j]=0;if(g!=0){h=u[i][i]*g;for(j=l;j<n;j++){s=0;for(k=l;k<m;k++)s+=u[k][i]*u[k][j];f=s/h;for(k=i;k<m;k++)u[k][j]+=f*u[k][i]}for(j=i;j<m;j++)u[j][i]=u[j][i]/g}else for(j=
i;j<m;j++)u[j][i]=0;u[i][i]+=1}prec=prec*x;for(k=n-1;k!=-1;k+=-1)for(var iteration=0;iteration<itmax;iteration++){var test_convergence=false;for(l=k;l!=-1;l+=-1){if(Math.abs(e[l])<=prec){test_convergence=true;break}if(Math.abs(q[l-1])<=prec)break}if(!test_convergence){c=0;s=1;var l1=l-1;for(i=l;i<k+1;i++){f=s*e[i];e[i]=c*e[i];if(Math.abs(f)<=prec)break;g=q[i];h=pythag(f,g);q[i]=h;c=g/h;s=-f/h;for(j=0;j<m;j++){y=u[j][l1];z=u[j][i];u[j][l1]=y*c+z*s;u[j][i]=-y*s+z*c}}}z=q[k];if(l==k){if(z<0){q[k]=-z;
for(j=0;j<n;j++)v[j][k]=-v[j][k]}break}if(iteration>=itmax-1)throw"Error: no convergence.";x=q[l];y=q[k-1];g=e[k-1];h=e[k];f=((y-z)*(y+z)+(g-h)*(g+h))/(2*h*y);g=pythag(f,1);if(f<0)f=((x-z)*(x+z)+h*(y/(f-g)-h))/x;else f=((x-z)*(x+z)+h*(y/(f+g)-h))/x;c=1;s=1;for(i=l+1;i<k+1;i++){g=e[i];y=q[i];h=s*g;g=c*g;z=pythag(f,h);e[i-1]=z;c=f/z;s=h/z;f=x*c+g*s;g=-x*s+g*c;h=y*s;y=y*c;for(j=0;j<n;j++){x=v[j][i-1];z=v[j][i];v[j][i-1]=x*c+z*s;v[j][i]=-x*s+z*c}z=pythag(f,h);q[i-1]=z;c=f/z;s=h/z;f=c*g+s*y;x=-s*g+c*y;
for(j=0;j<m;j++){y=u[j][i-1];z=u[j][i];u[j][i-1]=y*c+z*s;u[j][i]=-y*s+z*c}}e[l]=0;e[k]=f;q[k]=x}for(i=0;i<q.length;i++)if(q[i]<prec)q[i]=0;for(i=0;i<n;i++)for(j=i-1;j>=0;j--)if(q[j]<q[i]){c=q[j];q[j]=q[i];q[i]=c;for(k=0;k<u.length;k++){temp=u[k][i];u[k][i]=u[k][j];u[k][j]=temp}for(k=0;k<v.length;k++){temp=v[k][i];v[k][i]=v[k][j];v[k][j]=temp}i=j}return{U:u,S:q,V:v}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],8:[function(require,
module,exports){(function(){function getSqDist(p1,p2){var dx=p1.x-p2.x,dy=p1.y-p2.y;return dx*dx+dy*dy}function getSqSegDist(p,p1,p2){var x=p1.x,y=p1.y,dx=p2.x-x,dy=p2.y-y;if(dx!==0||dy!==0){var t=((p.x-x)*dx+(p.y-y)*dy)/(dx*dx+dy*dy);if(t>1){x=p2.x;y=p2.y}else if(t>0){x+=dx*t;y+=dy*t}}dx=p.x-x;dy=p.y-y;return dx*dx+dy*dy}function simplifyRadialDist(points,sqTolerance){var prevPoint=points[0],newPoints=[prevPoint],point;for(var i=1,len=points.length;i<len;i++){point=points[i];if(getSqDist(point,prevPoint)>
sqTolerance){newPoints.push(point);prevPoint=point}}if(prevPoint!==point)newPoints.push(point);return newPoints}function simplifyDouglasPeucker(points,sqTolerance){var len=points.length,MarkerArray=typeof Uint8Array!=="undefined"?Uint8Array:Array,markers=new MarkerArray(len),first=0,last=len-1,stack=[],newPoints=[],i,maxSqDist,sqDist,index;markers[first]=markers[last]=1;while(last){maxSqDist=0;for(i=first+1;i<last;i++){sqDist=getSqSegDist(points[i],points[first],points[last]);if(sqDist>maxSqDist){index=
i;maxSqDist=sqDist}}if(maxSqDist>sqTolerance){markers[index]=1;stack.push(first,index,index,last)}last=stack.pop();first=stack.pop()}for(i=0;i<len;i++)if(markers[i])newPoints.push(points[i]);return newPoints}function simplify(points,tolerance,highestQuality){var sqTolerance=tolerance!==undefined?tolerance*tolerance:1;points=highestQuality?points:simplifyRadialDist(points,sqTolerance);points=simplifyDouglasPeucker(points,sqTolerance);return points}if(typeof define==="function"&&define.amd)define(function(){return simplify});
else if(typeof module!=="undefined")module.exports=simplify;else if(typeof self!=="undefined")self.simplify=simplify;else window.simplify=simplify})()},{}],9:[function(require,module,exports){module.exports=createKDTree;module.exports.deserialize=deserializeKDTree;var ndarray=require("ndarray");var ndselect=require("ndarray-select");var pack=require("ndarray-pack");var ops=require("ndarray-ops");var ndscratch=require("ndarray-scratch");var pool=require("typedarray-pool");var inorderTree=require("inorder-tree-layout");
var bits=require("bit-twiddle");var KDTHeap=require("./lib/heap.js");function KDTree(points,ids,n,d){this.points=points;this.ids=ids;this.dimension=d;this.length=n}var proto=KDTree.prototype;proto.serialize=function(){if(this.length>0)return{p:Array.prototype.slice.call(this.points.data,0,this.length*this.dimension),i:Array.prototype.slice.call(this.ids,0,this.length)};else return{d:this.dimension}};proto.range=function kdtRangeQuery(lo,hi,visit){var n=this.length;if(n<1)return;var d=this.dimension;
for(var i=0;i<d;++i)if(hi[i]<lo[i])return;var points=this.points;var ids=this.ids;var visitRange=ndscratch.malloc([n,2,d]);var visitIndex=pool.mallocInt32(n);var rangeData=visitRange.data;var pointData=points.data;var visitCount=1;var visitTop=0;var retval;visitIndex[0]=0;pack(lo,visitRange.pick(0,0));pack(hi,visitRange.pick(0,1));while(visitTop<visitCount){var idx=visitIndex[visitTop];var k=bits.log2(idx+1)%d;var loidx=visitRange.index(visitTop,0,0);var hiidx=visitRange.index(visitTop,1,0);var pidx=
points.index(idx,0);var visitPoint=true;for(var i=0;i<d;++i){var pc=pointData[pidx+i];if(pc<rangeData[loidx+i]||rangeData[hiidx+i]<pc){visitPoint=false;break}}if(visitPoint){retval=visit(ids[idx]);if(retval!==undefined)break}var pk=pointData[pidx+k];var hk=rangeData[hiidx+k];var lk=rangeData[loidx+k];if(lk<=pk){var left=2*idx+1;if(left<n){visitIndex[visitCount]=left;var y=visitRange.index(visitCount,0,0);for(var i=0;i<d;++i)rangeData[y+i]=rangeData[loidx+i];var z=visitRange.index(visitCount,1,0);
for(var i=0;i<d;++i)rangeData[z+i]=rangeData[hiidx+i];rangeData[z+k]=Math.min(hk,pk);visitCount+=1}}if(pk<=hk){var right=2*(idx+1);if(right<n){visitIndex[visitCount]=right;var y=visitRange.index(visitCount,0,0);for(var i=0;i<d;++i)rangeData[y+i]=rangeData[loidx+i];var z=visitRange.index(visitCount,1,0);for(var i=0;i<d;++i)rangeData[z+i]=rangeData[hiidx+i];rangeData[y+k]=Math.max(lk,pk);visitCount+=1}}visitTop+=1}ndscratch.free(visitRange);pool.free(visitIndex);return retval};proto.rnn=function(point,
radius,visit){if(radius<0)return;var n=this.length;if(n<1)return;var d=this.dimension;var points=this.points;var ids=this.ids;var visitDistance=ndscratch.malloc([n,d]);var visitIndex=pool.mallocInt32(n);var distanceData=visitDistance.data;var pointData=points.data;var visitCount=1;var visitTop=0;var r2=radius*radius;var retval;visitIndex[0]=0;for(var i=0;i<d;++i)visitDistance.set(0,i,0);while(visitTop<visitCount){var idx=visitIndex[visitTop];var pidx=points.index(idx,0);var d2=0;for(var i=0;i<d;++i)d2+=
Math.pow(point[i]-pointData[pidx+i],2);if(d2<=r2){retval=visit(ids[idx]);if(retval!==undefined)break}var k=bits.log2(idx+1)%d;var ds=0;var didx=visitDistance.index(visitTop,0);for(var i=0;i<d;++i)if(i!==k)ds+=distanceData[didx+i];var qk=point[k];var pk=pointData[pidx+k];var dk=distanceData[didx+k];var lk=dk;var hk=dk;if(qk<pk)hk=Math.max(dk,Math.pow(pk-qk,2));else lk=Math.max(dk,Math.pow(pk-qk,2));var d2l=lk+ds;var d2h=hk+ds;if(d2l<=r2){var left=2*idx+1;if(left<n){visitIndex[visitCount]=left;var y=
visitDistance.index(visitCount,0);for(var i=0;i<d;++i)distanceData[y+i]=distanceData[didx+i];distanceData[y+k]=lk;visitCount+=1}}if(d2h<=r2){var right=2*(idx+1);if(right<n){visitIndex[visitCount]=right;var y=visitDistance.index(visitCount,0);for(var i=0;i<d;++i)distanceData[y+i]=distanceData[didx+i];distanceData[y+k]=hk;visitCount+=1}}visitTop+=1}ndscratch.free(visitDistance);pool.free(visitIndex);return retval};proto.nn=function(point,maxDistance){var n=this.length;if(n<1)return-1;if(typeof maxDistance===
"number"){if(maxDistance<0)return-1}else maxDistance=Infinity;var d=this.dimension;var points=this.points;var pointData=points.data;var dataVector=pool.mallocFloat64(d);var toVisit=new KDTHeap(n,d+1);var index=toVisit.index;var data=toVisit.data;index[0]=0;for(var i=0;i<=d;++i)data[i]=0;toVisit.count+=1;var nearest=-1;var nearestD=maxDistance;while(toVisit.count>0){if(data[0]>=nearestD)break;var idx=index[0];var pidx=points.index(idx,0);var d2=0;for(var i=0;i<d;++i)d2+=Math.pow(point[i]-pointData[pidx+
i],2);if(d2<nearestD){nearestD=d2;nearest=idx}var k=bits.log2(idx+1)%d;var ds=0;for(var i=0;i<d;++i){var dd=data[i+1];if(i!==k)ds+=dd;dataVector[i]=dd}var qk=point[k];var pk=pointData[pidx+k];var dk=dataVector[k];var lk=dk;var hk=dk;if(qk<pk)hk=Math.max(dk,Math.pow(pk-qk,2));else lk=Math.max(dk,Math.pow(pk-qk,2));var d2l=lk+ds;var d2h=hk+ds;toVisit.pop();if(d2l<nearestD){var left=2*idx+1;if(left<n){var vcount=toVisit.count;index[vcount]=left;var vptr=vcount*(d+1);data[vptr]=d2l;for(var i=1;i<=d;++i)data[vptr+
i]=dataVector[i-1];data[vptr+k+1]=lk;toVisit.push()}}if(d2h<nearestD){var right=2*(idx+1);if(right<n){var vcount=toVisit.count;index[vcount]=right;var vptr=vcount*(d+1);data[vptr]=d2h;for(var i=1;i<=d;++i)data[vptr+i]=dataVector[i-1];data[vptr+k+1]=hk;toVisit.push()}}}pool.freeFloat64(dataVector);toVisit.dispose();if(nearest<0)return-1;return this.ids[nearest]};proto.knn=function(point,maxPoints,maxDistance){if(typeof maxDistance==="number"){if(maxDistance<0)return[]}else maxDistance=Infinity;var n=
this.length;if(n<1)return[];if(typeof maxPoints==="number"){if(maxPoints<=0)return[];maxPoints=Math.min(maxPoints,n)|0}else maxPoints=n;var ids=this.ids;var d=this.dimension;var points=this.points;var pointData=points.data;var dataVector=pool.mallocFloat64(d);var closestPoints=new KDTHeap(maxPoints,1);var cl_index=closestPoints.index;var cl_data=closestPoints.data;var toVisit=new KDTHeap(n,d+1);var index=toVisit.index;var data=toVisit.data;index[0]=0;for(var i=0;i<=d;++i)data[i]=0;toVisit.count+=
1;var nearest=-1;var nearestD=maxDistance;while(toVisit.count>0){if(data[0]>=nearestD)break;var idx=index[0];var pidx=points.index(idx,0);var d2=0;for(var i=0;i<d;++i)d2+=Math.pow(point[i]-pointData[pidx+i],2);if(d2<nearestD){if(closestPoints.count>=maxPoints)closestPoints.pop();var pcount=closestPoints.count;cl_index[pcount]=idx;cl_data[pcount]=-d2;closestPoints.push();if(closestPoints.count>=maxPoints)nearestD=-cl_data[0]}var k=bits.log2(idx+1)%d;var ds=0;for(var i=0;i<d;++i){var dd=data[i+1];if(i!==
k)ds+=dd;dataVector[i]=dd}var qk=point[k];var pk=pointData[pidx+k];var dk=dataVector[k];var lk=dk;var hk=dk;if(qk<pk)hk=Math.max(dk,Math.pow(pk-qk,2));else lk=Math.max(dk,Math.pow(pk-qk,2));var d2l=lk+ds;var d2h=hk+ds;toVisit.pop();if(d2l<nearestD){var left=2*idx+1;if(left<n){var vcount=toVisit.count;index[vcount]=left;var vptr=vcount*(d+1);data[vptr]=d2l;for(var i=1;i<=d;++i)data[vptr+i]=dataVector[i-1];data[vptr+k+1]=lk;toVisit.push()}}if(d2h<nearestD){var right=2*(idx+1);if(right<n){var vcount=
toVisit.count;index[vcount]=right;var vptr=vcount*(d+1);data[vptr]=d2h;for(var i=1;i<=d;++i)data[vptr+i]=dataVector[i-1];data[vptr+k+1]=hk;toVisit.push()}}}pool.freeFloat64(dataVector);toVisit.dispose();var result=new Array(closestPoints.count);var ids=this.ids;for(var i=closestPoints.count-1;i>=0;--i){result[i]=ids[cl_index[0]];closestPoints.pop()}closestPoints.dispose();return result};proto.dispose=function kdtDispose(){pool.free(this.points.data);pool.freeInt32(this.ids);this.points=null;this.ids=
null;this.length=0};function createKDTree(points){var n,d,indexed;if(Array.isArray(points)){n=points.length;if(n===0)return new KDTree(null,null,0,0);d=points[0].length;indexed=ndarray(pool.mallocDouble(n*(d+1)),[n,d+1]);pack(points,indexed.hi(n,d))}else{n=points.shape[0];d=points.shape[1];var type=points.dtype;if(type==="int8"||type==="int16"||type==="int32")type="int32";else if(type==="uint8"||type==="uint8_clamped"||type==="buffer"||type==="uint16"||type==="uint32")type="uint32";else if(type===
"float32")type="float32";else type="float64";indexed=ndarray(pool.malloc(n*(d+1)),[n,d+1]);ops.assign(indexed.hi(n,d),points)}for(var i=0;i<n;++i)indexed.set(i,d,i);var pointArray=ndscratch.malloc([n,d],points.dtype);var indexArray=pool.mallocInt32(n);var pointer=0;var pointData=pointArray.data;var arrayData=indexed.data;var l2_n=bits.log2(bits.nextPow2(n));var sel_cmp=ndselect.compile(indexed.order,true,indexed.dtype);var toVisit=[indexed];while(pointer<n){var head=toVisit.shift();var array=head;
var nn=array.shape[0]|0;if(nn>1){var k=bits.log2(pointer+1)%d;var median;var n_2=inorderTree.root(nn);median=sel_cmp(array,n_2,function(a,b){return a.get(k)-b.get(k)});var pptr=pointArray.index(pointer,0);var mptr=median.offset;for(var i=0;i<d;++i)pointData[pptr++]=arrayData[mptr++];indexArray[pointer]=arrayData[mptr];pointer+=1;toVisit.push(array.hi(n_2));if(nn>2)toVisit.push(array.lo(n_2+1))}else{var mptr=array.offset;var pptr=pointArray.index(pointer,0);for(var i=0;i<d;++i)pointData[pptr+i]=arrayData[mptr++];
indexArray[pointer]=arrayData[mptr];pointer+=1}}pool.free(indexed.data);return new KDTree(pointArray,indexArray,n,d)}function deserializeKDTree(data){var points=data.p;var ids=data.i;if(points){var nd=points.length;var pointArray=pool.mallocFloat64(nd);for(var i=0;i<nd;++i)pointArray[i]=points[i];var n=ids.length;var idArray=pool.mallocInt32(n);for(var i=0;i<n;++i)idArray[i]=ids[i];var d=nd/n|0;return new KDTree(ndarray(pointArray,[n,d]),idArray,n,d)}else return new KDTree(null,null,0,data.d)}},{"./lib/heap.js":10,
"bit-twiddle":11,"inorder-tree-layout":12,"ndarray":27,"ndarray-ops":14,"ndarray-pack":19,"ndarray-scratch":25,"ndarray-select":26,"typedarray-pool":31}],10:[function(require,module,exports){module.exports=KDTHeap;var pool=require("typedarray-pool");function heapParent(i){if(i&1)return i-1>>1;return(i>>1)-1}function KDTHeap(n,d){this.count=0;this.dataSize=d;this.index=pool.mallocInt32(n);this.data=pool.mallocFloat64(n*d)}var proto=KDTHeap.prototype;proto.heapSwap=function(_i,_j){var data=this.data;
var index=this.index;var d=this.dataSize;var tmp=index[_i];index[_i]=index[_j];index[_j]=tmp;var aptr=d*_i;var bptr=d*_j;for(var _k=0;_k<d;++_k){var t2=data[aptr];data[aptr]=data[bptr];data[bptr]=t2;aptr+=1;bptr+=1}};proto.heapUp=function(i){var d=this.dataSize;var index=this.index;var data=this.data;var w=data[d*i];while(i>0){var parent=heapParent(i);if(parent>=0){var pw=data[d*parent];if(w<pw){this.heapSwap(i,parent);i=parent;continue}}break}};proto.heapDown=function(i){var d=this.dataSize;var index=
this.index;var data=this.data;var count=this.count;var w=data[d*i];while(true){var tw=w;var left=2*i+1;var right=2*(i+1);var next=i;if(left<count){var lw=data[d*left];if(lw<tw){next=left;tw=lw}}if(right<count){var rw=data[d*right];if(rw<tw)next=right}if(next===i)break;this.heapSwap(i,next);i=next}};proto.pop=function(){this.count-=1;this.heapSwap(0,this.count);this.heapDown(0)};proto.push=function(){this.heapUp(this.count);this.count+=1};proto.dispose=function(){pool.freeInt32(this.index);pool.freeFloat64(this.data)}},
{"typedarray-pool":31}],11:[function(require,module,exports){"use restrict";var INT_BITS=32;exports.INT_BITS=INT_BITS;exports.INT_MAX=2147483647;exports.INT_MIN=-1<<INT_BITS-1;exports.sign=function(v){return(v>0)-(v<0)};exports.abs=function(v){var mask=v>>INT_BITS-1;return(v^mask)-mask};exports.min=function(x,y){return y^(x^y)&-(x<y)};exports.max=function(x,y){return x^(x^y)&-(x<y)};exports.isPow2=function(v){return!(v&v-1)&&!!v};exports.log2=function(v){var r,shift;r=(v>65535)<<4;v>>>=r;shift=(v>
255)<<3;v>>>=shift;r|=shift;shift=(v>15)<<2;v>>>=shift;r|=shift;shift=(v>3)<<1;v>>>=shift;r|=shift;return r|v>>1};exports.log10=function(v){return v>=1E9?9:v>=1E8?8:v>=1E7?7:v>=1E6?6:v>=1E5?5:v>=1E4?4:v>=1E3?3:v>=100?2:v>=10?1:0};exports.popCount=function(v){v=v-(v>>>1&1431655765);v=(v&858993459)+(v>>>2&858993459);return(v+(v>>>4)&252645135)*16843009>>>24};function countTrailingZeros(v){var c=32;v&=-v;if(v)c--;if(v&65535)c-=16;if(v&16711935)c-=8;if(v&252645135)c-=4;if(v&858993459)c-=2;if(v&1431655765)c-=
1;return c}exports.countTrailingZeros=countTrailingZeros;exports.nextPow2=function(v){v+=v===0;--v;v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v+1};exports.prevPow2=function(v){v|=v>>>1;v|=v>>>2;v|=v>>>4;v|=v>>>8;v|=v>>>16;return v-(v>>>1)};exports.parity=function(v){v^=v>>>16;v^=v>>>8;v^=v>>>4;v&=15;return 27030>>>v&1};var REVERSE_TABLE=new Array(256);(function(tab){for(var i=0;i<256;++i){var v=i,r=i,s=7;for(v>>>=1;v;v>>>=1){r<<=1;r|=v&1;--s}tab[i]=r<<s&255}})(REVERSE_TABLE);exports.reverse=
function(v){return REVERSE_TABLE[v&255]<<24|REVERSE_TABLE[v>>>8&255]<<16|REVERSE_TABLE[v>>>16&255]<<8|REVERSE_TABLE[v>>>24&255]};exports.interleave2=function(x,y){x&=65535;x=(x|x<<8)&16711935;x=(x|x<<4)&252645135;x=(x|x<<2)&858993459;x=(x|x<<1)&1431655765;y&=65535;y=(y|y<<8)&16711935;y=(y|y<<4)&252645135;y=(y|y<<2)&858993459;y=(y|y<<1)&1431655765;return x|y<<1};exports.deinterleave2=function(v,n){v=v>>>n&1431655765;v=(v|v>>>1)&858993459;v=(v|v>>>2)&252645135;v=(v|v>>>4)&16711935;v=(v|v>>>16)&65535;
return v<<16>>16};exports.interleave3=function(x,y,z){x&=1023;x=(x|x<<16)&4278190335;x=(x|x<<8)&251719695;x=(x|x<<4)&3272356035;x=(x|x<<2)&1227133513;y&=1023;y=(y|y<<16)&4278190335;y=(y|y<<8)&251719695;y=(y|y<<4)&3272356035;y=(y|y<<2)&1227133513;x|=y<<1;z&=1023;z=(z|z<<16)&4278190335;z=(z|z<<8)&251719695;z=(z|z<<4)&3272356035;z=(z|z<<2)&1227133513;return x|z<<2};exports.deinterleave3=function(v,n){v=v>>>n&1227133513;v=(v|v>>>2)&3272356035;v=(v|v>>>4)&251719695;v=(v|v>>>8)&4278190335;v=(v|v>>>16)&
1023;return v<<22>>22};exports.nextCombination=function(v){var t=v|v-1;return t+1|(~t&-~t)-1>>>countTrailingZeros(v)+1}},{}],12:[function(require,module,exports){var bits=require("bit-twiddle");function rootInorder(n){var ptree=(bits.nextPow2(n+1)>>>1)-1;var f=n-ptree;if(bits.nextPow2(f)-1>=ptree)return ptree;return(ptree>>>1)+f}exports.root=rootInorder;function beginInorder(n){return 0}exports.begin=beginInorder;function endInorder(n){return n-1}exports.end=endInorder;function heightInorder(n,x){if(n<=
0)return 0;var r=rootInorder(n);if(x>r)return heightInorder(n-r-1,x-r-1);else if(x===r)return bits.log2(n);return heightInorder(r,x)}exports.height=heightInorder;function prevInorder(n,x){return Math.max(x-1,0)}exports.prev=prevInorder;function nextInorder(n,x){return Math.min(x+1,n-1)}exports.next=nextInorder;function parentInorder(n,x){if(n<=0)return-1;var r=rootInorder(n);if(x>r){var q=parentInorder(n-r-1,x-r-1);if(q<0)return r;else return q+r+1}else if(x===r)return-1;var q=parentInorder(r,x);
if(q<0)return r;return q}exports.parent=parentInorder;function leftInorder(n,x){if(n<=0)return 0;var r=rootInorder(n);if(x>r)return leftInorder(n-r-1,x-r-1)+r+1;else if(x===r)return rootInorder(x);return leftInorder(r,x)}exports.left=leftInorder;function rightInorder(n,x){if(n<=0)return 0;var r=rootInorder(n);if(x>r)return rightInorder(n-r-1,x-r-1)+r+1;else if(x===r)return rootInorder(n-r-1)+r+1;return rightInorder(r,x)}exports.right=rightInorder;function leafInorder(n,x){return heightInorder(n,x)===
0}exports.leaf=leafInorder;function loInorder(n,x){n|=0;x|=0;var l=0;while(n>1){var r=rootInorder(n);if(x>r){l+=r+1;n-=r+1;x-=r+1}else if(x===r)break;else n=r}return l}exports.lo=loInorder;function hiInorder(n,x){n|=0;x|=0;var l=0;while(n>1){var r=rootInorder(n);if(x>r){l+=r+1;n-=r+1;x-=r+1}else if(x===r){l+=n-1;break}else n=r}return l}exports.hi=hiInorder},{"bit-twiddle":13}],13:[function(require,module,exports){arguments[4][11][0].apply(exports,arguments)},{"dup":11}],14:[function(require,module,
exports){var compile=require("cwise-compiler");var EmptyProc={body:"",args:[],thisVars:[],localVars:[]};function fixup(x){if(!x)return EmptyProc;for(var i=0;i<x.args.length;++i){var a=x.args[i];if(i===0)x.args[i]={name:a,lvalue:true,rvalue:!!x.rvalue,count:x.count||1};else x.args[i]={name:a,lvalue:false,rvalue:true,count:1}}if(!x.thisVars)x.thisVars=[];if(!x.localVars)x.localVars=[];return x}function pcompile(user_args){return compile({args:user_args.args,pre:fixup(user_args.pre),body:fixup(user_args.body),
post:fixup(user_args.proc),funcName:user_args.funcName})}function makeOp(user_args){var args=[];for(var i=0;i<user_args.args.length;++i)args.push("a"+i);var wrapper=new Function("P",["return function ",user_args.funcName,"_ndarrayops(",args.join(","),") {P(",args.join(","),");return a0}"].join(""));return wrapper(pcompile(user_args))}var assign_ops={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};(function(){for(var id in assign_ops){var op=
assign_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+op+"=b"},rvalue:true,funcName:id+"eq"});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+op+"=s"},rvalue:true,funcName:id+"seq"})}})();var unary_ops={not:"!",
bnot:"~",neg:"-",recip:"1.0/"};(function(){for(var id in unary_ops){var op=unary_ops[id];exports[id]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+op+"b"},funcName:id});exports[id+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+op+"a"},rvalue:true,count:2,funcName:id+"eq"})}})();var binary_ops={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};(function(){for(var id in binary_ops){var op=binary_ops[id];exports[id]=makeOp({args:["array","array","array"],body:{args:["a",
"b","c"],body:"a=b"+op+"c"},funcName:id});exports[id+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+op+"s"},funcName:id+"s"});exports[id+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+op+"b"},rvalue:true,count:2,funcName:id+"eq"});exports[id+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+op+"s"},rvalue:true,count:2,funcName:id+"seq"})}})();var math_unary=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round",
"sin","sqrt","tan"];(function(){for(var i=0;i<math_unary.length;++i){var f=math_unary[i];exports[f]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:f});exports[f+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"})}})();var math_comm=["max","min","atan2","pow"];(function(){for(var i=
0;i<math_comm.length;++i){var f=math_comm[i];exports[f]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f});exports[f+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:f+"s"});exports[f+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+
f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"eq"});exports[f+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"seq"})}})();var math_noncomm=["atan2","pow"];(function(){for(var i=0;i<math_noncomm.length;++i){var f=math_noncomm[i];exports[f+"op"]=makeOp({args:["array","array","array"],pre:{args:[],
body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"op"});exports[f+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:f+"ops"});exports[f+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,
count:2,funcName:f+"opeq"});exports[f+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+f,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:true,count:2,funcName:f+"opseq"})}})();exports.any=compile({args:["array"],pre:EmptyProc,body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"});exports.all=compile({args:["array"],
pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"});exports.sum=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"});exports.prod=
compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"});exports.norm2squared=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],
localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"});exports.norm2=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"});exports.norminf=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",
lvalue:false,rvalue:true,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"});exports.norm1=compile({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:false,rvalue:true,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},
funcName:"norm1"});exports.sup=compile({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{"name":"_inline_1_arg0_","lvalue":false,"rvalue":true,"count":2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.inf=compile({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",
args:[{"name":"_inline_1_arg0_","lvalue":false,"rvalue":true,"count":2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}});exports.argmin=compile({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],
localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.argmax=compile({args:["index","array","shape"],
pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg1_",lvalue:false,rvalue:false,count:0},{name:"_inline_0_arg2_",lvalue:false,rvalue:true,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",
lvalue:false,rvalue:true,count:2},{name:"_inline_1_arg1_",lvalue:false,rvalue:true,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}});exports.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"});exports.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"});exports.assigns=
makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"});exports.equals=compile({args:["array","array"],pre:EmptyProc,body:{args:[{name:"x",lvalue:false,rvalue:true,count:1},{name:"y",lvalue:false,rvalue:true,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":15}],15:[function(require,module,exports){var createThunk=require("./lib/thunk.js");function Procedure(){this.argTypes=
[];this.shimArgs=[];this.arrayArgs=[];this.arrayBlockIndices=[];this.scalarArgs=[];this.offsetArgs=[];this.offsetArgIndex=[];this.indexArgs=[];this.shapeArgs=[];this.funcName="";this.pre=null;this.body=null;this.post=null;this.debug=false}function compileCwise(user_args){var proc=new Procedure;proc.pre=user_args.pre;proc.body=user_args.body;proc.post=user_args.post;var proc_args=user_args.args.slice(0);proc.argTypes=proc_args;for(var i=0;i<proc_args.length;++i){var arg_type=proc_args[i];if(arg_type===
"array"||typeof arg_type==="object"&&arg_type.blockIndices){proc.argTypes[i]="array";proc.arrayArgs.push(i);proc.arrayBlockIndices.push(arg_type.blockIndices?arg_type.blockIndices:0);proc.shimArgs.push("array"+i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args");}else if(arg_type==="scalar"){proc.scalarArgs.push(i);
proc.shimArgs.push("scalar"+i)}else if(arg_type==="index"){proc.indexArgs.push(i);if(i<proc.pre.args.length&&proc.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<proc.post.args.length&&proc.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index");}else if(arg_type==="shape"){proc.shapeArgs.push(i);if(i<
proc.pre.args.length&&proc.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<proc.body.args.length&&proc.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<proc.post.args.length&&proc.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape");}else if(typeof arg_type==="object"&&arg_type.offset){proc.argTypes[i]="offset";proc.offsetArgs.push({array:arg_type.array,offset:arg_type.offset});
proc.offsetArgIndex.push(i)}else throw new Error("cwise: Unknown argument type "+proc_args[i]);}if(proc.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(proc.pre.args.length>proc_args.length)throw new Error("cwise: Too many arguments in pre() block");if(proc.body.args.length>proc_args.length)throw new Error("cwise: Too many arguments in body() block");if(proc.post.args.length>proc_args.length)throw new Error("cwise: Too many arguments in post() block");proc.debug=!!user_args.printCode||
!!user_args.debug;proc.funcName=user_args.funcName||"cwise";proc.blockSize=user_args.blockSize||64;return createThunk(proc)}module.exports=compileCwise},{"./lib/thunk.js":17}],16:[function(require,module,exports){var uniq=require("uniq");function innerFill(order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,has_index=proc.indexArgs.length>0,code=[],vars=[],idx=0,pidx=0,i,j;for(i=0;i<dimension;++i)vars.push(["i",i,"=0"].join(""));for(j=0;j<nargs;++j)for(i=0;i<dimension;++i){pidx=
idx;idx=order[i];if(i===0)vars.push(["d",j,"s",i,"=t",j,"p",idx].join(""));else vars.push(["d",j,"s",i,"=(t",j,"p",idx,"-s",pidx,"*t",j,"p",pidx,")"].join(""))}code.push("var "+vars.join(","));for(i=dimension-1;i>=0;--i){idx=order[i];code.push(["for(i",i,"=0;i",i,"<s",idx,";++i",i,"){"].join(""))}code.push(body);for(i=0;i<dimension;++i){pidx=idx;idx=order[i];for(j=0;j<nargs;++j)code.push(["p",j,"+=d",j,"s",i].join(""));if(has_index){if(i>0)code.push(["index[",pidx,"]-=s",pidx].join(""));code.push(["++index[",
idx,"]"].join(""))}code.push("}")}return code.join("\n")}function outerFill(matched,order,proc,body){var dimension=order.length,nargs=proc.arrayArgs.length,blockSize=proc.blockSize,has_index=proc.indexArgs.length>0,code=[];for(var i=0;i<nargs;++i)code.push(["var offset",i,"=p",i].join(""));for(var i=matched;i<dimension;++i){code.push(["for(var j"+i+"=SS[",order[i],"]|0;j",i,">0;){"].join(""));code.push(["if(j",i,"<",blockSize,"){"].join(""));code.push(["s",order[i],"=j",i].join(""));code.push(["j",
i,"=0"].join(""));code.push(["}else{s",order[i],"=",blockSize].join(""));code.push(["j",i,"-=",blockSize,"}"].join(""));if(has_index)code.push(["index[",order[i],"]=j",i].join(""))}for(var i=0;i<nargs;++i){var indexStr=["offset"+i];for(var j=matched;j<dimension;++j)indexStr.push(["j",j,"*t",i,"p",order[j]].join(""));code.push(["p",i,"=(",indexStr.join("+"),")"].join(""))}code.push(innerFill(order,proc,body));for(var i=matched;i<dimension;++i)code.push("}");return code.join("\n")}function countMatches(orders){var matched=
0,dimension=orders[0].length;while(matched<dimension){for(var j=1;j<orders.length;++j)if(orders[j][matched]!==orders[0][matched])return matched;++matched}return matched}function processBlock(block,proc,dtypes){var code=block.body;var pre=[];var post=[];for(var i=0;i<block.args.length;++i){var carg=block.args[i];if(carg.count<=0)continue;var re=new RegExp(carg.name,"g");var ptrStr="";var arrNum=proc.arrayArgs.indexOf(i);switch(proc.argTypes[i]){case "offset":var offArgIndex=proc.offsetArgIndex.indexOf(i);
var offArg=proc.offsetArgs[offArgIndex];arrNum=offArg.array;ptrStr="+q"+offArgIndex;case "array":ptrStr="p"+arrNum+ptrStr;var localStr="l"+i;var arrStr="a"+arrNum;if(proc.arrayBlockIndices[arrNum]===0)if(carg.count===1)if(dtypes[arrNum]==="generic")if(carg.lvalue){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}else code=code.replace(re,[arrStr,".get(",ptrStr,")"].join(""));else code=code.replace(re,
[arrStr,"[",ptrStr,"]"].join(""));else if(dtypes[arrNum]==="generic"){pre.push(["var ",localStr,"=",arrStr,".get(",ptrStr,")"].join(""));code=code.replace(re,localStr);if(carg.lvalue)post.push([arrStr,".set(",ptrStr,",",localStr,")"].join(""))}else{pre.push(["var ",localStr,"=",arrStr,"[",ptrStr,"]"].join(""));code=code.replace(re,localStr);if(carg.lvalue)post.push([arrStr,"[",ptrStr,"]=",localStr].join(""))}else{var reStrArr=[carg.name],ptrStrArr=[ptrStr];for(var j=0;j<Math.abs(proc.arrayBlockIndices[arrNum]);j++){reStrArr.push("\\s*\\[([^\\]]+)\\]");
ptrStrArr.push("$"+(j+1)+"*t"+arrNum+"b"+j)}re=new RegExp(reStrArr.join(""),"g");ptrStr=ptrStrArr.join("+");if(dtypes[arrNum]==="generic")throw new Error("cwise: Generic arrays not supported in combination with blocks!");else code=code.replace(re,[arrStr,"[",ptrStr,"]"].join(""))}break;case "scalar":code=code.replace(re,"Y"+proc.scalarArgs.indexOf(i));break;case "index":code=code.replace(re,"index");break;case "shape":code=code.replace(re,"shape");break}}return[pre.join("\n"),code,post.join("\n")].join("\n").trim()}
function typeSummary(dtypes){var summary=new Array(dtypes.length);var allEqual=true;for(var i=0;i<dtypes.length;++i){var t=dtypes[i];var digits=t.match(/\d+/);if(!digits)digits="";else digits=digits[0];if(t.charAt(0)===0)summary[i]="u"+t.charAt(1)+digits;else summary[i]=t.charAt(0)+digits;if(i>0)allEqual=allEqual&&summary[i]===summary[i-1]}if(allEqual)return summary[0];return summary.join("")}function generateCWiseOp(proc,typesig){var dimension=typesig[1].length-Math.abs(proc.arrayBlockIndices[0])|
0;var orders=new Array(proc.arrayArgs.length);var dtypes=new Array(proc.arrayArgs.length);for(var i=0;i<proc.arrayArgs.length;++i){dtypes[i]=typesig[2*i];orders[i]=typesig[2*i+1]}var blockBegin=[],blockEnd=[];var loopBegin=[],loopEnd=[];var loopOrders=[];for(var i=0;i<proc.arrayArgs.length;++i){if(proc.arrayBlockIndices[i]<0){loopBegin.push(0);loopEnd.push(dimension);blockBegin.push(dimension);blockEnd.push(dimension+proc.arrayBlockIndices[i])}else{loopBegin.push(proc.arrayBlockIndices[i]);loopEnd.push(proc.arrayBlockIndices[i]+
dimension);blockBegin.push(0);blockEnd.push(proc.arrayBlockIndices[i])}var newOrder=[];for(var j=0;j<orders[i].length;j++)if(loopBegin[i]<=orders[i][j]&&orders[i][j]<loopEnd[i])newOrder.push(orders[i][j]-loopBegin[i]);loopOrders.push(newOrder)}var arglist=["SS"];var code=["'use strict'"];var vars=[];for(var j=0;j<dimension;++j)vars.push(["s",j,"=SS[",j,"]"].join(""));for(var i=0;i<proc.arrayArgs.length;++i){arglist.push("a"+i);arglist.push("t"+i);arglist.push("p"+i);for(var j=0;j<dimension;++j)vars.push(["t",
i,"p",j,"=t",i,"[",loopBegin[i]+j,"]"].join(""));for(var j=0;j<Math.abs(proc.arrayBlockIndices[i]);++j)vars.push(["t",i,"b",j,"=t",i,"[",blockBegin[i]+j,"]"].join(""))}for(var i=0;i<proc.scalarArgs.length;++i)arglist.push("Y"+i);if(proc.shapeArgs.length>0)vars.push("shape=SS.slice(0)");if(proc.indexArgs.length>0){var zeros=new Array(dimension);for(var i=0;i<dimension;++i)zeros[i]="0";vars.push(["index=[",zeros.join(","),"]"].join(""))}for(var i=0;i<proc.offsetArgs.length;++i){var off_arg=proc.offsetArgs[i];
var init_string=[];for(var j=0;j<off_arg.offset.length;++j)if(off_arg.offset[j]===0)continue;else if(off_arg.offset[j]===1)init_string.push(["t",off_arg.array,"p",j].join(""));else init_string.push([off_arg.offset[j],"*t",off_arg.array,"p",j].join(""));if(init_string.length===0)vars.push("q"+i+"=0");else vars.push(["q",i,"=",init_string.join("+")].join(""))}var thisVars=uniq([].concat(proc.pre.thisVars).concat(proc.body.thisVars).concat(proc.post.thisVars));vars=vars.concat(thisVars);code.push("var "+
vars.join(","));for(var i=0;i<proc.arrayArgs.length;++i)code.push("p"+i+"|=0");if(proc.pre.body.length>3)code.push(processBlock(proc.pre,proc,dtypes));var body=processBlock(proc.body,proc,dtypes);var matched=countMatches(loopOrders);if(matched<dimension)code.push(outerFill(matched,loopOrders[0],proc,body));else code.push(innerFill(loopOrders[0],proc,body));if(proc.post.body.length>3)code.push(processBlock(proc.post,proc,dtypes));if(proc.debug)console.log("-----Generated cwise routine for ",typesig,
":\n"+code.join("\n")+"\n----------");var loopName=[proc.funcName||"unnamed","_cwise_loop_",orders[0].join("s"),"m",matched,typeSummary(dtypes)].join("");var f=new Function(["function ",loopName,"(",arglist.join(","),"){",code.join("\n"),"} return ",loopName].join(""));return f()}module.exports=generateCWiseOp},{"uniq":18}],17:[function(require,module,exports){var compile=require("./compile.js");function createThunk(proc){var code=["'use strict'","var CACHED={}"];var vars=[];var thunkName=proc.funcName+
"_cwise_thunk";code.push(["return function ",thunkName,"(",proc.shimArgs.join(","),"){"].join(""));var typesig=[];var string_typesig=[];var proc_args=[["array",proc.arrayArgs[0],".shape.slice(",Math.max(0,proc.arrayBlockIndices[0]),proc.arrayBlockIndices[0]<0?","+proc.arrayBlockIndices[0]+")":")"].join("")];var shapeLengthConditions=[],shapeConditions=[];for(var i=0;i<proc.arrayArgs.length;++i){var j=proc.arrayArgs[i];vars.push(["t",j,"=array",j,".dtype,","r",j,"=array",j,".order"].join(""));typesig.push("t"+
j);typesig.push("r"+j);string_typesig.push("t"+j);string_typesig.push("r"+j+".join()");proc_args.push("array"+j+".data");proc_args.push("array"+j+".stride");proc_args.push("array"+j+".offset|0");if(i>0){shapeLengthConditions.push("array"+proc.arrayArgs[0]+".shape.length===array"+j+".shape.length+"+(Math.abs(proc.arrayBlockIndices[0])-Math.abs(proc.arrayBlockIndices[i])));shapeConditions.push("array"+proc.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,proc.arrayBlockIndices[0])+"]===array"+j+".shape[shapeIndex+"+
Math.max(0,proc.arrayBlockIndices[i])+"]")}}if(proc.arrayArgs.length>1){code.push("if (!("+shapeLengthConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')");code.push("for(var shapeIndex=array"+proc.arrayArgs[0]+".shape.length-"+Math.abs(proc.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {");code.push("if (!("+shapeConditions.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')");code.push("}")}for(var i=0;i<proc.scalarArgs.length;++i)proc_args.push("scalar"+
proc.scalarArgs[i]);vars.push(["type=[",string_typesig.join(","),"].join()"].join(""));vars.push("proc=CACHED[type]");code.push("var "+vars.join(","));code.push(["if(!proc){","CACHED[type]=proc=compile([",typesig.join(","),"])}","return proc(",proc_args.join(","),")}"].join(""));if(proc.debug)console.log("-----Generated thunk:\n"+code.join("\n")+"\n----------");var thunk=new Function("compile",code.join("\n"));return thunk(compile.bind(undefined,proc))}module.exports=createThunk},{"./compile.js":16}],
18:[function(require,module,exports){function unique_pred(list,compare){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i){b=a;a=list[i];if(compare(a,b)){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique_eq(list){var ptr=1,len=list.length,a=list[0],b=list[0];for(var i=1;i<len;++i,b=a){b=a;a=list[i];if(a!==b){if(i===ptr){ptr++;continue}list[ptr++]=a}}list.length=ptr;return list}function unique(list,compare,sorted){if(list.length===0)return list;
if(compare){if(!sorted)list.sort(compare);return unique_pred(list,compare)}if(!sorted)list.sort();return unique_eq(list)}module.exports=unique},{}],19:[function(require,module,exports){var ndarray=require("ndarray");var do_convert=require("./doConvert.js");module.exports=function convert(arr,result){var shape=[],c=arr,sz=1;while(c instanceof Array){shape.push(c.length);sz*=c.length;c=c[0]}if(shape.length===0)return ndarray();if(!result)result=ndarray(new Float64Array(sz),shape);do_convert(result,
arr);return result}},{"./doConvert.js":20,"ndarray":27}],20:[function(require,module,exports){module.exports=require("cwise-compiler")({"args":["array","scalar","index"],"pre":{"body":"{}","args":[],"thisVars":[],"localVars":[]},"body":{"body":"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}","args":[{"name":"_inline_1_arg0_",
"lvalue":true,"rvalue":false,"count":1},{"name":"_inline_1_arg1_","lvalue":false,"rvalue":true,"count":1},{"name":"_inline_1_arg2_","lvalue":false,"rvalue":true,"count":4}],"thisVars":[],"localVars":["_inline_1_i","_inline_1_v"]},"post":{"body":"{}","args":[],"thisVars":[],"localVars":[]},"funcName":"convert","blockSize":64})},{"cwise-compiler":21}],21:[function(require,module,exports){arguments[4][15][0].apply(exports,arguments)},{"./lib/thunk.js":23,"dup":15}],22:[function(require,module,exports){arguments[4][16][0].apply(exports,
arguments)},{"dup":16,"uniq":24}],23:[function(require,module,exports){arguments[4][17][0].apply(exports,arguments)},{"./compile.js":22,"dup":17}],24:[function(require,module,exports){arguments[4][18][0].apply(exports,arguments)},{"dup":18}],25:[function(require,module,exports){var ndarray=require("ndarray");var ops=require("ndarray-ops");var pool=require("typedarray-pool");function clone(array){var dtype=array.dtype;if(dtype==="generic"||dtype==="array")dtype="double";var data=pool.malloc(array.size,
dtype);var result=ndarray(data,array.shape);ops.assign(result,array);return result}exports.clone=clone;function malloc(shape,dtype){if(!dtype)dtype="double";var sz=1;var stride=new Array(shape.length);for(var i=shape.length-1;i>=0;--i){stride[i]=sz;sz*=shape[i]}return ndarray(pool.malloc(sz,dtype),shape,stride,0)}exports.malloc=malloc;function free(array){if(array.dtype==="generic"||array.dtype==="array")return;pool.free(array.data)}exports.free=free;function zeros(shape,dtype){if(!dtype)dtype="double";
var sz=1;var stride=new Array(shape.length);for(var i=shape.length-1;i>=0;--i){stride[i]=sz;sz*=shape[i]}var buf=pool.malloc(sz,dtype);for(var i=0;i<sz;++i)buf[i]=0;return ndarray(buf,shape,stride,0)}exports.zeros=zeros;function ones(shape,dtype){if(!dtype)dtype="double";var sz=1;var stride=new Array(shape.length);for(var i=shape.length-1;i>=0;--i){stride[i]=sz;sz*=shape[i]}var buf=pool.malloc(sz,dtype);for(var i=0;i<sz;++i)buf[i]=1;return ndarray(buf,shape,stride,0)}exports.ones=ones;function eye(shape,
dtype){var i,offset;if(!dtype)dtype="double";var sz=1;var stride=new Array(shape.length);for(i=shape.length-1;i>=0;--i){stride[i]=sz;sz*=shape[i]}var buf=pool.malloc(sz,dtype);for(i=0;i<sz;++i)buf[i]=0;var mindim=Infinity;var offsum=0;for(i=shape.length-1;i>=0;i--){offsum+=stride[i];mindim=Math.min(mindim,shape[i])}for(i=0,offset=0;i<mindim;i++,offset+=offsum)buf[offset]=1;return ndarray(buf,shape,stride,0)}exports.eye=eye},{"ndarray":27,"ndarray-ops":14,"typedarray-pool":31}],26:[function(require,
module,exports){module.exports=ndSelect;module.exports.compile=lookupCache;var ARRAY="a";var RANK="K";var CMP="C";var DATA="d";var OFFSET="o";var RND="R";var TMP="T";var LO="L";var HI="H";var PIVOT="X";function SHAPE(i){return"s"+i}function STRIDE(i){return"t"+i}function STEP(i){return"u"+i}function STEP_CMP(i){return"v"+i}function INDEX(i){return"i"+i}function PICK(i){return"p"+i}function PTR(i){return"x"+i}function permuteOrder(order){var norder=order.slice();norder.splice(order.indexOf(0),1);norder.unshift(0);
return norder}function compileQuickSelect(order,useCompare,dtype){order=permuteOrder(order);var dimension=order.length;var useGetter=dtype==="generic";var funcName="ndSelect"+dtype+order.join("_")+"_"+(useCompare?"cmp":"lex");var code=[];var args=[ARRAY,RANK];if(useCompare)args.push(CMP);var vars=[DATA+"="+ARRAY+".data",OFFSET+"="+ARRAY+".offset|0",RND+"=Math.random",TMP];for(var i=0;i<2;++i)vars.push(PTR(i)+"=0");for(var i=0;i<dimension;++i)vars.push(SHAPE(i)+"="+ARRAY+".shape["+i+"]|0",STRIDE(i)+
"="+ARRAY+".stride["+i+"]|0",INDEX(i)+"=0");for(var i=1;i<dimension;++i)if(i>1)vars.push(STEP_CMP(i)+"=("+STRIDE(i)+"-"+SHAPE(i-1)+"*"+STRIDE(i-1)+")|0",STEP(order[i])+"=("+STRIDE(order[i])+"-"+SHAPE(order[i-1])+"*"+STRIDE(order[i-1])+")|0");else vars.push(STEP_CMP(i)+"="+STRIDE(i),STEP(order[i])+"="+STRIDE(order[i]));if(useCompare)for(var i=0;i<2;++i)vars.push(PICK(i)+"="+ARRAY+".pick(0)");vars.push(PIVOT+"=0",LO+"=0",HI+"="+SHAPE(order[0])+"-1");function compare(out,i0,i1){if(useCompare)code.push(PICK(0),
".offset=",OFFSET,"+",STRIDE(order[0]),"*(",i0,");",PICK(1),".offset=",OFFSET,"+",STRIDE(order[0]),"*(",i1,");",out,"=",CMP,"(",PICK(0),",",PICK(1),");");else{code.push(PTR(0),"=",OFFSET,"+",STRIDE(0),"*(",i0,");",PTR(1),"=",OFFSET,"+",STRIDE(0),"*(",i1,");");if(dimension>1)code.push("_cmp:");for(var i=dimension-1;i>0;--i)code.push("for(",INDEX(i),"=0;",INDEX(i),"<",SHAPE(i),";",INDEX(i),"++){");if(useGetter)code.push(out,"=",DATA,".get(",PTR(0),")-",DATA,".get(",PTR(1),");");else code.push(out,"=",
DATA,"[",PTR(0),"]-",DATA,"[",PTR(1),"];");if(dimension>1)code.push("if(",out,")break _cmp;");for(var i=1;i<dimension;++i)code.push(PTR(0),"+=",STEP_CMP(i),";",PTR(1),"+=",STEP_CMP(i),"}")}}function swap(i0,i1){code.push(PTR(0),"=",OFFSET,"+",STRIDE(order[0]),"*(",i0,");",PTR(1),"=",OFFSET,"+",STRIDE(order[0]),"*(",i1,");");for(var i=dimension-1;i>0;--i)code.push("for(",INDEX(order[i]),"=0;",INDEX(order[i]),"<",SHAPE(order[i]),";",INDEX(order[i]),"++){");if(useGetter)code.push(TMP,"=",DATA,".get(",
PTR(0),");",DATA,".set(",PTR(0),",",DATA,".get(",PTR(1),"));",DATA,".set(",PTR(1),",",TMP,");");else code.push(TMP,"=",DATA,"[",PTR(0),"];",DATA,"[",PTR(0),"]=",DATA,"[",PTR(1),"];",DATA,"[",PTR(1),"]=",TMP,";");for(var i=1;i<dimension;++i)code.push(PTR(0),"+=",STEP(order[i]),";",PTR(1),"+=",STEP(order[i]),"}")}code.push("while(",LO,"<",HI,"){",PIVOT,"=(",RND,"()*(",HI,"-",LO,"+1)+",LO,")|0;");swap(PIVOT,HI);code.push(PIVOT,"=",LO,";","for(",INDEX(0),"=",LO,";",INDEX(0),"<",HI,";",INDEX(0),"++){");
compare(TMP,INDEX(0),HI);code.push("if(",TMP,"<0){");swap(PIVOT,INDEX(0));code.push(PIVOT,"++;");code.push("}}");swap(PIVOT,HI);code.push("if(",PIVOT,"===",RANK,"){",LO,"=",PIVOT,";","break;","}else if(",RANK,"<",PIVOT,"){",HI,"=",PIVOT,"-1;","}else{",LO,"=",PIVOT,"+1;","}","}");if(useCompare)code.push(PICK(0),".offset=",OFFSET,"+",LO,"*",STRIDE(0),";","return ",PICK(0),";");else code.push("return ",ARRAY,".pick(",LO,");");var procCode=["'use strict';function ",funcName,"(",args,"){","var ",vars.join(),
";",code.join(""),"};return ",funcName].join("");var proc=new Function(procCode);return proc()}var CACHE={};function lookupCache(order,useCompare,dtype){var typesig=order.join()+useCompare+dtype;var proc=CACHE[typesig];if(proc)return proc;return CACHE[typesig]=compileQuickSelect(order,useCompare,dtype)}function ndSelect(array,k,compare){k|=0;if(array.dimension===0||array.shape[0]<=k||k<0)return null;var useCompare=!!compare;var proc=lookupCache(array.order,useCompare,array.dtype);if(useCompare)return proc(array,
k,compare);else return proc(array,k)}},{}],27:[function(require,module,exports){var iota=require("iota-array");var isBuffer=require("is-buffer");var hasTypedArrays=typeof Float64Array!=="undefined";function compare1st(a,b){return a[0]-b[0]}function order(){var stride=this.stride;var terms=new Array(stride.length);var i;for(i=0;i<terms.length;++i)terms[i]=[Math.abs(stride[i]),i];terms.sort(compare1st);var result=new Array(terms.length);for(i=0;i<result.length;++i)result[i]=terms[i][1];return result}
function compileConstructor(dtype,dimension){var className=["View",dimension,"d",dtype].join("");if(dimension<0)className="View_Nil"+dtype;var useGetters=dtype==="generic";if(dimension===-1){var code="function "+className+"(a){this.data=a;};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+className+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+
className+"(a){return new "+className+"(a);}";var procedure=new Function(code);return procedure()}else if(dimension===0){var code="function "+className+"(a,d) {this.data = a;this.offset = d};var proto="+className+".prototype;proto.dtype='"+dtype+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+className+"_copy() {return new "+className+"(this.data,this.offset)};proto.pick=function "+
className+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+className+"_get(){return "+(useGetters?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+className+"_set(v){return "+(useGetters?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+className+"(a,b,c,d){return new "+className+"(a,d)}";var procedure=new Function("TrivialArray",code);return procedure(CACHED_CONSTRUCTORS[dtype][0])}var code=["'use strict'"];
var indices=iota(dimension);var args=indices.map(function(i){return"i"+i});var index_str="this.offset+"+indices.map(function(i){return"this.stride["+i+"]*i"+i}).join("+");var shapeArg=indices.map(function(i){return"b"+i}).join(",");var strideArg=indices.map(function(i){return"c"+i}).join(",");code.push("function "+className+"(a,"+shapeArg+","+strideArg+",d){this.data=a","this.shape=["+shapeArg+"]","this.stride=["+strideArg+"]","this.offset=d|0}","var proto="+className+".prototype","proto.dtype='"+
dtype+"'","proto.dimension="+dimension);code.push("Object.defineProperty(proto,'size',{get:function "+className+"_size(){return "+indices.map(function(i){return"this.shape["+i+"]"}).join("*"),"}})");if(dimension===1)code.push("proto.order=[0]");else{code.push("Object.defineProperty(proto,'order',{get:");if(dimension<4){code.push("function "+className+"_order(){");if(dimension===2)code.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})");else if(dimension===3)code.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")}else code.push("ORDER})")}code.push("proto.set=function "+
className+"_set("+args.join(",")+",v){");if(useGetters)code.push("return this.data.set("+index_str+",v)}");else code.push("return this.data["+index_str+"]=v}");code.push("proto.get=function "+className+"_get("+args.join(",")+"){");if(useGetters)code.push("return this.data.get("+index_str+")}");else code.push("return this.data["+index_str+"]}");code.push("proto.index=function "+className+"_index(",args.join(),"){return "+index_str+"}");code.push("proto.hi=function "+className+"_hi("+args.join(",")+
"){return new "+className+"(this.data,"+indices.map(function(i){return["(typeof i",i,"!=='number'||i",i,"<0)?this.shape[",i,"]:i",i,"|0"].join("")}).join(",")+","+indices.map(function(i){return"this.stride["+i+"]"}).join(",")+",this.offset)}");var a_vars=indices.map(function(i){return"a"+i+"=this.shape["+i+"]"});var c_vars=indices.map(function(i){return"c"+i+"=this.stride["+i+"]"});code.push("proto.lo=function "+className+"_lo("+args.join(",")+"){var b=this.offset,d=0,"+a_vars.join(",")+","+c_vars.join(","));
for(var i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){d=i"+i+"|0;b+=c"+i+"*d;a"+i+"-=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"c"+i}).join(",")+",b)}");code.push("proto.step=function "+className+"_step("+args.join(",")+"){var "+indices.map(function(i){return"a"+i+"=this.shape["+i+"]"}).join(",")+","+indices.map(function(i){return"b"+i+"=this.stride["+i+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");
for(var i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'){d=i"+i+"|0;if(d<0){c+=b"+i+"*(a"+i+"-1);a"+i+"=ceil(-a"+i+"/d)}else{a"+i+"=ceil(a"+i+"/d)}b"+i+"*=d}");code.push("return new "+className+"(this.data,"+indices.map(function(i){return"a"+i}).join(",")+","+indices.map(function(i){return"b"+i}).join(",")+",c)}");var tShape=new Array(dimension);var tStride=new Array(dimension);for(var i=0;i<dimension;++i){tShape[i]="a[i"+i+"]";tStride[i]="b[i"+i+"]"}code.push("proto.transpose=function "+
className+"_transpose("+args+"){"+args.map(function(n,idx){return n+"=("+n+"===undefined?"+idx+":"+n+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+className+"(this.data,"+tShape.join(",")+","+tStride.join(",")+",this.offset)}");code.push("proto.pick=function "+className+"_pick("+args+"){var a=[],b=[],c=this.offset");for(var i=0;i<dimension;++i)code.push("if(typeof i"+i+"==='number'&&i"+i+">=0){c=(c+this.stride["+i+"]*i"+i+")|0}else{a.push(this.shape["+i+"]);b.push(this.stride["+i+
"])}");code.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}");code.push("return function construct_"+className+"(data,shape,stride,offset){return new "+className+"(data,"+indices.map(function(i){return"shape["+i+"]"}).join(",")+","+indices.map(function(i){return"stride["+i+"]"}).join(",")+",offset)}");var procedure=new Function("CTOR_LIST","ORDER",code.join("\n"));return procedure(CACHED_CONSTRUCTORS[dtype],order)}function arrayDType(data){if(isBuffer(data))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(data)){case "[object Float64Array]":return"float64";
case "[object Float32Array]":return"float32";case "[object Int8Array]":return"int8";case "[object Int16Array]":return"int16";case "[object Int32Array]":return"int32";case "[object Uint8Array]":return"uint8";case "[object Uint16Array]":return"uint16";case "[object Uint32Array]":return"uint32";case "[object Uint8ClampedArray]":return"uint8_clamped"}if(Array.isArray(data))return"array";return"generic"}var CACHED_CONSTRUCTORS={"float32":[],"float64":[],"int8":[],"int16":[],"int32":[],"uint8":[],"uint16":[],
"uint32":[],"array":[],"uint8_clamped":[],"buffer":[],"generic":[]};(function(){for(var id in CACHED_CONSTRUCTORS)CACHED_CONSTRUCTORS[id].push(compileConstructor(id,-1))});function wrappedNDArrayCtor(data,shape,stride,offset){if(data===undefined){var ctor=CACHED_CONSTRUCTORS.array[0];return ctor([])}else if(typeof data==="number")data=[data];if(shape===undefined)shape=[data.length];var d=shape.length;if(stride===undefined){stride=new Array(d);for(var i=d-1,sz=1;i>=0;--i){stride[i]=sz;sz*=shape[i]}}if(offset===
undefined){offset=0;for(var i=0;i<d;++i)if(stride[i]<0)offset-=(shape[i]-1)*stride[i]}var dtype=arrayDType(data);var ctor_list=CACHED_CONSTRUCTORS[dtype];while(ctor_list.length<=d+1)ctor_list.push(compileConstructor(dtype,ctor_list.length-1));var ctor=ctor_list[d+1];return ctor(data,shape,stride,offset)}module.exports=wrappedNDArrayCtor},{"iota-array":28,"is-buffer":29}],28:[function(require,module,exports){function iota(n){var result=new Array(n);for(var i=0;i<n;++i)result[i]=i;return result}module.exports=
iota},{}],29:[function(require,module,exports){module.exports=function(obj){return!!(obj!=null&&(obj._isBuffer||obj.constructor&&typeof obj.constructor.isBuffer==="function"&&obj.constructor.isBuffer(obj)))}},{}],30:[function(require,module,exports){function dupe_array(count,value,i){var c=count[i]|0;if(c<=0)return[];var result=new Array(c),j;if(i===count.length-1)for(j=0;j<c;++j)result[j]=value;else for(j=0;j<c;++j)result[j]=dupe_array(count,value,i+1);return result}function dupe_number(count,value){var result,
i;result=new Array(count);for(i=0;i<count;++i)result[i]=value;return result}function dupe(count,value){if(typeof value==="undefined")value=0;switch(typeof count){case "number":if(count>0)return dupe_number(count|0,value);break;case "object":if(typeof count.length==="number")return dupe_array(count,value,0);break}return[]}module.exports=dupe},{}],31:[function(require,module,exports){(function(global,Buffer){var bits=require("bit-twiddle");var dup=require("dup");if(!global.__TYPEDARRAY_POOL)global.__TYPEDARRAY_POOL=
{UINT8:dup([32,0]),UINT16:dup([32,0]),UINT32:dup([32,0]),INT8:dup([32,0]),INT16:dup([32,0]),INT32:dup([32,0]),FLOAT:dup([32,0]),DOUBLE:dup([32,0]),DATA:dup([32,0]),UINT8C:dup([32,0]),BUFFER:dup([32,0])};var hasUint8C=typeof Uint8ClampedArray!=="undefined";var POOL=global.__TYPEDARRAY_POOL;if(!POOL.UINT8C)POOL.UINT8C=dup([32,0]);if(!POOL.BUFFER)POOL.BUFFER=dup([32,0]);var DATA=POOL.DATA,BUFFER=POOL.BUFFER;exports.free=function free(array){if(Buffer.isBuffer(array))BUFFER[bits.log2(array.length)].push(array);
else{if(Object.prototype.toString.call(array)!=="[object ArrayBuffer]")array=array.buffer;if(!array)return;var n=array.length||array.byteLength;var log_n=bits.log2(n)|0;DATA[log_n].push(array)}};function freeArrayBuffer(buffer){if(!buffer)return;var n=buffer.length||buffer.byteLength;var log_n=bits.log2(n);DATA[log_n].push(buffer)}function freeTypedArray(array){freeArrayBuffer(array.buffer)}exports.freeUint8=exports.freeUint16=exports.freeUint32=exports.freeInt8=exports.freeInt16=exports.freeInt32=
exports.freeFloat32=exports.freeFloat=exports.freeFloat64=exports.freeDouble=exports.freeUint8Clamped=exports.freeDataView=freeTypedArray;exports.freeArrayBuffer=freeArrayBuffer;exports.freeBuffer=function freeBuffer(array){BUFFER[bits.log2(array.length)].push(array)};exports.malloc=function malloc(n,dtype){if(dtype===undefined||dtype==="arraybuffer")return mallocArrayBuffer(n);else switch(dtype){case "uint8":return mallocUint8(n);case "uint16":return mallocUint16(n);case "uint32":return mallocUint32(n);
case "int8":return mallocInt8(n);case "int16":return mallocInt16(n);case "int32":return mallocInt32(n);case "float":case "float32":return mallocFloat(n);case "double":case "float64":return mallocDouble(n);case "uint8_clamped":return mallocUint8Clamped(n);case "buffer":return mallocBuffer(n);case "data":case "dataview":return mallocDataView(n);default:return null}return null};function mallocArrayBuffer(n){var n=bits.nextPow2(n);var log_n=bits.log2(n);var d=DATA[log_n];if(d.length>0)return d.pop();
return new ArrayBuffer(n)}exports.mallocArrayBuffer=mallocArrayBuffer;function mallocUint8(n){return new Uint8Array(mallocArrayBuffer(n),0,n)}exports.mallocUint8=mallocUint8;function mallocUint16(n){return new Uint16Array(mallocArrayBuffer(2*n),0,n)}exports.mallocUint16=mallocUint16;function mallocUint32(n){return new Uint32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocUint32=mallocUint32;function mallocInt8(n){return new Int8Array(mallocArrayBuffer(n),0,n)}exports.mallocInt8=mallocInt8;function mallocInt16(n){return new Int16Array(mallocArrayBuffer(2*
n),0,n)}exports.mallocInt16=mallocInt16;function mallocInt32(n){return new Int32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocInt32=mallocInt32;function mallocFloat(n){return new Float32Array(mallocArrayBuffer(4*n),0,n)}exports.mallocFloat32=exports.mallocFloat=mallocFloat;function mallocDouble(n){return new Float64Array(mallocArrayBuffer(8*n),0,n)}exports.mallocFloat64=exports.mallocDouble=mallocDouble;function mallocUint8Clamped(n){if(hasUint8C)return new Uint8ClampedArray(mallocArrayBuffer(n),
0,n);else return mallocUint8(n)}exports.mallocUint8Clamped=mallocUint8Clamped;function mallocDataView(n){return new DataView(mallocArrayBuffer(n),0,n)}exports.mallocDataView=mallocDataView;function mallocBuffer(n){n=bits.nextPow2(n);var log_n=bits.log2(n);var cache=BUFFER[log_n];if(cache.length>0)return cache.pop();return new Buffer(n)}exports.mallocBuffer=mallocBuffer;exports.clearCache=function clearCache(){for(var i=0;i<32;++i){POOL.UINT8[i].length=0;POOL.UINT16[i].length=0;POOL.UINT32[i].length=
0;POOL.INT8[i].length=0;POOL.INT16[i].length=0;POOL.INT32[i].length=0;POOL.FLOAT[i].length=0;POOL.DOUBLE[i].length=0;POOL.UINT8C[i].length=0;DATA[i].length=0;BUFFER[i].length=0}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},require("buffer").Buffer)},{"bit-twiddle":11,"buffer":1,"dup":30}],32:[function(require,module,exports){var colorSort;colorSort=require("../color/sort.coffee");module.exports=function(a,b,keys,sort,colors,vars,
depth){var i,k,retVal;if(!sort)sort="asc";if(!(colors instanceof Array))colors=[colors];if(!(keys instanceof Array))keys=[keys];if(vars&&depth!==void 0&&typeof depth!=="number")depth=vars.id.nesting.indexOf(depth);retVal=0;i=0;while(i<keys.length){k=keys[i];a=vars&&a.d3plus&&a.d3plus.sortKeys?a.d3plus.sortKeys[k]:a[k];b=vars&&b.d3plus&&b.d3plus.sortKeys?b.d3plus.sortKeys[k]:b[k];if(vars&&colors.indexOf(k)>=0)retVal=colorSort(a,b);else retVal=a<b?-1:1;if(retVal!==0||i===keys.length-1)break;i++}if(sort===
"asc")return retVal;else return-retVal}},{"../color/sort.coffee":49}],33:[function(require,module,exports){module.exports=function(arr,value){var constructor;if(arr instanceof Array){constructor=value===void 0||value===null?value:value.constructor;return arr.indexOf(value)>=0||arr.indexOf(constructor)>=0}else return false}},{}],34:[function(require,module,exports){var comparator,fetchSort;comparator=require("./comparator.coffee");fetchSort=require("../core/fetch/sort.coffee");module.exports=function(arr,
keys,sort,colors,vars,depth){var d,data,i,len;if(!arr||arr.length<=1)return arr||[];else{if(vars){if(!keys)keys=vars.order.value||vars.size.value||vars.id.value;if(!sort)sort=vars.order.sort.value;if(!colors)colors=vars.color.value||[];for(i=0,len=arr.length;i<len;i++){d=arr[i];if(!d.d3plus)d.d3plus={};data="d3plus"in d&&"d3plus"in d.d3plus?d.d3plus:d;d.d3plus.sortKeys=fetchSort(vars,data,keys,colors,depth)}}return arr.sort(function(a,b){return comparator(a,b,keys,sort,colors,vars,depth)})}}},{"../core/fetch/sort.coffee":65,
"./comparator.coffee":32}],35:[function(require,module,exports){module.exports=function(arr,x){if(x===void 0)return arr;if(x===false)return[];if(x instanceof Array)return x;if(!(arr instanceof Array))arr=[];if(arr.indexOf(x)>=0)arr.splice(arr.indexOf(x),1);else arr.push(x);return arr}},{}],36:[function(require,module,exports){var sheet;sheet=function(name){var css,i,returnBoolean,tested;tested=sheet.tested;if(name in tested)return tested[name];i=0;returnBoolean=false;while(i<document.styleSheets.length){css=
document.styleSheets[i];if(css.href&&css.href.indexOf(name)>=0){returnBoolean=true;break}i++}return returnBoolean};sheet.tested={};module.exports=sheet},{}],37:[function(require,module,exports){module.exports=/(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent)},{}],38:[function(require,module,exports){var ie,touch;ie=require("./ie.js");touch=require("./touch.coffee");if(touch)module.exports={click:"click",down:"touchstart",up:"touchend",over:ie?"mouseenter":"mouseover",out:ie?"mouseleave":"mouseout",
move:"mousemove"};else module.exports={click:"click",down:"mousedown",up:"mouseup",over:ie?"mouseenter":"mouseover",out:ie?"mouseleave":"mouseout",move:"mousemove"}},{"./ie.js":37,"./touch.coffee":43}],39:[function(require,module,exports){var prefix;prefix=function(){var val;if("-webkit-transform"in document.body.style)val="-webkit-";else if("-moz-transform"in document.body.style)val="-moz-";else if("-ms-transform"in document.body.style)val="-ms-";else if("-o-transform"in document.body.style)val=
"-o-";else val="";prefix=function(){return val};return val};module.exports=prefix},{}],40:[function(require,module,exports){module.exports=d3.select("html").attr("dir")==="rtl"},{}],41:[function(require,module,exports){module.exports={"y":function(){return window.pageYOffset!==undefined?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop},"x":function(){return window.pageXOffset!==undefined?window.pageXOffset:(document.documentElement||document.body.parentNode||
document.body).scrollLeft}}},{}],42:[function(require,module,exports){var scrollbar;scrollbar=function(){var inner,outer,val,w1,w2;inner=document.createElement("p");inner.style.width="100%";inner.style.height="200px";outer=document.createElement("div");outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);
w1=inner.offsetWidth;outer.style.overflow="scroll";w2=inner.offsetWidth;if(w1===w2)w2=outer.clientWidth;document.body.removeChild(outer);val=w1-w2;scrollbar=function(){return val};return val};module.exports=scrollbar},{}],43:[function(require,module,exports){module.exports="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch?true:false},{}],44:[function(require,module,exports){module.exports=function(color){var hsl;hsl=d3.hsl(color);if(hsl.l>.45){if(hsl.s>.8)hsl.s=.8;hsl.l=
.45}return hsl.toString()}},{}],45:[function(require,module,exports){module.exports=function(color,increment){var c;if(increment===void 0)increment=.5;c=d3.hsl(color);increment=(1-c.l)*increment;c.l+=increment;c.s-=increment;return c.toString()}},{}],46:[function(require,module,exports){module.exports=function(c1,c2,o1,o2){var b,g,r;if(!o1)o1=1;if(!o2)o2=1;c1=d3.rgb(c1);c2=d3.rgb(c2);r=(o1*c1.r+o2*c2.r-o1*o2*c2.r)/(o1+o2-o1*o2);g=(o1*c1.g+o2*c2.g-o1*o2*c2.g)/(o1+o2-o1*o2);b=(o1*c1.b+o2*c2.b-o1*o2*
c2.b)/(o1+o2-o1*o2);return d3.rgb(r,g,b).toString()}},{}],47:[function(require,module,exports){var defaultScale;defaultScale=require("./scale.coffee");module.exports=function(x,scale){var rand_int;rand_int=x||Math.floor(Math.random()*20);scale=scale||defaultScale;return scale(rand_int)}},{"./scale.coffee":48}],48:[function(require,module,exports){module.exports=d3.scale.ordinal().range(["#b22200","#282F6B","#EACE3F","#B35C1E","#224F20","#5F487C","#759143","#419391","#993F88","#e89c89","#ffee8d","#afd5e8",
"#f7ba77","#a5c697","#c5b5e5","#d1d392","#bbefd0","#e099cf"])},{}],49:[function(require,module,exports){module.exports=function(a,b){var aHSL,bHSL;aHSL=d3.hsl(a);bHSL=d3.hsl(b);a=aHSL.s===0?361:aHSL.h;b=bHSL.s===0?361:bHSL.h;if(a===b)return aHSL.l-bHSL.l;else return a-b}},{}],50:[function(require,module,exports){module.exports=function(color){var b,g,r,rgbColor,yiq;rgbColor=d3.rgb(color);r=rgbColor.r;g=rgbColor.g;b=rgbColor.b;yiq=(r*299+g*587+b*114)/1E3;if(yiq>=128)return"#444444";else return"#f7f7f7"}},
{}],51:[function(require,module,exports){module.exports=function(color){var blackColors,testColor,userBlack;color=color+"";color=color.replace(RegExp(" ","g"),"");if(color.indexOf("rgb")===0)color=color.split("(")[1].split(")")[0].split(",").slice(0,3).join(",");if(color.indexOf("hsl")===0)color=color.split(",")[2].split(")")[0];testColor=d3.rgb(color).toString();blackColors=["black","#000","#000000","0%","0,0,0"];userBlack=blackColors.indexOf(color)>=0;return testColor!=="#000000"||userBlack}},{}],
52:[function(require,module,exports){var ie,print,wiki;ie=require("../../client/ie.js");wiki=require("./wiki.coffee");print=function(type,message,style){style=style||"";if(ie||typeof InstallTrigger!=="undefined")console.log("[ D3plus ] "+message);else if(type.indexOf("group")===0)console[type]("%c[ D3plus ]%c "+message,"font-weight: 800;"+"color: #b35c1e;"+"margin-left: 0px;","font-weight:200;"+style);else console[type]("%c"+message,style+"font-weight:200;")};print.comment=function(message){this("log",
message,"color:#aaa;")};print.error=function(message,url){this("groupCollapsed","ERROR: "+message,"font-weight:800;color:#D74B03;");this.stack();this.wiki(url);this.groupEnd()};print.group=function(message){this("group",message,"color:#888;")};print.groupCollapsed=function(message){this("groupCollapsed",message,"color:#888;")};print.groupEnd=function(){if(!ie)console.groupEnd()};print.log=function(message){this("log",message,"color:#444444;")};print.stack=function(){var err,line,message,page,splitter,
stack,url;if(!ie){err=new Error;if(err.stack){stack=err.stack.split("\n");stack=stack.filter(function(e){return e.indexOf("Error")!==0&&e.indexOf("d3plus.js:")<0&&e.indexOf("d3plus.min.js:")<0});if(stack.length&&stack[0].length){splitter=window.chrome?"at ":"@";url=stack[0];if(url.indexOf(splitter)>=0)url=url.split(splitter)[1];stack=url.split(":");if(stack.length===3)stack.pop();line=stack.pop();page=stack.join(":").split("/");page=page[page.length-1];message="line "+line+" of "+page+": "+url;this("log",
message,"color:#D74B03;")}}}};print.time=function(message){if(!ie)console.time(message)};print.timeEnd=function(message){if(!ie)console.timeEnd(message)};print.warning=function(message,url){this("groupCollapsed",message,"color:#888;");this.stack();this.wiki(url);this.groupEnd()};print.wiki=function(url){if(url){if(url in wiki)url=d3plus.repo+"wiki/"+wiki[url];this("log","documentation: "+url,"color:#aaa;")}};module.exports=print},{"../../client/ie.js":37,"./wiki.coffee":53}],53:[function(require,
module,exports){module.exports={active:"Visualizations#active",aggs:"Visualizations#aggs",alt:"Forms#alt",attrs:"Visualizations#attrs",axes:"Visualizations#axes",background:"Visualizations#background",color:"Visualizations#color",cols:"Visualizations#cols",config:"Visualizations#config",container:"Visualizations#container",coords:"Visualizations#coords",csv:"Visualizations#csv",data:"Visualizations#data",depth:"Visualizations#depth",descs:"Visualizations#descs",dev:"Visualizations#dev",draw:"Visualizations#draw",
edges:"Visualizations#edges",error:"Visualizations#error",focus:"Visualizations#focus",font:"Visualizations#font",footer:"Visualizations#footer",format:"Visualizations#format",height:"Visualizations#height",history:"Visualizations#history",hover:"Forms#hover",icon:"Visualizations#icon",id:"Visualizations#id",keywords:"Forms#keywords",labels:"Visualizations#labels",legend:"Visualizations#legend",links:"Visualizations#links",margin:"Visualizations#margin",messages:"Visualizations#messages",method:"Methods",
mouse:"Visualizations#mouse",nodes:"Visualizations#nodes",open:"Forms#open",order:"Visualizations#order",remove:"Forms#remove",search:"Forms#search",select:"Forms#select",selectAll:"Forms#selectAll",shape:"Visualizations#shape",size:"Visualizations#size",temp:"Visualizations#temp",text:"Visualizations#text",time:"Visualizations#time",timeline:"Visualizations#timeline",timing:"Visualizations#timing",title:"Visualizations#title",tooltip:"Visualizations#tooltip",total:"Visualizations#total",type:"Visualizations#type",
ui:"Visualizations#ui",width:"Visualizations#width",x:"Visualizations#x",y:"Visualizations#y",zoom:"Visualizations#zoom"}},{}],54:[function(require,module,exports){var buckets=require("../../util/buckets.coffee"),fetchValue=require("../fetch/value.coffee"),print=require("../console/print.coffee");module.exports=function(vars){if(vars.dev.value)print.time("getting color data range");var data_range=[];vars.data.pool.forEach(function(d){var val=parseFloat(fetchValue(vars,d,vars.color.value));if(typeof val==
"number"&&!isNaN(val)&&data_range.indexOf(val)<0)data_range.push(val)});if(vars.dev.value)print.timeEnd("getting color data range");if(data_range.length>1){var data_domain=null;if(vars.dev.value)print.time("calculating color scale");data_range=d3.extent(data_range);if(data_range[0]<0&&data_range[1]>0){var color_range=vars.color.range;if(color_range.length==3){data_range.push(data_range[1]);data_range[1]=0}}else if(data_range[1]>0&&data_range[0]>=0){var color_range=vars.color.heatmap;data_range=buckets(data_range,
color_range.length)}else{var color_range=vars.color.range.slice(0);if(data_range[0]<0)color_range.pop();else color_range.shift()}vars.color.valueScale=d3.scale.sqrt().domain(data_range).range(color_range).interpolate(d3.interpolateRgb);if(vars.dev.value)print.timeEnd("calculating color scale")}else vars.color.valueScale=null}},{"../../util/buckets.coffee":203,"../console/print.coffee":52,"../fetch/value.coffee":67}],55:[function(require,module,exports){var fetchValue=require("../fetch/value.coffee"),
print=require("../console/print.coffee"),validObject=require("../../object/validate.coffee");module.exports=function(vars,data){if(vars.dev.value)print.time("filtering data");var availableKeys=d3.keys(vars.data.keys||{});if("attrs"in vars)availableKeys=availableKeys.concat(d3.keys(vars.attrs.keys||{}));data=data.filter(function(d){var val=fetchValue(vars,d,vars.id.value);return val!==null});var typeReqs=vars.types[vars.type.value].requirements||[];vars.data.filters.forEach(function(key){if(availableKeys.indexOf(vars[key].value)>=
0&&typeReqs.indexOf(key)>=0)data=data.filter(function(d){var val=fetchValue(vars,d,vars[key].value);if(key==="y"&&vars.y2.value&&val===null)val=fetchValue(vars,d,vars.y2.value);else if(key==="x"&&vars.x2.value&&val===null)val=fetchValue(vars,d,vars.x2.value);if(key==="size")return typeof val==="number";else return val!==null})});var key=vars.data.solo.length?"solo":"mute";if(vars.data[key].length)vars.data[key].forEach(function(v){function test_value(val){var arr=vars[v][key].value;var match=false;
arr.forEach(function(f){if(typeof f==="function")match=f(val);else if(f===val)match=true});return key==="solo"?match:!match}function filter_data(d,flat){if(!flat&&vars[v].nesting){var nesting=vars[v].nesting;if(validObject(nesting))nesting=d3.values(nesting);for(var n=0;n<nesting.length;n++){var new_data=d.filter(function(dd){return test_value(fetchValue(vars,dd,nesting[n]))});if(new_data.length)d=new_data}}else d=d.filter(function(dd){return test_value(fetchValue(vars,dd,vars[v].value))});return d}
data=filter_data(data);if(v==="id"){if("nodes"in vars&&vars.nodes.value){if(vars.dev.value)print.time("filtering nodes");vars.nodes.restricted=filter_data(vars.nodes.value);if(vars.dev.value)print.timeEnd("filtering nodes")}if("edges"in vars&&vars.edges.value){if(vars.dev.value)print.time("filtering edges");vars.edges.restricted=vars.edges.value.filter(function(d){var points=filter_data([d[vars.edges.source],d[vars.edges.target]]);return points.length===2});if(vars.dev.value)print.timeEnd("filtering edges")}}});
else if("nodes"in vars){vars.nodes.restricted=undefined;vars.edges.restricted=undefined}if(vars.dev.value)print.timeEnd("filtering data");return data}},{"../../object/validate.coffee":171,"../console/print.coffee":52,"../fetch/value.coffee":67}],56:[function(require,module,exports){var dataNest=require("./nest.js"),fetchValue=require("../fetch/value.coffee"),print=require("../console/print.coffee"),uniques=require("../../util/uniques.coffee");module.exports=function(vars){var timerString;vars.data.time=
{"values":[]};if(vars.time&&vars.time.value){if(vars.dev.value){timerString="analyzing time periods";print.time(timerString)}vars.data.time.values=uniques(vars.data.value,vars.time.value,fetchValue,vars);vars.data.time.values.sort(function(a,b){return a-b});var step=[];vars.data.time.values.forEach(function(y,i){if(i!==0){var prev=vars.data.time.values[i-1];step.push(y-prev);if(i===vars.data.time.values.length-1)vars.data.time.total=y-vars.data.time.values[0]}});step=d3.min(step);vars.data.time.step=
step;var periods=["Milliseconds","Seconds","Minutes","Hours","Date","Month","FullYear"],conversions=[1E3,60,60,24,30,12,1];vars.data.time.periods=periods;var getDiff=function(start,end,i){if(!vars.data.time.stepDivider){arr=conversions.slice(0,i);if(arr.length)vars.data.time.stepDivider=arr.reduce(function(a,b){return a*b});else vars.data.time.stepDivider=1}return Math.round(Math.floor(end-start)/vars.data.time.stepDivider)};var total=vars.data.time.total;periods.forEach(function(p,i){var c=p==="Date"?
28:conversions[i];if(!vars.data.time.stepType&&(i===periods.length-1||Math.round(step)<c)){vars.data.time.stepType=p;var start=vars.data.time.values[0],end=vars.data.time.values[vars.data.time.values.length-1];vars.data.time.stepIntervals=getDiff(start,end,i)}if(!vars.data.time.totalType&&(i===periods.length-1||Math.round(total)<c))vars.data.time.totalType=p;step=step/c;total=total/c});vars.data.time.values.forEach(function(y,i){if(i!==0){var prev=vars.data.time.values[0];vars.data.time.dataSteps.push(getDiff(prev,
y,periods.indexOf(vars.data.time.stepType)))}else vars.data.time.dataSteps=[0]});var userFormat=vars.time.format.value,locale=vars.format.locale.value,functions=[function(d){return d.getMilliseconds()},function(d){return d.getSeconds()},function(d){return d.getMinutes()},function(d){return d.getHours()},function(d){return d.getDate()!=1},function(d){return d.getMonth()},function(d){return true}];vars.data.time.functions=functions;var getFormat=function(s,t,small){if(s===t)return small&&locale.timeFormat[s+
"Small"]?locale.timeFormat[s+"Small"]:locale.timeFormat[s];else if(periods.indexOf(s)>=4||periods.indexOf(t)<=3)return locale.timeFormat[t+"-"+s];else{var format;if(t==="Date")format=locale.timeFormat[t];else format=locale.timeFormat[t+"-Date"];if(s==="Hours")return format+" "+locale.timeFormat[s];else return format+" "+locale.timeFormat["Hours-"+s]}};vars.data.time.getFormat=getFormat;if(userFormat){if(typeof userFormat==="string")vars.data.time.format=d3.locale(locale.format).timeFormat(userFormat);
else if(typeof userFormat==="function")vars.data.time.format=userFormat;else if(userFormat instanceof Array)vars.data.time.format=d3.locale(locale.format).timeFormat.multi(userFormat);vars.data.time.multiFormat=vars.data.time.format}else{var stepType=vars.data.time.stepType,totalType=vars.data.time.totalType;var multi=[];for(var p=periods.indexOf(stepType);p<=periods.indexOf(totalType);p++){var prev=p-1<periods.indexOf(stepType)?periods[p]:periods[p-1];var small=periods[p]===prev&&stepType!==totalType;
var format=getFormat(prev,periods[p],small);multi.push([format,functions[p]])}vars.data.time.format=d3.locale(locale.format).timeFormat(getFormat(stepType,totalType));if(multi.length>1){multi[multi.length-1][1]=function(d){return true};vars.data.time.multiFormat=d3.locale(locale.format).timeFormat.multi(multi)}else vars.data.time.multiFormat=vars.data.time.format}vars.data.time.ticks=[];var min=d3.min(vars.data.time.values);var max=d3.max(vars.data.time.values);for(var s=0;s<=vars.data.time.stepIntervals;s++){var m=
new Date(min);m["set"+vars.data.time.stepType](m["get"+vars.data.time.stepType]()+s);if(m<=max)vars.data.time.ticks.push(m)}if(vars.dev.value)print.timeEnd(timerString)}if(vars.dev.value){timerString="nesting data by time and depths";print.time(timerString)}vars.data.nested={};if(vars.data.time.values.length===0){vars.data.nested.all={};vars.id.nesting.forEach(function(depth,i){var nestingDepth=vars.id.nesting.slice(0,i+1);vars.data.nested.all[depth]=dataNest(vars,vars.data.value,nestingDepth)})}else{var timeData=
vars.data.value.reduce(function(o,d){var ms=fetchValue(vars,d,vars.time.value).getTime();if(!(ms in o))o[ms]=[];o[ms].push(d);return o},{});vars.data.time.values.forEach(function(t){var ms=t.getTime();vars.data.nested[ms]={};vars.id.nesting.forEach(function(depth,i){var nestingDepth=vars.id.nesting.slice(0,i+1);vars.data.nested[ms][depth]=dataNest(vars,timeData[ms],nestingDepth)})})}if(vars.dev.value)print.timeEnd(timerString)}},{"../../util/uniques.coffee":209,"../console/print.coffee":52,"../fetch/value.coffee":67,
"./nest.js":60}],57:[function(require,module,exports){var fetchValue;fetchValue=require("../fetch/value.coffee");module.exports=function(vars,data,nesting){var d,groupedData,i,j,k,len,len1,n,strippedData,val;groupedData=d3.nest();if(vars.id.grouping.value){if(nesting===void 0)nesting=vars.id.nesting;for(i=j=0,len=nesting.length;j<len;i=++j){n=nesting[i];if(i<vars.depth.value)(function(n){return groupedData.key(function(d){return fetchValue(vars,d.d3plus,n)})})(n)}}strippedData=[];for(k=0,len1=data.length;k<
len1;k++){d=data[k];val=vars.size.value?fetchValue(vars,d,vars.size.value):1;if(val&&typeof val==="number"&&val>0){delete d.d3plus.r;delete d.d3plus.x;delete d.d3plus.y;strippedData.push({d3plus:d,id:d[vars.id.value],value:val})}}return groupedData.entries(strippedData)}},{"../fetch/value.coffee":67}],58:[function(require,module,exports){var print,validObject,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};print=require("../console/print.coffee");
validObject=require("../../object/validate.coffee");module.exports=function(vars,type){var get_keys,k,kk,lengthMatch,ref,ref1,timerString,v,vv;timerString=type+" key analysis";if(vars.dev.value)print.time(timerString);vars[type].keys={};get_keys=function(arr){var a,i,k,len,results,results1,v;if(arr instanceof Array){results=[];for(i=0,len=arr.length;i<len;i++){a=arr[i];results.push(get_keys(a))}return results}else if(validObject(arr)){results1=[];for(k in arr){v=arr[k];if(k.indexOf("d3plus")!==0&&
!(indexOf.call(vars[type].keys,k)>=0)&&v!==null)results1.push(vars[type].keys[k]=typeof v);else results1.push(void 0)}return results1}};if(validObject(vars[type].value)){lengthMatch=d3.keys(vars[type].value).length===vars.id.nesting.length;ref=vars[type].value;for(k in ref){v=ref[k];if(lengthMatch&&vars.id.nesting.indexOf(k)>=0&&validObject(v))for(kk in v){vv=v[kk];get_keys(vv)}else get_keys(v)}}else{ref1=vars[type].value;for(k in ref1){v=ref1[k];get_keys(v)}}if(vars.dev.value)return print.time(timerString)}},
{"../../object/validate.coffee":171,"../console/print.coffee":52}],59:[function(require,module,exports){var print,validObject;print=require("../console/print.coffee");validObject=require("../../object/validate.coffee");module.exports=function(vars,key,next){var consoleMessage,fileType,parser,url;consoleMessage=vars.dev.value;if(consoleMessage)print.time("loading "+key);url=vars[key].url;if(!vars[key].filetype.value){fileType=url.slice(url.length-5).split(".");if(fileType.length>1)fileType=fileType[1];
else fileType=false;if(fileType){if(fileType==="txt")fileType="text";if(vars[key].filetype.accepted.indexOf(fileType)<0)fileType="json"}else fileType="json"}else fileType=vars[key].filetype.value;if(fileType==="dsv")parser=d3.dsv(vars[key].delimiter.value,"text/plain");else parser=d3[fileType];return parser(url,function(error,data){var k,ret;if(!error&&data){if(typeof vars[key].callback==="function"){ret=vars[key].callback(data);if(ret)if(validObject(ret)&&key in ret)for(k in ret){if(k in vars)vars[k].value=
ret[k]}else vars[key].value=ret}else vars[key].value=data;if(["json"].indexOf(fileType)<0)vars[key].value.forEach(function(d){var results;results=[];for(k in d)if(!isNaN(d[k]))results.push(d[k]=parseFloat(d[k]));else if(d[k].toLowerCase()==="false")results.push(d[k]=false);else if(d[k].toLowerCase()==="true")results.push(d[k]=true);else if(d[k].toLowerCase()==="null")results.push(d[k]=null);else if(d[k].toLowerCase()==="undefined")results.push(d[k]=void 0);else results.push(void 0);return results});
vars[key].changed=true;vars[key].loaded=true}else vars.error.internal='Could not load data from: "'+url+'"';if(consoleMessage)print.timeEnd("loading "+key);return next()})}},{"../../object/validate.coffee":171,"../console/print.coffee":52}],60:[function(require,module,exports){var fetchValue=require("../fetch/value.coffee"),validObject=require("../../object/validate.coffee"),uniqueValues=require("../../util/uniques.coffee");var dataNest=function(vars,flatData,nestingLevels,discrete){if(discrete===
undefined)discrete=true;var nestedData=d3.nest(),groupedData=[],segments="temp"in vars?["active","temp","total"]:[];if(!nestingLevels.length)nestedData.key(function(d){return true});else nestingLevels.forEach(function(level,i){nestedData.key(function(d){return fetchValue(vars,d,level)})});if(discrete&&vars.axes&&vars.axes.discrete&&(!vars.time||vars[vars.axes.discrete].value!==vars.time.value))nestedData.key(function(d){return fetchValue(vars,d,vars[vars.axes.discrete].value)});var deepest_is_id=
nestingLevels.length&&vars.id.nesting.indexOf(nestingLevels[nestingLevels.length-1])>=0;var i=nestingLevels.length&&deepest_is_id?nestingLevels.length-1:0;var depthKey=deepest_is_id?vars.id.nesting[i]:vars.depth.value;nestedData.rollup(function(leaves){if(leaves.length===1&&"d3plus"in leaves[0]){groupedData.push(leaves[0]);return leaves[0]}leaves=leaves.reduce(function(arr,ll){if(ll.values instanceof Array)return arr.concat(ll.values);arr.push(ll);return arr},[]);var returnObj={"d3plus":{"data":{},
"depth":i}};var merged=d3.sum(leaves,function(ll){return"d3plus"in ll&&ll.d3plus.merged?1:0});if(merged===leaves.length)for(var ll=0;ll<leaves.length;ll++){var l=leaves[ll];if(!returnObj.d3plus.merged)returnObj.d3plus.merged=[];returnObj.d3plus.merged=returnObj.d3plus.merged.concat(l.d3plus.merged);if(l.d3plus.text)returnObj.d3plus.text=l.d3plus.text}for(var s=0;s<segments.length;s++){var c=segments[s];var segmentAgg=vars.aggs&&vars.aggs.value[key]?vars.aggs.value[key]:"sum";if("d3plus"in leaves[0]&&
c in leaves[0].d3plus)returnObj.d3plus[c]=d3.sum(leaves,function(d){return d.d3plus[c]});else if(typeof segmentAgg==="function")returnObj.d3plus[c]=segmentAgg(leaves);else returnObj.d3plus[c]=d3[segmentAgg](leaves,function(d){var a=c==="total"?1:0;if(vars[c].value){a=fetchValue(vars,d,vars[c].value);if(typeof a!=="number")a=a?1:0}return a})}for(var key in vars.data.keys){if(key in returnObj.d3plus.data)returnObj[key]=returnObj.d3plus[key];else{var agg=vars.aggs&&vars.aggs.value[key]?vars.aggs.value[key]:
"sum",aggType=typeof agg,keyType=vars.data.keys[key],idKey=vars.id.nesting.indexOf(key)>=0,timeKey="time"in vars&&key===vars.time.value;if(key in returnObj.d3plus.data)returnObj[key]=returnObj.d3plus[key];else if(aggType==="function")returnObj[key]=vars.aggs.value[key](leaves);else if(timeKey)returnObj[key]=parseDates(uniqueValues(leaves,key));else if(vars.axes&&vars.axes.discrete&&vars[vars.axes.discrete].value===key)returnObj[key]=uniqueValues(leaves,key);else if(keyType==="number"&&aggType==="string"&&
!idKey){var vals=leaves.map(function(d){return d[key]});vals=vals.filter(function(d){return typeof d===keyType});if(vals.length)returnObj[key]=d3[agg](vals)}else{var testVals=checkVal(leaves,key);var keyValues=testVals.length===1?testVals[0][key]:uniqueValues(testVals,key);if(testVals.length===1)returnObj[key]=keyValues;else if(keyValues&&keyValues.length){if(!(keyValues instanceof Array))keyValues=[keyValues];if(idKey&&vars.id.nesting.indexOf(key)>i)returnObj[key]=testVals;else returnObj[key]=keyValues}else if(idKey){var endPoint=
vars.id.nesting.indexOf(key)-1;if(endPoint>=i&&(!("endPoint"in returnObj.d3plus)||returnObj.d3plus.endPoint>i))returnObj.d3plus.endPoint=i}}}if(key in returnObj&&returnObj[key]instanceof Array&&returnObj[key].length===1)returnObj[key]=returnObj[key][0]}for(var lll=0;lll<nestingLevels.length;lll++){var level=nestingLevels[lll];if(!(level in returnObj))returnObj[level]=fetchValue(vars,leaves[0],level)}groupedData.push(returnObj);return returnObj});var find_keys=function(obj,depth,keys){if(obj.children){if(vars.data.keys[nestingLevels[depth]]==
"number")obj.key=parseFloat(obj.key);keys[nestingLevels[depth]]=obj.key;delete obj.key;for(var k in keys)obj[k]=keys[k];depth++;obj.children.forEach(function(c){find_keys(c,depth,keys)})}};nestedData=nestedData.entries(flatData).map(rename_key_value).map(function(obj){find_keys(obj,0,{});return obj});return groupedData};var checkVal=function(leaves,key){var returnVals=[];function run(obj){if(obj instanceof Array)obj.forEach(run);else if(validObject(obj)&&key in obj)if(obj[key]instanceof Array)obj[key].forEach(run);
else returnVals.push(obj)}run(leaves);return returnVals};var parseDates=function(dateArray){var dates=[];function checkDate(arr){for(var i=0;i<arr.length;i++){var d=arr[i];if(d)if(d.constructor===Array)checkDate(d);else dates.push(d)}}checkDate(dateArray);return uniqueValues(dates)};var rename_key_value=function(obj){if(obj.values&&obj.values.length){obj.children=obj.values.map(function(obj){return rename_key_value(obj)});delete obj.values;return obj}else if(obj.values)return obj.values;else return obj};
module.exports=dataNest},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"../fetch/value.coffee":67}],61:[function(require,module,exports){var arraySort=require("../../array/sort.coffee"),dataNest=require("./nest.js"),fetchValue=require("../fetch/value.coffee"),fetchColor=require("../fetch/color.coffee"),fetchText=require("../fetch/text.js");module.exports=function(vars,rawData,split){var threshold;if(vars.size.threshold.value===false)threshold=0;else if(typeof vars.size.threshold.value===
"number")threshold=vars.size.threshold.value;else if(typeof vars.size.threshold.value==="function")threshold=vars.size.threshold.value(vars);else if(typeof vars.types[vars.type.value].threshold==="number")threshold=vars.types[vars.type.value].threshold;else if(typeof vars.types[vars.type.value].threshold==="function")threshold=vars.types[vars.type.value].threshold(vars);else threshold=.02;if(typeof threshold=="number"&&threshold>0){var largeEnough=[],cutoff=vars.depth.value===0?0:{},removed=[],parents=
[],labelException=[],largest={};var nest=d3.nest();if(split)nest.key(function(d){return fetchValue(vars,d,split)});nest.rollup(function(leaves){var total=leaves.length;if(vars.aggs.value[vars.size.value])if(typeof vars.aggs.value[vars.size.value]=="function")total=vars.aggs.value[vars.size.value](leaves);else{if(typeof vars.aggs.value[vars.size.value]=="string")total=d3[vars.aggs.value[vars.size.value]](leaves,function(l){return fetchValue(vars,l,vars.size.value)})}else total=d3.sum(leaves,function(l){return fetchValue(vars,
l,vars.size.value)});var x=split?fetchValue(vars,leaves[0],split):"all";largest[x]=total;return total}).entries(rawData);rawData.forEach(function(d){var id=fetchValue(vars,d,vars.id.value),val=fetchValue(vars,d,vars.size.value),x=split?fetchValue(vars,d,split):"all",allowed=val/largest[x]>=threshold;if(allowed&&largeEnough.indexOf(id)<0){largeEnough.push(id);if(vars.depth.value){var p=fetchValue(vars,d,vars.id.nesting[vars.depth.value-1]);if(parents.indexOf(p)<0)parents.push(p)}}});var filteredData=
rawData.filter(function(d){var id=fetchValue(vars,d,vars.id.value),allowed=largeEnough.indexOf(id)>=0;var p=vars.depth.value?fetchValue(vars,d,vars.id.nesting[vars.depth.value-1]):null;if(p!==null&&parents.indexOf(p)<0&&labelException.indexOf(p)<0)labelException.push(p);if(!allowed){var val=fetchValue(vars,d,vars.size.value);if(val>0){if(vars.depth.value===0){if(val>cutoff)cutoff=val}else{if(!(p in cutoff))cutoff[p]=0;if(val>cutoff[p])cutoff[p]=val}removed.push(d)}}return allowed});if(removed.length>
1){removed=arraySort(removed,vars.size.value,"desc",[],vars);var levels=vars.id.nesting.slice(0,vars.depth.value);if(vars.types[vars.type.value].requirements.indexOf(vars.axes.discrete)>=0)levels.push(vars[vars.axes.discrete].value);var merged=dataNest(vars,removed,levels);merged.forEach(function(m){var parent=vars.id.nesting[vars.depth.value-1];var p_id=fetchValue(vars,m,parent);children=parent?removed.filter(function(r){return fetchValue(vars,r,parent)===p_id}):removed;if(children.length>1){vars.id.nesting.forEach(function(d,
i){if(vars.depth.value==i){var prev=m[d];if(typeof prev==="string")m[d]="d3plus_other_"+prev;else m[d]="d3plus_other"}else if(i>vars.depth.value)delete m[d]});if(vars.color.value&&vars.color.type==="string")if(vars.depth.value===0)m[vars.color.value]=vars.color.missing;else m[vars.color.value]=fetchValue(vars,p_id,vars.color.value,parent);if(vars.icon.value)m[vars.icon.value]=fetchValue(vars,p_id,vars.icon.value,parent);if(p_id)m.d3plus.depth=vars.depth.value;var textLabel;if(vars.depth.value===0){textLabel=
vars.format.value(vars.format.locale.value.ui.values,{"key":"threshold","vars":vars});textLabel+=" < "+vars.format.value(cutoff,{"key":vars.size.value,"vars":vars})}else{textLabel=fetchText(vars,m,vars.depth.value-1);textLabel=textLabel.length?textLabel[0].split(" < ")[0]:vars.format.value(vars.format.locale.value.ui.values,{"key":"threshold","vars":vars});if(p_id,labelException.indexOf(p_id)<0)textLabel+=" < "+vars.format.value(cutoff[p_id],{"key":vars.size.value,"vars":vars})}if(p_id,labelException.indexOf(p_id)<
0)textLabel+=" ("+vars.format.value(threshold*100,{"key":"share","vars":vars})+")";m.d3plus.threshold=cutoff;m.d3plus.merged=children;if(vars.text.value)m[vars.text.value]=textLabel;m.d3plus.text=textLabel}})}else merged=removed;return filteredData.concat(merged)}return rawData}},{"../../array/sort.coffee":34,"../fetch/color.coffee":63,"../fetch/text.js":66,"../fetch/value.coffee":67,"./nest.js":60}],62:[function(require,module,exports){var sizes;sizes=require("../../font/sizes.coffee");module.exports=
function(vars,opts){var f,format,func,getFormat,limit,locale,p,periods,pp,prev,render,small,step,style,time,total,vals,values;values=opts.values||vars.data.time.ticks;style=opts.style||{};limit=opts.limit||vars.width.value;time={};periods=vars.data.time.periods;step=vars.data.time.stepType;total=vars.data.time.totalType;func=vars.data.time.functions;getFormat=vars.data.time.getFormat;locale=vars.format.locale.value.format;if(vars.time.format.value){time.format=vars.data.time.format;time.values=values;
time.sizes=sizes(values.map(function(v){return time.format(v)}),style)}else{p=periods.indexOf(step);while(p<=periods.indexOf(total)){vals=values.filter(function(t){var match,pp;if(p===periods.indexOf(step))return true;match=true;pp=p-1;if(p<0)return true;while(pp>=periods.indexOf(step)){if(!match)break;match=!func[pp](t);pp--}return match});if(periods[p]===total)format=d3.locale(locale).timeFormat(getFormat(periods[p],total));else{pp=p;format=[];while(pp<=periods.indexOf(total)){prev=pp-1<periods.indexOf(step)?
pp:pp-1;prev=periods[prev];small=periods[pp]===prev&&step!==total;f=getFormat(prev,periods[pp],small);format.push([f,func[pp]]);pp++}format[format.length-1][1]=function(){return true};format=d3.locale(locale).timeFormat.multi(format)}render=sizes(vals.map(function(v){return format(v)}),style);if(d3.sum(render,function(r){return r.width})<limit||p===periods.indexOf(total)){time.format=format;time.values=vals;time.sizes=render;break}p++}}return time}},{"../../font/sizes.coffee":101}],63:[function(require,
module,exports){var fetchValue,getColor,getRandom,randomColor,uniques,validColor,validObject;fetchValue=require("./value.coffee");randomColor=require("../../color/random.coffee");validColor=require("../../color/validate.coffee");validObject=require("../../object/validate.coffee");uniques=require("../../util/uniques.coffee");module.exports=function(vars,id,level){var color,colorLevel,colors,i,obj,value;obj=validObject(id);if(obj&&"d3plus"in id&&"color"in id.d3plus)return id.d3plus.color;if(level===
void 0)level=vars.id.value;if(typeof level==="number")level=vars.id.nesting[level];if(!vars.color.value)return getRandom(vars,id,level);else{colors=[];i=vars.id.nesting.indexOf(level);while(i>=0){colorLevel=vars.id.nesting[i];value=uniques(id,vars.color.value,fetchValue,vars,colorLevel);if(value.length===1)value=value[0];if(!(value instanceof Array)&&value!==void 0&&value!==null){color=getColor(vars,id,value,level);if(colors.indexOf(color)<0)colors.push(color);break}i--}if(colors.length===1)return colors[0];
else return vars.color.missing}};getColor=function(vars,id,color,level){if(!color){if(vars.color.value&&typeof vars.color.valueScale==="function")return vars.color.valueScale(0);return getRandom(vars,id,level)}else if(!vars.color.valueScale)if(validColor(color))return color;else return getRandom(vars,color,level);else return vars.color.valueScale(color)};getRandom=function(vars,c,level){if(validObject(c))c=fetchValue(vars,c,level);if(c instanceof Array)c=c[0];return randomColor(c,vars.color.scale.value)}},
{"../../color/random.coffee":47,"../../color/validate.coffee":51,"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"./value.coffee":67}],64:[function(require,module,exports){var dataFilter=require("../data/filter.js"),dataNest=require("../data/nest.js"),print=require("../console/print.coffee"),stringFormat=require("../../string/format.js"),stringList=require("../../string/list.coffee");module.exports=function(vars,years,depth){if(!vars.data.value)return[];if(depth===undefined)depth=
vars.depth.value;var nestLevel=vars.id.nesting[depth];if(years&&!(years instanceof Array))years=[years];if(!years&&"time"in vars){years=[];var key=vars.time.solo.value.length?"solo":"mute",filterList=vars.time[key].value;if(filterList.length){years=[];for(var yi=0;yi<filterList.length;yi++){var y=filterList[yi];if(typeof y==="function")for(var ti=0;ti<vars.data.time.values.length;ti++){var ms=vars.data.time.values[ti].getTime();if(y(ms))years.push(ms)}else if(y.constructor===Date)years.push((new Date(y)).getTime());
else{y+="";if(y.length===4&&parseInt(y)+""===y)y=y+"/01/01";var d=new Date(y);if(d!=="Invalid Date")years.push(d.getTime())}}if(key==="mute")years=vars.data.time.values.filter(function(t){return years.indexOf(t.getTime())<0})}else years.push("all")}else years=["all"];if(years.indexOf("all")>=0&&vars.data.time.values.length){years=vars.data.time.values.slice(0);for(var i=0;i<years.length;i++)years[i]=years[i].getTime()}var cacheID=[vars.type.value,nestLevel,depth].concat(vars.data.filters).concat(years),
filter=vars.data.solo.length?"solo":"mute",cacheKeys=d3.keys(vars.data.cache),vizFilter=vars.types[vars.type.value].filter||undefined;if(vars.data[filter].length)for(var di=0;di<vars.data[filter].length;di++){var f=vars.data[filter][di];var vals=vars[f][filter].value.slice(0);vals.unshift(f);vals.unshift(filter);cacheID=cacheID.concat(vals)}if(vars.axes&&vars.axes.discrete)cacheID.push(vars.axes.discrete);cacheID=cacheID.join("_");vars.data.cacheID=cacheID;var match=false;for(var c=0;c<cacheKeys.length;c++){var matchKey=
cacheKeys[c].split("_").slice(1).join("_");if(matchKey===cacheID){cacheID=(new Date).getTime()+"_"+cacheID;vars.data.cache[cacheID]=vars.data.cache[cacheKeys[c]];delete vars.data.cache[cacheKeys[c]];break}}var returnData;if(vars.data.cache[cacheID]){if(vars.dev.value)print.comment("data already cached");returnData=vars.data.cache[cacheID].data;if("nodes"in vars){vars.nodes.restricted=vars.data.cache[cacheID].nodes;vars.edges.restricted=vars.data.cache[cacheID].edges}if(typeof vizFilter==="function")returnData=
vizFilter(vars,returnData);return returnData}else{var missing=[];returnData=[];if(vars.data.value&&vars.data.value.length)for(var yz=0;yz<years.length;yz++){var year=years[yz];if(vars.data.nested[year])returnData=returnData.concat(vars.data.nested[year][nestLevel]);else missing.push(year)}if(returnData.length===0&&missing.length&&!vars.error.internal){if(missing.length>1)missing=d3.extent(missing);missing=missing.map(function(m){return vars.data.time.format(new Date(m))});missing=missing.join(" - ");
var str=vars.format.locale.value.error.dataYear,and=vars.format.locale.value.ui.and;missing=stringList(missing,and);vars.error.internal=stringFormat(str,missing);vars.time.missing=true}else{if(vars.time)vars.time.missing=false;if(years.length>1){var separated=false;["x","y","x2","y2"].forEach(function(a){if(vars[a].value===vars.time.value&&vars[a].scale.value==="discrete")separated=true});if(!separated){var nested=vars.id.nesting.slice(0,depth+1);returnData=dataNest(vars,returnData,nested)}}if(!returnData)returnData=
[];else returnData=dataFilter(vars,returnData);if(cacheKeys.length===20){cacheKeys.sort();delete vars.data.cache[cacheKeys[0]]}cacheID=(new Date).getTime()+"_"+cacheID;vars.data.cache[cacheID]={"data":returnData};if("nodes"in vars){vars.data.cache[cacheID].nodes=vars.nodes.restricted;vars.data.cache[cacheID].edges=vars.edges.restricted}if(typeof vizFilter==="function")returnData=vizFilter(vars,returnData);if(vars.dev.value)print.comment("storing data in cache")}return returnData}}},{"../../string/format.js":172,
"../../string/list.coffee":173,"../console/print.coffee":52,"../data/filter.js":55,"../data/nest.js":60}],65:[function(require,module,exports){var fetchColor,fetchText,fetchValue;fetchValue=require("./value.coffee");fetchColor=require("./color.coffee");fetchText=require("./text.js");module.exports=function(vars,d,keys,colors,depth){var agg,i,key,len,obj,value;if(!(keys instanceof Array))keys=[keys];if(!(colors instanceof Array))colors=[colors];if(vars)if(depth===void 0)depth=vars.id.value;else if(typeof depth!==
"number")depth=vars.id.nesting.indexOf(depth);obj={};for(i=0,len=keys.length;i<len;i++){key=keys[i];if(vars)if(colors.indexOf(key)>=0)value=fetchColor(vars,d,depth);else if(key===vars.text.value)value=fetchText(vars,d,depth);else if(d3.keys(d).length===3&&d["d3plus"]&&d["key"]&&d["values"])value=fetchValue(vars,d.values.map(function(dd){return dd.d3plus}),key,depth);else value=fetchValue(vars,d,key,depth);else value=d[key];if([vars.data.keys[key],vars.attrs.keys[key]].indexOf("number")>=0){agg=vars.order.agg.value||
vars.aggs.value[key]||"sum";if(!(value instanceof Array))value=[value];value=d3[agg](value)}else{if(value instanceof Array)value=value[0];value=typeof value==="string"?value.toLowerCase():value}obj[key]=value}return obj}},{"./color.coffee":63,"./text.js":66,"./value.coffee":67}],66:[function(require,module,exports){var fetchValue=require("./value.coffee"),validObject=require("../../object/validate.coffee"),uniques=require("../../util/uniques.coffee");module.exports=function(vars,obj,depth){if(typeof depth!==
"number")depth=vars.depth.value;var key=vars.id.nesting[depth],textKeys;if(vars.text.nesting&&validObject(vars.text.nesting))if(vars.text.nesting[key])textKeys=vars.text.nesting[key];else textKeys=vars.text.value;else{textKeys=[];if(vars.text.value&&depth===vars.depth.value)textKeys.push(vars.text.value);textKeys.push(key)}if(!(textKeys instanceof Array))textKeys=[textKeys];var names=[];if(validObject(obj)&&"d3plus"in obj&&obj.d3plus.text){names.push(obj.d3plus.text.toString());names.push(vars.format.value(obj.d3plus.text.toString(),
{"vars":vars,"data":obj}))}else{var formatObj=validObject(obj)?obj:undefined;if(formatObj&&obj[vars.id.value]instanceof Array)obj=obj[vars.id.value];else if(!(obj instanceof Array))obj=[obj];textKeys.forEach(function(t){var name=uniques(obj,t,fetchValue,vars,key);if(name.length){if(name.length>1)name=name.filter(function(n){return n instanceof Array||typeof n==="string"&&n.indexOf(" < ")<0});name=name.map(function(n){if(n instanceof Array){n=n.filter(function(nn){return nn});return n.map(function(nn){return vars.format.value(nn.toString(),
{"vars":vars,"data":formatObj,"key":t})})}else if(n)return vars.format.value(n.toString(),{"vars":vars,"data":formatObj,"key":t})});if(name.length===1)name=name[0];names.push(name)}})}return names}},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209,"./value.coffee":67}],67:[function(require,module,exports){var cacheInit,checkAttrs,checkData,fetch,fetchArray,filterArray,find,uniqueValues,validObject,valueParse;validObject=require("../../object/validate.coffee");uniqueValues=require("../../util/uniques.coffee");
find=function(vars,node,variable,depth){var cache,nodeObject,returned,val;nodeObject=validObject(node);if(typeof variable==="function"&&nodeObject)return variable(node,vars);if(nodeObject){if(variable in node)return node[variable];cache=vars.data.cacheID+"_"+depth;cacheInit(node,cache,vars);if(variable in node.d3plus.data[cache])return node.d3plus.data[cache][variable];if(depth in node)node=node[depth];else if(vars.id.value in node){node=node[vars.id.value];if(depth!==variable)returned=checkData(vars,
node,depth,vars.id.value);if(returned===null||returned===void 0)returned=checkAttrs(vars,node,depth,vars.id.value);if(returned===null||returned===void 0)return null;else if(depth===variable)return returned;node=returned}else return null}if(node instanceof Array&&!validObject(node[0]))node=uniqueValues(node);if(node instanceof Array&&validObject(node[0])){val=uniqueValues(node,variable);if(val.length)return val}val=checkData(vars,node,variable,depth);if(val)return val;val=checkAttrs(vars,node,variable,
depth);return val};checkData=function(vars,node,variable,depth){var val;if(vars.data.viz instanceof Array&&variable in vars.data.keys)val=uniqueValues(filterArray(vars.data.viz,node,depth),variable);if(val&&val.length)return val;else return null};checkAttrs=function(vars,node,variable,depth){var attrList,n,val,vals;if("attrs"in vars&&vars.attrs.value&&variable in vars.attrs.keys){if(validObject(vars.attrs.value)&&depth in vars.attrs.value)attrList=vars.attrs.value[depth];else attrList=vars.attrs.value;
if(attrList instanceof Array){val=uniqueValues(filterArray(attrList,node,depth),variable);if(val.length)return val}else if(node instanceof Array){attrList=[function(){var j,len,results;if(n in attrList){results=[];for(j=0,len=node.length;j<len;j++){n=node[j];results.push(attrList[n])}return results}}()];if(attrList.length){vals=uniqueValues(attrList,variable);if(vals.length)return vals}}else if(node in attrList)return attrList[node][variable]}return null};filterArray=function(arr,node,depth){if(node instanceof
Array)return arr.filter(function(d){return node.indexOf(d[depth])>=0});else return arr.filter(function(d){return d[depth]===node})};cacheInit=function(node,cache,vars){if(!("d3plus"in node))node.d3plus={};if(!("data"in node.d3plus))node.d3plus.data={};if(vars.data.changed||vars.attrs&&vars.attrs.changed||!(cache in node.d3plus.data))node.d3plus.data[cache]={};return node};valueParse=function(vars,node,depth,variable,val){var cache,d,i,j,len,timeVar,v;if(val===null)return val;timeVar="time"in vars&&
vars.time.value===variable;if(!(val instanceof Array))val=[val];for(i=j=0,len=val.length;j<len;i=++j){v=val[i];if(timeVar&&v!==null&&v.constructor!==Date){v=v+"";if(v.length===4&&parseInt(v)+""===v)v+="/01/01";d=new Date(v);if(d!=="Invalid Date")val[i]=d}}if(val.length===1)val=val[0];if(val!==null&&validObject(node)&&typeof variable==="string"&&!(variable in node)){cache=vars.data.cacheID+"_"+depth;node.d3plus.data[cache][variable]=val}return val};fetchArray=function(vars,arr,variable,depth){var item,
j,len,v,val;val=[];for(j=0,len=arr.length;j<len;j++){item=arr[j];if(validObject(item)){v=find(vars,item,variable,depth);val.push(valueParse(vars,item,depth,variable,v))}else val.push(item)}if(typeof val[0]!=="number")val=uniqueValues(val);if(val.length===1)return val[0];else return val};fetch=function(vars,node,variable,depth){var nodeObject,val;if(!variable)return null;if(typeof variable==="number")return variable;nodeObject=validObject(node);if(!depth)depth=vars.id.value;if(nodeObject&&node.values instanceof
Array)val=fetchArray(vars,node.values,variable,depth);else if(nodeObject&&node[variable]instanceof Array)val=fetchArray(vars,node[variable],variable,depth);else if(node instanceof Array)val=fetchArray(vars,node,variable,depth);else{val=find(vars,node,variable,depth);val=valueParse(vars,node,depth,variable,val)}return val};module.exports=fetch},{"../../object/validate.coffee":171,"../../util/uniques.coffee":209}],68:[function(require,module,exports){module.exports=function(type){var attrs,styles,tester;
if(["div","svg"].indexOf(type)<0)type="div";styles={position:"absolute",left:"-9999px",top:"-9999px",visibility:"hidden",display:"block"};attrs=type==="div"?{}:{position:"absolute"};tester=d3.select("body").selectAll(type+".d3plus_tester").data([0]);tester.enter().append(type).attr("class","d3plus_tester").style(styles).attr(attrs);return tester}},{}],69:[function(require,module,exports){module.exports={dev:{accepted:"{0} is not an accepted value for {1}, please use one of the following: {2}.",deprecated:"the {0} method has been removed, please update your code to use {1}.",
noChange:"{0} was not updated because it did not change.",noContainer:"cannot find a container on the page matching {0}.",of:"of",oldStyle:"style properties for {0} have now been embedded directly into .{1}().",sameEdge:"edges cannot link to themselves. automatically removing self-referencing edge {0}.",set:"{0} has been set.",setLong:"{0} has been set to {1}.",setContainer:"please define a container div using .container()"},error:{accepted:"{0} is not an accepted {1} for {2} visualizations, please use one of the following: {3}.",
connections:"no connections available for {0}.",data:"no data available",dataYear:"no data available for {0}.",lib:"{0} visualizations require loading the {1} library.",libs:"{0} visualizations require loading the following libraries: {1}.",method:"{0} visualizations require setting the {1} method.",methods:"{0} visualizations require setting the following methods: {1}."},format:{decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%A, %B %-d, %Y %X",date:"%-m/%-d/%Y",time:"%I:%M:%S %p",
periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},lowercase:["a","an","and","as","at","but","by","for","from","if","in","into","near","nor","of","on","onto","or","per","that","the","to","with",
"via","vs","vs."],message:{data:"analyzing data",draw:"drawing visualization",initializing:"initializing {0}",loading:"loading data",tooltipReset:"resetting tooltips",ui:"updating ui"},method:{active:"active segments",color:"color",depth:"depth",dev:"verbose",focus:"focus",icon:"icon",id:"id",height:"height",labels:"labels",legend:"legend",margin:"margin",messages:"status messages",mode:"mode",mute:"hide",order:"order",search:"search",shape:"shape",size:"size",solo:"isolate",style:"style",temp:"temporary segments",
text:"text",time:"time",timeline:"timeline",total:"total segments",type:"type",width:"width",x:"x axis",y:"y axis",zoom:"zoom"},time:["date","day","month","time","year"],timeFormat:{FullYear:"%Y",Month:"%B",MonthSmall:"%b",Date:"%A %-d",DateSmall:"%-d",Hours:"%I %p",Minutes:"%I:%M",Seconds:"%Ss",Milliseconds:"%Lms","FullYear-Month":"%b %Y","FullYear-Date":"%-m/%-d/%Y","Month-Date":"%b %-d","Hours-Minutes":"%I:%M %p","Hours-Seconds":"%I:%M:%S %p","Hours-Milliseconds":"%H:%M:%S.%L","Minutes-Seconds":"%I:%M:%S %p",
"Minutes-Milliseconds":"%H:%M:%S.%L","Seconds-Milliseconds":"%H:%M:%S.%L"},ui:{and:"and",back:"back",collapse:"click to collapse",error:"error",expand:"click to expand",including:"including",loading:"loading...",more:"{0} more",moreInfo:"click for more info",or:"or",noResults:"no results matching {0}.",primary:"primary connections",share:"share",total:"total",values:"values"},uppercase:["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"],visualization:{bar:"Bar Chart",
box:"Box Plot",bubbles:"Bubbles",chart:"Chart",geo_map:"Geo Map",line:"Line Plot",network:"Network",paths:"Paths",pie:"Pie Chart",rings:"Rings",scatter:"Scatter Plot",stacked:"Stacked Area",table:"Table",tree_map:"Tree Map"}}},{}],70:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":".","grouping":[3],"currency":[""," \u20ac"],"dateTime":"%A, %e de %B de %Y, %X","date":"%d/%m/%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["domingo","lunes","martes","mi\u00e9rcoles",
"jueves","viernes","s\u00e1bado"],"shortDays":["dom","lun","mar","mi\u00e9","jue","vie","s\u00e1b"],"months":["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],"shortMonths":["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"]},"dev":{"accepted":"{0} no es un valor aceptado para {1}, por favor utilice uno de los siguientes: {2}.","deprecated":"el m\u00e9todo {0} ha sido eliminado, por favor, actualiza tu c\u00f3digo para utilizar {1}.",
"noChange":"{0} no se actualiza porque no cambi\u00f3.","noContainer":"no se puede encontrar un contenedor en la p\u00e1gina correspondiente a {0}.","of":"de","oldStyle":"propiedades de estilo para {0} ahora se han incorporado directamente en. {1} ().","sameEdge":"los v\u00ednculos no se pueden enlazar con si mismos. eliminando autom\u00e1ticamente el v\u00ednculo {0} que se autorreferencia.","set":"{0} se ha establecido.","setLong":"{0} ha sido establecido a {1}.","setContainer":"defina un div contenedor utilizando .container ()"},
"error":{"accepted":"{0} no es un {1} aceptado para visualizaciones de {2}, por favor utilice uno de los siguientes: {3}.","connections":"no hay conexiones disponibles para {0}.","data":"No hay datos disponibles","dataYear":"no hay datos disponibles para {0}.","lib":"{0} visualizaciones requieren cargar las siguientes librer\u00edas: {1}.","libs":"{0} visualizaciones requieren cargar las siguientes librer\u00edas: {1}.","method":"{0} visualizaciones requieren establecer el \u200b\u200bm\u00e9todo {1}.",
"methods":"{0} visualizaciones requieren establecer los siguientes m\u00e9todos: {1}."},"lowercase":["una","y","en","pero","en","de","o","el","la","los","las","para","a","con"],"method":{"active":"segmentos activos","color":"color","depth":"profundidad","dev":"detallado","focus":"foco","icon":"\u00edcono","id":"id","height":"alto","labels":"r\u00f3tulo","legend":"leyenda","margin":"margen","messages":"mensajes de estado","mute":"ocultar","order":"orden","search":"b\u00fasqueda","shape":"forma","size":"tama\u00f1o",
"solo":"aislar","style":"estilo","temp":"segmentos temporales","text":"texto","time":"tiempo","timeline":"l\u00ednea de tiempo","total":"segmentos totales","type":"tipo","width":"anchura","x":"eje x","y":"eje Y","zoom":"#ERROR!","mode":"modo"},"time":["fecha","d\u00eda","mes","hora","a\u00f1o"],"visualization":{"bubbles":"Burbujas","chart":"Tabla","geo_map":"Mapa Geo","line":"L\u00ednea Solar","network":"Red","rings":"Anillos","scatter":"Gr\u00e1fico De Dispersi\u00f3n","stacked":"\u00c1rea Apilada",
"tree_map":"Mapa de \u00c1rbol","bar":"Gr\u00e1fico De Barras","box":"Diagrama de Cajas","paths":"Caminos","pie":"Gr\u00e1fico de Pastel","table":"Tabla"},"ui":{"and":"y","back":"atr\u00e1s","collapse":"click para cerrar","error":"error","expand":"haga clic para ampliar","loading":"Cargando ...","more":"{0} m\u00e1s","moreInfo":"clic para m\u00e1s informaci\u00f3n","noResults":"no se encontraron resultados para {0}.","primary":"relaciones principales","share":"porcentaje","total":"total","values":"valores",
"including":"Incluyendo","or":"o"},"message":{"data":"analizando los datos","draw":"visualizando","initializing":"inicializando {0}","loading":"cargando datos","tooltipReset":"restableciendo las descripciones emergentes","ui":"actualizando la interfaz de usuario"},"uppercase":["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","UI"]}},{}],71:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":".","grouping":[3],"currency":["",
" \u20ac"],"dateTime":"%A, le %e %B %Y, %X","date":"%d/%m/%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"shortDays":["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],"months":["janvier","f\u00e9vrier","mars","avril","mai","juin","juillet","ao\u00fbt","septembre","octobre","novembre","d\u00e9cembre"],"shortMonths":["janv.","f\u00e9vr.","mars","avr.","mai","juin","juil.","ao\u00fbt","sept.","oct.","nov.","d\u00e9c."]},"dev":{"accepted":"{0} n'est pas une option valide pour {1}, les valeurs possibles sont: {2}.",
"deprecated":"{0} a \u00e9t\u00e9 \u00e9limin\u00e9 de la version courante, mettez \u00e0 jour votre code source avec {1}.","noChange":"{0} n'a pas \u00e9t\u00e9 mis \u00e0 jour car inchang\u00e9.","noContainer":"impossible de trouver un contenant correspondant \u00e0 {0}.","of":"de","oldStyle":"les propri\u00e9t\u00e9s de {0} ont \u00e9t\u00e9 imbriqu\u00e9es dans .{1}().","sameEdge":"un arc ne peut pas boucler sur lui m\u00eame. L'auto-r\u00e9f\u00e9rence est automatiquement \u00e9limin\u00e9e {0}.",
"set":"{0} a \u00e9t\u00e9 mis \u00e0 jour.","setLong":"{0} a \u00e9t\u00e9 mis \u00e0 jour \u00e0 {1}.","setContainer":"merci de choisir un div qui utilise .container()"},"error":{"accepted":"{0} n'est pas correct {1} pour {2} visualisations, merci d'utilisez une des options suivantes: {3}.","connections":"Pas de connections disponibles pour {0}.","data":"Pas de donn\u00e9es disponibles","dataYear":"Pas de donn\u00e9es disponibles pour {0}.","lib":"La visualisation de {0} n\u00e9cessite le chargement de la librairie {1}.",
"libs":"La visualisation de {0} n\u00e9cessite le chargement des librairies {1}.","method":"La visualisation du {0} exige la d\u00e9finition de {1}.","methods":"La visualisation du {0} exige les d\u00e9finitions de {1}."},"lowercase":["un","une","de","des","et","mais","les","ou","pour","avec","comme","par","vers","si","dans","pr\u00e8s","ni","dessus","que","le","la","via","sinon","alors"],"method":{"active":"segments actifs","color":"couleur","depth":"profondeur","dev":"verbeux","focus":"focus","icon":"\u00edcone",
"id":"id","height":"hauteur","labels":"labels","legend":"l\u00e9gende","margin":"marge","messages":"messages","mute":"cacher","order":"ordre","search":"recherche","shape":"format","size":"taille","solo":"isoler","style":"style","temp":"segments temporaires","text":"texte","time":"temps","timeline":"ligne temporelle","total":"segments totaux","type":"type","width":"largeur","x":"axe x","y":"axe y","zoom":"zoom","mode":"mode"},"time":["ann\u00e9e","date","jour","heure","mois"],"visualization":{"bubbles":"Bulles",
"chart":"Graphique","geo_map":"Carte","line":"Courbes","network":"R\u00e9seau","rings":"Anneaux","scatter":"Nuage de points","stacked":"Aires empil\u00e9es","tree_map":"Arbre","bar":"Diagramme en barres","box":"Bo\u00eetes \u00e0 Moustaches","paths":"Chemins","pie":"Camembert","table":"Table"},"ui":{"and":"et","back":"retour","collapse":"clic pour r\u00e9duire","error":"erreur","expand":"clic pour agrandir","loading":"chargement ...","more":"plus {0}","moreInfo":"clic pour plus d'information","noResults":"pas de r\u00e9sultat correspondant \u00e0 {0}.",
"primary":"connections primaires","share":"part","total":"total","values":"valeurs","including":"incluant","or":"ou"},"message":{"data":"analyse des donn\u00e9es","draw":"trac\u00e9 en cours","initializing":"Initialisation {0}","loading":"chargement","tooltipReset":"r\u00e9initialisation des bulles","ui":"rafraichissement de l'interface"},"uppercase":["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","IT","TV","UI"]}},{}],72:[function(require,module,exports){module.exports=
{"format":{"decimal":".","thousands":",","grouping":[3],"currency":["\u20a9",""],"dateTime":"%Y/%m/%d %a %X","date":"%Y/%m/%d","time":"%H:%M:%S","periods":["\uc624\uc804","\uc624\ud6c4"],"days":["\uc77c\uc694\uc77c","\uc6d4\uc694\uc77c","\ud654\uc694\uc77c","\uc218\uc694\uc77c","\ubaa9\uc694\uc77c","\uae08\uc694\uc77c","\ud1a0\uc694\uc77c"],"shortDays":["\uc77c","\uc6d4","\ud654","\uc218","\ubaa9","\uae08","\ud1a0"],"months":["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4",
"9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4"],"shortMonths":["1\uc6d4","2\uc6d4","3\uc6d4","4\uc6d4","5\uc6d4","6\uc6d4","7\uc6d4","8\uc6d4","9\uc6d4","10\uc6d4","11\uc6d4","12\uc6d4"]},"dev":{"accepted":"{0} {1}, \ub2e4\uc74c \uc911 \ud558\ub098\ub97c \uc0ac\uc6a9\ud558\uc2ed\uc2dc\uc624\uc5d0 \ub300\ud55c \ud5c8\uc6a9 \uac12\uc774 \uc544\ub2d9\ub2c8\ub2e4 : {2}.","deprecated":"{0} \uba54\uc18c\ub4dc\uac00 \uc81c\uac70 \ub41c, \uc0ac\uc6a9\ud558\ub294 \ucf54\ub4dc\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\uc2ed\uc2dc\uc624 {1}.",
"noChange":"{0}\uc774 \ubcc0\uacbd\ub418\uc9c0 \uc54a\uc558\uae30 \ub54c\ubb38\uc5d0 \uc5c5\ub370\uc774\ud2b8\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.","noContainer":"\ud398\uc774\uc9c0 \ub9e4\uce6d {0}\uc5d0 \ucee8\ud14c\uc774\ub108\ub97c \ucc3e\uc744 \uc218 \uc5c6\ub2e4.","of":"\uc758","oldStyle":"{0} \uc9c0\uae08\uc5d0 \uc9c1\uc811 \ub0b4\uc7a5 \ub41c\uc704\ud55c \uc2a4\ud0c0\uc77c\uc758 \ud638\ud154 .{1}().","sameEdge":"\uac00\uc7a5\uc790\ub9ac\ub294 \uc790\uc2e0\uc5d0 \ub9c1\ud06c \ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \uc790\ub3d9\uc73c\ub85c \uc790\uccb4 \ucc38\uc870 \uac00\uc7a5\uc790\ub9ac {0}\uc744 \uc81c\uac70\ud558\ub294 \ub2e8\uacc4\ub97c \ud3ec\ud568\ud55c\ub2e4.",
"set":"{0} \uc124\uc815\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.","setLong":"{0} {1}\ub85c \uc124\uc815\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.","setContainer":".container() \uc0ac\uc6a9\ud558\uc5ec \ucee8\ud14c\uc774\ub108 \uc0ac\uc5c5\ubd80\ub97c \uc815\uc758\ud558\uc2ed\uc2dc\uc624"},"error":{"accepted":"{0} \uc544\ub2c8\ub2e4 \ud5c8\uc6a9 {1} {2} \uc2dc\uac01\ud654\ub294 \ub2e4\uc74c \uc911 \ud558\ub098\ub97c \uc0ac\uc6a9\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4 : {3}.","connections":"{0}\uc5d0 \ub300\ud55c \uc5f0\uacb0\uc774 \uc5c6\uc74c.",
"data":"\uc790\ub8cc \uc5c6\uc74c","dataYear":"{0}\uc5d0 \ub300\ud55c \uc790\ub8cc\uac00 \uc5c6\uc74c.","lib":"{0} \uc2dc\uac01\ud654\ub294 {1} \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c\ub85c\ub4dc \ud560 \ud544\uc694\ud569\ub2c8\ub2e4.","libs":"{0} \uc2dc\uac01\ud654\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c\ub85c\ub4dc \ud560 \ud544\uc694 : {1}.","method":"{0} \uc2dc\uac01\ud654\ub97c \uc704\ud574 {1} \uba54\uc11c\ub4dc\ub97c \uc124\uc815\ud574\uc57c \ud55c\ub2e4.","methods":"{0} \uc2dc\uac01\ud654\ub97c \uc704\ud574 \ub2e4\uc74c\uacfc \uac19\uc740 \uba54\uc11c\ub4dc\ub97c \uc124\uc815\ud574\uc57c\ud55c\ub2e4: {1}."},
"lowercase":[],"method":{"active":"\ud65c\uc131 \uc138\uadf8\uba3c\ud2b8","color":"\uc0c9","depth":"\uae4a\uc774","dev":"\ud480\uc5b4\uc11c","focus":"\ucd08\uc810","icon":"\uc0c1","id":"\uc2e0\ubd84\uc99d","height":"\ub192\uc774","labels":"\ub77c\ubca8","legend":"\ubc94\ub840","margin":"\uc5ec\uc720","messages":"\uc0c1\ud0dc \uba54\uc2dc\uc9c0","order":"\uc8fc\ubb38","search":"\uc218\uc0c9","shape":"\ubaa8\uc591","size":"\ud06c\uae30","style":"\uc2a4\ud0c0\uc77c","temp":"\uc784\uc2dc \uc138\uadf8\uba3c\ud2b8",
"text":"\ubcf8\ubb38","time":"\uc2dc\uac01","timeline":"\ud0c0\uc784 \ub77c\uc778","total":"\ucd1d \uc138\uadf8\uba3c\ud2b8","type":"\uc720\ud615","width":"\ud3ed","x":"X \ucd95","y":"Y \ucd95","zoom":"\uc90c","mode":"\ubaa8\ub4dc","mute":"\uc228\uae40","solo":"\ub3c5\uc8fc"},"time":["\ub0a0\uc9dc","\uc694\uc77c","\uc6d4","\uc2dc\uac04","\ub144"],"visualization":{"bubbles":"\ubc84\ube14 \ucc28\ud2b8","chart":"\ucc28\ud2b8","geo_map":"\uc9c0\ub3c4\ud615","line":"\uc120\ud615 \uadf8\ub798\ud504","network":"\ub124\ud2b8\uc6cc\ud06c \uadf8\ub798\ud504",
"rings":"\ubc18\uc9c0","scatter":"\uc0b0\ud3ec\ub3c4","stacked":"\uc2a4\ud0dd \uc601\uc5ed","tree_map":"\ud2b8\ub9ac \ub9f5","bar":"\ub9c9\ub300 \ucc28\ud2b8","box":"\ubc15\uc2a4 \ud50c\ub86f","paths":"\uacbd\ub85c","pie":"\ud30c\uc774 \ucc28\ud2b8","table":"\ud45c"},"ui":{"and":"\uacfc","back":"\ub4a4\ub85c","collapse":"\ucd95\uc18c\ud558\ub824\uba74 \ud074\ub9ad","error":"\uc624\ub958","expand":"\ud655\uc7a5\ud558\ub824\uba74 \ud074\ub9ad","loading":"\ub85c\ub4dc \uc911 ...","more":"{0} \uc774\uc0c1",
"moreInfo":"\ucd94\uac00 \uc815\ubcf4\ub97c \uc704\ud574 \ud074\ub9ad\ud558\uc2ed\uc2dc\uc624","noResults":"\uc77c\uce58\ud558\ub294 \uacb0\uacfc\uac12\uc774 \uc5c6\uc74c {0}.","primary":"\uae30\ubcf8 \uc5f0\uacb0","share":"\ube44\uc911","total":"\ud569\uacc4","values":"\uac12","including":"...\uc744 \ud3ec\ud568\ud558\uc5ec","or":"\ub610\ub294"},"message":{"data":"\ub370\uc774\ud130 \ubd84\uc11d \uc911","draw":"\ub370\uc774\ud130 \uc2dc\uac01\ud654 \uc911","initializing":"\ucd08\uae30\ud654 {0}",
"loading":"\ub370\uc774\ud130 \ub85c\ub529 \uc911","tooltipReset":"\ud234\ud301\uc744 \uc7ac\uc124\uc815","ui":"UI \uc5c5\ub370\uc774\ud2b8 \uc911"},"uppercase":["CEO","\ucd5c\uace0 \uacbd\uc601\uc790","\ucd5c\uace0 \uc7ac\ubb34 \ucc45\uc784\uc790 (CFO)","CFO\ub294","CNC","COO","\uad6c\uad6c","CPU","CPU\ub97c","\uad6d\ub0b4 \ucd1d\uc0dd\uc0b0 (GDP)","HVAC","ID","IT","R & D","TV","UI"]}},{}],73:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":".","grouping":[3],
"currency":[""," \u0434\u0435\u043d."],"dateTime":"%A, %e %B %Y \u0433. %X","date":"%d.%m.%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["\u043d\u0435\u0434\u0435\u043b\u0430","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0440\u0442\u043e\u043a","\u043f\u0435\u0442\u043e\u043a","\u0441\u0430\u0431\u043e\u0442\u0430"],"shortDays":["\u043d\u0435\u0434","\u043f\u043e\u043d",
"\u0432\u0442\u043e","\u0441\u0440\u0435","\u0447\u0435\u0442","\u043f\u0435\u0442","\u0441\u0430\u0431"],"months":["\u0458\u0430\u043d\u0443\u0430\u0440\u0438","\u0444\u0435\u0432\u0440\u0443\u0430\u0440\u0438","\u043c\u0430\u0440\u0442","\u0430\u043f\u0440\u0438\u043b","\u043c\u0430\u0458","\u0458\u0443\u043d\u0438","\u0458\u0443\u043b\u0438","\u0430\u0432\u0433\u0443\u0441\u0442","\u0441\u0435\u043f\u0442\u0435\u043c\u0432\u0440\u0438","\u043e\u043a\u0442\u043e\u043c\u0432\u0440\u0438","\u043d\u043e\u0435\u043c\u0432\u0440\u0438",
"\u0434\u0435\u043a\u0435\u043c\u0432\u0440\u0438"],"shortMonths":["\u0458\u0430\u043d","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0458","\u0458\u0443\u043d","\u0458\u0443\u043b","\u0430\u0432\u0433","\u0441\u0435\u043f","\u043e\u043a\u0442","\u043d\u043e\u0435","\u0434\u0435\u043a"]},"dev":{"accepted":"{0} \u043d\u0435 \u0435 \u043f\u0440\u0438\u0444\u0430\u0442\u0435\u043da \u0432\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0430 \u0437\u0430 {1}, \u0432\u0435 \u043c\u043e\u043b\u0438\u043c\u0435 \u043a\u043e\u0440\u0438\u0441\u0442\u0435\u0442\u0435 \u0435\u0434\u043da \u043e\u0434 \u0441\u043b\u0435\u0434\u043d\u0438\u0432\u0435 \u0432\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438: {2}.",
"deprecated":"{0} \u043c\u0435\u0442\u043e\u0434 \u0435 \u043e\u0442\u0441\u0442\u0440\u0430\u043d\u0435\u0442\u0430, \u0432\u0435 \u043c\u043e\u043b\u0438\u043c\u0435 \u043e\u0431\u043d\u043e\u0432\u0435\u0442\u0435 \u0433\u043e \u0432\u0430\u0448\u0438\u043e\u0442 \u043a\u043e\u0434 \u0437\u0430 \u0434\u0430 \u0441\u0435 \u043a\u043e\u0440\u0438\u0441\u0442\u0438 {1}.","noChange":"{0} \u043d\u0435 \u0435 \u0430\u0436\u0443\u0440\u0438\u0440\u0430\u043d\u0430, \u0431\u0438\u0434\u0435\u0458\u045c\u0438 \u043d\u0435\u043c\u0430\u0448\u0435 \u043f\u0440\u043e\u043c\u0435\u043d\u0438.",
"noContainer":"\u043d\u0435 \u043c\u043e\u0436e \u0434\u0430 \u0441\u0435 \u043d\u0430\u0458\u0434\u0435 \u043a\u043e\u043d\u0442\u0435\u0458\u043d\u0435\u0440 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u0442\u0430 \u043a\u043e\u0458 \u0441\u0435 \u0441\u043e\u0432\u043f\u0430\u0453\u0430 \u0441\u043e {0}.","of":"\u043d\u0430","oldStyle":"\u0441\u0432\u043e\u0458\u0441\u0442\u0432\u0430\u0442\u0430 \u0437\u0430 \u0441\u0442\u0438\u043b\u043e\u0442 \u0437\u0430 {0} \u0441\u0435\u0433\u0430 \u0441\u0435 \u0432\u0433\u0440\u0430\u0434\u0435\u043d\u0438 \u0434\u0438\u0440\u0435\u043a\u0442\u043d\u043e \u0432\u043e. {1} ().",
"sameEdge":"\u0440\u0430\u0431\u043e\u0432\u0438\u0442\u0435 \u043d\u0435 \u043c\u043e\u0436\u0435 \u0434\u0430 \u0438\u043c\u0430\u0430\u0442 \u0430\u043b\u043a\u0430 \u0441\u0430\u043c\u0438\u0442\u0435 \u043a\u043e\u043d \u0441\u0435\u0431\u0435. \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0441\u043a\u0438 \u0433\u0438 \u043e\u0442\u0441\u0442\u0440\u0430\u043d\u0443\u0432\u0430\u043c \u0440\u0430\u0431\u043e\u0432\u0438\u0442\u0435 \u043a\u043e\u0438 \u0441\u0435 \u0441\u0430\u043c\u043e-\u0440\u0435\u0444\u0435\u0440\u0435\u043d\u0446\u0438\u0440\u0430\u0430\u0442 {0}.",
"set":"{0} \u0435 \u043d\u0430\u043c\u0435\u0441\u0442\u0435\u043d.","setLong":"{0} \u0435 \u043f\u043e\u0441\u0442\u0430\u0432\u0435\u043d \u043d\u0430 {1}.","setContainer":"\u0412\u0435 \u043c\u043e\u043b\u0438\u043c\u0435 \u0434\u0435\u0444\u0438\u043d\u0438\u0440\u0430\u0458\u0442\u0435 \u043a\u043e\u043d\u0442\u0435\u0458\u043d\u0435\u0440 div \u043a\u043e\u0440\u0438\u0441\u0442\u0435\u0458\u045c\u0438 .container()"},"error":{"accepted":"{0} \u043d\u0435 \u0435 \u043f\u0440\u0438\u0444\u0430\u0442\u043b\u0438\u0432\u0430 \u0437\u0430 {1} {2} \u0432\u0438\u0437\u0443\u0435\u043b\u0438\u0437\u0430\u0446\u0438\u0458\u0430, \u0432\u0435 \u043c\u043e\u043b\u0438\u043c\u0435 \u043a\u043e\u0440\u0438\u0441\u0442\u0435\u0442\u0435 \u0435\u0434\u043d\u0430 \u043e\u0434 \u0441\u043b\u0435\u0434\u043d\u0438\u0432\u0435: {3}.",
"connections":"\u043d\u0435 \u0435 \u0434\u043e\u0441\u0442\u0430\u043f\u043d\u0430 \u0437\u0430 \u0432\u0440\u0441\u043a\u0438 {0}.","data":"\u043d\u0435\u043c\u0430 \u043f\u043e\u0434\u0430\u0442\u043e\u0446\u0438","dataYear":"\u041d\u0435\u043c\u0430 \u0434\u043e\u0441\u0442\u0430\u043f\u043d\u0438 \u043f\u043e\u0434\u0430\u0442\u043e\u0446\u0438 \u0437\u0430 {0}.","lib":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u0430\u0440\u0430\u0430\u0442 \u0432\u0447\u0438\u0442\u0443\u0432\u0430\u045a\u0435 \u043d\u0430 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u0442\u0430 {1} .",
"libs":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u0430\u0440\u0430\u0430\u0442 \u0432\u0447\u0438\u0442\u0443\u0432\u0430\u045a\u0435 \u0441\u043b\u0435\u0434\u043d\u0438\u0432\u0435 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438: {1}.","method":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u0430\u0440\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u0443\u0432\u0430\u045a\u0435 \u043d\u0430 {1} \u043c\u0435\u0442\u043e\u0434\u043e\u0442.",
"methods":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0431\u0430\u0440\u0430\u0430\u0442 \u043f\u043e\u0441\u0442\u0430\u0432\u0443\u0432\u0430\u045a\u0435 \u043d\u0430 \u0441\u043b\u0435\u0434\u043d\u0438\u0432\u0435 \u043c\u0435\u0442\u043e\u0434\u0438: {1}."},"lowercase":["a","\u0438","\u0432\u043e","\u043d\u043e","\u043d\u0430","\u0438\u043b\u0438","\u0434\u0430","\u0441\u0435","\u0441\u043e"],"method":{"active":"\u0430\u043a\u0442\u0438\u0432\u043d\u0438 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0438",
"color":"\u0431\u043e\u0458\u0430","depth":"\u0434\u043b\u0430\u0431\u043e\u0447\u0438\u043d\u0430","dev":"\u043e\u043f\u0448\u0438\u0440\u043d\u043e","focus":"\u0444\u043e\u043a\u0443\u0441","icon":"\u0438\u043a\u043e\u043d\u0430","id":"id","height":"\u0432\u0438\u0441\u0438\u043d\u0430","labels":"\u0435\u0442\u0438\u043a\u0435\u0442\u0438","legend":"\u043b\u0435\u0433\u0435\u043d\u0434\u0430","margin":"\u043c\u0430\u0440\u0433\u0438\u043d\u0430","messages":"\u043f\u043e\u0440\u0430\u043a\u0438 \u0437\u0430 \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0442",
"mute":"\u0441\u043a\u0440\u0438\u0435","order":"\u0446\u0435\u043b","search":"\u0431\u0430\u0440\u0430\u0458","shape":"\u0444\u043e\u0440\u043c\u0430","size":"\u0433\u043e\u043b\u0435\u043c\u0438\u043d\u0430","solo":"\u0438\u0437\u043e\u043b\u0438\u0440\u0430\u045a\u0435","style":"\u0441\u0442\u0438\u043b","temp":"\u043f\u0440\u0438\u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0438","text":"\u0442\u0435\u043a\u0441\u0442","time":"\u0432\u0440\u0435\u043c\u0435",
"timeline":"\u0432\u0440\u0435\u043c\u0435\u043f\u043b\u043e\u0432","total":"\u0412\u043a\u0443\u043f\u043d\u043e \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u0438","type":"\u0442\u0438\u043f","width":"\u0448\u0438\u0440\u0438\u043d\u0430","x":"x \u043e\u0441\u043a\u0430\u0442\u0430","y":"\u043e\u0441\u043a\u0430\u0442\u0430 y","zoom":"\u0437\u0443\u043c","mode":"\u0440\u0435\u0436\u0438\u043c"},"time":["\u0434\u0430\u0442\u0443\u043c","\u0434\u0435\u043d","\u043c\u0435\u0441\u0435\u0446","\u0432\u0440\u0435\u043c\u0435",
"\u0433\u043e\u0434\u0438\u043d\u0430"],"visualization":{"bubbles":"\u041c\u0435\u0443\u0440\u0447\u0438\u045a\u0430","chart":"\u0428\u0435\u043c\u0430","geo_map":"\u0413\u0435\u043e \u043c\u0430\u043f\u0430","line":"\u041b\u0438\u043d\u0438\u0441\u043a\u0438 \u0433\u0440\u0430\u0444\u0438\u043a","network":"\u041c\u0440\u0435\u0436\u0430","rings":"\u041f\u0440\u0441\u0442\u0435\u043d\u0438","scatter":"\u0420\u0430\u0441\u043f\u0440\u0441\u043a\u0430\u043d \u0433\u0440\u0430\u0444\u0438\u043a","stacked":"\u041d\u0430\u0440\u0435\u0434\u0435\u043d\u0430 \u043f\u043e\u0432\u0440\u0448\u0438\u043d\u0430",
"tree_map":"\u041c\u0430\u043f\u0430 \u0432\u043e \u0432\u0438\u0434 \u043d\u0430 \u0434\u0440\u0432\u043e","bar":"\u0411\u0430\u0440 \u0442\u0430\u0431\u0435\u043b\u0430","box":"\u041a\u0443\u0442\u0438\u0458\u0430 \u041f\u0430\u0440\u0446\u0435\u043b","paths":"\u041f\u0430\u0442\u0435\u043a\u0438","pie":"\u041f\u0438\u0442\u0430 \u0433\u0440\u0430\u0444\u0438\u043a\u043e\u043d","table":"\u0422\u0430\u0431\u0435\u043b\u0430"},"ui":{"and":"\u0438","back":"\u043d\u0430\u0437\u0430\u0434","collapse":"\u043a\u043b\u0438\u043a\u043d\u0438 \u0437\u0430 \u0434\u0430 \u0441\u0435 \u0441\u043e\u0431\u0435\u0440\u0435",
"error":"\u0433\u0440\u0435\u0448\u043a\u0430","expand":"\u043a\u043b\u0438\u043a\u043d\u0438 \u0437\u0430 \u0434\u0430 \u0441\u0435 \u043f\u0440\u043e\u0448\u0438\u0440\u0438","loading":"\u0421\u0435 \u0432\u0447\u0438\u0442\u0443\u0432\u0430 ...","more":"{0} \u043f\u043e\u0432\u0435\u045c\u0435","moreInfo":"\u043a\u043b\u0438\u043a\u043d\u0435\u0442\u0435 \u0437\u0430 \u043f\u043e\u0432\u0435\u045c\u0435 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438","noResults":"\u041d\u0435 \u0441\u0435 \u043f\u0440\u043e\u043d\u0430\u0458\u0434\u0435\u043d\u0438 \u043f\u043e\u0458\u0430\u0432\u0443\u0432\u0430\u045a\u0435 \u043d\u0430 {0}.",
"primary":"\u043e\u0441\u043d\u043e\u0432\u043d\u043e \u0432\u0440\u0441\u043a\u0438","share":"\u0443\u0434\u0435\u043b","total":"\u0412\u043a\u0443\u043f\u043d\u0438\u043e\u0442","values":"\u0432\u0440\u0435\u0434\u043d\u043e\u0441\u0442\u0438","including":"\u0412\u043a\u043b\u0443\u0447\u0443\u0432\u0430\u0458\u045c\u0438","or":"\u0438\u043b\u0438"},"message":{"data":"\u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043d\u0430 \u043f\u043e\u0434\u0430\u0442\u043e\u0446\u0438","draw":"\u0446\u0440\u0442\u0430\u045a\u0435 \u043d\u0430 \u0432\u0438\u0437\u0443\u0435\u043b\u0438\u0437\u0430\u0446\u0438\u0458\u0430",
"initializing":"\u0438\u043d\u0438\u0446\u0438\u0458\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0458\u0430 {0}","loading":"\u043f\u043e\u0434\u0430\u0442\u043e\u0446\u0438 \u0437\u0430 \u0432\u0447\u0438\u0442\u0443\u0432\u0430\u045a\u0435","tooltipReset":"\u0440\u0435\u0441\u0435\u0442\u0438\u0440\u0430\u045a\u0435 \u043d\u0430 \u043e\u0431\u0458\u0430\u0441\u043d\u0443\u0432\u0430\u045a\u0430\u0442\u0430","ui":"\u0430\u0436\u0443\u0440\u0438\u0440\u0430\u045a\u0435 \u043d\u0430 \u043a\u043e\u0440\u0438\u043d\u0438\u0447\u043a\u0438\u043e\u0442 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0458\u0441"},
"uppercase":["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","IT","R&D","TV","UI"]}},{}],74:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":".","grouping":[3],"currency":["R$",""],"dateTime":"%A, %e de %B de %Y. %X","date":"%d/%m/%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["Domingo","Segunda","Ter\u00e7a","Quarta","Quinta","Sexta","S\u00e1bado"],"shortDays":["Dom","Seg","Ter","Qua","Qui","Sex","S\u00e1b"],"months":["Janeiro",
"Fevereiro","Mar\u00e7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],"shortMonths":["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},"dev":{"accepted":"{0} n\u00e3o \u00e9 um valor v\u00e1lido para {1}, por favor use um dos seguintes procedimentos: {2}.","deprecated":"{0} m\u00e9todo foi removido, por favor atualize seu c\u00f3digo para utilizar {1}.","noChange":"{0} n\u00e3o foi atualizado porque ele n\u00e3o mudou.","noContainer":"N\u00e3o foi poss\u00edvel encontrar um local na p\u00e1gina correspondente a {0}.",
"of":"de","oldStyle":"propriedades de estilo para {0} j\u00e1 foi incorporado diretamente no. {1} ().","sameEdge":"bordas n\u00e3o podem vincular a si mesmos. removendo automaticamente borda de auto-refer\u00eancia {0}.","set":"{0} foi definido.","setLong":"{0} foi definida para {1}.","setContainer":"por favor, defina um div utilizando .container()"},"error":{"accepted":"{0} n\u00e3o \u00e9 um {1} reconhecido para visualiza\u00e7\u00f5es {2}, favor usar um dos seguintes procedimentos: {3}.","connections":"N\u00e3o h\u00e1 conex\u00f5es dispon\u00edveis para {0}.",
"data":"N\u00e3o h\u00e1 dados dispon\u00edveis","dataYear":"N\u00e3o h\u00e1 dados dispon\u00edveis para {0}.","lib":"A visualiza\u00e7\u00e3o {0} necessita que seja carregado a biblioteca {1}.","libs":"A visualiza\u00e7\u00e3o {0} necessita que seja carregado as bibliotecas {1}.","method":"A visualiza\u00e7\u00e3o {0} exige a defini\u00e7\u00e3o do m\u00e9todo {1}.","methods":"A visualiza\u00e7\u00e3o {0} exige a defini\u00e7\u00e3o dos m\u00e9todos {1}."},"lowercase":["um","uma","e","como","em",
"no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],"method":{"active":"segmentos activos","color":"cor","depth":"profundidade","dev":"verboso","focus":"foco","icon":"\u00edcone","id":"identificador","height":"altura","labels":"etiquetas","legend":"legenda","margin":"margem","messages":"mensagens de status","mute":"ocultar","order":"ordenar","search":"pesquisar","shape":"forma","size":"tamanho","solo":"isolar","style":"estilo","temp":"segmentos tempor\u00e1rios",
"text":"texto","time":"tempo","timeline":"linha do tempo","total":"segmentos no total","type":"tipo","width":"largura","x":"eixo x","y":"eixo y","zoom":"zoom","mode":"modo"},"time":["data","dia","m\u00eas","hora","ano"],"visualization":{"bubbles":"Bolhas","chart":"Gr\u00e1fico","geo_map":"Mapa","line":"Gr\u00e1fico de Linha","network":"Rede","rings":"An\u00e9is","scatter":"Dispers\u00e3o","stacked":"Evolu\u00e7\u00e3o","tree_map":"Tree Map","bar":"Gr\u00e1fico de Barras","box":"Box Plot","paths":"Caminhos",
"pie":"Pie Chart","table":"Tabela"},"ui":{"and":"e","back":"voltar","collapse":"Clique para fechar","error":"erro","expand":"clique para expandir","loading":"carregando ...","more":"mais {0}","moreInfo":"Clique para mais informa\u00e7\u00f5es","noResults":"nenhum resultado para {0}.","primary":"conex\u00f5es prim\u00e1rias","share":"participa\u00e7\u00e3o","total":"total","values":"valores","including":"Incluindo","or":"ou"},"message":{"data":"analisando dados","draw":"desenhando visualiza\u00e7\u00e3o",
"initializing":"inicializando {0}","loading":"carregando dados","tooltipReset":"redefinindo as dicas","ui":"atualizando interface"},"uppercase":["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","P&D","TV","IU"]}},{}],75:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":".","grouping":[3],"currency":["\u20ac",""],"dateTime":"%A, %e de %B de %Y. %X","date":"%d/%m/%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["Domingo","Segunda",
"Ter\u00e7a","Quarta","Quinta","Sexta","S\u00e1bado"],"shortDays":["Dom","Seg","Ter","Qua","Qui","Sex","S\u00e1b"],"months":["Janeiro","Fevereiro","Mar\u00e7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],"shortMonths":["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"]},"dev":{"accepted":"{0} n\u00e3o \u00e9 um valor v\u00e1lido para {1}, por favor escolha uma das seguintes op\u00e7\u00f5es: {2}.","deprecated":"o m\u00e9todo {0} foi removido, por favor atualize o seu c\u00f3digo para usar {1}.",
"noChange":"{0} n\u00e3o foi atualizado porque n\u00e3o houve modifica\u00e7\u00f5es.","noContainer":"N\u00e3o foi poss\u00edvel encontrar um elemento na p\u00e1gina correspondente a {0}.","of":"de","oldStyle":"as propriedades de {0} j\u00e1 foram inclu\u00eddas em .{1}().","sameEdge":"bordas n\u00e3o podem vincular a si mesmos. removendo automaticamente borda de auto-refer\u00eancia {0}.","set":"{0} foi definido.","setLong":"{0} foi alterado para {1}.","setContainer":"por favor indique um elemento div atrav\u00e9s do m\u00e9todo .container()"},
"error":{"accepted":"{0} n\u00e3o \u00e9 uma {1} v\u00e1lida para a visualiza\u00e7\u00e3o {2}, por favor escolha uma das seguintes: {3}.","connections":"n\u00e3o existem liga\u00e7\u00f5es dispon\u00edveis para {0}.","data":"n\u00e3o existem dados dispon\u00edveis","dataYear":"n\u00e3o existem dados dispon\u00edveis para {0}.","lib":"a visualiza\u00e7\u00e3o {0} necessita que a biblioteca {1} seja carregada.","libs":"a visualiza\u00e7\u00e3o {0} necessita que as seguintes bibliotecas sejam carregadas: {1}.",
"method":"A visualiza\u00e7\u00e3o {0} exige a defini\u00e7\u00e3o do m\u00e9todo {1}.","methods":"A visualiza\u00e7\u00e3o {0} exige a defini\u00e7\u00e3o dos seguintes m\u00e9todos {1}."},"lowercase":["um","uma","e","como","em","no","na","mas","por","para","pelo","pela","de","do","da","se","perto","nem","ou","que","o","a","com","v"],"method":{"active":"segmentos activos","color":"cor","depth":"profundidade","dev":"verboso","focus":"foco","icon":"\u00edcone","id":"identificador","height":"altura",
"labels":"etiquetas","legend":"legenda","margin":"margem","messages":"estado","order":"ordenar","search":"pesquisar","shape":"forma","size":"tamanho","style":"estilo","temp":"segmentos tempor\u00e1rios","text":"texto","time":"tempo","timeline":"linha temporal","total":"segmentos no total","type":"tipo","width":"largura","x":"eixo dos xx","y":"eixo dos yy","zoom":"zoom","mode":"#ERROR!","mute":"ocultar","solo":"isolar"},"time":["data","dia","m\u00eas","hora","ano"],"visualization":{"bubbles":"Bolhas",
"chart":"Diagrama","geo_map":"Mapa","line":"Gr\u00e1fico de Linha","network":"Grafo","rings":"An\u00e9is","scatter":"Gr\u00e1fico de Dispers\u00e3o","stacked":"Gr\u00e1fico de \u00c1rea","tree_map":"Tree Map","bar":"Gr\u00e1fico de Barras","box":"Diagrama de Caixa e Bigodes","paths":"Caminhos","pie":"Gr\u00e1fico de Setores","table":"Tabela"},"ui":{"and":"e","back":"voltar","collapse":"Clique para colapsar","error":"erro","expand":"clique para expandir","loading":"a carregar ...","more":"mais {0}",
"moreInfo":"Clique para mais informa\u00e7\u00f5es","noResults":"nenhum resultado para {0}.","primary":"liga\u00e7\u00f5es principais","share":"propor\u00e7\u00e3o","total":"total","values":"valores","including":"Incluindo","or":"ou"},"message":{"data":"a analisar os dados","draw":"a desenhar a visualiza\u00e7\u00e3o","initializing":"a inicializar {0}","loading":"a carregar os dados","tooltipReset":"a actualizar as caixas de informa\u00e7\u00e3o","ui":"a actualizar o interface"},"uppercase":["CEO",
"CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","PIB","HVAC","ID","TI","I&D","TV","IU"]}},{}],76:[function(require,module,exports){module.exports={"format":{"decimal":",","thousands":"\u00a0","grouping":[3],"currency":[""," \u0440\u0443\u0431."],"dateTime":"%A, %e %B %Y \u0433. %X","date":"%d.%m.%Y","time":"%H:%M:%S","periods":["AM","PM"],"days":["\u0432\u043e\u0441\u043a\u0440\u0435\u0441\u0435\u043d\u044c\u0435","\u043f\u043e\u043d\u0435\u0434\u0435\u043b\u044c\u043d\u0438\u043a","\u0432\u0442\u043e\u0440\u043d\u0438\u043a",
"\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043f\u044f\u0442\u043d\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043e\u0442\u0430"],"shortDays":["\u0432\u0441","\u043f\u043d","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043f\u0442","\u0441\u0431"],"months":["\u044f\u043d\u0432\u0430\u0440\u044f","\u0444\u0435\u0432\u0440\u0430\u043b\u044f","\u043c\u0430\u0440\u0442\u0430","\u0430\u043f\u0440\u0435\u043b\u044f","\u043c\u0430\u044f","\u0438\u044e\u043d\u044f",
"\u0438\u044e\u043b\u044f","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f","\u043e\u043a\u0442\u044f\u0431\u0440\u044f","\u043d\u043e\u044f\u0431\u0440\u044f","\u0434\u0435\u043a\u0430\u0431\u0440\u044f"],"shortMonths":["\u044f\u043d\u0432","\u0444\u0435\u0432","\u043c\u0430\u0440","\u0430\u043f\u0440","\u043c\u0430\u0439","\u0438\u044e\u043d","\u0438\u044e\u043b","\u0430\u0432\u0433","\u0441\u0435\u043d","\u043e\u043a\u0442","\u043d\u043e\u044f","\u0434\u0435\u043a"]},
"dev":{"accepted":"{0} \u043d\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 {1}, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445: {2}.","deprecated":"\u041c\u0435\u0442\u043e\u0434 {0} \u0431\u044b\u043b \u0443\u0434\u0430\u043b\u0435\u043d, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0432\u0430\u0448 \u043a\u043e\u0434, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c {1}.",
"noChange":"{0} \u043d\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u043d \u043d\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u0441\u044f.","noContainer":"\u043d\u0435 \u043c\u043e\u0433\u0443 \u043d\u0430\u0439\u0442\u0438 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u044f {0}.","of":"\u0438\u0437",
"oldStyle":"\u0441\u0432\u043e\u0439\u0441\u0442\u0432\u0430 \u0441\u0442\u0438\u043b\u044f \u0434\u043b\u044f {0} \u0443\u0436\u0435 \u0432 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0431\u044b\u043b\u0438 \u0432\u0441\u0442\u0440\u043e\u0435\u043d \u043d\u0435\u043f\u043e\u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0432. {1} ().","sameEdge":"\u041a\u0440\u0430\u044f \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0441\u0432\u044f\u0437\u0430\u0442\u044c \u0441\u0435\u0431\u044f. \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0443\u0434\u0430\u043b\u044f\u044f \u0430\u0432\u0442\u043e\u0440\u0435\u0444\u0435\u0440\u0435\u043d\u0442\u043d\u044b\u0445 \u0440\u0435\u0431\u0440\u043e {0}.",
"set":"{0} \u0431\u044b\u043b \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d.","setLong":"{0} \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 {1}.","setContainer":"\u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 DIV \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e .container ()"},"error":{"accepted":"{0} \u043d\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0442\u0441\u044f {1} \u0434\u043b\u044f {2} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438, \u043f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445: {3}.",
"connections":"\u043d\u0435\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f, \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b\u0435 \u0434\u043b\u044f {0}.","data":"\u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b","dataYear":"\u043d\u0435\u0442 \u0434\u0430\u043d\u043d\u044b\u0445 {0}.","lib":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 {1} \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0443.",
"libs":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a: {1}.","method":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 {1} \u043c\u0435\u0442\u043e\u0434\u0430.",
"methods":"{0} \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432: {1}."},"lowercase":["\u0438","\u043a\u0430\u043a","\u0432","\u043d\u043e","\u0434\u043b\u044f","\u0438\u0437","\u0435\u0441\u043b\u0438 \u0432","\u0432","\u043d\u0435\u0434\u0430\u043b\u0435\u043a\u043e","\u043d\u0438",
"\u043d\u0430","\u043d\u0430","\u0438\u043b\u0438","\u0432","\u0447\u0442\u043e","\u043a","\u0441","\u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e","\u043f\u0440\u043e\u0442\u0438\u0432","\u043f\u0440\u043e\u0442\u0438\u0432"],"method":{"active":"\u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u044b","color":"\u0446\u0432\u0435\u0442","depth":"\u0433\u043b\u0443\u0431\u0438\u043d\u0430","dev":"\u043c\u043d\u043e\u0433\u043e\u0441\u043b\u043e\u0432\u043d\u044b\u0439",
"focus":"\u0444\u043e\u043a\u0443\u0441","icon":"\u0437\u043d\u0430\u0447\u043e\u043a","id":"ID","height":"\u0432\u044b\u0441\u043e\u0442\u0430","labels":"\u043d\u0430\u0434\u043f\u0438\u0441\u0438","legend":"\u043b\u0435\u0433\u0435\u043d\u0434\u0430","margin":"\u043f\u043e\u043b\u0435","messages":"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u043e \u0441\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0438","mute":"\u0441\u043a\u0440\u044b\u0432\u0430\u0442\u044c","order":"\u043f\u043e\u0440\u044f\u0434\u043e\u043a",
"search":"\u043f\u043e\u0438\u0441\u043a","shape":"\u0444\u043e\u0440\u043c\u0430","size":"\u0440\u0430\u0437\u043c\u0435\u0440","solo":"\u0438\u0437\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c","style":"\u0441\u0442\u0438\u043b\u044c","temp":"\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0435 \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u044b","text":"\u0442\u0435\u043a\u0441\u0442","time":"\u0432\u0440\u0435\u043c\u044f","timeline":"\u0433\u0440\u0430\u0444\u0438\u043a","total":"\u0432\u0441\u0435\u0433\u043e \u0441\u0435\u0433\u043c\u0435\u043d\u0442\u043e\u0432",
"type":"\u0442\u0438\u043f","width":"\u0448\u0438\u0440\u0438\u043d\u0430","x":"\u043e\u0441\u044c \u0445","y":"\u041e\u0441\u044c Y","zoom":"\u043c\u0430\u0441\u0448\u0442\u0430\u0431","mode":"\u0440\u0435\u0436\u0438\u043c"},"time":["\u0434\u0430\u0442\u0430","\u0434\u0435\u043d\u044c","\u043c\u0435\u0441\u044f\u0446","\u0432\u0440\u0435\u043c\u044f","\u0433\u043e\u0434"],"visualization":{"bubbles":"\u041f\u0443\u0437\u044b\u0440\u0438","chart":"\u0413\u0440\u0430\u0444\u0438\u043a","geo_map":"\u0413\u0435\u043e \u041a\u0430\u0440\u0442\u0430",
"line":"\u041b\u0438\u043d\u0438\u044f \u0437\u0435\u043c\u043b\u044f","network":"\u0421\u0435\u0442\u044c","rings":"\u041a\u043e\u043b\u044c\u0446\u0430","scatter":"\u0420\u0430\u0437\u0431\u0440\u043e\u0441 \u0437\u0435\u043c\u043b\u044f","stacked":"\u0421 \u043d\u0430\u043a\u043e\u043f\u043b\u0435\u043d\u0438\u0435\u043c \u041f\u043b\u043e\u0449\u0430\u0434\u044c","tree_map":"\u0414\u0435\u0440\u0435\u0432\u043e \u041a\u0430\u0440\u0442\u0430","bar":"\u0413\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0430",
"box":"\u041a\u043e\u0440\u043e\u0431\u043a\u0430 \u0437\u0435\u043c\u043b\u044f","paths":"\u041f\u0443\u0442\u0438","pie":"\u041a\u0440\u0443\u0433\u043e\u0432\u0430\u044f \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0430","table":"\u0421\u0442\u043e\u043b"},"ui":{"and":"\u0438","back":"\u043d\u0430\u0437\u0430\u0434","collapse":"\u0429\u0435\u043b\u043a\u043d\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0441\u0432\u0435\u0440\u043d\u0443\u0442\u044c","error":"\u043e\u0448\u0438\u0431\u043a\u0430",
"expand":"\u0449\u0435\u043b\u043a\u043d\u0438\u0442\u0435, \u0447\u0442\u043e\u0431\u044b \u0440\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c","loading":"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 ...","more":"{0} \u0431\u043e\u043b\u0435\u0435","moreInfo":"\u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0431\u043e\u043b\u0435\u0435 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0439 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438",
"noResults":"\u043d\u0435\u0442 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432, \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0445 {0}.","primary":"\u043f\u0435\u0440\u0432\u0438\u0447\u043d\u044b\u0435 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f","share":"\u0434\u043e\u043b\u044f","total":"\u043e\u0431\u0449\u0435\u0435","values":"\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f","including":"\u0432\u043a\u043b\u044e\u0447\u0430\u044f",
"or":"\u0438\u043b\u0438"},"message":{"data":"\u0410\u043d\u0430\u043b\u0438\u0437\u0438\u0440\u0443\u044f \u0434\u0430\u043d\u043d\u044b\u0435","draw":"\u0440\u0438\u0441\u0443\u043d\u043e\u043a \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f","initializing":"\u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 {0}","loading":"\u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445","tooltipReset":"\u0441\u0431\u0440\u043e\u0441 \u043f\u043e\u0434\u0441\u043a\u0430\u0437\u043a\u0438",
"ui":"\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430"},"uppercase":["ID"]}},{}],77:[function(require,module,exports){module.exports={"format":{"decimal":".","thousands":",","grouping":[3],"currency":["\u00a5",""],"dateTime":"%A %B %e %Y %X","date":"%Y/%-m/%-d","time":"%H:%M:%S","periods":["\u4e0a\u5348","\u4e0b\u5348"],"days":["\u661f\u671f\u65e5",
"\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],"shortDays":["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],"months":["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"],"shortMonths":["\u4e00\u6708",
"\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"]},"dev":{"accepted":"{0}\u4e0d\u662f{1}\u7684\u53ef\u63a5\u53d7\u503c, \u8bf7\u7528\u4e0b\u5217\u4e4b\u4e00\u7684\u503c:{2}","deprecated":"{0}\u7684\u65b9\u6cd5\u5df2\u88ab\u79fb\u9664, \u8bf7\u66f4\u65b0\u60a8\u7684\u4ee3\u7801\u53bb\u4f7f\u7528{1}","noChange":"{0}\u6ca1\u6709\u66f4\u65b0, \u56e0\u4e3a\u5b83\u5e76\u6ca1\u6709\u6539\u53d8\u3002",
"noContainer":"\u65e0\u6cd5\u5728\u8be5\u9875\u627e\u5230\u5bb9\u5668\u53bb\u5339\u914d{0}","of":"\u7684","oldStyle":"\u6837\u5f0f\u5c5e\u6027{0}\u73b0\u5728\u5df2\u7ecf\u76f4\u63a5\u5d4c\u5165\u5230\u3002{1}\uff08\uff09\u3002","sameEdge":"\u8fb9\u7f18\u4e0d\u80fd\u94fe\u63a5\u5230\u81ea\u5df1\u3002\u81ea\u52a8\u53bb\u9664\u81ea\u6211\u53c2\u7167\u8fb9\u7f18{0}\u3002","set":"{0}\u5df2\u7ecf\u88ab\u8bbe\u7f6e\u3002","setLong":"{0}\u88ab\u8bbe\u7f6e\u4e3a{1}\u3002","setContainer":"\u8bf7\u4f7f\u7528()\u5bb9\u5668\u6765\u5b9a\u4e49div\u5bb9\u5668"},
"error":{"accepted":"{0}\u5bf9\u4e8e{2}\u7684\u53ef\u89c6\u5316\u6548\u679c\u5e76\u4e0d\u662f\u4e00\u4e2a\u53ef\u63a5\u53d7\u7684{1}, \u8bf7\u4f7f\u7528\u5982\u4e0b\u7684\u4e00\u4e2a\uff1a{3}.","connections":"\u6ca1\u6709\u5bf9{0}\u53ef\u7528\u7684\u8fde\u63a5\u3002","data":"\u65e0\u53ef\u7528\u6570\u636e","dataYear":"\u6ca1\u6709\u6570\u636e\u5bf9{0}\u53ef\u7528\u3002","lib":"{0}\u7684\u53ef\u89c6\u5316\u8981\u6c42\u88c5\u8f7d{1}\u5e93\u3002","libs":"{0}\u7684\u53ef\u89c6\u5316\u9700\u8981\u52a0\u8f7d\u4ee5\u4e0b\u5e93\uff1a{1}\u3002",
"method":"{0}\u7684\u53ef\u89c6\u5316\u8981\u6c42\u8bbe\u7f6e{1}\u65b9\u6cd5\u3002","methods":"{0}\u7684\u53ef\u89c6\u5316\u8981\u6c42\u8bbe\u7f6e\u4ee5\u4e0b\u65b9\u6cd5\uff1a{1}\u3002"},"lowercase":["\u4e00\u4e2a","\u548c","\u5728","\u4f46\u662f","\u5728...\u91cc","\u7684","\u6216\u8005","\u8fd9","\u5411","\u4e0e...\u4e00\u8d77"],"method":{"active":"\u6d3b\u8dc3\u6bb5","color":"\u989c\u8272","depth":"\u6df1\u5ea6","dev":"\u8be6\u7ec6","focus":"\u7126\u70b9","icon":"\u56fe\u6807","id":"\u8eab\u4efd\u8ba4\u8bc1",
"height":"\u9ad8\u5ea6","labels":"\u6807\u7b7e","legend":"\u56fe\u4f8b\u6ce8\u91ca","margin":"\u5916\u8fb9\u8ddd","messages":"\u72b6\u6001\u6d88\u606f","mute":"\u9690\u85cf","order":"\u89c4\u5219","search":"\u641c\u7d22","shape":"\u5f62\u72b6","size":"\u5927\u5c0f","solo":"\u9694\u79bb","style":"\u6837\u5f0f","temp":"\u6682\u65f6\u6027\u533a\u6bb5","text":"\u6587\u672c","time":"\u65f6\u95f4","timeline":"\u65f6\u95f4\u8f74","total":"\u603b\u6bb5","type":"\u7c7b\u578b","width":"\u5bbd\u5ea6","x":"X\u8f74",
"y":"Y\u8f74","zoom":"\u7f29\u653e","mode":"\u6a21\u5f0f"},"time":["\u65e5","\u661f\u671f","\u6708","\u65f6\u95f4","\u5e74"],"visualization":{"bubbles":"\u6c14\u6ce1","chart":"\u56fe\u8868","geo_map":"\u5730\u7406\u5730\u56fe","line":"\u7ebf\u56fe","network":"\u7f51\u7edc","rings":"\u7279\u6027","scatter":"\u6563\u70b9\u56fe","stacked":"\u5806\u79ef\u9762\u79ef\u56fe","tree_map":"\u6811\u56fe","bar":"\u6761\u56fe","box":"\u7bb1\u7ebf\u56fe","paths":"\u8def\u5f84","pie":"\u997c\u56fe","table":"\u8868"},
"ui":{"and":"\u548c","back":"\u540e\u9762","collapse":"\u70b9\u51fb\u5408\u5e76","error":"\u9519\u8bef","expand":"\u5355\u51fb\u4ee5\u5c55\u5f00","loading":"\u8f7d\u5165\u4e2d...","more":"{0}\u66f4\u591a","moreInfo":"\u70b9\u51fb\u4e86\u89e3\u66f4\u591a\u4fe1\u606f","noResults":"\u6ca1\u6709\u7ed3\u679c\u5339\u914d{0}\u3002","primary":"\u4e3b\u8981\u8fde\u63a5","share":"\u5171\u4eab","total":"\u603b","values":"\u503c","including":"\u5305\u62ec","or":"\u6216"},"message":{"data":"\u5206\u6790\u6570\u636e",
"draw":"\u7ed8\u5236\u53ef\u89c6\u5316","initializing":"\u521d\u59cb\u5316{0}","loading":"\u52a0\u8f7d\u6570\u636e","tooltipReset":"\u91cd\u7f6e\u5de5\u5177\u63d0\u793a","ui":"\u66f4\u65b0UI"},"uppercase":["CEO","CEOs","CFO","CFOs","CNC","COO","COOs","CPU","CPUs","GDP","HVAC","ID","\u7535\u89c6","\u7528\u6237\u754c\u9762","\u7814\u53d1"]}},{}],78:[function(require,module,exports){module.exports={en_US:require("./languages/en_US.coffee"),es_ES:require("./languages/es_ES.js"),fr_FR:require("./languages/fr_FR.js"),
ko_KR:require("./languages/ko_KR.js"),mk_MK:require("./languages/mk_MK.js"),pt_BR:require("./languages/pt_BR.js"),pt_PT:require("./languages/pt_PT.js"),ru_RU:require("./languages/ru_RU.js"),zh_CN:require("./languages/zh_CN.js")}},{"./languages/en_US.coffee":69,"./languages/es_ES.js":70,"./languages/fr_FR.js":71,"./languages/ko_KR.js":72,"./languages/mk_MK.js":73,"./languages/pt_BR.js":74,"./languages/pt_PT.js":75,"./languages/ru_RU.js":76,"./languages/zh_CN.js":77}],79:[function(require,module,exports){var checkObject,
copy,createFunction,initialize,print,process,setMethod,stringFormat,validObject;copy=require("../../util/copy.coffee");print=require("../console/print.coffee");process=require("./process/detect.coffee");setMethod=require("./set.coffee");stringFormat=require("../../string/format.js");validObject=require("../../object/validate.coffee");module.exports=function(vars,methods){var method,obj,results;results=[];for(method in methods){obj=methods[method];vars[method]=copy(obj);vars[method].initialized=initialize(vars,
vars[method],method);results.push(vars.self[method]=createFunction(vars,method))}return results};initialize=function(vars,obj,method,p){var d,deps,i,len,o;obj.previous=false;obj.changed=false;obj.initialized=false;obj.callback=false;if("init"in obj&&!("value"in obj)){obj.value=obj.init(vars);delete obj.init}if("process"in obj)obj.value=process(vars,obj,obj.value);for(o in obj)if(o==="deprecates"){deps=obj[o]instanceof Array?obj[o]:[obj[o]];for(i=0,len=deps.length;i<len;i++){d=deps[i];vars.self[d]=
function(dep,n){return function(x){var doc,rec,str;str=vars.format.locale.value.dev.deprecated;dep="."+dep+"()";rec=p?'"'+n+'" in .'+p+"()":"."+n+"()";doc=p||n;print.error(stringFormat(str,dep,rec),doc);return vars.self}}(d,method)}}else if(o==="global"){if(!(method in vars))vars[method]=[]}else if(o!=="value")if(validObject(obj[o]))initialize(vars,obj[o],o,method);return true};createFunction=function(vars,key){return function(user,callback){var accepted,checkFont,checkValue,fontAttr,fontAttrValue,
s,starting,str;accepted="accepted"in vars[key]?vars[key].accepted:null;if(typeof accepted==="function")accepted=accepted(vars);if(!(accepted instanceof Array))accepted=[accepted];if(user===Object)return vars[key];else if(!arguments.length&&accepted.indexOf(void 0)<0)if("value"in vars[key])return vars[key].value;else return vars[key];if(key==="style"&&typeof user==="object"){str=vars.format.locale.value.dev.oldStyle;for(s in user){print.warning(stringFormat(str,'"'+s+'"',s),s);vars.self[s](user[s])}}if(key===
"font"){if(typeof user==="string")user={family:user};starting=true;checkValue=function(o,a,m,v){if(validObject(o[m])&&a in o[m])if(validObject(o[m][a]))if(o[m][a].process)o[m][a].value=o[m][a].process(v);else o[m][a].value=v;else o[m][a]=v};checkFont=function(o,a,v){var m;if(validObject(o)){if(starting)for(m in o)checkValue(o,a,m,v);else if("font"in o)checkValue(o,a,"font",v);starting=false;for(m in o)checkFont(o[m],a,v)}};for(fontAttr in user){fontAttrValue=user[fontAttr];if(fontAttr!=="secondary"){if(validObject(fontAttrValue))fontAttrValue=
fontAttrValue.value;if(fontAttrValue)checkFont(vars,fontAttr,fontAttrValue)}}}checkObject(vars,key,vars,key,user);if(typeof callback==="function")vars[key].callback=callback;if(vars[key].chainable===false)return vars[key].value;else return vars.self}};checkObject=function(vars,method,object,key,value){var approvedObject,d,objectOnly,passingObject;if(["accepted","changed","initialized","previous","process"].indexOf(key)<0){passingObject=validObject(value);objectOnly=validObject(object[key])&&"objectAccess"in
object[key]&&object[key]["objectAccess"]===false;approvedObject=passingObject&&(objectOnly||!("value"in value)&&(!validObject(object[key])||!(d3.keys(value)[0]in object[key])));if(value===null||!passingObject||approvedObject)setMethod(vars,method,object,key,value);else if(passingObject)for(d in value)checkObject(vars,method,object[key],d,value[d])}}},{"../../object/validate.coffee":171,"../../string/format.js":172,"../../util/copy.coffee":206,"../console/print.coffee":52,"./process/detect.coffee":87,
"./set.coffee":93}],80:[function(require,module,exports){module.exports=function(g){if(!g)g=false;return{accepted:[false,Array,Function,Number,Object,String],callback:{accepted:[false,Function],value:false},global:g,process:Array,value:[]}}},{}],81:[function(require,module,exports){var rtl;rtl=require("../../../client/rtl.coffee");module.exports=function(align){var accepted;accepted=["left","center","right"];if(align===false)accepted.unshift(false);if(accepted.indexOf(align)<0)align="left";return{accepted:accepted,
process:function(value){if(rtl)if(value==="left")return"right";else if(value==="right")return"left";else return value;else return value},value:align}}},{"../../../client/rtl.coffee":40}],82:[function(require,module,exports){module.exports=function(decoration){var accepted;accepted=["line-through","none","overline","underline"];if(decoration===false)accepted.unshift(false);if(accepted.indexOf(decoration)<0)decoration="none";return{accepted:accepted,value:decoration}}},{}],83:[function(require,module,
exports){var helvetica,validate;validate=require("../../../font/validate.coffee");helvetica=["Helvetica Neue","HelveticaNeue","Helvetica","Arial","sans-serif"];module.exports=function(family){if(family===void 0)family=helvetica;return{process:validate,value:family}}},{"../../../font/validate.coffee":102}],84:[function(require,module,exports){module.exports=function(position){var accepted;accepted=["top","middle","bottom"];if(position===false)accepted.unshift(false);if(accepted.indexOf(position)<0)position=
"bottom";return{accepted:accepted,mapping:{top:"0ex",middle:"0.5ex",bottom:"1ex"},process:function(value){this.text=value;return this.mapping[value]},value:position}}},{}],85:[function(require,module,exports){module.exports=function(transform){var accepted;accepted=["capitalize","lowercase","none","uppercase"];if(transform===false)accepted.unshift(false);if(accepted.indexOf(transform)<0)transform="none";return{accepted:accepted,value:transform}}},{}],86:[function(require,module,exports){module.exports=
function(value,vars,method){var elem;if(vars.history)vars.history.reset();if(value.constructor===String){if(value.indexOf("/")>=0){method.url=value;return[]}elem=d3.selectAll(value);if(elem.size())return elem;if(value.indexOf(".")>=0)method.url=value;return[]}else return value}},{}],87:[function(require,module,exports){var copy,update;copy=require("../../../util/copy.coffee");update=require("../../../array/update.coffee");module.exports=function(vars,object,value){if(object.process===Array)return update(copy(object.value),
value);else if(typeof object.process==="object"&&typeof value==="string")return object.process[value];else if(typeof object.process==="function")return object.process(value,vars,object);else return value}},{"../../../array/update.coffee":35,"../../../util/copy.coffee":206}],88:[function(require,module,exports){var stylesheet;stylesheet=require("../../../client/css.coffee");module.exports=function(value,vars,method){if(value===false||value.indexOf("fa-")<0||value.indexOf("fa-")===0&&stylesheet("font-awesome"))return value;
else return method.fallback}},{"../../../client/css.coffee":36}],89:[function(require,module,exports){module.exports=function(value,self){var i,j,k,l,len,len1,len2,len3,m,results,side,sides,v;if(typeof value==="string"){value=value.split(" ");for(i=j=0,len=value.length;j<len;i=++j){v=value[i];value[i]=parseFloat(v,10)}if(value.length===1)value=value[0];else if(value.length===2)value={top:value[0],right:value[1],bottom:value[0],left:value[1]};else if(value.length===3)value={top:value[0],right:value[1],
bottom:value[2],left:value[1]};else if(value.length===4)value={top:value[0],right:value[1],bottom:value[2],left:value[3]};else value=0}sides=["top","right","bottom","left"];if(typeof value==="number")for(k=0,len1=sides.length;k<len1;k++){side=sides[k];self[side]=value}else for(l=0,len2=sides.length;l<len2;l++){side=sides[l];self[side]=value[side]}self.css="";results=[];for(i=m=0,len3=sides.length;m<len3;i=++m){side=sides[i];if(i)self.css+=" ";results.push(self.css+=self[side]+"px")}return results}},
{}],90:[function(require,module,exports){var contains,format,list,print;contains=require("../../array/contains.coffee");format=require("../../string/format.js");list=require("../../string/list.coffee");print=require("../console/print.coffee");module.exports=function(vars,accepted,value,method,text){var a,allowed,app,i,len,recs,str,val;if(typeof accepted==="function")accepted=accepted(vars);if(!(accepted instanceof Array))accepted=[accepted];allowed=contains(accepted,value);if(allowed===false&&value!==
void 0){recs=[];val=JSON.stringify(value);if(typeof value!=="string")val='"'+val+'"';for(i=0,len=accepted.length;i<len;i++){a=accepted[i];if(typeof a==="string")recs.push('"'+a+'"');else if(typeof a==="function")recs.push(a.toString().split("()")[0].substring(9));else if(a===void 0)recs.push("undefined");else recs.push(JSON.stringify(a))}recs=list(recs,vars.format.locale.value.ui.or);if(vars.type&&["mode","shape"].indexOf(method)>=0){str=vars.format.locale.value.error.accepted;app=vars.format.locale.value.visualization[vars.type.value]||
vars.type.value;print.warning(format(str,val,method,app,recs),method)}else{str=vars.format.locale.value.dev.accepted;print.warning(format(str,val,text,recs),method)}}return!allowed}},{"../../array/contains.coffee":33,"../../string/format.js":172,"../../string/list.coffee":173,"../console/print.coffee":52}],91:[function(require,module,exports){module.exports=function(rendering){var accepted;accepted=["auto","optimizeSpeed","crispEdges","geometricPrecision"];if(!(accepted.indexOf(rendering)>=0))rendering=
"crispEdges";return{accepted:accepted,value:rendering}}},{}],92:[function(require,module,exports){var reset,validObject;validObject=require("../../object/validate.coffee");reset=function(obj,method){var o;if(obj.changed)obj.changed=false;if(method==="draw"){obj.frozen=false;obj.update=true;obj.first=false}for(o in obj)if(o.indexOf("d3plus")<0&&validObject(obj[o]))reset(obj[o],o)};module.exports=reset},{"../../object/validate.coffee":171}],93:[function(require,module,exports){var copy,d3selection,
mergeObject,print,process,rejected,stringFormat,updateArray,validObject;copy=require("../../util/copy.coffee");d3selection=require("../../util/d3selection.coffee");validObject=require("../../object/validate.coffee");mergeObject=require("../../object/merge.coffee");print=require("../console/print.coffee");process=require("./process/detect.coffee");rejected=require("./rejected.coffee");stringFormat=require("../../string/format.js");updateArray=require("../../array/update.coffee");module.exports=function(vars,
method,object,key,value){var accepted,c,callback,d3object,hasValue,id,k,longArray,n,parentKey,str,text,typeFunction,valString;if(key==="value"||!key||key===method)text="."+method+"()";else text='"'+key+'" '+vars.format.locale.value.dev.of+" ."+method+"()";if(key==="value"&&"accepted"in object)accepted=object.accepted;else if(validObject(object[key])&&"accepted"in object[key])accepted=object[key].accepted;else accepted=[value];if(!rejected(vars,accepted,value,method,text)){if(validObject(object[key])&&
"value"in object[key]){parentKey=key;object=object[key];key="value"}if(key==="value"&&"process"in object)value=process(vars,object,value);if(!(object[key]instanceof Array)&&object[key]===value&&value!==void 0){str=vars.format.locale.value.dev.noChange;if(vars.dev.value)print.comment(stringFormat(str,text))}else{object.changed=true;if(object.loaded)object.loaded=false;if("history"in vars&&method!=="draw"){c=copy(object);c.method=method;vars.history.chain.push(c)}object.previous=object[key];if("id"in
vars&&key==="value"&&"nesting"in object)if(method!=="id"){if(typeof object.nesting!=="object")object.nesting={};if(validObject(value)){for(id in value)if(typeof value[id]==="string")value[id]=[value[id]];object.nesting=mergeObject(object.nesting,value);if(!(vars.id.value in object.nesting))object.nesting[vars.id.value]=value[d3.keys(value)[0]]}else if(value instanceof Array)object.nesting[vars.id.value]=value;else object.nesting[vars.id.value]=[value];object[key]=object.nesting[vars.id.value][0]}else if(value instanceof
Array){object.nesting=value;if("depth"in vars&&vars.depth.value<value.length)object[key]=value[vars.depth.value];else{object[key]=value[0];if("depth"in vars)vars.depth.value=0}}else{object[key]=value;object.nesting=[value];if("depth"in vars)vars.depth.value=0}else if(method==="depth"){if(value>=vars.id.nesting.length)vars.depth.value=vars.id.nesting.length-1;else if(value<0)vars.depth.value=0;else vars.depth.value=value;vars.id.value=vars.id.nesting[vars.depth.value];if(typeof vars.text.nesting===
"object"){n=vars.text.nesting[vars.id.value];if(n){vars.text.nesting[vars.id.value]=typeof n==="string"?[n]:n;vars.text.value=n instanceof Array?n[0]:n}}}else if(validObject(object[key])&&validObject(value))object[key]=mergeObject(object[key],value);else object[key]=value;if(key==="value"&&object.global){hasValue=object[key].length>0;k=parentKey||key;if(k in vars&&(hasValue&&vars.data[k].indexOf(method)<0||!hasValue&&vars.data[k].indexOf(method)>=0))vars.data[k]=updateArray(vars.data[k],method)}if(key===
"value"&&object.dataFilter&&vars.data&&vars.data.filters.indexOf(method)<0)vars.data.filters.push(method);if(vars.dev.value&&object.changed&&object[key]!==void 0){longArray=object[key]instanceof Array&&object[key].length>10;d3object=d3selection(object[key]);typeFunction=typeof object[key]==="function";valString=!longArray&&!d3object&&!typeFunction?typeof object[key]==="string"?object[key]:JSON.stringify(object[key]):null;if(valString!==null&&valString.length<260){str=vars.format.locale.value.dev.setLong;
print.log(stringFormat(str,text,'"'+valString+'"'))}else{str=vars.format.locale.value.dev.set;print.log(stringFormat(str,text))}}}if(key==="value"&&object.callback&&!object.url){callback=typeof object.callback==="function"?object.callback:object.callback.value;if(callback)callback(value,vars.self)}}}},{"../../array/update.coffee":35,"../../object/merge.coffee":170,"../../object/validate.coffee":171,"../../string/format.js":172,"../../util/copy.coffee":206,"../../util/d3selection.coffee":207,"../console/print.coffee":52,
"./process/detect.coffee":87,"./rejected.coffee":90}],94:[function(require,module,exports){var print=require("../console/print.coffee"),stringFormat=require("../../string/format.js");module.exports=function(vars){if(vars.dev.value){var timerString="analyzing edges list";print.time(timerString)}var appReqs=vars.types[vars.type.value].requirements;if(!(appReqs instanceof Array))appReqs=[appReqs];var createNodes=appReqs.indexOf("nodes")>=0&&!vars.nodes.value;if(createNodes){vars.nodes.value=[];var placed=
[];vars.nodes.changed=true}vars.edges.value.forEach(function(e){["source","target"].forEach(function(dir){var dirType=typeof e[vars.edges[dir]];if(dirType!=="object")if(dirType==="number"&&!createNodes&&vars.data.keys[vars.id.value]!=="number")e[vars.edges[dir]]=vars.nodes.value[e[vars.edges[dir]]];else if(createNodes&&placed.indexOf(e[vars.edges[dir]])>=0)e[vars.edges[dir]]=vars.nodes.value.filter(function(n){return n[vars.id.value]===e[vars.edges[dir]]})[0];else{var obj={};obj[vars.id.value]=e[vars.edges[dir]];
e[vars.edges[dir]]=obj}var newNode=e[vars.edges[dir]];if(createNodes)if(placed.indexOf(newNode[vars.id.value])<0){placed.push(newNode[vars.id.value]);vars.nodes.value.push(newNode)}});if(!("keys"in vars.data))vars.data.keys={};if(!(vars.id.value in vars.data.keys))vars.data.keys[vars.id.value]=typeof e[vars.edges.source][vars.id.value]});vars.edges.value=vars.edges.value.filter(function(e){var source=e[vars.edges.source][vars.id.value],target=e[vars.edges.target][vars.id.value];if(source===target){var str=
vars.format.locale.value.dev.sameEdge;print.warning(stringFormat(str,'"'+source+'"'),"edges");return false}else return true});vars.edges.linked=true;if(vars.dev.value)print.timeEnd(timerString)}},{"../../string/format.js":172,"../console/print.coffee":52}],95:[function(require,module,exports){var hideElement=require("./hideElement.js");module.exports=function(vars){var attributes=[vars.color.value,vars.icon.value,vars.keywords.value,vars.alt.value,"style"];if(!vars.text.value)vars.self.text("text");
attributes=attributes.concat(vars.id.nesting);function get_attributes(obj,elem){[].forEach.call(elem.attributes,function(attr){if(/^data-/.test(attr.name)){var camelCaseName=attr.name.substr(5).replace(/-(.)/g,function($0,$1){return $1.toUpperCase()});obj[camelCaseName]=attr.value}});attributes.forEach(function(a){if(elem.getAttribute(a)!==null)obj[a]=elem.getAttribute(a)})}vars.self.data({"element":vars.data.value});var elementTag=vars.data.element.value.node().tagName.toLowerCase(),elementType=
vars.data.element.value.attr("type"),elementData=[];if(elementTag==="select"){var elementID=vars.data.element.value.node().id;if(elementID)vars.self.container({"id":elementID});vars.data.element.value.selectAll("option").each(function(o,i){var data_obj={};data_obj.text=d3.select(this).text();get_attributes(data_obj,this);elementData.push(data_obj);if(this.selected)for(var i=vars.id.nesting.length-1;i>=0;i--){var level=vars.id.nesting[i];if(level in data_obj){vars.self.focus(data_obj[level]);break}}})}else if(elementTag===
"input"&&elementType==="radio"){var elementName=vars.data.element.value.node().getAttribute("name");if(elementName)vars.self.container({"id":elementName});vars.data.element.value.each(function(o,i){var data_obj={};get_attributes(data_obj,this);var id=data_obj[vars.id.value]||this.id||false;if(id&&isNaN(parseFloat(id))){var label=d3.select("label[for="+id+"]");if(!label.empty()){data_obj.text=label.html();label.call(hideElement)}}elementData.push(data_obj);if(this.checked)vars.self.focus(data_obj[vars.id.value])})}if(!vars.focus.value.length&&
elementData.length){vars.data.element.value.node().selectedIndex=0;vars.self.focus(elementData[0][vars.id.value])}var elementLegend=d3.select("legend[for="+vars.container.id+"]");if(!elementLegend.empty()){vars.self.title(elementLegend.html());elementLegend.call(hideElement)}var containerTag=vars.container.value?vars.container.value.node().tagName.toLowerCase():false;if(vars.container.value===false||containerTag==="body")vars.container.value=d3.select(vars.data.element.value.node().parentNode);vars.data.element.value.call(hideElement);
return elementData}},{"./hideElement.js":96}],96:[function(require,module,exports){module.exports=function(elem){elem.style("position","absolute","important").style("clip","rect(1px 1px 1px 1px)","important").style("clip","rect(1px, 1px, 1px, 1px)","important").style("width","1px","important").style("height","1px","important").style("margin","-1px","important").style("padding","0","important").style("border","0","important").style("overflow","hidden","important")}},{}],97:[function(require,module,
exports){var print=require("../console/print.coffee");module.exports=function(vars){if(vars.type.value==="network"){if(vars.dev.value){var timerString="analyzing node positions";print.time(timerString)}var set=vars.nodes.value.filter(function(n){return typeof n.x==="number"&&typeof n.y==="number"}).length;if(set===vars.nodes.value.length)vars.nodes.positions=true;else{var force=d3.layout.force().size([vars.width.viz,vars.height.viz]).nodes(vars.nodes.value).links(vars.edges.value);var strength=vars.edges.strength.value;
if(strength)if(typeof strength==="string")force.linkStrength(function(e){return e[strength]});else force.linkStrength(strength);var iterations=50,threshold=.01;force.start();for(var i=iterations;i>0;--i){force.tick();if(force.alpha()<threshold)break}force.stop();vars.nodes.positions=true}if(vars.dev.value)print.timeEnd(timerString)}}},{"../console/print.coffee":52}],98:[function(require,module,exports){var numeric;numeric=require("numeric");module.exports=function(data,options){var N,X,Xfulltr,Xtr,
bestResult,beta_hat,bic,degree,degrees,i,j,k,l,loglike,m,point,prevBIC,q,ref,ref1,residual,sigma2,sse,y,y_hat;if(options==null)options={};if(options.maxDegree==null)options.maxDegree=5;N=data.length;prevBIC=Number.MAX_VALUE;bestResult=null;Xfulltr=function(){var l,ref,results;results=[];for(degree=l=1,ref=options.maxDegree+1;1<=ref?l<ref:l>ref;degree=1<=ref?++l:--l)results.push(function(){var len,m,results1;results1=[];for(m=0,len=data.length;m<len;m++){point=data[m];results1.push(Math.pow(point[0],
degree))}return results1}());return results}();y=function(){var l,len,results;results=[];for(l=0,len=data.length;l<len;l++){point=data[l];results.push(point[1])}return results}();for(i=l=0,ref=1<<options.maxDegree;0<=ref?l<ref:l>ref;i=0<=ref?++l:--l){Xtr=[function(){var m,ref1,results;results=[];for(q=m=0,ref1=N;0<=ref1?m<ref1:m>ref1;q=0<=ref1?++m:--m)results.push(1);return results}()];degrees=[0];for(j=m=0,ref1=options.maxDegree;0<=ref1?m<ref1:m>ref1;j=0<=ref1?++m:--m)if((i&1<<j)>0){Xtr.push(Xfulltr[j]);
degrees.push(j+1)}X=numeric.transpose(Xtr);k=degrees.length;beta_hat=numeric.dot(numeric.dot(numeric.inv(numeric.dot(Xtr,X)),Xtr),y);y_hat=numeric.dot(X,beta_hat);residual=numeric.sub(y,y_hat);sse=numeric.dot(residual,residual);sigma2=sse/(N-k);loglike=-.5*N*Math.log(2*Math.PI)-.5*N*Math.log(sigma2)-sse/(2*sigma2);bic=-2*loglike+k*(Math.log(N)-Math.log(2*Math.PI));if(bic<prevBIC){prevBIC=bic;bestResult=[degrees,beta_hat,y_hat]}}return bestResult}},{"numeric":7}],99:[function(require,module,exports){var kdtree;
kdtree=require("static-kdtree");module.exports=function(points,K){var avg_lrd,i,j,kdists,ldr,ldrs,neighbors,p,reachDist,result,sqDist,tree;if(K==null)K=10;tree=kdtree(points);neighbors=function(){var k,len,results;results=[];for(k=0,len=points.length;k<len;k++){p=points[k];results.push(tree.knn(p,K+1).slice(1))}return results}();sqDist=function(i,j){var A,B,delta,dist,k,ref;A=points[i];B=points[j];dist=0;for(i=k=0,ref=A.length;0<=ref?k<ref:k>ref;i=0<=ref?++k:--k){delta=A[i]-B[i];dist+=delta*delta}return dist};
kdists=function(){var k,ref,results;results=[];for(i=k=0,ref=points.length;0<=ref?k<ref:k>ref;i=0<=ref?++k:--k)results.push(sqDist(i,neighbors[i][K-1]));return results}();reachDist=function(i,j){return Math.max(sqDist(i,j),kdists[j])};ldr=function(i){var j,k,len,rDist,ref;rDist=0;ref=neighbors[i];for(k=0,len=ref.length;k<len;k++){j=ref[k];rDist+=reachDist(i,j)}return K/rDist};ldrs=function(){var k,ref,results;results=[];for(i=k=0,ref=points.length;0<=ref?k<ref:k>ref;i=0<=ref?++k:--k)results.push(ldr(i));
return results}();result=function(){var k,l,len,ref,ref1,results;results=[];for(i=k=0,ref=points.length;0<=ref?k<ref:k>ref;i=0<=ref?++k:--k){avg_lrd=0;ref1=neighbors[i];for(l=0,len=ref1.length;l<len;l++){j=ref1[l];avg_lrd+=ldrs[j]}avg_lrd/=K;results.push([i,avg_lrd/ldrs[i]])}return results}();return result.sort(function(a,b){return b[1]-a[1]})}},{"static-kdtree":9}],100:[function(require,module,exports){module.exports=function(points){var mad,median,result;median=d3.median(points);mad=d3.median(points.map(function(p){return Math.abs(p-
median)}));result=points.map(function(p,i){return[i,Math.abs(p-median)/mad]});return result.sort(function(a,b){return b[1]-a[1]})}},{}],101:[function(require,module,exports){var fontTester;fontTester=require("../core/font/tester.coffee");module.exports=function(words,style,opts){var attr,getHeight,getWidth,sizes,spacing,tester,tspans;if(!opts)opts={};style=style||{};tester=opts.parent||fontTester("svg").append("text");sizes=[];if(!(words instanceof Array))words=[words];tspans=tester.selectAll("tspan").data(words);
attr={left:"0px",position:"absolute",top:"0px",x:0,y:0};spacing=0;if("letter-spacing"in style){spacing=parseFloat(style["letter-spacing"]);delete style["letter-spacing"]}getWidth=function(elem){var add;add=0;if(spacing)add=(d3.select(elem).text().length-1)*spacing;return elem.getComputedTextLength()+add};getHeight=function(elem){return elem.parentNode.getBBox().height||elem.getBoundingClientRect().height};tspans.enter().append("tspan").text(String).style(style).attr(attr).each(function(d){if(typeof opts.mod===
"function")return opts.mod(this)}).each(function(d){var children,height,width;children=d3.select(this).selectAll("tspan");if(children.size()){width=[];children.each(function(){return width.push(getWidth(this))});width=d3.max(width)}else width=getWidth(this);height=getHeight(this);return sizes.push({height:height,text:d,width:width})});tspans.remove();if(!opts.parent)tester.remove();return sizes}},{"../core/font/tester.coffee":68}],102:[function(require,module,exports){var fontTester,validate;fontTester=
require("../core/font/tester.coffee");validate=function(fontList){var completed,family,font,fontString,i,j,len,len1,monospace,proportional,testElement,testWidth,tester,valid;if(!(fontList instanceof Array))fontList=fontList.split(",");for(i=0,len=fontList.length;i<len;i++){font=fontList[i];font.trim()}fontString=fontList.join(", ");completed=validate.complete;if(fontString in completed)return completed[fontString];testElement=function(font){return tester.append("span").style("font-family",font).style("font-size",
"32px").style("padding","0px").style("margin","0px").text("abcdefghiABCDEFGHI_!@#$%^&*()_+1234567890")};testWidth=function(font,control){var elem,width1,width2;elem=testElement(font);width1=elem.node().offsetWidth;width2=control.node().offsetWidth;elem.remove();return width1!==width2};tester=fontTester("div");monospace=testElement("monospace");proportional=testElement("sans-serif");for(j=0,len1=fontList.length;j<len1;j++){family=fontList[j];valid=testWidth(family+",monospace",monospace);if(!valid)valid=
testWidth(family+",sans-serif",proportional);if(valid){valid=family;break}}if(!valid)valid="sans-serif";monospace.remove();proportional.remove();completed[fontString]=valid;return valid};validate.complete={};module.exports=validate},{"../core/font/tester.coffee":68}],103:[function(require,module,exports){var arraySort=require("../array/sort.coffee"),attach=require("../core/methods/attach.coffee"),dataFormat=require("../core/data/format.js"),dataKeys=require("../core/data/keys.coffee"),dataLoad=require("../core/data/load.coffee"),
fetchData=require("../core/fetch/data.js"),ie=require("../client/ie.js"),methodReset=require("../core/methods/reset.coffee"),print=require("../core/console/print.coffee");module.exports=function(){var vars={"types":{"auto":require("./types/auto.js"),"button":require("./types/button/button.coffee"),"drop":require("./types/drop/drop.coffee"),"toggle":require("./types/toggle.js")}};vars.self=function(selection){var large=vars.data.value instanceof Array&&vars.data.value.length>vars.data.large;vars.draw.timing=
vars.draw.first||large||ie?0:vars.timing.ui;if(vars.data.value instanceof Array){if(vars.dev.value)print.group('drawing "'+vars.type.value+'"');if(vars.data.changed){vars.data.cache={};dataKeys(vars,"data");dataFormat(vars)}vars.data.viz=fetchData(vars);if(vars.data.sort.value&&(vars.data.changed||vars.order.changed||vars.order.sort.changed))arraySort(vars.data.viz,vars.order.value||vars.text.value,vars.order.sort.value,vars.color.value,vars);if(vars.focus.value===false&&["auto","button"].indexOf(vars.type.value)<
0){var element=vars.data.element.value;if(element&&element.node().tagName.toLowerCase()==="select"){var i=element.property("selectedIndex");i=i<0?0:i;var option=element.selectAll("option")[0][i],val=option.getAttribute("data-"+vars.id.value)||option.getAttribute(vars.id.value);if(val)vars.focus.value=val}if(vars.focus.value===false&&vars.data.viz.length)vars.focus.value=vars.data.viz[0][vars.id.value];if(vars.dev.value&&vars.focus.value!==false)print.log('"value" set to "'+vars.focus.value+'"')}var getLevel=
function(d,depth){depth=typeof depth!=="number"?vars.id.nesting.length===1?0:vars.id.nesting.length-1:depth;var level=vars.id.nesting[depth];if(depth>0&&(!(level in d)||d[level]instanceof Array))return getLevel(d,depth-1);else return level};if(vars.data.changed){if(vars.search.value==="auto")if(vars.data.viz.length>10){vars.search.enabled=true;if(vars.dev.value)print.log("Search enabled.")}else{vars.search.enabled=false;if(vars.dev.value)print.log("Search disabled.")}else vars.search.enabled=vars.search.value;
var elementTag=vars.data.element.value?vars.data.element.value.node().tagName.toLowerCase():"";if(vars.data.element.value&&elementTag==="select"){var optionData=[];for(var level in vars.data.nested.all)optionData=optionData.concat(vars.data.nested.all[level]);options=vars.data.element.value.selectAll("option").data(optionData,function(d){var level=d?getLevel(d):false;return d&&level in d?d[level]:false});options.exit().remove();options.enter().append("option");options.each(function(d){var level=getLevel(d),
textKey=level===vars.id.value?vars.text.value||vars.id.value:vars.text.nesting!==true&&level in vars.text.nesting?vars.text.nesting[level]:level;for(var k in d)if(typeof d[k]!=="object"){if(k===textKey)d3.select(this).html(d[k]);if(["alt","value"].indexOf(k)>=0)d3.select(this).attr(k,d[k]);else d3.select(this).attr("data-"+k,d[k])}if(d[level]===vars.focus.value)this.selected=true;else this.selected=false})}}else if(vars.focus.changed&&vars.data.element.value){var tag=vars.data.element.value.node().tagName.toLowerCase();
if(tag==="select")vars.data.element.value.selectAll("option").each(function(d){if(d[getLevel(d)]===vars.focus.value)this.selected=true;else this.selected=false});else{var tag=vars.data.element.value.attr("type").toLowerCase();if(tag==="radio")vars.data.element.value.each(function(d){if(this.value===vars.focus.value)this.checked=true;else this.checked=false})}}if(vars.type.value!=="auto"){if(!vars.container.ui){vars.container.ui=vars.container.value.selectAll("div#d3plus_"+vars.type.value+"_"+vars.container.id).data(["container"]);
var before=vars.data.element.value?vars.data.element.value[0][0]:null;if(before)if(before.id)before="#"+before.id;else{var id=before.getAttribute(vars.id.value)?vars.id.value:"data-"+vars.id.value;if(before.getAttribute(id))before="["+id+"="+before.getAttribute(id)+"]";else before=null}vars.container.ui.enter().insert("div",before).attr("id","d3plus_"+vars.type.value+"_"+vars.container.id).style("position","relative").style("overflow","visible").style("vertical-align","top")}vars.container.ui.style("display",
vars.ui.display.value);vars.container.ui.transition().duration(vars.draw.timing).style("margin",vars.ui.margin.css);var title=vars.container.ui.selectAll("div.d3plus_title").data(vars.title.value?[vars.title.value]:[]);title.enter().insert("div","#d3plus_"+vars.type.value+"_"+vars.container.id).attr("class","d3plus_title").style("display","inline-block");title.style("color",vars.font.color).style("font-family",vars.font.family.value).style("font-size",vars.font.size+"px").style("font-weight",vars.font.weight).style("padding",
vars.ui.padding.css).style("border-color","transparent").style("border-style","solid").style("border-width",vars.ui.border+"px").text(String).each(function(d){vars.margin.left=this.offsetWidth})}if(vars.data.value.length){var app=vars.format.locale.value.visualization[vars.type.value];if(vars.dev.value)print.time("drawing "+app);vars.types[vars.type.value](vars);if(vars.dev.value)print.timeEnd("drawing "+app)}else if(vars.data.url&&(!vars.data.loaded||vars.data.stream))dataLoad(vars,"data",vars.self.draw);
if(vars.dev.value)print.timeEnd("total draw time");methodReset(vars)}};attach(vars,{"active":require("./methods/active.coffee"),"alt":require("./methods/alt.coffee"),"color":require("./methods/color.coffee"),"config":require("./methods/config.coffee"),"container":require("./methods/container.coffee"),"data":require("./methods/data.js"),"depth":require("./methods/depth.coffee"),"dev":require("./methods/dev.coffee"),"draw":require("./methods/draw.js"),"focus":require("./methods/focus.coffee"),"font":require("./methods/font.coffee"),
"format":require("./methods/format.coffee"),"height":require("./methods/height.coffee"),"history":require("./methods/history.coffee"),"hover":require("./methods/hover.coffee"),"icon":require("./methods/icon.coffee"),"id":require("./methods/id.coffee"),"keywords":require("./methods/keywords.coffee"),"margin":require("./methods/margin.coffee"),"open":require("./methods/open.coffee"),"order":require("./methods/order.coffee"),"remove":require("./methods/remove.coffee"),"search":require("./methods/search.coffee"),
"select":require("./methods/select.coffee"),"selectAll":require("./methods/selectAll.coffee"),"text":require("./methods/text.coffee"),"timing":require("./methods/timing.coffee"),"title":require("./methods/title.coffee"),"type":require("./methods/type.coffee"),"ui":require("./methods/ui.coffee"),"width":require("./methods/width.coffee")});return vars.self}},{"../array/sort.coffee":34,"../client/ie.js":37,"../core/console/print.coffee":52,"../core/data/format.js":56,"../core/data/keys.coffee":58,"../core/data/load.coffee":59,
"../core/fetch/data.js":64,"../core/methods/attach.coffee":79,"../core/methods/reset.coffee":92,"./methods/active.coffee":104,"./methods/alt.coffee":105,"./methods/color.coffee":106,"./methods/config.coffee":107,"./methods/container.coffee":108,"./methods/data.js":109,"./methods/depth.coffee":110,"./methods/dev.coffee":111,"./methods/draw.js":112,"./methods/focus.coffee":113,"./methods/font.coffee":114,"./methods/format.coffee":115,"./methods/height.coffee":116,"./methods/history.coffee":117,"./methods/hover.coffee":118,
"./methods/icon.coffee":119,"./methods/id.coffee":120,"./methods/keywords.coffee":121,"./methods/margin.coffee":122,"./methods/open.coffee":123,"./methods/order.coffee":124,"./methods/remove.coffee":125,"./methods/search.coffee":126,"./methods/select.coffee":127,"./methods/selectAll.coffee":128,"./methods/text.coffee":129,"./methods/timing.coffee":130,"./methods/title.coffee":131,"./methods/type.coffee":132,"./methods/ui.coffee":133,"./methods/width.coffee":134,"./types/auto.js":135,"./types/button/button.coffee":136,
"./types/drop/drop.coffee":141,"./types/toggle.js":158}],104:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Array,Function,Number,String],value:false}},{"../../core/methods/filter.coffee":80}],105:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Array,Function,Object,String],mute:filter(true),solo:filter(true),value:"alt"}},{"../../core/methods/filter.coffee":80}],
106:[function(require,module,exports){module.exports={accepted:[String],value:"color"}},{}],107:[function(require,module,exports){module.exports={accepted:[Object],objectAccess:false,process:function(value,vars){var method,setting;for(method in value){setting=value[method];if(method in vars.self)vars.self[method](setting)}return value},value:{}}},{}],108:[function(require,module,exports){var d3selection;d3selection=require("../../util/d3selection.coffee");module.exports={accepted:[false,Array,Object,
String],element:false,id:"default",process:function(value){if(value===false)return d3.select("body");else if(d3selection(value))return value;else if(value instanceof Array)return d3.select(value[0][0]);else return d3.select(value)},value:d3.select("body")}},{"../../util/d3selection.coffee":207}],109:[function(require,module,exports){var d3selection=require("../../util/d3selection.coffee"),process=require("../../core/methods/process/data.coffee");module.exports={"accepted":[false,Array,Function,String],
"delimiter":{"accepted":[String],"value":"|"},"element":{"process":function(value,vars){var element=false;if(d3selection(value))element=value;else if(typeof value==="string"&&!d3.select(value).empty())element=d3.select(value);if(element)vars.self.container(d3.select(element.node().parentNode));return element},"value":false},"filetype":{"accepted":[false,"json","xml","html","csv","dsv","tsv","txt"],"value":false},"filters":[],"large":400,"mute":[],"process":function(value,vars){if(vars.container.id===
"default"&&value.length)vars.self.container({"id":"default"+value.length});return process(value,vars,this)},"solo":[],"sort":{"accepted":[Boolean],"value":false},"value":false}},{"../../core/methods/process/data.coffee":86,"../../util/d3selection.coffee":207}],110:[function(require,module,exports){module.exports={accepted:[Number],value:0}},{}],111:[function(require,module,exports){module.exports={accepted:[Boolean],value:false}},{}],112:[function(require,module,exports){var d3selection=require("../../util/d3selection.coffee"),
hideElement=require("../../core/parse/hideElement.js"),parseElement=require("../../core/parse/element.js"),print=require("../../core/console/print.coffee"),stringFormat=require("../../string/format.js");module.exports={"accepted":[undefined,Function],"first":true,"frozen":false,"process":function(value,vars){if(this.initialized===false){this.initialized=true;return value}if(vars.data.value&&(!(vars.data.value instanceof Array)||d3selection(vars.data.value)))vars.data.value=parseElement(vars);else if(vars.data.element.value)vars.data.element.value.call(hideElement);
if(value===undefined&&typeof this.value==="function")value=this.value;if(vars.container.value===false){var str=vars.format.locale.value.dev.setContainer;print.warning(str,"container")}else if(vars.container.value.empty()){var str=vars.format.locale.value.dev.noContainer;print.warning(stringFormat(str,'"'+vars.container.value+'"'),"container")}else{if(vars.dev.value)print.time("total draw time");vars.container.value.call(vars.self)}if(typeof value==="function"&&vars.history.chain.length){var changesObject=
{};changes.forEach(function(c){var method=c.method;delete c.method;changesObject[method]=c});value(changesObject);vars.history.chain=[]}return value},"update":true,"value":undefined}},{"../../core/console/print.coffee":52,"../../core/parse/element.js":95,"../../core/parse/hideElement.js":96,"../../string/format.js":172,"../../util/d3selection.coffee":207}],113:[function(require,module,exports){module.exports={accepted:[false,Number,String],deprecates:"highlight",process:function(value,vars){var d,
element,elementTag,elementType,i,j,k,len,len1,ref;element=vars.data.element.value;if(element&&["string","number"].indexOf(typeof value)>=0){elementTag=element.node().tagName.toLowerCase();elementType=element.attr("type");if(elementTag==="select"){ref=element.selectAll("option");for(i=j=0,len=ref.length;j<len;i=++j){d=ref[i];if(d&&d[vars.id.value]===value)element.node().selectedIndex=i}}else if(elementTag==="input"&&elementType==="radio")for(k=0,len1=element.length;k<len1;k++){d=element[k];this.checked=
d&&d[vars.id.value]===value}}return value},value:false}},{}],114:[function(require,module,exports){var align,decoration,family,transform;family=require("../../core/methods/font/family.coffee");align=require("../../core/methods/font/align.coffee");decoration=require("../../core/methods/font/decoration.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={align:align(),color:"#444444",decoration:decoration(),family:family(),secondary:{align:align(),color:"#444444",decoration:decoration(),
family:family(),size:12,spacing:0,transform:transform(),weight:200},size:12,spacing:0,transform:transform(),weight:200}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],115:[function(require,module,exports){var formatNumber,locale,mergeObject,titleCase;formatNumber=require("../../number/format.coffee");locale=require("../../core/locale/locale.coffee");mergeObject=require("../../object/merge.coffee");
titleCase=require("../../string/title.coffee");module.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:false,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(locale)},process:function(value){var defaultLocale,returnObject;defaultLocale="en_US";returnObject=locale[defaultLocale];if(value!==defaultLocale)returnObject=mergeObject(returnObject,locale[value]);this.language=value;return returnObject},value:"en_US"},number:{accepted:[false,
Function],value:false},process:function(value,vars){if(typeof value==="string")vars.self.format({locale:value});else if(typeof value==="function")return value;return this.value},text:{accepted:[false,Function],value:false},value:function(value,opts){var f,v,vars;if(!opts)opts={};vars=opts.vars||{};if(vars.time&&vars.time.value&&opts.key===vars.time.value){v=value.constructor===Date?value:new Date(value);return vars.data.time.format(v)}else if(typeof value==="number"){f=this.number.value||formatNumber;
return f(value,opts)}else if(typeof value==="string"){f=this.text.value||titleCase;return f(value,opts)}else return JSON.stringify(value)}}},{"../../core/locale/locale.coffee":78,"../../number/format.coffee":169,"../../object/merge.coffee":170,"../../string/title.coffee":175}],116:[function(require,module,exports){module.exports={accepted:[false,Number],max:600,secondary:false,value:false}},{}],117:[function(require,module,exports){module.exports={back:function(){if(this.states.length)return this.states.pop()()},
chain:[],reset:function(){var results;results=[];while(this.states.length)results.push(this.states.pop()());return results},states:[]}},{}],118:[function(require,module,exports){module.exports={accepted:[Boolean,Number,String],value:false}},{}],119:[function(require,module,exports){var process;process=require("../../core/methods/process/icon.coffee");module.exports={accepted:[false,Array,Function,Object,String],back:{accepted:[false,String],fallback:"&#x276e;",opacity:1,process:process,rotate:0,value:"fa-angle-left"},
button:{accepted:[false,String],fallback:false,opacity:1,process:process,rotate:0,value:false},drop:{accepted:[false,String],fallback:"&#x276f;",opacity:1,process:process,rotate:0,value:"fa-angle-down"},next:{accepted:[false,String],fallback:"&#x276f;",opacity:1,process:process,rotate:0,value:"fa-angle-right"},select:{accepted:[false,String],fallback:"&#x2713;",opacity:1,process:process,rotate:0,value:"fa-check"},style:{accepted:[Object,String],value:"default"},value:"icon"}},{"../../core/methods/process/icon.coffee":88}],
120:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[Array,String],dataFilter:true,mute:filter(true),nesting:["value"],solo:filter(true),value:"value"}},{"../../core/methods/filter.coffee":80}],121:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Array,Function,Object,String],mute:filter(true),solo:filter(true),value:"keywords"}},{"../../core/methods/filter.coffee":80}],
122:[function(require,module,exports){var process;process=require("../../core/methods/process/margin.coffee");module.exports={accepted:[Number,Object,String],process:function(value){var userValue;if(value===void 0)value=this.value;userValue=value;process(value,this);return userValue},value:0}},{"../../core/methods/process/margin.coffee":89}],123:[function(require,module,exports){module.exports={accepted:[Boolean],flipped:{accepted:[Boolean],value:false},value:false}},{}],124:[function(require,module,
exports){module.exports={accepted:[false,Function,String],sort:{accepted:["asc","desc"],deprecates:["sort"],value:"asc"},value:false}},{}],125:[function(require,module,exports){module.exports={accepted:void 0,process:function(value,vars){if(this.initialized)vars.container.value.remove()},value:void 0}},{}],126:[function(require,module,exports){module.exports={accepted:["auto",Boolean],process:function(value){if(typeof value==="Boolean")this.enabled=value;return value},term:"",value:"auto"}},{}],127:[function(require,
module,exports){module.exports={accepted:[String],chainable:false,process:function(value,vars){var container;container=vars.container.value;if(container&&value)return container.select(value);else return value},value:void 0}},{}],128:[function(require,module,exports){module.exports={accepted:[String],chainable:false,process:function(value,vars){var container;container=vars.container.value;if(container&&value)return container.selectAll(value);else return value},value:void 0}},{}],129:[function(require,
module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,String],nesting:true,mute:filter(true),solo:filter(true),secondary:{accepted:[false,String],nesting:true,value:false},value:false}},{"../../core/methods/filter.coffee":80}],130:[function(require,module,exports){module.exports={mouseevents:60,ui:200}},{}],131:[function(require,module,exports){var decoration,family,stringStrip,transform;decoration=require("../../core/methods/font/decoration.coffee");
family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");stringStrip=require("../../string/strip.js");module.exports={accepted:[false,Function,String],font:{align:"center",color:"#444444",decoration:decoration(),family:family(),size:16,transform:transform(),weight:400},link:false,process:function(value,vars){var id;if(vars.container.id.indexOf("default")===0&&value){id=stringStrip(value).toLowerCase();vars.self.container({id:id})}return value},
value:false}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../string/strip.js":174}],132:[function(require,module,exports){module.exports={accepted:function(vars){return d3.keys(vars.types)},value:"auto"}},{}],133:[function(require,module,exports){var align,decoration,family,margin,transform;family=require("../../core/methods/font/family.coffee");align=require("../../core/methods/font/align.coffee");decoration=
require("../../core/methods/font/decoration.coffee");margin=require("../../core/methods/process/margin.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={align:align("center"),border:1,color:{primary:{process:function(value,vars){var primary;primary=this.value;if(!vars.ui.color.secondary.value)vars.ui.color.secondary.value=d3.rgb(primary).darker(.75).toString();return value},value:"#ffffff"},secondary:{value:false}},display:{acceped:["block","inline-block"],value:"inline-block"},
font:{align:align("center"),color:"#444",decoration:decoration(),family:family(),size:11,transform:transform(),weight:200},margin:{process:function(value){var userValue;if(value===void 0)value=this.value;userValue=value;margin(value,this);return userValue},value:5},padding:{process:function(value){var userValue;if(value===void 0)value=this.value;userValue=value;margin(value,this);return userValue},value:5}}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,
"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../core/methods/process/margin.coffee":89}],134:[function(require,module,exports){module.exports={accepted:[false,Number],secondary:false,value:false}},{}],135:[function(require,module,exports){module.exports=function(vars){var dataLength=vars.data.value.length;if(dataLength===1)vars.self.type("button").draw();else if(dataLength<5)vars.self.type("toggle").draw();else vars.self.type("drop").draw()}},{}],136:[function(require,
module,exports){module.exports=function(vars){var button,checks,color,icons,mouseevents,print,style,updatedButtons;print=require("../../../core/console/print.coffee");color=require("./functions/color.coffee");icons=require("./functions/icons.js");mouseevents=require("./functions/mouseevents.coffee");style=require("./functions/style.js");button=vars.container.ui.selectAll("div.d3plus_node").data(vars.data.viz,function(d){return d[vars.id.value]});if(vars.dev.value)print.time("enter");button.enter().append("div").attr("class",
"d3plus_node").call(color,vars).call(style,vars).call(icons,vars).call(mouseevents,vars);if(vars.dev.value)print.timeEnd("enter");if(vars.draw.update||vars.draw.timing){if(vars.dev.value)print.time("ordering");button.order();if(vars.dev.value)print.timeEnd("ordering");updatedButtons=button}else{checks=[vars.focus.previous,vars.focus.value,vars.hover.previous,vars.hover.value].filter(function(c){return c});updatedButtons=button.filter(function(b){return checks.indexOf(b[vars.id.value])>=0})}if(vars.dev.value)print.time("update");
updatedButtons.classed("d3plus_button_active",function(d){return vars.focus.value===d[vars.id.value]});if(vars.draw.timing)updatedButtons.transition().duration(vars.draw.timing).call(color,vars).call(style,vars);else updatedButtons.call(color,vars).call(style,vars);updatedButtons.call(icons,vars).call(mouseevents,vars);if(vars.dev.value)print.timeEnd("update");return button.exit().remove()}},{"../../../core/console/print.coffee":52,"./functions/color.coffee":137,"./functions/icons.js":138,"./functions/mouseevents.coffee":139,
"./functions/style.js":140}],137:[function(require,module,exports){module.exports=function(elem,vars){var legible,lighter,textColor;legible=require("../../../../color/legible.coffee");lighter=require("../../../../color/lighter.coffee");textColor=require("../../../../color/text.coffee");return elem.style("background-color",function(d){var color;if(vars.focus.value===d[vars.id.value])color=vars.ui.color.secondary.value;else color=vars.ui.color.primary.value;if(vars.hover.value===d[vars.id.value])color=
d3.rgb(color).darker(.15).toString();return color}).style("color",function(d){var bg,color,image,opacity;if(vars.focus.value===d[vars.id.value])opacity=.75;else opacity=1;image=d[vars.icon.value]&&vars.data.viz.length<vars.data.large;if(!image&&d[vars.color.value])color=legible(d[vars.color.value]);else{if(vars.focus.value===d[vars.id.value])bg=vars.ui.color.secondary.value;else bg=vars.ui.color.primary.value;if(vars.hover.value===d[vars.id.value])bg=d3.rgb(bg).darker(.15).toString();color=textColor(bg)}color=
d3.rgb(color);return"rgba("+color.r+","+color.g+","+color.b+","+opacity+")"}).style("border-color",vars.ui.color.secondary.value)}},{"../../../../color/legible.coffee":44,"../../../../color/lighter.coffee":45,"../../../../color/text.coffee":50}],138:[function(require,module,exports){var prefix=require("../../../../client/prefix.coffee"),rtl=require("../../../../client/rtl.coffee");module.exports=function(elem,vars){var reversed=vars.font.align.value==="right"&&!rtl||rtl&&vars.font.align.value==="right";
elem.each(function(d,i){var children=["label"];if(d[vars.icon.value]&&vars.data.viz.length<=vars.data.large)children.push("icon");var iconGraphic=vars.icon.button.value;if(d[vars.id.value]===vars.focus.value&&vars.icon.select.value){iconGraphic=vars.icon.select.value;children.push("selected")}else if(iconGraphic&&d.d3plus.icon!==false)children.push("selected");var buffer=0;var items=d3.select(this).selectAll("div.d3plus_button_element").data(children,function(c){return c});items.enter().append("div").style("display",
function(c){return c==="label"?"block":"absolute"});items.order().attr("class",function(c){var extra="";if(c==="selected"&&iconGraphic.indexOf("fa-")===0)extra=" fa "+iconGraphic;return"d3plus_button_element d3plus_button_"+c+extra}).html(function(c){if(c==="label"){var k=vars.text.value&&vars.text.value in d&&!(d[vars.text.value]instanceof Array)?vars.text.value:vars.id.value;return vars.format.value(d[k])}return c==="selected"&&iconGraphic.indexOf("fa-")<0?iconGraphic:""}).style("background-image",
function(c){if(c==="icon")return"url('"+d[vars.icon.value]+"')";return"none"}).style("background-color",function(c){if(c==="icon"&&d.style==="knockout")return d[vars.color.value]||vars.ui.color.primary.value;return"transparent"}).style("background-size","100%").style("text-align",function(c){return c==="label"?vars.font.align.value:"center"}).style("position",function(c){return c=="label"?"static":"absolute"}).style("width",function(c){if(c==="label")return"auto";if(vars.height.value)buffer=vars.height.value-
(vars.ui.padding.top+vars.ui.padding.bottom)-vars.ui.border*2;else buffer=vars.font.size+vars.ui.border;return buffer+"px"}).style("height",function(c){if(c==="icon")return buffer+"px";return"auto"}).style("margin-top",function(c){if(c==="label")return"0px";if(this.offsetHeight||this.getBoundingClientRect().height)var h=this.offsetHeight||this.getBoundingClientRect().height;else if(c==="selected")var h=vars.font.size;else var h=buffer;return-h/2+"px"}).style("top",function(c){return c==="label"?"auto":
"50%"}).style("left",function(c){if(c==="icon"&&!reversed||c==="selected"&&reversed)return vars.ui.padding.left+"px";return"auto"}).style("right",function(c){if(c==="icon"&&reversed||c==="selected"&&!reversed)return vars.ui.padding.right+"px";return"auto"}).style(prefix()+"transition",function(c){return c==="selected"?vars.draw.timing/1E3+"s":"none"}).style(prefix()+"transform",function(c){var degree=c==="selected"?vars.icon.select.rotate:"none";return typeof degree==="string"?degree:"rotate("+degree+
"deg)"}).style("opacity",function(c){return c==="selected"?vars.icon.select.opacity:1});items.exit().remove();var text=d3.select(this).selectAll(".d3plus_button_label");if(buffer>0){var p=vars.ui.padding;if(children.length===3)p=p.top+"px "+(p.right*2+buffer)+"px "+p.bottom+"px "+(p.left*2+buffer)+"px";else if(children.indexOf("icon")>=0&&!rtl||children.indexOf("selected")>=0&&rtl)p=p.top+"px "+p.right+"px "+p.bottom+"px "+(p.left*2+buffer)+"px";else p=p.top+"px "+(p.right*2+buffer)+"px "+p.bottom+
"px "+p.left+"px";text.style("padding",p)}else text.style("padding",vars.ui.padding.css);if(typeof vars.width.value==="number"){var width=vars.width.value;width-=parseFloat(text.style("padding-left"),10);width-=parseFloat(text.style("padding-right"),10);width-=vars.ui.border*2;width+="px"}else var width="auto";text.style("width",width)})}},{"../../../../client/prefix.coffee":39,"../../../../client/rtl.coffee":40}],139:[function(require,module,exports){module.exports=function(elem,vars,color){var events,
ie;color=require("./color.coffee");events=require("../../../../client/pointer.coffee");ie=require("../../../../client/ie.js");return elem.on(events.over,function(d,i){vars.self.hover(d[vars.id.value]);if(ie||!vars.draw.timing)return d3.select(this).style("cursor","pointer").call(color,vars);else return d3.select(this).style("cursor","pointer").transition().duration(vars.timing.mouseevents).call(color,vars)}).on(events.out,function(d){vars.self.hover(false);if(ie||!vars.draw.timing)return d3.select(this).style("cursor",
"auto").call(color,vars);else return d3.select(this).style("cursor","auto").transition().duration(vars.timing.mouseevents).call(color,vars)}).on(events.click,function(d){if(vars.focus.value!==false)return vars.self.focus(d[vars.id.value]).draw();else if(vars.focus.callback)return vars.focus.callback(d,vars.self)})}},{"../../../../client/ie.js":37,"../../../../client/pointer.coffee":38,"./color.coffee":137}],140:[function(require,module,exports){module.exports=function(elem,vars){elem.style("position",
"relative").style("margin",vars.ui.margin.css).style("display",vars.ui.display.value).style("border-style","solid").style("border-width",vars.ui.border+"px").style("font-family",vars.font.family.value).style("font-size",vars.font.size+"px").style("font-weight",vars.font.weight).style("letter-spacing",vars.font.spacing+"px")}},{}],141:[function(require,module,exports){module.exports=function(vars){var button,data,element,keyboard,list,search,selector,title,update,width,windowevent;element=require("./functions/element.coffee");
keyboard=require("./functions/keyboard.coffee");windowevent=require("./functions/window.js");width=require("./functions/width.js");button=require("./functions/button.js");selector=require("./functions/selector.js");title=require("./functions/title.js");search=require("./functions/search.js");list=require("./functions/list.js");data=require("./functions/data.js");update=require("./functions/update.js");vars.margin.top=0;vars.margin.title=0;element(vars);keyboard(vars);windowevent(vars);width(vars);
button(vars);selector(vars);title(vars);search(vars);list(vars);data(vars);return update(vars)}},{"./functions/button.js":144,"./functions/data.js":145,"./functions/element.coffee":146,"./functions/keyboard.coffee":149,"./functions/list.js":150,"./functions/search.js":152,"./functions/selector.js":153,"./functions/title.js":154,"./functions/update.js":155,"./functions/width.js":156,"./functions/window.js":157}],142:[function(require,module,exports){module.exports=function(vars,value,active){var ret=
[],active=active||vars.active.value;if(active instanceof Array)for(var i=0;i<active.length;i++)ret.push(this(vars,value,active[i]));else{var t=typeof active;if(t==="number")ret.push(vars.depth.value===active);else if(t==="function")ret.push(active(value));else ret.push(value===active)}return ret.indexOf(true)>=0}},{}],143:[function(require,module,exports){var print=require("../../../../core/console/print.coffee");module.exports=function(vars){if(vars.dev.value)print.time("rotating arrow");var offset=
vars.icon.drop.value==="&#x276f;"?90:0;if(vars.open.value!=vars.open.flipped.value)var rotate=180+offset;else var rotate=offset;vars.container.button.icon({"select":{"opacity":vars.open.value?.5:1,"rotate":rotate}}).draw();if(vars.dev.value)print.timeEnd("rotating arrow")}},{"../../../../core/console/print.coffee":52}],144:[function(require,module,exports){var copy=require("../../../../util/copy.coffee"),events=require("../../../../client/pointer.coffee"),form=require("../../../form.js"),print=require("../../../../core/console/print.coffee");
module.exports=function(vars){if(!("button"in vars.container)){if(vars.dev.value)print.time("creating main button");vars.container.button=form().container(vars.container.ui).type("button").ui({"margin":0});if(vars.dev.value)print.timeEnd("creating main button")}if(vars.focus.changed||vars.data.changed||vars.depth.changed){var depth=vars.depth.value;var buttonData=copy(vars.data.value.filter(function(d){var match=false;for(var i=0;i<vars.id.nesting.length;i++){var level=vars.id.nesting[i];match=level in
d&&d[level]===vars.focus.value;if(match){depth=i;break}}return match})[0]);if(!buttonData)buttonData=vars.container.button.data()[0]||vars.data.viz[0];vars.container.button.data([buttonData]).id(vars.id.nesting).depth(depth)}var hover=vars.hover.value===true?vars.focus.value:false;vars.container.button.draw({"update":vars.draw.update}).focus("").font(vars.font).format(vars.format).hover(hover).icon({"button":vars.icon.drop.value,"select":vars.icon.drop.value,"value":vars.icon.value}).text(vars.text.value).timing({"ui":vars.draw.timing}).ui({"border":vars.ui.border,
"color":vars.ui.color,"padding":vars.ui.padding.css}).width(vars.width.value).draw();var button=vars.container.button.container(Object).ui;vars.margin.top+=button.node().offsetHeight||button.node().getBoundingClientRect().height;button.on(events.click,function(){vars.self.open(!vars.open.value).draw()})}},{"../../../../client/pointer.coffee":38,"../../../../core/console/print.coffee":52,"../../../../util/copy.coffee":206,"../../../form.js":103}],145:[function(require,module,exports){var stringFormat=
require("../../../../string/format.js"),stringStrip=require("../../../../string/strip.js");module.exports=function(vars){if(vars.data.url&&!vars.data.loaded){var loadingObject={};loadingObject[vars.text.value||vars.id.value]=vars.format.value(vars.format.locale.value.ui.loading);vars.data.filtered=[loadingObject];vars.data.changed=vars.data.lastFilter!=="loading";vars.data.lastFilter="loading"}else if(vars.open.value)if(!vars.search.term){vars.data.filtered=vars.data.viz;vars.data.changed=vars.data.lastFilter!==
"viz";vars.data.lastFilter="viz";if(vars.id.nesting.length>1&&vars.depth.value<vars.id.nesting.length-1){vars.data.filtered=vars.data.filtered.filter(function(d){if("endPoint"in d.d3plus&&d.d3plus.endPoint===vars.depth.value)d.d3plus.icon=false;return true});vars.data.changed=vars.data.lastFilter!=="depth";vars.data.lastFilter="depth"}}else{var searchWords=stringStrip(vars.search.term).split("_"),searchKeys=[vars.id.value,vars.text.value,vars.alt.value,vars.keywords.value];searchKeys=searchKeys.filter(function(t){return t});
searchWords=searchWords.filter(function(t){return t!==""});var startMatches=[],exactMatches=[],softMatches=[],searchData=[];vars.id.nesting.forEach(function(n){searchData=searchData.concat(vars.data.nested.all[n])});searchData.forEach(function(d){var match=false;searchKeys.forEach(function(key){if(!match&&key in d&&typeof d[key]==="string"){var text=d[key].toLowerCase();if([vars.text.value,vars.id.value].indexOf(key)>=0&&text.indexOf(vars.search.term)===0){startMatches.push(d);match=true}else if(text.indexOf(vars.search.term)>=
0){exactMatches.push(d);match=true}else{var texts=stringStrip(text).split("_");for(var t in texts)if(!match)for(var s in searchWords){if(texts[t].indexOf(searchWords[s])===0){softMatches.push(d);match=true;break}}else break}}})});vars.data.filtered=d3.merge([startMatches,exactMatches,softMatches]);vars.data.filtered.forEach(function(d,i){d.d3plus_order=i});vars.data.changed=true;vars.data.lastFilter="search";if(vars.data.filtered.length===0){var noData={},str=vars.format.value(vars.format.locale.value.ui.noResults);
noData[vars.text.value||vars.id.value]=stringFormat(str,'"'+vars.search.term+'"');vars.data.filtered=[noData]}}else vars.data.filtered=[]}},{"../../../../string/format.js":172,"../../../../string/strip.js":174}],146:[function(require,module,exports){module.exports=function(vars){if(vars.data.element.value){vars.data.element.value.on("focus."+vars.container.id,function(){return vars.self.hover(true).draw()});vars.data.element.value.on("blur."+vars.container.id,function(){var search;if(vars.search.enabled)search=
d3.event.relatedTarget!==vars.container.value.select("input").node();else search=true;if(search)return vars.self.open(false).hover(false).draw()});vars.data.element.value.on("change."+vars.container.id,function(){return vars.self.focus(this.value).draw()});return vars.data.element.value.on("keydown.cancel_"+vars.container.id,function(){if(d3.event.keyCode!==9)return d3.event.preventDefault()})}}},{}],147:[function(require,module,exports){module.exports=function(vars){var height=vars.height.secondary,
button=vars.container.button.container().node().getBoundingClientRect(),available=window.innerHeight-button.bottom-vars.ui.border*2-vars.ui.margin.top-vars.ui.margin.bottom-vars.ui.padding.top-vars.ui.padding.bottom;if(available<button.height*3){available=button.top-10;vars.self.open({"flipped":true})}if(typeof height!=="number")height=available;if(height>vars.height.max)height=vars.height.max;vars.self.height({"secondary":height})}},{}],148:[function(require,module,exports){var active,copy,form,
print;active=require("./active.js");copy=require("../../../../util/copy.coffee");form=require("../../../form.js");print=require("../../../../core/console/print.coffee");module.exports=function(vars){var deepest,large,order;if(vars.open.value){if(vars.dev.value)print.time("updating list items");if(!("items"in vars.container))vars.container.items=form().container(vars.container.list).type("button").ui({border:0,display:"block",margin:0}).width(false);large=vars.draw.timing?vars.data.large:1;order=copy(vars.order);
order.value=vars.search.term.length?"d3plus_order":vars.order.value;deepest=vars.depth.value===vars.id.nesting.length-1;if(vars.focus.changed||vars.container.items.focus()===false)vars.container.items.focus(vars.focus.value,function(value){var change,data,depth,solo;data=vars.data.filtered.filter(function(f){return f[vars.id.value]===value})[0];if(vars.depth.value<vars.id.nesting.length-1&&vars.id.nesting[vars.depth.value+1]in data){depth=vars.depth.value;solo=vars.id.solo.value;vars.history.states.push(function(){return vars.self.depth(depth).id({solo:solo}).draw()});
vars.self.depth(vars.depth.value+1).id({solo:[value]}).draw()}else{if(!vars.depth.changed)vars.self.open(false);change=value!==vars.focus.value;if(change&&vars.active.value)change=active(vars,value);if(change)vars.self.focus(value).draw()}});vars.container.items.active(vars.active.value).data({large:large,sort:vars.data.sort.value,value:vars.data.filtered}).draw({update:vars.draw.update}).font(vars.font.secondary).format(vars.format).hover(vars.hover.value).id(vars.id.value).icon({button:deepest?
false:vars.icon.next,select:deepest?vars.icon.select:false,value:vars.icon.value}).order(order).text(vars.text.secondary.value||vars.text.value).timing({ui:vars.draw.timing}).ui({color:{primary:vars.id.nesting.length===1?vars.ui.color.primary.value:vars.ui.color.secondary.value,secondary:vars.ui.color.secondary.value},padding:vars.ui.padding.css}).draw();if(vars.dev.value)print.timeEnd("updating list items")}}},{"../../../../core/console/print.coffee":52,"../../../../util/copy.coffee":206,"../../../form.js":103,
"./active.js":142}],149:[function(require,module,exports){module.exports=function(vars){return d3.select(window).on("keydown."+vars.container.id,function(){var d,data,depth,hist,hover,i,index,j,key,len,matchKey,ref,solo;key=d3.event.keyCode;if(vars.open.value||vars.hover.value===true){matchKey=vars.hover.value===true?"focus":"hover";index=false;ref=vars.data.filtered;for(i=j=0,len=ref.length;j<len;i=++j){d=ref[i];if(d[vars.id.value]===vars[matchKey].value){index=i;break}}if(key===9&&vars.open.value&&
(!vars.search.enabled||vars.search.enabled&&!d3.event.shiftKey))return vars.self.open(false).hover(false).draw();else if([38,40].indexOf(key)>=0){if(index===false)index=0;else if(key===38){if(vars.open.value)if(index<=0)index=vars.data.filtered.length-1;else index-=1}else if(key===40)if(vars.open.value)if(index>=vars.data.filtered.length-1)index=0;else index+=1;if(typeof vars.hover.value!=="boolean")hover=vars.data.filtered[index][vars.id.value];else hover=vars.focus.value;return vars.self.hover(hover).open(true).draw()}else if(key===
13)if(typeof vars.hover.value!=="boolean"){data=vars.data.filtered.filter(function(f){return f[vars.id.value]===vars.hover.value})[0];depth=vars.depth.value;if(depth<vars.id.nesting.length-1&&vars.id.nesting[depth+1]in data){solo=vars.id.solo.value;hist=function(){return vars.self.depth(depth).id({solo:solo}).draw()};vars.history.states.push(hist);return vars.self.depth(vars.depth.value+1).id({solo:[vars.hover.value]}).draw()}else return vars.self.focus(vars.hover.value).hover(true).draw()}else return vars.self.hover(vars.focus.value).open(true).draw();
else if(key===27)if(vars.open.value)return vars.self.open(false).hover(true).draw();else if(vars.hover.value===true)return vars.self.hover(false).draw()}})}},{}],150:[function(require,module,exports){var print=require("../../../../core/console/print.coffee");module.exports=function(vars){if(vars.dev.value)print.time("populating list");vars.container.list=vars.container.selector.selectAll("div.d3plus_drop_list").data(["list"]);vars.container.list.enter().append("div").attr("class","d3plus_drop_list").attr("id",
"d3plus_drop_list_"+vars.container.id).style("overflow-y","auto").style("overflow-x","hidden");if(vars.dev.value)print.timeEnd("populating list")}},{"../../../../core/console/print.coffee":52}],151:[function(require,module,exports){var print=require("../../../../core/console/print.coffee");module.exports=function(vars){if(vars.open.value){if(vars.dev.value)print.time("calculating height");var hidden=false;if(vars.container.selector.style("display")=="none")var hidden=true;if(hidden)vars.container.selector.style("display",
"block");var old_height=vars.container.selector.style("height"),old_scroll=vars.container.selector.property("scrollTop"),list_height=vars.container.list.style("max-height"),list_scroll=vars.container.list.property("scrollTop");vars.container.selector.style("height","auto");vars.container.list.style("max-height","200000px");vars.container.listHeight=parseFloat(vars.container.selector.style("height"),10);vars.container.list.style("max-height",list_height).property("scrollTop",list_scroll);vars.container.selector.style("height",
old_height).property("scrollTop",old_scroll);var scrolling=false;if(vars.container.listHeight>vars.height.secondary){vars.container.listHeight=vars.height.secondary;scrolling=true}if(hidden)vars.container.selector.style("display","none");if(vars.dev.value)print.timeEnd("calculating height");if(scrolling){if(vars.dev.value)print.time("calculating scroll position");var options=vars.container.list.select("div").selectAll("div.d3plus_node");var option=options[0][0];var matchID=typeof vars.hover.value!==
"boolean"?vars.hover.value:vars.focus.value;options.each(function(d,i){if(d[vars.id.value]===matchID)option=this});var hidden=false;if(vars.container.selector.style("display")==="none"){hidden=true;vars.container.selector.style("display","block")}var button_top=option.offsetTop,button_height=option.offsetHeight||option.getBoundingClientRect().height,list_top=vars.container.list.property("scrollTop");if(hidden)vars.container.selector.style("display","none");if(hidden||vars.data.changed||vars.depth.changed)vars.container.listScroll=
button_top;else{vars.container.listScroll=list_top;if(button_top<list_top)vars.container.listScroll=button_top;else if(button_top+button_height>list_top+vars.height.secondary-vars.search.height)vars.container.listScroll=button_top-(vars.height.secondary-button_height-vars.search.height)}if(vars.dev.value)print.timeEnd("calculating scroll position")}else vars.container.listScroll=0}else{vars.container.listScroll=vars.container.list.property("scrollTop");vars.container.listHeight=0}}},{"../../../../core/console/print.coffee":52}],
152:[function(require,module,exports){var prefix=require("../../../../client/prefix.coffee"),print=require("../../../../core/console/print.coffee");module.exports=function(vars){if(vars.dev.value)print.time("creating search");var data=require("./data.js"),items=require("./items.coffee"),update=require("./update.js");vars.container.search=vars.container.selector.selectAll("div.d3plus_drop_search").data(vars.search.enabled?["search"]:[]);function searchStyle(elem){elem.style("padding",vars.ui.padding.css).style("display",
"block").style("background-color",d3.rgb(vars.ui.color.primary.value).darker(.15).toString())}function inputStyle(elem){var width=vars.width.secondary-vars.ui.padding.left*2-vars.ui.padding.right*2+vars.ui.border*2;elem.style("padding",vars.ui.padding.left/2+vars.ui.padding.right/2+"px").style("width",width+"px").style("border-width","0px").style("font-family",vars.font.secondary.family.value).style("font-size",vars.font.secondary.size+"px").style("font-weight",vars.font.secondary.weight).style("text-align",
vars.font.secondary.align).style("outline","none").style(prefix()+"border-radius","0").attr("placeholder",vars.format.value(vars.format.locale.value.method.search))}if(vars.draw.timing){vars.container.search.transition().duration(vars.draw.timing).call(searchStyle);vars.container.search.select("input").transition().duration(vars.draw.timing).call(inputStyle)}else{vars.container.search.call(searchStyle);vars.container.search.select("input").call(inputStyle)}vars.container.search.enter().insert("div",
"#d3plus_drop_list_"+vars.container.id).attr("class","d3plus_drop_search").attr("id","d3plus_drop_search_"+vars.container.id).call(searchStyle).append("input").attr("id","d3plus_drop_input_"+vars.container.id).style("-webkit-appearance","none").call(inputStyle);vars.container.search.select("input").on("keyup."+vars.container.id,function(d){var term=this.value;if(vars.search.term!==term){vars.search.term=term;data(vars);items(vars);update(vars)}});vars.container.search.exit().remove();var oldDisplay=
vars.container.selector.style("display");vars.container.selector.style("display","block");vars.search.height=vars.search.enabled?vars.container.search.node().offsetHeight||vars.container.search.node().getBoundingClientRect().height:0;vars.container.selector.style("display",oldDisplay);if(vars.search.enabled)vars.margin.title+=vars.search.height;if(vars.dev.value)print.timeEnd("creating search")}},{"../../../../client/prefix.coffee":39,"../../../../core/console/print.coffee":52,"./data.js":145,"./items.coffee":148,
"./update.js":155}],153:[function(require,module,exports){module.exports=function(vars){vars.container.selector=vars.container.ui.selectAll("div.d3plus_drop_selector").data(["selector"]);vars.container.selector.enter().append("div").attr("class","d3plus_drop_selector").style("position","absolute").style("top","0px").style("z-index","-1").style("overflow","hidden");vars.container.selector.style("padding",vars.ui.border+"px")}},{}],154:[function(require,module,exports){var events=require("../../../../client/pointer.coffee"),
lighter=require("../../../../color/lighter.coffee"),print=require("../../../../core/console/print.coffee"),textColor=require("../../../../color/text.coffee");module.exports=function(vars){if(vars.open.value){if(vars.dev.value)print.time("creating title and back button");var self=this,enabled=vars.id.solo.value.length===1&&vars.depth.value>0,title=enabled,focus=vars.container.button.data(Object).viz[0];title=true;for(var i=0;i<vars.id.nesting.length;i++){var level=vars.id.nesting[i];if(level in focus&&
focus[level]===vars.focus.value){title=false;break}}vars.container.title=vars.container.selector.selectAll("div.d3plus_drop_title").data(enabled?["title"]:[]);function boxStyle(elem){elem.style("padding",vars.ui.padding.css).style("display","block").style("background-color",vars.ui.color.secondary.value).style("font-family",vars.font.secondary.family.value).style("font-size",vars.font.secondary.size+"px").style("font-weight",vars.font.secondary.weight).style("text-align",vars.font.secondary.align).style("color",
textColor(vars.ui.color.secondary.value))}function backStyle(elem){if(!elem.empty()){var className=vars.icon.back.value.indexOf("fa-")===0?" fa "+vars.icon.back.value:"";className="d3plus_drop_back"+className;var text=vars.icon.back.value.indexOf("fa-")===0?"":vars.icon.back.value;elem.style("position","absolute").attr("class",className).style("top",vars.ui.padding.top+vars.font.secondary.size/2/2.5+"px").html(text)}}function titleStyle(elem){var text=title?vars.focus.value:vars.format.locale.value.ui.back;
elem.text(vars.format.value(text)).style("padding","0px "+(vars.ui.padding.left+vars.ui.padding.right)+"px")}if(vars.draw.timing){vars.container.title.transition().duration(vars.draw.timing).call(boxStyle);vars.container.title.select("div.d3plus_drop_title_text").transition().duration(vars.draw.timing).call(titleStyle)}else{vars.container.title.call(boxStyle);vars.container.title.select("div.d3plus_drop_title_text").call(titleStyle)}vars.container.title.select("span.d3plus_drop_back").call(backStyle);
var enter=vars.container.title.enter().insert("div","#d3plus_drop_list_"+vars.container.id).attr("class","d3plus_drop_title").attr("id","d3plus_drop_title_"+vars.container.id).call(boxStyle);enter.append("span").attr("id","d3plus_drop_back_"+vars.container.id).attr("class","d3plus_drop_back").call(backStyle);enter.append("div").attr("id","d3plus_drop_title_text_"+vars.container.id).attr("class","d3plus_drop_title_text").call(titleStyle);vars.container.title.on(events.over,function(d,i){var color=
lighter(vars.ui.color.secondary.value);d3.select(this).style("cursor","pointer").transition().duration(vars.timing.mouseevents).style("background-color",color).style("color",textColor(color))}).on(events.out,function(d){var color=vars.ui.color.secondary.value;d3.select(this).style("cursor","auto").transition().duration(vars.timing.mouseevents).style("background-color",color).style("color",textColor(color))}).on(events.click,function(d){vars.history.back()});vars.container.title.exit().remove();if(enabled)vars.margin.title+=
vars.container.title.node().offsetHeight||vars.container.title.node().getBoundingClientRect().height;if(vars.dev.value)print.timeEnd("creating title and back button")}}},{"../../../../client/pointer.coffee":38,"../../../../color/lighter.coffee":45,"../../../../color/text.coffee":50,"../../../../core/console/print.coffee":52}],155:[function(require,module,exports){var items=require("./items.coffee"),height=require("./height.js"),print=require("../../../../core/console/print.coffee"),scrolllist=require("./scroll.js"),
arrow=require("./arrow.js");module.exports=function(vars){if(vars.draw.timing)vars.container.ui.transition().duration(vars.draw.timing).each("start",function(){if(vars.open.value)d3.select(this).style("z-index",9999)}).style("margin",vars.ui.margin.css).each("end",function(){if(!vars.open.value)d3.select(this).style("z-index","auto")});else vars.container.ui.style("margin",vars.ui.margin.css).style("z-index",function(){if(vars.open.value)return 9999;else return"auto"});items(vars);height(vars);scrolllist(vars);
arrow(vars);if(vars.dev.value)print.time("drawing list");function position(elem){var flipped=vars.open.flipped.value;elem.style("top",function(){return flipped?"auto":vars.margin.top-vars.ui.border+"px"}).style("bottom",function(){return flipped?vars.margin.top+vars.ui.border+"px":"auto"})}function update(elem){elem.style("left",function(){if(vars.font.align.value==="left")return vars.margin.left+"px";else if(vars.font.align.value==="center")return vars.margin.left-(vars.width.secondary-vars.width.value)/
2+"px";else return"auto"}).style("right",function(){return vars.font.align.value==="right"?"0px":"auto"}).style("height",vars.container.listHeight+"px").style("padding",vars.ui.border+"px").style("background-color",vars.ui.color.secondary.value).style("z-index",function(){return vars.open.value?"9999":"-1"}).style("width",vars.width.secondary-vars.ui.border*2+"px").style("opacity",vars.open.value?1:0).call(position)}function finish(elem){elem.style("display",vars.open.value?null:"none").call(position);
if(vars.search.enabled&&vars.open.value)vars.container.selector.select("div.d3plus_drop_search input").node().focus()}var max_height=vars.open.value?vars.height.secondary-vars.margin.title:0;if(!vars.draw.timing){vars.container.selector.call(update).call(finish);vars.container.list.style("width",vars.width.secondary-vars.ui.border*2+"px").style("max-height",max_height+"px").property("scrollTop",vars.container.listScroll)}else{vars.container.selector.transition().duration(vars.draw.timing).each("start",
function(){d3.select(this).style("display",vars.open.value?"block":null)}).call(update).each("end",function(){d3.select(this).transition().duration(vars.draw.timing).call(finish)});function scrollTopTween(scrollTop){return function(){var i=d3.interpolateNumber(this.scrollTop,scrollTop);return function(t){this.scrollTop=i(t)}}}vars.container.list.transition().duration(vars.draw.timing).style("width",vars.width.secondary-vars.ui.border*2+"px").style("max-height",max_height+"px").tween("scroll",scrollTopTween(vars.container.listScroll))}if(vars.dev.value)print.timeEnd("drawing list")}},
{"../../../../core/console/print.coffee":52,"./arrow.js":143,"./height.js":147,"./items.coffee":148,"./scroll.js":151}],156:[function(require,module,exports){var copy=require("../../../../util/copy.coffee"),fontTester=require("../../../../core/font/tester.coffee"),form=require("../../../form.js"),print=require("../../../../core/console/print.coffee"),validObject=require("../../../../object/validate.coffee");module.exports=function(vars){var data=[],buffer=0;for(var level in vars.data.nested.all){var newData=
vars.data.nested.all[level],key=validObject(vars.text.nesting)&&level in vars.text.nesting?vars.text.nesting[level][0]:level;if([vars.id.value,vars.text.value].indexOf(key)<0){newData=copy(newData);newData.forEach(function(d){d[vars.text.value||vars.id.value]=d[key]})}data=data.concat(newData)}function getWidth(type){var key=type==="primary"?"value":type,icon=key==="value"?vars.icon.drop.value:vars.icon.select.value||vars.icon.drop.value,text=key==="value"?vars.text.value:vars.text.secondary.value||
vars.text.value,font=key==="value"?vars.font:vars.font.secondary;if(vars.dev.value)print.time("calculating "+type+" width");var button=form().container(fontTester()).data({"large":9999,"value":data}).draw({"update":false}).font(font).format(vars.format).icon({"button":icon,"value":vars.icon.value}).id(vars.id.value).timing({"ui":0}).text(text||vars.id.value).type("button").ui({"border":type==="primary"?vars.ui.border:0,"display":"inline-block","margin":0,"padding":vars.ui.padding.css}).width(false).draw();
var w=[];button.selectAll("div.d3plus_node").each(function(o){w.push(this.offsetWidth+1)}).remove();var dropWidth={};dropWidth[key]=d3.max(w);vars.self.width(dropWidth);if(vars.dev.value)print.timeEnd("calculating "+type+" width")}if(typeof vars.width.value!=="number")getWidth("primary");if(typeof vars.width.secondary!=="number")if(!vars.text.secondary.value||vars.text.value===vars.text.secondary.value)vars.self.width({"secondary":vars.width.value});else getWidth("secondary")}},{"../../../../core/console/print.coffee":52,
"../../../../core/font/tester.coffee":68,"../../../../object/validate.coffee":171,"../../../../util/copy.coffee":206,"../../../form.js":103}],157:[function(require,module,exports){var child=require("../../../../util/child.coffee");var windowEvents=function(vars,elem){if(elem===undefined)var elem=window;d3.select(elem).on("click."+vars.container.id,function(){var element=d3.event.target||d3.event.toElement,parent=element.parentNode;if(parent&&["d3plus_node","d3plus_drop_title"].indexOf(parent.className)>=
0)element=parent.parentNode;if(element&&parent&&!child(vars.container.ui,element)&&(vars.open.value||vars.hover.value))vars.self.open(false).hover(false).draw()});try{var same_origin=window.parent.location.host===window.location.host}catch(e){var same_origin=false}if(same_origin)if(elem.self!==window.top)windowEvents(vars,elem.parent)};module.exports=windowEvents},{"../../../../util/child.coffee":204}],158:[function(require,module,exports){var form=require("../form.js");module.exports=function(vars){if(!("buttons"in
vars.container))vars.container.buttons=form().container(vars.container.ui).type("button");var dataLength=vars.data.viz.length,buttonWidth=vars.width.value?vars.width.value/dataLength:false;var toggles=vars.container.ui.selectAll("div.d3plus_toggle").data(vars.data.viz,function(d){return d[vars.id.value]});toggles.exit().remove();toggles.enter().append("div").attr("class","d3plus_toggle").style("display","inline-block").style("vertical-align","top");toggles.order().each(function(d){if(!("form"in d.d3plus))d.d3plus.form=
form().container(d3.select(this));var id=vars.id.nesting.length>vars.depth.value?vars.id.nesting[vars.depth.value+1]:vars.id.value;if(d[id]instanceof Array)d.d3plus.form.container({"id":vars.container.id+"_"+d[vars.id.value]}).data(d[id]).id(vars.id.nesting.slice(1)).type("drop");else d.d3plus.form.data([d]).id(vars.id.value).type("button");d.d3plus.form.color(vars.color).focus(vars.focus.value,function(value){if(value!==vars.focus.value)vars.self.focus(value).draw()}).hover(vars.hover.value).icon({"select":false,
"value":vars.icon.value}).font(vars.font).format(vars.format).order(vars.order).text(vars.text.value).ui({"border":vars.ui.border,"color":vars.ui.color,"display":"inline-block","margin":0,"padding":vars.ui.padding.css}).width(buttonWidth).draw()});if(vars.data.element.value)vars.data.element.value.on("focus."+vars.container.id,function(){vars.self.focus(this.value).hover(this.value).draw()}).on("blur."+vars.container.id,function(){vars.self.hover(false).draw()})}},{"../form.js":103}],159:[function(require,
module,exports){var intersectPoints,lineIntersection,pointInPoly,pointInSegmentBox,polyInsidePoly,rayIntersectsSegment,rotatePoint,rotatePoly,segmentsIntersect,simplify,squaredDist;simplify=require("simplify-js");module.exports=function(poly,options){var aRatio,aRatios,angle,angleRad,angleStep,angles,area,aspectRatioStep,aspectRatios,bBox,boxHeight,boxWidth,centroid,events,height,i,insidePoly,j,k,l,left,len,len1,len2,len3,m,maxArea,maxAspectRatio,maxHeight,maxRect,maxWidth,maxx,maxy,minAspectRatio,
minSqDistH,minSqDistW,minx,miny,modifOrigins,origOrigin,origin,origins,p,p1H,p1W,p2H,p2W,rectPoly,ref,ref1,ref2,ref3,ref4,ref5,ref6,ref7,ref8,right,rndPoint,rndX,rndY,tempPoly,tolerance,width,widthStep,x0,y0;if(poly.length<3)return null;events=[];aspectRatioStep=.5;angleStep=5;if(options==null)options={};if(options.maxAspectRatio==null)options.maxAspectRatio=15;if(options.minWidth==null)options.minWidth=0;if(options.minHeight==null)options.minHeight=0;if(options.tolerance==null)options.tolerance=
.02;if(options.nTries==null)options.nTries=20;if(options.angle!=null)if(options.angle instanceof Array)angles=options.angle;else if(typeof options.angle==="number")angles=[options.angle];else if(typeof options.angle==="string"&&!isNaN(options.angle))angles=[Number(options.angle)];if(angles==null)angles=d3.range(-90,90+angleStep,angleStep);if(options.aspectRatio!=null)if(options.aspectRatio instanceof Array)aspectRatios=options.aspectRatio;else if(typeof options.aspectRatio==="number")aspectRatios=
[options.aspectRatio];else if(typeof options.aspectRatio==="string"&&!isNaN(options.aspectRatio))aspectRatios=[Number(options.aspectRatio)];if(options.origin!=null)if(options.origin instanceof Array)if(options.origin[0]instanceof Array)origins=options.origin;else origins=[options.origin];area=Math.abs(d3.geom.polygon(poly).area());if(area===0)return null;ref=d3.extent(poly,function(d){return d[0]}),minx=ref[0],maxx=ref[1];ref1=d3.extent(poly,function(d){return d[1]}),miny=ref1[0],maxy=ref1[1];tolerance=
Math.min(maxx-minx,maxy-miny)*options.tolerance;tempPoly=function(){var j,len,results;results=[];for(j=0,len=poly.length;j<len;j++){p=poly[j];results.push({x:p[0],y:p[1]})}return results}();if(tolerance>0){tempPoly=simplify(tempPoly,tolerance);poly=function(){var j,len,results;results=[];for(j=0,len=tempPoly.length;j<len;j++){p=tempPoly[j];results.push([p.x,p.y])}return results}()}if(options.vdebug)events.push({type:"simplify",poly:poly});ref2=d3.extent(poly,function(d){return d[0]}),minx=ref2[0],
maxx=ref2[1];ref3=d3.extent(poly,function(d){return d[1]}),miny=ref3[0],maxy=ref3[1];bBox=[[minx,miny],[maxx,miny],[maxx,maxy],[minx,maxy]];ref4=[maxx-minx,maxy-miny],boxWidth=ref4[0],boxHeight=ref4[1];widthStep=Math.min(boxWidth,boxHeight)/50;if(origins==null){origins=[];centroid=d3.geom.polygon(poly).centroid();if(pointInPoly(centroid,poly))origins.push(centroid);while(origins.length<options.nTries){rndX=Math.random()*boxWidth+minx;rndY=Math.random()*boxHeight+miny;rndPoint=[rndX,rndY];if(pointInPoly(rndPoint,
poly))origins.push(rndPoint)}}if(options.vdebug)events.push({type:"origins",points:origins});maxArea=0;maxRect=null;for(j=0,len=angles.length;j<len;j++){angle=angles[j];angleRad=-angle*Math.PI/180;if(options.vdebug)events.push({type:"angle",angle:angle});for(i=k=0,len1=origins.length;k<len1;i=++k){origOrigin=origins[i];ref5=intersectPoints(poly,origOrigin,angleRad),p1W=ref5[0],p2W=ref5[1];ref6=intersectPoints(poly,origOrigin,angleRad+Math.PI/2),p1H=ref6[0],p2H=ref6[1];modifOrigins=[];if(p1W!=null&&
p2W!=null)modifOrigins.push([(p1W[0]+p2W[0])/2,(p1W[1]+p2W[1])/2]);if(p1H!=null&&p2H!=null)modifOrigins.push([(p1H[0]+p2H[0])/2,(p1H[1]+p2H[1])/2]);if(options.vdebug)events.push({type:"modifOrigin",idx:i,p1W:p1W,p2W:p2W,p1H:p1H,p2H:p2H,modifOrigins:modifOrigins});for(l=0,len2=modifOrigins.length;l<len2;l++){origin=modifOrigins[l];if(options.vdebug)events.push({type:"origin",cx:origin[0],cy:origin[1]});ref7=intersectPoints(poly,origin,angleRad),p1W=ref7[0],p2W=ref7[1];if(p1W===null||p2W===null)continue;
minSqDistW=Math.min(squaredDist(origin,p1W),squaredDist(origin,p2W));maxWidth=2*Math.sqrt(minSqDistW);ref8=intersectPoints(poly,origin,angleRad+Math.PI/2),p1H=ref8[0],p2H=ref8[1];if(p1H===null||p2H===null)continue;minSqDistH=Math.min(squaredDist(origin,p1H),squaredDist(origin,p2H));maxHeight=2*Math.sqrt(minSqDistH);if(maxWidth*maxHeight<maxArea)continue;if(aspectRatios!=null)aRatios=aspectRatios;else{minAspectRatio=Math.max(1,options.minWidth/maxHeight,maxArea/(maxHeight*maxHeight));maxAspectRatio=
Math.min(options.maxAspectRatio,maxWidth/options.minHeight,maxWidth*maxWidth/maxArea);aRatios=d3.range(minAspectRatio,maxAspectRatio+aspectRatioStep,aspectRatioStep)}for(m=0,len3=aRatios.length;m<len3;m++){aRatio=aRatios[m];left=Math.max(options.minWidth,Math.sqrt(maxArea*aRatio));right=Math.min(maxWidth,maxHeight*aRatio);if(right*maxHeight<maxArea)continue;if(right-left>=widthStep)if(options.vdebug)events.push({type:"aRatio",aRatio:aRatio});while(right-left>=widthStep){width=(left+right)/2;height=
width/aRatio;x0=origin[0],y0=origin[1];rectPoly=[[x0-width/2,y0-height/2],[x0+width/2,y0-height/2],[x0+width/2,y0+height/2],[x0-width/2,y0+height/2]];rectPoly=rotatePoly(rectPoly,angleRad,origin);if(polyInsidePoly(rectPoly,poly)){insidePoly=true;maxArea=width*height;maxRect={cx:x0,cy:y0,width:width,height:height,angle:angle};left=width}else{insidePoly=false;right=width}if(options.vdebug)events.push({type:"rectangle",cx:x0,cy:y0,width:width,height:height,areaFraction:width*height/area,angle:angle,
insidePoly:insidePoly})}}}}}return[maxRect,maxArea,events]};squaredDist=function(a,b){var deltax,deltay;deltax=b[0]-a[0];deltay=b[1]-a[1];return deltax*deltax+deltay*deltay};rayIntersectsSegment=function(p,p1,p2){var a,b,mAB,mAP,ref;ref=p1[1]<p2[1]?[p1,p2]:[p2,p1],a=ref[0],b=ref[1];if(p[1]===b[1]||p[1]===a[1])p[1]+=Number.MIN_VALUE;if(p[1]>b[1]||p[1]<a[1])return false;else if(p[0]>a[0]&&p[0]>b[0])return false;else if(p[0]<a[0]&&p[0]<b[0])return true;else{mAB=(b[1]-a[1])/(b[0]-a[0]);mAP=(p[1]-a[1])/
(p[0]-a[0]);return mAP>mAB}};pointInPoly=function(p,poly){var a,b,c,i,n;i=-1;n=poly.length;b=poly[n-1];c=0;while(++i<n){a=b;b=poly[i];if(rayIntersectsSegment(p,a,b))c++}return c%2!==0};pointInSegmentBox=function(p,p1,q1){var eps,px,py;eps=1E-9;px=p[0],py=p[1];if(px<Math.min(p1[0],q1[0])-eps||px>Math.max(p1[0],q1[0])+eps||py<Math.min(p1[1],q1[1])-eps||py>Math.max(p1[1],q1[1])+eps)return false;return true};lineIntersection=function(p1,q1,p2,q2){var cross1,cross2,denom,dx1,dx2,dy1,dy2,eps,px,py;eps=
1E-9;dx1=p1[0]-q1[0];dy1=p1[1]-q1[1];dx2=p2[0]-q2[0];dy2=p2[1]-q2[1];denom=dx1*dy2-dy1*dx2;if(Math.abs(denom)<eps)return null;cross1=p1[0]*q1[1]-p1[1]*q1[0];cross2=p2[0]*q2[1]-p2[1]*q2[0];px=(cross1*dx2-cross2*dx1)/denom;py=(cross1*dy2-cross2*dy1)/denom;return[px,py]};segmentsIntersect=function(p1,q1,p2,q2){var p;p=lineIntersection(p1,q1,p2,q2);if(p==null)return false;return pointInSegmentBox(p,p1,q1)&&pointInSegmentBox(p,p2,q2)};polyInsidePoly=function(polyA,polyB){var aA,aB,bA,bB,iA,iB,nA,nB;iA=
-1;nA=polyA.length;nB=polyB.length;bA=polyA[nA-1];while(++iA<nA){aA=bA;bA=polyA[iA];iB=-1;bB=polyB[nB-1];while(++iB<nB){aB=bB;bB=polyB[iB];if(segmentsIntersect(aA,bA,aB,bB))return false}}return pointInPoly(polyA[0],polyB)};rotatePoint=function(p,alpha,origin){var cosAlpha,sinAlpha,xshifted,yshifted;if(origin==null)origin=[0,0];xshifted=p[0]-origin[0];yshifted=p[1]-origin[1];cosAlpha=Math.cos(alpha);sinAlpha=Math.sin(alpha);return[cosAlpha*xshifted-sinAlpha*yshifted+origin[0],sinAlpha*xshifted+cosAlpha*
yshifted+origin[1]]};rotatePoly=function(poly,alpha,origin){var j,len,point,results;results=[];for(j=0,len=poly.length;j<len;j++){point=poly[j];results.push(rotatePoint(point,alpha,origin))}return results};intersectPoints=function(poly,origin,alpha){var a,b,closestPointLeft,closestPointRight,eps,i,idx,minSqDistLeft,minSqDistRight,n,p,shiftedOrigin,sqDist,x0,y0;eps=1E-9;origin=[origin[0]+eps*Math.cos(alpha),origin[1]+eps*Math.sin(alpha)];x0=origin[0],y0=origin[1];shiftedOrigin=[x0+Math.cos(alpha),
y0+Math.sin(alpha)];idx=0;if(Math.abs(shiftedOrigin[0]-x0)<eps)idx=1;i=-1;n=poly.length;b=poly[n-1];minSqDistLeft=Number.MAX_VALUE;minSqDistRight=Number.MAX_VALUE;closestPointLeft=null;closestPointRight=null;while(++i<n){a=b;b=poly[i];p=lineIntersection(origin,shiftedOrigin,a,b);if(p!=null&&pointInSegmentBox(p,a,b)){sqDist=squaredDist(origin,p);if(p[idx]<origin[idx]){if(sqDist<minSqDistLeft){minSqDistLeft=sqDist;closestPointLeft=p}}else if(p[idx]>origin[idx])if(sqDist<minSqDistRight){minSqDistRight=
sqDist;closestPointRight=p}}}return[closestPointLeft,closestPointRight]}},{"simplify-js":8}],160:[function(require,module,exports){module.exports=function(radians,distance,shape){var adjacentLegLength,coords,diagonal,oppositeLegLength;coords={x:0,y:0};if(radians<0)radians=Math.PI*2+radians;if(shape==="square"){diagonal=45*(Math.PI/180);if(radians<=Math.PI)if(radians<Math.PI/2)if(radians<diagonal){coords.x+=distance;oppositeLegLength=Math.tan(radians)*distance;coords.y+=oppositeLegLength}else{coords.y+=
distance;adjacentLegLength=distance/Math.tan(radians);coords.x+=adjacentLegLength}else if(radians<Math.PI-diagonal){coords.y+=distance;adjacentLegLength=distance/Math.tan(Math.PI-radians);coords.x-=adjacentLegLength}else{coords.x-=distance;oppositeLegLength=Math.tan(Math.PI-radians)*distance;coords.y+=oppositeLegLength}else if(radians<3*Math.PI/2)if(radians<diagonal+Math.PI){coords.x-=distance;oppositeLegLength=Math.tan(radians-Math.PI)*distance;coords.y-=oppositeLegLength}else{coords.y-=distance;
adjacentLegLength=distance/Math.tan(radians-Math.PI);coords.x-=adjacentLegLength}else if(radians<2*Math.PI-diagonal){coords.y-=distance;adjacentLegLength=distance/Math.tan(2*Math.PI-radians);coords.x+=adjacentLegLength}else{coords.x+=distance;oppositeLegLength=Math.tan(2*Math.PI-radians)*distance;coords.y-=oppositeLegLength}}else{coords.x+=distance*Math.cos(radians);coords.y+=distance*Math.sin(radians)}return coords}},{}],161:[function(require,module,exports){var offset;offset=require("../geom/offset.coffee");
module.exports=function(path){var angle,i,j,last,len,length,o,obtuse,p,poly,prev,radius,segments,start,step,width;if(!path)return[];path=path.slice(1).slice(0,-1).split(/L|A/);poly=[];for(j=0,len=path.length;j<len;j++){p=path[j];p=p.split(" ");if(p.length===1)poly.push(p[0].split(",").map(function(d){return parseFloat(d)}));else{prev=poly[poly.length-1];last=p.pop().split(",").map(function(d){return parseFloat(d)});radius=parseFloat(p.shift().split(",")[0]);width=Math.sqrt(Math.pow(last[0]-prev[0],
2)+Math.pow(last[1]-prev[1],2));angle=Math.acos((radius*radius+radius*radius-width*width)/(2*radius*radius));obtuse=p[1].split(",")[0]==="1";if(obtuse)angle=Math.PI*2-angle;length=angle/(Math.PI*2)*(radius*Math.PI*2);segments=length/5;start=Math.atan2(-prev[1],-prev[0])-Math.PI;step=angle/segments;i=step;while(i<angle){o=offset(start+i,radius);poly.push([o.x,o.y]);i+=step}poly.push(last)}}return poly}},{"../geom/offset.coffee":160}],162:[function(require,module,exports){var d3plus,message,stylesheet;
d3plus={};d3plus.version="1.9.2 - Cornflower";d3plus.repo="https://github.com/alexandersimoes/d3plus/";d3plus.array={comparator:require("./array/comparator.coffee"),contains:require("./array/contains.coffee"),sort:require("./array/sort.coffee"),update:require("./array/update.coffee")};d3plus.client={css:require("./client/css.coffee"),ie:require("./client/ie.js"),pointer:require("./client/pointer.coffee"),prefix:require("./client/prefix.coffee"),rtl:require("./client/rtl.coffee"),scroll:require("./client/scroll.js"),
scrollbar:require("./client/scrollbar.coffee"),touch:require("./client/touch.coffee")};d3plus.color={legible:require("./color/legible.coffee"),lighter:require("./color/lighter.coffee"),mix:require("./color/mix.coffee"),random:require("./color/random.coffee"),scale:require("./color/scale.coffee"),sort:require("./color/sort.coffee"),text:require("./color/text.coffee"),validate:require("./color/validate.coffee")};d3plus.data={bestRegress:require("./data/bestRegress.coffee"),lof:require("./data/lof.coffee"),
mad:require("./data/mad.coffee")};d3plus.font={sizes:require("./font/sizes.coffee"),validate:require("./font/validate.coffee")};d3plus.form=require("./form/form.js");d3plus.geom={largestRect:require("./geom/largestRect.coffee"),offset:require("./geom/offset.coffee"),path2poly:require("./geom/path2poly.coffee")};d3plus.network={cluster:require("./network/cluster.coffee"),distance:require("./network/distance.coffee"),normalize:require("./network/normalize.coffee"),shortestPath:require("./network/shortestPath.coffee"),
smallestGap:require("./network/smallestGap.coffee"),subgraph:require("./network/subgraph.coffee")};d3plus.number={format:require("./number/format.coffee")};d3plus.object={merge:require("./object/merge.coffee"),validate:require("./object/validate.coffee")};d3plus.string={format:require("./string/format.js"),list:require("./string/list.coffee"),strip:require("./string/strip.js"),title:require("./string/title.coffee")};d3plus.textwrap=require("./textwrap/textwrap.coffee");d3plus.tooltip={create:require("./tooltip/create.js"),
move:require("./tooltip/move.coffee"),remove:require("./tooltip/remove.coffee")};d3plus.util={buckets:require("./util/buckets.coffee"),child:require("./util/child.coffee"),closest:require("./util/closest.coffee"),copy:require("./util/copy.coffee"),d3selection:require("./util/d3selection.coffee"),dataurl:require("./util/dataURL.coffee"),uniques:require("./util/uniques.coffee")};d3plus.viz=require("./viz/viz.coffee");stylesheet=require("./client/css.coffee");message=require("./core/console/print.coffee");
if(stylesheet("d3plus.css"))message.warning("d3plus.css has been deprecated, you do not need to load this file.",d3plus.repo+"releases/tag/v1.4.0");if(typeof window!=="undefined")window.d3plus=d3plus;module.exports=d3plus},{"./array/comparator.coffee":32,"./array/contains.coffee":33,"./array/sort.coffee":34,"./array/update.coffee":35,"./client/css.coffee":36,"./client/ie.js":37,"./client/pointer.coffee":38,"./client/prefix.coffee":39,"./client/rtl.coffee":40,"./client/scroll.js":41,"./client/scrollbar.coffee":42,
"./client/touch.coffee":43,"./color/legible.coffee":44,"./color/lighter.coffee":45,"./color/mix.coffee":46,"./color/random.coffee":47,"./color/scale.coffee":48,"./color/sort.coffee":49,"./color/text.coffee":50,"./color/validate.coffee":51,"./core/console/print.coffee":52,"./data/bestRegress.coffee":98,"./data/lof.coffee":99,"./data/mad.coffee":100,"./font/sizes.coffee":101,"./font/validate.coffee":102,"./form/form.js":103,"./geom/largestRect.coffee":159,"./geom/offset.coffee":160,"./geom/path2poly.coffee":161,
"./network/cluster.coffee":163,"./network/distance.coffee":164,"./network/normalize.coffee":165,"./network/shortestPath.coffee":166,"./network/smallestGap.coffee":167,"./network/subgraph.coffee":168,"./number/format.coffee":169,"./object/merge.coffee":170,"./object/validate.coffee":171,"./string/format.js":172,"./string/list.coffee":173,"./string/strip.js":174,"./string/title.coffee":175,"./textwrap/textwrap.coffee":199,"./tooltip/create.js":200,"./tooltip/move.coffee":201,"./tooltip/remove.coffee":202,
"./util/buckets.coffee":203,"./util/child.coffee":204,"./util/closest.coffee":205,"./util/copy.coffee":206,"./util/d3selection.coffee":207,"./util/dataURL.coffee":208,"./util/uniques.coffee":209,"./viz/viz.coffee":332}],163:[function(require,module,exports){var normalize;normalize=require("./normalize.coffee");module.exports=function(edges,options){var Q,a,b,cid,commSize,commSizes,communities,community,deltaQ,distance,edge,endpoint,events,i,id,iter,j,k,len,len1,linksMap,m,maxa,maxb,node,nodeid,nodes,
nodesMap,ref,ref1,result,startpoint;events=[];if(options==null)options={};if(options.nodes==null||typeof options.nodes!=="object"){ref=normalize(edges,options),edges=ref[0],options=ref[1];if(options===null)return null}distance=options.distance,nodeid=options.nodeid,startpoint=options.startpoint,endpoint=options.endpoint,nodes=options.nodes;nodesMap={};for(id in nodes)nodesMap[id]={node:nodes[id].node,degree:0};m=0;linksMap={};for(i=0,len=edges.length;i<len;i++){edge=edges[i];a=nodeid(startpoint(edge));
b=nodeid(endpoint(edge));if(!(a in linksMap))linksMap[a]={};if(!(b in linksMap))linksMap[b]={};if(!(b in linksMap[a])){linksMap[a][b]=0;linksMap[b][a]=0;m++;nodesMap[a].degree+=1;nodesMap[b].degree+=1}}communities={};Q=0;for(id in nodesMap){node=nodesMap[id];communities[id]={score:node.degree/(2*m),nodes:[id]}}for(a in linksMap)for(b in linksMap[a])linksMap[a][b]=1/(2*m)-nodesMap[a].degree*nodesMap[b].degree/(4*m*m);iter=0;while(iter<1E3){deltaQ=-1;maxa=void 0;maxb=void 0;for(a in linksMap)for(b in linksMap[a])if(linksMap[a][b]>
deltaQ){deltaQ=linksMap[a][b];maxa=a;maxb=b}if(deltaQ<0)break;for(k in linksMap[maxa]){if(k!==maxb){if(k in linksMap[maxb])linksMap[maxb][k]+=linksMap[maxa][k];else linksMap[maxb][k]=linksMap[maxa][k]-2*communities[maxb].score*communities[k].score;linksMap[k][maxb]=linksMap[maxb][k]}delete linksMap[k][maxa]}for(k in linksMap[maxb])if(!(k in linksMap[maxa])&&k!==maxb){linksMap[maxb][k]-=2*communities[maxa].score*communities[k].score;linksMap[k][maxb]=linksMap[maxb][k]}ref1=communities[maxa].nodes;
for(j=0,len1=ref1.length;j<len1;j++){node=ref1[j];communities[maxb].nodes.push(node)}communities[maxb].score+=communities[maxa].score;if(options.vdebug)events.push({type:"merge",father:maxb,child:maxa,nodes:communities[maxb].nodes});delete communities[maxa];delete linksMap[maxa];Q+=deltaQ;iter++}commSizes=function(){var results;results=[];for(cid in communities){community=communities[cid];results.push([cid,community.nodes.length])}return results}();commSizes.sort(function(a,b){return b[1]-a[1]});
result=function(){var l,len2,results;results=[];for(l=0,len2=commSizes.length;l<len2;l++){commSize=commSizes[l];results.push(communities[commSize[0]].nodes)}return results}();return[result,events]}},{"./normalize.coffee":165}],164:[function(require,module,exports){module.exports=function(n1,n2){var xx,yy;if(!(n1 instanceof Array))n1=[n1.x,n1.y];if(!(n2 instanceof Array))n2=[n2.x,n2.y];xx=Math.abs(n1[0]-n2[0]);yy=Math.abs(n1[1]-n2[1]);return Math.sqrt(xx*xx+yy*yy)}},{}],165:[function(require,module,
exports){var print;print=require("../core/console/print.coffee");module.exports=function(edges,options){var K,a,b,directed,distance,edge,edge2distance,endpoint,errormsg,i,id,id1,idA,idB,j,k,l,len,len1,len2,node,nodeA,nodeB,nodeid,nodes,ref,ref1,source,startpoint,target,vdebug;source=options.source,target=options.target,directed=options.directed,distance=options.distance,nodeid=options.nodeid,startpoint=options.startpoint,endpoint=options.endpoint,K=options.K,vdebug=options.vdebug;if(!directed)directed=
false;if(K==null)K=1;if(nodeid==null)nodeid=function(node){return node};else if(typeof nodeid==="string")nodeid=function(nodeid){return function(node){return node[nodeid]}}(nodeid);if(source!=null&&typeof source==="object")source=nodeid(source);if(target!=null&&typeof target==="object")target=nodeid(target);if(startpoint==null)startpoint=function(edge){return edge.source};else if(typeof startpoint==="string")startpoint=function(startpoint){return function(edge){return edge[startpoint]}}(startpoint);
if(endpoint==null)endpoint=function(edge){return edge.target};else if(typeof endpoint==="string")endpoint=function(endpoint){return function(edge){return edge[endpoint]}}(endpoint);if(distance==null)distance=function(edge){return 1};else if(typeof distance==="number")distance=function(distance){return function(edge){return distance}}(distance);else if(typeof distance==="string")distance=function(distance){return function(edge){return edge[distance]}}(distance);else if(distance instanceof Array){edge2distance=
{};for(i=j=0,len=edges.length;j<len;i=++j){edge=edges[i];a=nodeid(startpoint(edge));b=nodeid(endpoint(edge));edge2distance[a+"_"+b]=distance[i]}distance=function(edge){a=nodeid(startpoint(edge));b=nodeid(endpoint(edge));return edge2distance[a+"_"+b]}}nodes={};for(k=0,len1=edges.length;k<len1;k++){edge=edges[k];nodeA=startpoint(edge);nodeB=endpoint(edge);idA=nodeid(nodeA);idB=nodeid(nodeB);ref=[nodeA,nodeB];for(l=0,len2=ref.length;l<len2;l++){node=ref[l];id=nodeid(node);if(!(id in nodes))nodes[id]=
{node:node,outedges:[]}}nodes[idA].outedges.push(edge);if(!directed)nodes[idB].outedges.push(edge)}errormsg=null;if(edges.length===0)errormsg="The length of edges is 0";else if(K<0)errormsg="K can not have negative value";else if(distance(edges[0])==null)errormsg="Check the distance function/attribute";else if(startpoint(edges[0])==null)errormsg="Check the startpoint function/attribute";else if(endpoint(edges[0])==null)errormsg="Check the endpoint function/attribute";else{id1=nodeid(startpoint(edges[0]));
if(id1==null||(ref1=typeof id1)!=="string"&&ref1!=="number")errormsg="Check the nodeid function/attribute";else if(source!=null&&!(source in nodes))errormsg="The source is not in the graph";else if(target!=null&&!(target in nodes))errormsg="The target is not in the graph"}if(errormsg!=null){print.error(errormsg);return null}return[edges,{source:source,target:target,directed:directed,distance:distance,nodeid:nodeid,startpoint:startpoint,endpoint:endpoint,K:K,nodes:nodes,vdebug:vdebug}]}},{"../core/console/print.coffee":52}],
166:[function(require,module,exports){var Heap,normalize;Heap=require("heap");normalize=require("./normalize.coffee");module.exports=function(edges,source,options){var K,a,alt,b,directed,distance,edge,endpoint,getPath,heap,i,id,j,len,len1,maxsize,node,nodeid,nodes,path,ref,ref1,ref2,res,result,startpoint,target,u,visited;if(options==null)options={};options.source=source;if(options.nodes==null||typeof options.nodes!=="object"){ref=normalize(edges,options),edges=ref[0],options=ref[1];if(options===null)return null}source=
options.source,target=options.target,directed=options.directed,distance=options.distance,nodeid=options.nodeid,startpoint=options.startpoint,endpoint=options.endpoint,K=options.K,nodes=options.nodes;for(id in nodes){node=nodes[id];node.count=0}heap=new Heap(function(a,b){return a.distance-b.distance});visited={};if(target==null)visited[source]=true;heap.push({edge:null,target:source,distance:0});maxsize=0;result=[];while(!heap.empty()){maxsize=Math.max(maxsize,heap.size());path=heap.pop();u=path.target;
nodes[u].count++;if(target==null)result.push(path);else if(u===target)result.push(path);if(result.length===K)break;if(nodes[u].count<=K){ref1=nodes[u].outedges;for(i=0,len=ref1.length;i<len;i++){edge=ref1[i];a=nodeid(startpoint(edge));b=nodeid(endpoint(edge));if(!directed&&b===u)ref2=[b,a],a=ref2[0],b=ref2[1];if(target==null){if(visited[b])continue;visited[b]=true}alt=path.distance+distance(edge);heap.push({edge:edge,previous:path,target:b,distance:alt})}}}getPath=function(path){edges=[];while(path.edge!=
null){edges.push(path.edge);path=path.previous}return edges.reverse()};for(j=0,len1=result.length;j<len1;j++){res=result[j];if(target!=null){delete res.target;res.edges=getPath(res)}delete res.edge;delete res.previous}return result}},{"./normalize.coffee":165,"heap":5}],167:[function(require,module,exports){var distance;distance=require("./distance.coffee");module.exports=function(arr,opts){var distances,quad;if(!opts)opts={};distances=[];quad=d3.geom.quadtree().x(function(d){if(opts.accessor)return opts.accessor(d)[0];
else return d[0]}).y(function(d){if(opts.accessor)return opts.accessor(d)[1];else return d[1]});quad(arr).visit(function(node){var i,j,len,len1,n1,n2,ref,ref1;if(!node.leaf){ref=node.nodes;for(i=0,len=ref.length;i<len;i++){n1=ref[i];if(n1&&n1.point)if(opts.origin)distances.push(distance(n1,opts));else{ref1=node.nodes;for(j=0,len1=ref1.length;j<len1;j++){n2=ref1[j];if(n2&&n2.point&&n2.point!==n1.point)distances.push(distance(n1,n2))}}}}return false});if(opts.all)return distances.sort(function(aa,bb){return aa-
bb});else return d3.min(distances)}},{"./distance.coffee":164}],168:[function(require,module,exports){var normalize;normalize=require("./normalize.coffee");module.exports=function(edges,source,options){var K,dfs,directed,distance,edge,endpoint,id,nodeid,nodes,ref,startpoint,visited;if(options==null)options={};options.source=source;if(options.nodes==null||typeof options.nodes!=="object"){ref=normalize(edges,options),edges=ref[0],options=ref[1];if(options===null)return null}source=options.source,directed=
options.directed,distance=options.distance,nodeid=options.nodeid,startpoint=options.startpoint,endpoint=options.endpoint,K=options.K,nodes=options.nodes;visited={};visited[source]=true;dfs=function(origin,curr_distance){var a,b,edge,i,len,new_distance,ref1,ref2,results;ref1=nodes[origin].outedges;results=[];for(i=0,len=ref1.length;i<len;i++){edge=ref1[i];a=nodeid(startpoint(edge));b=nodeid(endpoint(edge));if(!directed&&b===origin)ref2=[b,a],a=ref2[0],b=ref2[1];if(!(b in visited)){new_distance=curr_distance+
distance(edge);if(new_distance<=K){visited[b]=true;results.push(dfs(b,new_distance))}else results.push(void 0)}else results.push(void 0)}return results};dfs(source,0);return{nodes:function(){var results;results=[];for(id in visited)results.push(nodes[id].node);return results}(),edges:function(){var i,len,results;results=[];for(i=0,len=edges.length;i<len;i++){edge=edges[i];if(nodeid(startpoint(edge))in visited&&nodeid(endpoint(edge))in visited)results.push(edge)}return results}()}}},{"./normalize.coffee":165}],
169:[function(require,module,exports){var defaultLocale;defaultLocale=require("../core/locale/languages/en_US.coffee");module.exports=function(number,opts){var affixes,format,key,labels,length,locale,ret,sigs,symbol,time,vars,zeros;if(!opts)opts={};if("locale"in opts)locale=opts.locale;else locale=defaultLocale;time=locale.time.slice();format=d3.locale(locale.format);if(!opts)opts={};vars=opts.vars||{};key=opts.key;labels="labels"in opts?opts.labels:true;length=number.toString().split(".")[0].length;
if(vars.time&&vars.time.value)time.push(vars.time.value);if(typeof key==="string"&&time.indexOf(key.toLowerCase())>=0)ret=number;else if(key==="share"){if(number===0)ret=0;else if(number>=100)ret=format.numberFormat(",f")(number);else if(number>99)ret=format.numberFormat(".3g")(number);else ret=format.numberFormat(".2g")(number);ret+="%"}else if(number<10&&number>-10){length=number.toString().split(".");sigs=1;if(length.length>1){sigs=d3.min([parseFloat(length[1]).toString().length,2]);if(!(-1<number&&
number<1)){zeros=length[1].length-parseFloat(length[1]).toString().length;sigs+=1+zeros}}ret=format.numberFormat("."+sigs+"g")(number)}else if(length>3){symbol=d3.formatPrefix(number).symbol;symbol=symbol.replace("G","B");number=d3.formatPrefix(number).scale(number);number=format.numberFormat(".3g")(number);number=number.replace(locale.format.decimal,".");number=parseFloat(number)+"";number=number.replace(".",locale.format.decimal);ret=number+symbol}else if(length===3)ret=format.numberFormat(",f")(number);
else if(number===0)ret=0;else if(number===parseInt(number,10))ret=format.numberFormat(".2")(number);else ret=format.numberFormat(".3g")(number);if(ret.length>2&&""+ret.indexOf(".0")===ret.length-2)ret=ret.slice(0,ret.length-2);if(labels&&key&&"format"in vars&&key in vars.format.affixes.value){affixes=vars.format.affixes.value[key];return affixes[0]+ret+affixes[1]}else return ret}},{"../core/locale/languages/en_US.coffee":69}],170:[function(require,module,exports){var d3selection,validate;d3selection=
require("../util/d3selection.coffee");validate=require("./validate.coffee");module.exports=function(obj1,obj2){var copyObject,obj3;copyObject=function(obj,ret,shallow){var k,results,v;results=[];for(k in obj){v=obj[k];if(typeof v!=="undefined")if(!shallow&&validate(v)){if(typeof ret[k]!=="object")ret[k]={};results.push(copyObject(v,ret[k],k.indexOf("d3plus")===0))}else if(!d3selection(v)&&v instanceof Array)results.push(ret[k]=v.slice(0));else results.push(ret[k]=v);else results.push(void 0)}return results};
obj3={};if(obj1)copyObject(obj1,obj3);if(obj2)copyObject(obj2,obj3);return obj3}},{"../util/d3selection.coffee":207,"./validate.coffee":171}],171:[function(require,module,exports){module.exports=function(obj){return obj&&obj.constructor===Object}},{}],172:[function(require,module,exports){module.exports=function(){var args=Array.prototype.slice.call(arguments),str=args.shift();str.unkeyed_index=0;return str.replace(/\{(\w*)\}/g,function(match,key){if(key===""){key=str.unkeyed_index;str.unkeyed_index++}if(key==
+key)return args[key]!=="undefined"?args[key]:match;else{for(var i=0;i<args.length;i++)if(typeof args[i]==="object"&&typeof args[i][key]!=="undefined")return args[i][key];return match}}.bind(str))}},{}],173:[function(require,module,exports){var format,locale;format=require("./format.js");locale=require("../core/locale/languages/en_US.coffee").ui;module.exports=function(list,andText,max,moreText){var amount;if(!(list instanceof Array))return list;else list=list.slice(0);if(!andText)andText=locale.and;
if(!moreText)moreText=locale.moreText;if(list.length===2)return list.join(" "+andText+" ");else{if(max&&list.length>max){amount=list.length-max+1;list=list.slice(0,max-1);list[max-1]=format(moreText,amount)}if(list.length>1)list[list.length-1]=andText+" "+list[list.length-1];return list.join(", ")}}},{"../core/locale/languages/en_US.coffee":69,"./format.js":172}],174:[function(require,module,exports){module.exports=function(str){var removed=["!","@","#","$","%","^","&","*","(",")","[","]","{","}",
".",",","/","\\","|","'",'"',";",":","<",">","?","=","+"];var diacritics=[[/[\300-\306]/g,"A"],[/[\340-\346]/g,"a"],[/[\310-\313]/g,"E"],[/[\350-\353]/g,"e"],[/[\314-\317]/g,"I"],[/[\354-\357]/g,"i"],[/[\322-\330]/g,"O"],[/[\362-\370]/g,"o"],[/[\331-\334]/g,"U"],[/[\371-\374]/g,"u"],[/[\321]/g,"N"],[/[\361]/g,"n"],[/[\307]/g,"C"],[/[\347]/g,"c"]];str+="";return""+str.replace(/[^A-Za-z0-9\-_]/g,function(chr){if(" "===chr)return"_";else if(removed.indexOf(chr)>=0)return"";var ret=chr;for(var d=0;d<
diacritics.length;d++)if((new RegExp(diacritics[d][0])).test(chr)){ret=diacritics[d][1];break}return ret})}},{}],175:[function(require,module,exports){var defaultLocale;defaultLocale=require("../core/locale/languages/en_US.coffee");module.exports=function(text,opts){var biglow,bigs,key,locale,smalls;if(!text)return"";if(!opts)opts={};key=opts.key;if(text.charAt(text.length-1)===".")return text.charAt(0).toUpperCase()+text.substr(1);locale="locale"in this?this.locale.value:defaultLocale;smalls=locale.lowercase.map(function(b){return b.toLowerCase()});
bigs=locale.uppercase;bigs=bigs.concat(bigs.map(function(b){return b+"s"}));biglow=bigs.map(function(b){return b.toLowerCase()});return text.replace(/[^\s!-#%&(-\x2A,-:;\x3F@\x5B-\x5D_\x7B}\u00A1\u00A7\u00AB\u00B6\u00B7\u00BB\u00BF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E3B\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]*/g,
function(txt,i){var bigindex,new_txt;if(txt){bigindex=biglow.indexOf(txt.toLowerCase());if(bigindex>=0)return new_txt=bigs[bigindex];else if(smalls.indexOf(txt.toLowerCase())>=0&&i!==0&&i!==text.length-1)return new_txt=txt.toLowerCase();else return new_txt=txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()}else return""})}},{"../core/locale/languages/en_US.coffee":69}],176:[function(require,module,exports){var foreign,tspan;foreign=require("./foreign.coffee");tspan=require("./tspan.coffee");
module.exports=function(vars){if(vars.text.html.value)foreign(vars);else tspan(vars)}},{"./foreign.coffee":177,"./tspan.coffee":180}],177:[function(require,module,exports){module.exports=function(vars){var anchor,color,family,opacity,text;text=vars.container.value;family=text.attr("font-family")||text.style("font-family");anchor=vars.align.value||text.attr("text-anchor")||text.style("text-anchor");color=text.attr("fill")||text.style("fill");opacity=text.attr("opacity")||text.style("opacity");anchor=
anchor==="end"?"right":anchor==="middle"?"center":"left";d3.select(text.node().parentNode).append("foreignObject").attr("width",vars.width.value+"px").attr("height",vars.height.value+"px").attr("x","0px").attr("y","0px").append("xhtml:div").style("font-family",family).style("font-size",vars.size.value[1]+"px").style("color",color).style("text-align",anchor).style("opacity",opacity).text(vars.text.current)}},{}],178:[function(require,module,exports){module.exports=function(vars){var diff,elem,height,
prev,radius,shape,size,width,x,y;elem=vars.container.value;prev=elem.node().previousElementSibling;shape=prev?prev.tagName.toLowerCase():"";if(prev)prev=d3.select(prev);vars.container.x=vars.x.value||parseFloat(elem.attr("x"),10);vars.container.y=vars.y.value||parseFloat(elem.attr("y"),10);if(prev){if(vars.shape.accepted.indexOf(shape)>=0)vars.self.shape(shape);if(shape==="rect"){x=parseFloat(prev.attr("x"),10)||0;y=parseFloat(prev.attr("y"),10)||0;if(vars.padding.value===false){diff=Math.abs(x-vars.container.x);
if(diff)vars.self.padding(diff)}if(!vars.container.x)vars.container.x=x+vars.padding.value;if(!vars.container.y)vars.container.y=y+vars.padding.value;if(!vars.width.value){width=parseFloat(prev.attr("width"||prev.style("width",10)));vars.self.width(width)}if(!vars.height.value){height=parseFloat(prev.attr("height"||prev.style("height",10)));vars.self.height(height)}}else if(shape==="circle"){radius=parseFloat(prev.attr("r"),10);x=parseFloat(prev.attr("cx"),10)||0;x-=radius;y=parseFloat(prev.attr("cy"),
10)||0;y-=radius;if(vars.padding.value===false){diff=Math.abs(x-vars.container.x);if(diff)vars.self.padding(diff)}if(!vars.container.x)vars.container.x=x+vars.padding.value;if(!vars.container.y)vars.container.y=y+vars.padding.value;if(!vars.width.value)vars.self.width(radius*2,10);if(!vars.height.value)vars.self.height(radius*2,10)}else{if(!vars.width.value)vars.self.width(500);if(!vars.height.value)vars.self.height(500)}}if(!vars.container.x)vars.container.x=0;if(!vars.container.y)vars.container.y=
0;vars.width.inner=vars.width.value-vars.padding.value*2;vars.height.inner=vars.height.value-vars.padding.value*2;size=elem.attr("font-size")||elem.style("font-size");size=parseFloat(size,10);vars.container.fontSize=size;vars.container.dy=parseFloat(elem.attr("dy"),10);if(!vars.size.value)if(vars.resize.value)return vars.self.size([4,80]);else return vars.self.size([size/2,size])}},{}],179:[function(require,module,exports){module.exports=function(vars){var text;if(!vars.text.value){text=vars.container.value.text();
if(text){if(text.indexOf("tspan")>=0){text.replace(/\<\/tspan\>\<tspan\>/g," ");text.replace(/\<\/tspan\>/g,"");text.replace(/\<tspan\>/g,"")}text=text.replace(/(\r\n|\n|\r)/gm,"");text=text.replace(/^\s+|\s+$/g,"");vars.self.text(text)}}if(vars.text.value instanceof Array)vars.text.phrases=vars.text.value.filter(function(t){return["string","number"].indexOf(typeof t)>=0});else vars.text.phrases=[vars.text.value+""];if(!vars.align.value)return vars.container.align=vars.container.value.style("text-anchor")||
vars.container.value.attr("text-anchor")}},{}],180:[function(require,module,exports){var rtl;rtl=require("../../client/rtl.coffee");module.exports=function(vars){var anchor,dy,ellipsis,fontSize,h,height,line,lineWidth,lines,mirror,newLine,placeWord,progress,reverse,rmod,rotate,rx,ry,space,start,textBox,translate,truncate,valign,width,words,wrap,x,xOffset,y,yOffset;newLine=function(first){var tspan;if(!reverse||first)tspan=vars.container.value.append("tspan");else tspan=vars.container.value.insert("tspan",
"tspan");return tspan.attr("x",x+"px").attr("dy",dy+"px").style("baseline-shift","0%").attr("dominant-baseline","alphabetic")};mirror=vars.rotate.value===-90||vars.rotate.value===90;width=mirror?vars.height.inner:vars.width.inner;height=mirror?vars.width.inner:vars.height.inner;if(vars.shape.value==="circle")anchor="middle";else anchor=vars.align.value||vars.container.align||"start";if(anchor==="end"||anchor==="start"&&rtl)xOffset=width;else if(anchor==="middle")xOffset=width/2;else xOffset=0;valign=
vars.valign.value||"top";x=vars.container.x+xOffset;fontSize=vars.resize.value?vars.size.value[1]:vars.container.fontSize||vars.size.value[0];dy=vars.container.dy||fontSize*1.1;textBox=null;progress=null;words=null;reverse=false;yOffset=0;if(vars.shape.value==="circle")if(valign==="middle")yOffset=height/dy%1*dy/2;else if(valign==="end")yOffset=height/dy%1*dy;vars.container.value.attr("text-anchor",anchor).attr("font-size",fontSize+"px").style("font-size",fontSize+"px").attr("x",vars.container.x).attr("y",
vars.container.y);truncate=function(){textBox.remove();if(reverse){line++;textBox=vars.container.value.select("tspan")}else{line--;textBox=d3.select(vars.container.value.node().lastChild)}if(!textBox.empty()){words=textBox.text().match(/[^\s-]+-?/g);return ellipsis()}};lineWidth=function(){var b;if(vars.shape.value==="circle"){b=(line-1)*dy+yOffset;if(b>height/2)b+=dy;return 2*Math.sqrt(b*(2*(width/2)-b))}else return width};ellipsis=function(){var lastChar,lastWord;if(words&&words.length){lastWord=
words.pop();lastChar=lastWord.charAt(lastWord.length-1);if(lastWord.length===1&&vars.text.split.value.indexOf(lastWord)>=0)return ellipsis();else{if(vars.text.split.value.indexOf(lastChar)>=0)lastWord=lastWord.substr(0,lastWord.length-1);textBox.text(words.join(" ")+" "+lastWord+"...");if(textBox.node().getComputedTextLength()>lineWidth())return ellipsis()}}else return truncate()};placeWord=function(word){var current,i,joiner,next_char;current=textBox.text();next_char="";if(reverse){next_char=vars.text.current.charAt(vars.text.current.length-
progress.length-1);if(next_char===" "){joiner="";i=2;while(next_char===" "){joiner+=" ";next_char=vars.text.current.charAt(vars.text.current.length-progress.length-i);i++}}else joiner="";progress=word+joiner+progress;textBox.text(word+joiner+current)}else{next_char=vars.text.current.charAt(progress.length);if(next_char===" "){joiner="";i=1;while(next_char===" "){joiner+=" ";next_char=vars.text.current.charAt(progress.length+i);i++}}else joiner="";progress+=joiner+word;textBox.text(current+joiner+
word)}if(Math.floor(textBox.node().getComputedTextLength())>lineWidth()||next_char==="\n"){textBox.text(current);if(current.length)textBox=newLine();textBox.text(word);if(reverse)return line--;else return line++}};start=1;line=null;lines=null;wrap=function(){var i,j,len,next_char,unsafe,word;vars.container.value.text("").html("");words=vars.text.words.slice();if(reverse)words.reverse();progress="";textBox=newLine(true);line=start;for(j=0,len=words.length;j<len;j++){word=words[j];if(line*dy>height){truncate();
break}placeWord(word);unsafe=true;while(unsafe){next_char=vars.text.current.charAt(progress.length);i=1;while(next_char===" "){next_char=vars.text.current.charAt(progress.length+i);i++}unsafe=vars.text.split.value.indexOf(next_char)>=0;if(unsafe)placeWord(next_char)}}if(line*dy>height)truncate();return lines=Math.abs(line-start)+1};wrap();lines=0;vars.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return lines++});if(vars.shape.value==="circle"){space=height-lines*
dy;if(space>dy)if(valign==="middle"){start=(space/dy/2>>0)+1;wrap()}else if(valign==="bottom"){reverse=true;start=height/dy>>0;wrap()}}lines=0;vars.container.value.selectAll("tspan").each(function(){if(d3.select(this).text().length)return lines++});if(valign==="top")y=0;else{h=lines*dy;y=valign==="middle"?height/2-h/2:height-h}y-=dy*.2;translate="translate(0,"+y+")";if(vars.rotate.value===180||vars.rotate.value===-180){rx=vars.container.x+width/2;ry=vars.container.y+height/2}else{rmod=vars.rotate.value<
0?width:height;rx=vars.container.x+rmod/2;ry=vars.container.y+rmod/2}rotate="rotate("+vars.rotate.value+", "+rx+", "+ry+")";return vars.container.value.attr("transform",rotate+translate)}},{"../../client/rtl.coffee":40}],181:[function(require,module,exports){var flow,fontSizes,resize,wrap;flow=require("./flow.coffee");fontSizes=require("../../font/sizes.coffee");wrap=function(vars){var firstChar;if(vars.text.phrases.length){vars.text.current=vars.text.phrases.shift()+"";vars.text.words=vars.text.current.match(vars.text["break"]);
firstChar=vars.text.current.charAt(0);if(firstChar!==vars.text.words[0].charAt(0))vars.text.words[0]=firstChar+vars.text.words[0];vars.container.value.html("");if(vars.resize.value)resize(vars);else flow(vars)}};module.exports=wrap;resize=function(vars){var addon,areaMod,areaRatio,boxArea,height,heightMax,i,lineWidth,maxWidth,mirror,sizeMax,sizeRatio,sizes,textArea,width,widthRatio,words;words=[];i=0;while(i<vars.text.words.length){addon=i===vars.text.words.length-1?"":" ";words.push(vars.text.words[i]+
addon);i++}mirror=vars.rotate.value===-90||vars.rotate.value===90;width=mirror?vars.height.inner:vars.width.inner;height=mirror?vars.width.inner:vars.height.inner;sizeMax=Math.floor(vars.size.value[1]);lineWidth=vars.shape.value==="circle"?width*.75:width;sizes=fontSizes(words,{"font-size":sizeMax+"px"},{parent:vars.container.value});maxWidth=d3.max(sizes,function(d){return d.width});areaMod=1.165+width/height*.11;textArea=d3.sum(sizes,function(d){var h;h=vars.container.dy||sizeMax*1.2;return d.width*
h})*areaMod;if(vars.shape.value==="circle")boxArea=Math.PI*Math.pow(width/2,2);else boxArea=lineWidth*height;if(maxWidth>lineWidth||textArea>boxArea){areaRatio=Math.sqrt(boxArea/textArea);widthRatio=lineWidth/maxWidth;sizeRatio=d3.min([areaRatio,widthRatio]);sizeMax=d3.max([vars.size.value[0],Math.floor(sizeMax*sizeRatio)])}heightMax=Math.floor(height*.8);if(sizeMax>heightMax)sizeMax=heightMax;if(maxWidth*(sizeMax/vars.size.value[1])<=lineWidth){if(sizeMax!==vars.size.value[1])vars.self.size([vars.size.value[0],
sizeMax]);flow(vars)}else wrap(vars)}},{"../../font/sizes.coffee":101,"./flow.coffee":176}],182:[function(require,module,exports){module.exports={accepted:[false,"start","middle","end","left","center","right"],process:function(value){var css;css=["left","center","right"].indexOf(value);if(css>=0)value=this.accepted[css+1];return value},value:false}},{}],183:[function(require,module,exports){arguments[4][107][0].apply(exports,arguments)},{"dup":107}],184:[function(require,module,exports){var d3selection;
d3selection=require("../../util/d3selection.coffee");module.exports={accepted:[false,Array,Object,String],element:false,id:"default",process:function(value){if(value===false)return false;else if(d3selection(value))return value;else if(value instanceof Array)return d3.select(value[0][0]);else return d3.select(value)},value:false}},{"../../util/d3selection.coffee":207}],185:[function(require,module,exports){arguments[4][111][0].apply(exports,arguments)},{"dup":111}],186:[function(require,module,exports){var print,
stringFormat;print=require("../../core/console/print.coffee");stringFormat=require("../../string/format.js");module.exports={accepted:[void 0],process:function(value,vars){var str;if(this.initialized===false)return value;if(vars.container.value===false){str=vars.format.locale.value.dev.setContainer;print.warning(str,"container")}else if(vars.container.value.empty()){str=vars.format.locale.value.dev.noContainer;print.warning(stringFormat(str,'"'+vars.container.value+'"'),"container")}else{if(vars.dev.value)print.time("total draw time");
vars.container.value.call(vars.self)}return value},value:void 0}},{"../../core/console/print.coffee":52,"../../string/format.js":172}],187:[function(require,module,exports){var locale,mergeObject;locale=require("../../core/locale/locale.coffee");mergeObject=require("../../object/merge.coffee");module.exports={accepted:[Function,String],locale:{accepted:function(){return d3.keys(locale)},process:function(value){var defaultLocale,returnObject;defaultLocale="en_US";returnObject=locale[defaultLocale];
if(value!==defaultLocale)returnObject=mergeObject(returnObject,locale[value]);this.language=value;return returnObject},value:"en_US"},process:function(value,vars){if(this.initialized&&typeof value==="string")vars.self.format({locale:value});else if(typeof value==="function")return value;return this.value},value:"en_US"}},{"../../core/locale/locale.coffee":78,"../../object/merge.coffee":170}],188:[function(require,module,exports){module.exports={accepted:[false,Number],value:false}},{}],189:[function(require,
module,exports){arguments[4][188][0].apply(exports,arguments)},{"dup":188}],190:[function(require,module,exports){arguments[4][111][0].apply(exports,arguments)},{"dup":111}],191:[function(require,module,exports){module.exports={accepted:[-180,-90,0,90,180],value:0}},{}],192:[function(require,module,exports){module.exports={accepted:["circle","square"],value:false}},{}],193:[function(require,module,exports){module.exports={accepted:[Array,false],value:false}},{}],194:[function(require,module,exports){module.exports=
{accepted:[false,Array,Number,String],html:{accepted:[Boolean],value:false},init:function(vars){var s;s=this.split.value;this["break"]=new RegExp("[^\\s\\"+s.join("\\")+"]+\\"+s.join("?\\")+"?","g");return false},split:{accepted:[Array],process:function(s){this["break"]=new RegExp("[^\\s\\"+s.join("\\")+"]+\\"+s.join("?\\")+"?","g");return s},value:["-","/",";",":","&"]}}},{}],195:[function(require,module,exports){module.exports={accepted:[false,"top","middle","bottom"],value:false}},{}],196:[function(require,
module,exports){arguments[4][188][0].apply(exports,arguments)},{"dup":188}],197:[function(require,module,exports){arguments[4][188][0].apply(exports,arguments)},{"dup":188}],198:[function(require,module,exports){arguments[4][188][0].apply(exports,arguments)},{"dup":188}],199:[function(require,module,exports){var attach,print,sizes,text,wrap;attach=require("../core/methods/attach.coffee");sizes=require("./helpers/parseSize.coffee");print=require("../core/console/print.coffee");text=require("./helpers/parseText.coffee");
wrap=require("./helpers/wrap.coffee");module.exports=function(){var vars;vars={self:function(selection){selection.each(function(){sizes(vars);if(vars.size.value[0]<=vars.height.inner){text(vars);wrap(vars)}else vars.container.value.html("");if(vars.dev.value)print.timeEnd("total draw time")});return vars.self}};attach(vars,{align:require("./methods/align.coffee"),config:require("./methods/config.coffee"),container:require("./methods/container.coffee"),dev:require("./methods/dev.coffee"),draw:require("./methods/draw.coffee"),
format:require("./methods/format.coffee"),height:require("./methods/height.coffee"),padding:require("./methods/padding.coffee"),resize:require("./methods/resize.coffee"),rotate:require("./methods/rotate.coffee"),text:require("./methods/text.coffee"),shape:require("./methods/shape.coffee"),size:require("./methods/size.coffee"),valign:require("./methods/valign.coffee"),width:require("./methods/width.coffee"),x:require("./methods/x.coffee"),y:require("./methods/y.coffee")});return vars.self}},{"../core/console/print.coffee":52,
"../core/methods/attach.coffee":79,"./helpers/parseSize.coffee":178,"./helpers/parseText.coffee":179,"./helpers/wrap.coffee":181,"./methods/align.coffee":182,"./methods/config.coffee":183,"./methods/container.coffee":184,"./methods/dev.coffee":185,"./methods/draw.coffee":186,"./methods/format.coffee":187,"./methods/height.coffee":188,"./methods/padding.coffee":189,"./methods/resize.coffee":190,"./methods/rotate.coffee":191,"./methods/shape.coffee":192,"./methods/size.coffee":193,"./methods/text.coffee":194,
"./methods/valign.coffee":195,"./methods/width.coffee":196,"./methods/x.coffee":197,"./methods/y.coffee":198}],200:[function(require,module,exports){var defaultLocale=require("../core/locale/languages/en_US.coffee"),events=require("../client/pointer.coffee"),legible=require("../color/legible.coffee"),move=require("./move.coffee"),prefix=require("../client/prefix.coffee"),rtl=require("../client/rtl.coffee"),removeTooltip=require("./remove.coffee"),scroll=require("../client/scroll.js"),stringList=require("../string/list.coffee"),
textColor=require("../color/text.coffee");module.exports=function(params){var default_width=params.fullscreen?250:200,vendor=prefix();params.width=params.width||default_width;params.max_width=params.max_width||386;params.id=params.id||"default";params.size=params.fullscreen||params.html?"large":"small";params.offset=params.offset||0;params.arrow_offset=params.arrow?8:0;params.x=params.x||0;params.y=params.y||0;params.parent=params.parent||d3.select("body");params.curtain=params.curtain||"#fff";params.curtainopacity=
params.curtainopacity||.8;params.background=params.background||"#fff";params.fontcolor=params.fontcolor||"#444";params.fontfamily=params.fontfamily||"sans-serif";params.fontweight=params.fontweight||"normal";params.fontsize=params.fontsize||"12px";params.style=params.style||"default";params.zindex=params.size=="small"?2E3:500;params.locale=params.locale||defaultLocale;params.stacked=params.stacked||false;var parentHeight=params.parent?params.parent.node().offsetHeight||params.parent.node().getBoundingClientRect().height:
0;if(!params.iconsize)params.iconsize=params.size=="small"?22:50;if(params.parent.node()===document.body)params.limit=[window.innerWidth+scroll.x(),window.innerHeight+scroll.y()];else params.limit=[parseFloat(params.parent.style("width"),10),parseFloat(params.parent.style("height"),10)];if(params.title instanceof Array){var and=params.locale.ui.and,more=params.locale.ui.more;params.title=stringList(params.title,and,3,more)}removeTooltip(params.id);params.anchor={};if(params.fullscreen){params.anchor.x=
"center";params.anchor.y="center";params.x=params.parent?params.parent.node().offsetWidth/2:window.innerWidth/2;params.y=params.parent?parentHeight/2:window.innerHeight/2}else if(params.align){var a=params.align.split(" ");params.anchor.y=a[0];if(a[1])params.anchor.x=a[1];else params.anchor.x="center"}else{params.anchor.x="center";params.anchor.y="top"}var title_width=params.width-30;if(params.fullscreen)var curtain=params.parent.append("div").attr("id","d3plus_tooltip_curtain_"+params.id).attr("class",
"d3plus_tooltip_curtain").style("background-color",params.curtain).style("opacity",params.curtainopacity).style("position","absolute").style("z-index",499).style("top","0px").style("right","0px").style("bottom","0px").style("left","0px").on(events.click,function(){removeTooltip(params.id)});var tooltip=params.parent.append("div").datum(params).attr("id","d3plus_tooltip_id_"+params.id).attr("class","d3plus_tooltip d3plus_tooltip_"+params.size).style("color",params.fontcolor).style("font-family",params.fontfamily).style("font-weight",
params.fontweight).style("font-size",params.fontsize+"px").style(vendor+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").on(events.out,close_descriptions);if(params.max_height)tooltip.style("max-height",params.max_height+"px");if(params.fixed){tooltip.style("z-index",500);params.mouseevents=true}else tooltip.style("z-index",2E3);var container=tooltip.append("div").datum(params).attr("class","d3plus_tooltip_container").style("background-color",params.background).style("padding",
"6px");if(params.fullscreen&&params.html&&!params.stacked){w=params.parent?params.parent.node().offsetWidth*.75:window.innerWidth*.75;h=params.parent?parentHeight*.75:window.innerHeight*.75;container.style("width",w+"px").style("height",h+"px");var body=container.append("div").attr("class","d3plus_tooltip_body").style("padding-right","6px").style("display","inline-block").style("z-index",1).style("width",params.width+"px")}else{if(params.width=="auto"){var w="auto";container.style("max-width",params.max_width+
"px")}else var w=params.width-14+"px";var body=container.style("width",w)}if(params.title||params.icon)var header=body.append("div").attr("class","d3plus_tooltip_header").style("position","relative").style("z-index",1);if(params.fullscreen){var close=tooltip.append("div").attr("class","d3plus_tooltip_close").style("background-color",params.color).style("color",textColor(params.color)).style("position","absolute").style(vendor+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)").style("font-size","20px").style("height",
"18px").style("line-height","14px").style("text-align","center").style("right","16px").style("top","-10px").style("width","18px").style("z-index",10).html("&times;").on(events.over,function(){d3.select(this).style("cursor","pointer").style(vendor+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.5)")}).on(events.out,function(){d3.select(this).style("cursor","auto").style(vendor+"box-shadow","0 1px 3px rgba(0, 0, 0, 0.25)")}).on(events.click,function(){removeTooltip(params.id)});d3.select("body").on("keydown.esc_"+
params.id,function(){if(d3.event.keyCode===27){removeTooltip(params.id);d3.select("body").on("keydown.esc_"+params.id,null)}})}if(!params.mouseevents)tooltip.style("pointer-events","none");else if(params.mouseevents!==true){var oldout=d3.select(params.mouseevents).on(events.out);var newout=function(){var target=d3.event.toElement||d3.event.relatedTarget;if(target){var c=typeof target.className=="string"?target.className:target.className.baseVal;var istooltip=c.indexOf("d3plus_tooltip")==0}else var istooltip=
false;if(!target||!ischild(tooltip.node(),target)&&!ischild(params.mouseevents,target)&&!istooltip){oldout(d3.select(params.mouseevents).datum());close_descriptions();d3.select(params.mouseevents).on(events.out,oldout)}};var ischild=function(parent,child){var node=child.parentNode;while(node!==null){if(node==parent)return true;node=node.parentNode}return false};d3.select(params.mouseevents).on(events.out,newout);tooltip.on(events.out,newout);var move_event=d3.select(params.mouseevents).on(events.move);
if(move_event)tooltip.on(events.move,move_event)}if(params.arrow)var arrow=tooltip.append("div").attr("class","d3plus_tooltip_arrow").style("background-color",params.background).style(vendor+"box-shadow","0px 1px 3px rgba(0, 0, 0, 0.25)").style("position","absolute").style("bottom","-5px").style("height","10px").style("left","50%").style("margin-left","-5px").style("width","10px").style(vendor+"transform","rotate(45deg)").style("z-index",-1);if(params.icon){var title_icon=header.append("div").attr("class",
"d3plus_tooltip_icon").style("width",params.iconsize+"px").style("height",params.iconsize+"px").style("z-index",1).style("background-position","50%").style("background-size","100%").style("background-image","url("+params.icon+")").style("display","inline-block").style("margin","0px 3px 3px 0px");if(params.style=="knockout")title_icon.style("background-color",params.color);title_width-=title_icon.node().offsetWidth}if(params.title){var mw=params.max_width-6;if(params.icon)mw-=params.iconsize+6;mw+=
"px";var title=header.append("div").attr("class","d3plus_tooltip_title").style("max-width",mw).style("color",!params.icon?legible(params.color):params.fontcolor).style("vertical-align","top").style("width",title_width+"px").style("display","inline-block").style("overflow","hidden").style("text-overflow","ellipsis").style("word-wrap","break-word").style("z-index",1).style("font-size",params.size==="large"?"18px":"16px").style("line-height",params.size==="large"?"20px":"17px").style("padding",params.size===
"large"?"3px 6px":"3px").text(params.title)}if(params.description)var description=body.append("div").attr("class","d3plus_tooltip_description").style("font-size","12px").style("padding","6px").text(params.description);if(params.data||params.html&&!params.fullscreen)var data_container=body.append("div").attr("class","d3plus_tooltip_data_container").style("overflow-y","auto").style("z-index",-1);if(params.data){var val_width=0,val_heights={};var last_group=null;params.data.forEach(function(d,i){if(d.group)if(last_group!=
d.group){last_group=d.group;data_container.append("div").attr("class","d3plus_tooltip_data_title").style("font-size","12px").style("font-weight","bold").style("padding","6px 3px 0px 3px").text(d.group)}var block=data_container.append("div").attr("class","d3plus_tooltip_data_block").style("font-size","12px").style("padding","3px 6px").style("position","relative").datum(d);if(d.highlight===true)block.style("color",legible(params.color));else if(d.allColors||d.highlight!==params.color)block.style("color",
legible(d.highlight));var name=block.append("div").attr("class","d3plus_tooltip_data_name").style("display","inline-block").html(d.name).on(events.out,function(){d3.event.stopPropagation()});if(d.link)name.style("cursor","pointer").on(events.click,d.link);if(d.value instanceof Array){var and=params.locale.ui.and,more=params.locale.ui.more;d.value=list(d.value,and,3,more)}var val=block.append("div").attr("class","d3plus_tooltip_data_value").style("display","block").style("position","absolute").style("text-align",
"right").style("top","3px").html(d.value).on(events.out,function(){d3.event.stopPropagation()});if(rtl)val.style("left","6px");else val.style("right","6px");if(params.mouseevents&&d.desc){var desc=block.append("div").attr("class","d3plus_tooltip_data_desc").style("color","#888").style("overflow","hidden").style(vendor+"transition","height 0.5s").style("width","85%").text(d.desc).on(events.out,function(){d3.event.stopPropagation()});var dh=desc.node().offsetHeight||desc.node().getBoundingClientRect().height;
desc.style("height","0px");var help=name.append("div").attr("class","d3plus_tooltip_data_help").style("background-color","#ccc").style(vendor+"border-radius","5px").style("color","#fff").style("cursor","pointer").style("display","inline-block").style("font-size","8px").style("font-weight","bold").style("height","10px").style("margin","3px 0px 0px 3px").style("padding-right","1px").style("text-align","center").style("width","10px").style("vertical-align","top").style(prefix+"transition","background-color 0.5s").text("?").on(events.over,
function(){var c=d3.select(this.parentNode.parentNode).style("color");d3.select(this).style("background-color",c);desc.style("height",dh+"px")}).on(events.out,function(){d3.event.stopPropagation()});name.style("cursor","pointer").on(events.over,function(){close_descriptions();var c=d3.select(this.parentNode).style("color");help.style("background-color",c);desc.style("height",dh+"px")});block.on(events.out,function(){d3.event.stopPropagation();close_descriptions()})}var w=parseFloat(val.style("width"),
10);if(w>params.width/2)w=params.width/2;if(w>val_width)val_width=w;if(i!=params.data.length-1)if(d.group&&d.group==params.data[i+1].group||!d.group&&!params.data[i+1].group)data_container.append("div").attr("class","d3plus_tooltip_data_seperator").style("background-color","#ddd").style("display","block").style("height","1px").style("margin","0px 3px")});data_container.selectAll(".d3plus_tooltip_data_name").style("width",function(){var w=parseFloat(d3.select(this.parentNode).style("width"),10);return w-
val_width-30+"px"});data_container.selectAll(".d3plus_tooltip_data_value").style("width",val_width+"px").each(function(d){var h=parseFloat(d3.select(this).style("height"),10);val_heights[d.name]=h});data_container.selectAll(".d3plus_tooltip_data_name").style("min-height",function(d){return val_heights[d.name]+"px"})}if(params.html&&(!params.fullscreen||params.stacked)){data_container.append("div").html(params.html);if(params.js)params.js(container)}var footer=body.append("div").attr("class","d3plus_tooltip_footer").style("font-size",
"10px").style("position","relative").style("text-align","center");if(params.footer)footer.html(params.footer);params.height=tooltip.node().offsetHeight||tooltip.node().getBoundingClientRect().height;if(params.html&&params.fullscreen&&!params.stacked){var h=params.height-12;var w=tooltip.node().offsetWidth-params.width-44;container.append("div").attr("class","d3plus_tooltip_html").style("width",w+"px").style("height",h+"px").style("display","inline-block").style("vertical-align","top").style("overflow-y",
"auto").style("padding","0px 12px").style("position","absolute").html(params.html);if(params.js)params.js(container)}params.width=tooltip.node().offsetWidth;if(params.anchor.y!="center")params.height+=params.arrow_offset;else params.width+=params.arrow_offset;if(params.data||(!params.fullscreen||params.stacked)&&params.html){if(!params.fullscreen||params.stacked){var limit=params.fixed?parentHeight-params.y-10:parentHeight-10;var h=params.height<limit?params.height:limit}else var h=params.height;
h-=parseFloat(container.style("padding-top"),10);h-=parseFloat(container.style("padding-bottom"),10);if(header){h-=header.node().offsetHeight||header.node().getBoundingClientRect().height;h-=parseFloat(header.style("padding-top"),10);h-=parseFloat(header.style("padding-bottom"),10)}if(footer){h-=footer.node().offsetHeight||footer.node().getBoundingClientRect().height;h-=parseFloat(footer.style("padding-top"),10);h-=parseFloat(footer.style("padding-bottom"),10)}data_container.style("max-height",h+
"px")}params.height=tooltip.node().offsetHeight||tooltip.node().getBoundingClientRect().height;move(params.x,params.y,params.id)};function close_descriptions(){d3.selectAll("div.d3plus_tooltip_data_desc").style("height","0px");d3.selectAll("div.d3plus_tooltip_data_help").style("background-color","#ccc")}},{"../client/pointer.coffee":38,"../client/prefix.coffee":39,"../client/rtl.coffee":40,"../client/scroll.js":41,"../color/legible.coffee":44,"../color/text.coffee":50,"../core/locale/languages/en_US.coffee":69,
"../string/list.coffee":173,"./move.coffee":201,"./remove.coffee":202}],201:[function(require,module,exports){var arrowStyle,scroll;scroll=require("../client/scroll.js");module.exports=function(x,y,id){var d,mins,tooltip;if(!id)id="default";tooltip=d3.select("div#d3plus_tooltip_id_"+id);if(tooltip.node()){d=tooltip.datum();d.cx=x;d.cy=y;if(!d.fixed){if(d.parent.node().tagName.toLowerCase()==="body")mins=[scroll.x(),scroll.y()];else mins=[0,0];if(d.anchor.y!=="center"){if(d.anchor.x==="right")d.x=
d.cx-d.arrow_offset-4;else if(d.anchor.x==="center")d.x=d.cx-d.width/2;else if(d.anchor.x==="left")d.x=d.cx-d.width+d.arrow_offset+2;if(d.anchor.y==="bottom")d.flip=d.cy+d.height+d.offset<=d.limit[1];else if(d.anchor.y==="top")d.flip=d.cy-d.height-d.offset<mins[1];if(d.flip)d.y=d.cy+d.offset+d.arrow_offset;else d.y=d.cy-d.height-d.offset-d.arrow_offset}else{d.y=d.cy-d.height/2;if(d.anchor.x==="right")d.flip=d.cx+d.width+d.offset<=d.limit[0];else if(d.anchor.x==="left")d.flip=d.cx-d.width-d.offset<
mins[0];if(d.anchor.x==="center"){d.flip=false;d.x=d.cx-d.width/2}else if(d.flip)d.x=d.cx+d.offset+d.arrow_offset;else d.x=d.cx-d.width-d.offset}if(d.x<mins[0])d.x=mins[0];else if(d.x+d.width>d.limit[0])d.x=d.limit[0]-d.width;if(d.y<mins[1])d.y=mins[1];else if(d.y+d.height>d.limit[1])d.y=d.limit[1]-d.height}tooltip.style("top",d.y+"px").style("left",d.x+"px");if(d.arrow)tooltip.selectAll(".d3plus_tooltip_arrow").call(arrowStyle)}return tooltip};arrowStyle=function(arrow){return arrow.style("bottom",
function(d){if(d.anchor.y!=="center"&&!d.flip)return"-5px";else return"auto"}).style("right",function(d){if(d.anchor.y==="center"&&!d.flip)return"-5px";else return"auto"}).style("top",function(d){if(d.anchor.y!=="center"&&d.flip)return"-5px";else if(d.anchor.y==="center")return"50%";else return"auto"}).style("left",function(d){if(d.anchor.y==="center"&&d.flip)return"-5px";else if(d.anchor.y!=="center")return"50%";else return"auto"}).style("margin-left",function(d){var arrow_x;if(d.anchor.y==="center")return"auto";
else{if(d.anchor.x==="right")arrow_x=-d.width/2+d.arrow_offset/2;else if(d.anchor.x==="left")arrow_x=d.width/2-d.arrow_offset*2-5;else arrow_x=-5;if(d.cx-d.width/2-5<arrow_x){arrow_x=d.cx-d.width/2-5;if(arrow_x<2-d.width/2)arrow_x=2-d.width/2}else if(-(d.limit[0]-d.cx-d.width/2+5)>arrow_x){arrow_x=-(d.limit[0]-d.cx-d.width/2+5);if(arrow_x>d.width/2-11)arrow_x=d.width/2-11}return arrow_x+"px"}}).style("margin-top",function(d){var arrow_y;if(d.anchor.y!=="center")return"auto";else{if(d.anchor.y==="bottom")arrow_y=
-d.height/2+d.arrow_offset/2-1;else if(d.anchor.y==="top")arrow_y=d.height/2-d.arrow_offset*2-2;else arrow_y=-9;if(d.cy-d.height/2-d.arrow_offset<arrow_y){arrow_y=d.cy-d.height/2-d.arrow_offset;if(arrow_y<4-d.height/2)arrow_y=4-d.height/2}else if(-(d.limit[1]-d.cy-d.height/2+d.arrow_offset)>arrow_y){arrow_y=-(d.limit[1]-d.cy-d.height/2+d.arrow_offset);if(arrow_y>d.height/2-22)arrow_y=d.height/2-22}return arrow_y+"px"}})}},{"../client/scroll.js":41}],202:[function(require,module,exports){module.exports=
function(id){if(id){d3.selectAll("div#d3plus_tooltip_curtain_"+id).remove();return d3.selectAll("div#d3plus_tooltip_id_"+id).remove()}else{d3.selectAll("div.d3plus_tooltip_curtain").remove();return d3.selectAll("div.d3plus_tooltip").remove()}}},{}],203:[function(require,module,exports){module.exports=function(arr,n){var buckets,step;buckets=[];step=1/(n-1)*(arr[1]-arr[0]);return d3.range(arr[0],arr[1]+step,step)}},{}],204:[function(require,module,exports){var d3selection;d3selection=require("./d3selection.coffee");
module.exports=function(parent,child){var node;if(!parent||!child)return false;if(d3selection(parent))parent=parent.node();if(d3selection(parent))child=child.node();node=child.parentNode;while(node!==null){if(node===parent)return true;node=node.parentNode}return false}},{"./d3selection.coffee":207}],205:[function(require,module,exports){module.exports=function(arr,value){var closest,i;if(value.constructor===String){i=arr.indexOf(value);if(i>-1)return arr[i];else return arr[0]}closest=arr[0];arr.forEach(function(p){if(Math.abs(value-
p)<Math.abs(value-closest))return closest=p});return closest}},{}],206:[function(require,module,exports){var copy,objectMerge,objectValidate;objectMerge=require("../object/merge.coffee");objectValidate=require("../object/validate.coffee");copy=function(variable){var ret;if(objectValidate(variable))return objectMerge(variable);else if(variable instanceof Array){ret=[];variable.forEach(function(o){return ret.push(copy(o))});return ret}else return variable};module.exports=copy},{"../object/merge.coffee":170,
"../object/validate.coffee":171}],207:[function(require,module,exports){var ie;ie=require("../client/ie.js");module.exports=function(elem){if(ie)return typeof elem==="object"&&elem instanceof Array&&"size"in elem&&"select"in elem;else return elem instanceof d3.selection}},{"../client/ie.js":37}],208:[function(require,module,exports){module.exports=function(url,callback){var img;img=new Image;img.src=url;img.crossOrigin="Anonymous";img.onload=function(){var canvas,context;canvas=document.createElement("canvas");
canvas.width=this.width;canvas.height=this.height;context=canvas.getContext("2d");context.drawImage(this,0,0);callback.call(this,canvas.toDataURL("image/png"));canvas=null}}},{}],209:[function(require,module,exports){var objectValidate,uniques;objectValidate=require("../object/validate.coffee");uniques=function(data,value,fetch,vars,depth,sorted){var check,d,i,j,k,len,len1,len2,len3,lookups,m,v,val,vals;if(data===void 0)return[];if(vars&&depth===void 0)depth=vars.id.value;sorted=true===sorted&&sorted===
void 0;if(!(data instanceof Array))data=[data];lookups=[];if(value===void 0)return data.reduce(function(p,c){var lookup;lookup=JSON.stringify(c);if(lookups.indexOf(lookup)<0){if(p.indexOf(c)<0)p.push(c);lookups.push(lookup)}return p},[]);vals=[];check=function(v){var l;if(v!==void 0&&v!==null){l=JSON.stringify(v);if(lookups.indexOf(l)<0){vals.push(v);return lookups.push(l)}}};if(typeof fetch==="function"&&vars)for(i=0,len=data.length;i<len;i++){d=data[i];val=uniques(fetch(vars,d,value,depth));for(j=
0,len1=val.length;j<len1;j++){v=val[j];check(v)}}else if(typeof value==="function")for(k=0,len2=data.length;k<len2;k++){d=data[k];val=value(d);check(val)}else for(m=0,len3=data.length;m<len3;m++){d=data[m];if(objectValidate(d)){val=d[value];check(val)}}if(sorted)return vals.sort(function(a,b){return a-b});else return vals};module.exports=uniques},{"../object/validate.coffee":171}],210:[function(require,module,exports){module.exports=function(vars){var checkParent,i,len,ref,s;vars.container.value.style("position",
function(){var current,remain;current=d3.select(this).style("position");remain=["absolute","fixed"].indexOf(current)>=0;if(remain)return current;else return"relative"});if(vars.container.changed)vars.container.value.html("");ref=["width","height"];for(i=0,len=ref.length;i<len;i++){s=ref[i];if(!vars[s].value){checkParent=function(element){var elem,val;if(element.tagName===void 0||["BODY","HTML"].indexOf(element.tagName)>=0){val=window["inner"+s.charAt(0).toUpperCase()+s.slice(1)];elem=document!==element?
d3.select(element):false;if(elem)if(s==="width"){val-=parseFloat(elem.style("margin-left"),10);val-=parseFloat(elem.style("margin-right"),10);val-=parseFloat(elem.style("padding-left"),10);val-=parseFloat(elem.style("padding-right"),10)}else{val-=parseFloat(elem.style("margin-top"),10);val-=parseFloat(elem.style("margin-bottom"),10);val-=parseFloat(elem.style("padding-top"),10);val-=parseFloat(elem.style("padding-bottom"),10)}return vars[s].value=val<=20?vars[s].small:val}else{val=parseFloat(d3.select(element).style(s),
10);if(typeof val==="number"&&val>0)return vars[s].value=val;else if(element.tagName!=="BODY")return checkParent(element.parentNode)}};checkParent(vars.container.value.node());if(d3.selectAll("body > *:not(script)").size()===1)d3.select("body").style("overflow","hidden")}}vars.container.value.style("width",vars.width.value+"px").style("height",vars.height.value+"px")}},{}],211:[function(require,module,exports){var dataFormat=require("../../core/data/format.js"),dataColor=require("../../core/data/color.js"),
dataKeys=require("../../core/data/keys.coffee"),dataLoad=require("../../core/data/load.coffee"),drawDrawer=require("./ui/drawer.js"),drawLegend=require("./ui/legend.js"),drawTimeline=require("./ui/timeline.coffee"),errorCheck=require("./errorCheck.js"),fetchData=require("../../core/fetch/data.js"),finish=require("./finish.js"),focusTooltip=require("./focus/tooltip.coffee"),history=require("./ui/history.coffee"),parseEdges=require("../../core/parse/edges.js"),parseNodes=require("../../core/parse/nodes.js"),
print=require("../../core/console/print.coffee"),removeTooltip=require("../../tooltip/remove.coffee"),runType=require("./types/run.coffee"),shapes=require("./shapes/draw.js"),stringFormat=require("../../string/format.js"),svgSetup=require("./svg/enter.js"),svgUpdate=require("./svg/update.js"),titles=require("./ui/titles.js"),validObject=require("../../object/validate.coffee");module.exports=function(vars){var steps=[],appType=vars.type.value,locale=vars.format.locale.value,uiMessage=locale.message.ui,
drawMessage=locale.message.draw;var urlLoads=["data","attrs","coords","nodes","edges"];urlLoads.forEach(function(u){if(!vars.error.value&&!vars[u].loaded&&vars[u].url)steps.push({"function":function(vars,next){dataLoad(vars,u,next)},"message":locale.message.loading,"wait":true})});if(vars.draw.update){var appName=locale.visualization[appType]||appType,appSetup=vars.types[appType].setup||false,appReqs=vars.types[appType].requirements||[],appMessage=stringFormat(locale.message.initializing,appName),
dataMessage=locale.message.data;if(!(appReqs instanceof Array))appReqs=[appReqs];appName=appName.toLowerCase();if(!vars.error.value&&typeof appSetup==="function")steps.push({"function":function(vars){if(vars.dev.value){var timerString="running "+appName+" setup";print.time(timerString)}appSetup(vars);if(vars.dev.value)print.timeEnd(timerString)},"message":appMessage});if(vars.container.changed)steps.push({"function":svgSetup,"message":appMessage});if(!(appType in vars.g.apps))steps.push({"function":function(vars){if(vars.dev.value){var timerString=
"creating "+appName+" group";print.time(timerString)}vars.g.apps[appType]=vars.g.app.append("g").attr("id",appType).attr("opacity",0);if(vars.dev.value)print.timeEnd(timerString)},"message":appMessage});if(vars.data.changed)steps.push({"function":function(vars){vars.data.cache={};delete vars.nodes.restricted;delete vars.edges.restricted;dataKeys(vars,"data")},"message":dataMessage});if(vars.attrs.changed)steps.push({"function":function(vars){dataKeys(vars,"attrs")},"message":dataMessage});steps.push({"function":function(vars){if(!vars.color.type||
vars.color.changed||vars.data.changed||vars.attrs.changed||vars.id.changed||vars.depth.changed||vars.time.fixed.value&&(vars.time.solo.changed||vars.time.mute.changed)){vars.color.valueScale=false;if(vars.dev.value){var timerString="checking color type";print.time(timerString)}vars.color.type=false;if(vars.color.value){var colorKey=vars.color.value;if(validObject(colorKey))if(colorKey[vars.id.value])colorKey=colorKey[vars.id.value];else colorKey=colorKey[d3.keys(colorKey)[0]];if(vars.data.keys&&colorKey in
vars.data.keys)vars.color.type=vars.data.keys[colorKey];else if(vars.attrs.keys&&colorKey in vars.attrs.keys)vars.color.type=vars.attrs.keys[colorKey]}else if(vars.data.keys)vars.color.type=vars.data.keys[vars.id.value];if(vars.dev.value)print.timeEnd(timerString)}},"message":dataMessage});if(appReqs.indexOf("edges")>=0&&vars.edges.value&&(!vars.edges.linked||vars.edges.changed))steps.push({"function":parseEdges,"message":dataMessage});if(appReqs.indexOf("nodes")>=0&&vars.edges.value&&(!vars.nodes.positions||
vars.nodes.changed||vars.type.changed))steps.push({"function":parseNodes,"message":dataMessage});if(vars.data.changed||vars.time.changed||vars.time.format.changed||vars.id.changed||vars.x.scale.changed&&[vars.x.scale.value,vars.x.scale.previous].indexOf("discrete")>=0||vars.y.scale.changed&&[vars.y.scale.value,vars.y.scale.previous].indexOf("discrete")>=0)steps.push({"function":dataFormat,"message":dataMessage});if(!vars.error.value)steps.push({"function":function(vars){var year=!vars.time.fixed.value?
["all"]:null;if(vars.dev.value){var timerString=year?"fetching pool data":"fetching data";print.time(timerString)}vars.data.pool=fetchData(vars,year);if(vars.dev.value)print.timeEnd(timerString);if(!year)vars.data.viz=vars.data.pool;else{if(vars.dev.value)print.time("fetching data for current year");vars.data.viz=fetchData(vars);if(vars.dev.value)print.timeEnd("fetching data for current year")}vars.draw.timing=vars.data.viz.length<vars.data.large?vars.timing.transitions:0},"message":dataMessage});
if(!vars.error.value)steps.push({"check":function(vars){return vars.color.value&&vars.color.type==="number"&&vars.color.valueScale===false},"function":dataColor,"message":dataMessage})}steps.push({"function":function(vars){if(vars.dev.value){var str=vars.format.locale.value.message.tooltipReset;print.time(str)}if(vars.type.previous&&appType!==vars.type.previous)removeTooltip(vars.type.previous);removeTooltip(appType);if(vars.dev.value)print.timeEnd(str)},"message":uiMessage});if(!vars.error.value)steps.push({"function":errorCheck,
"message":uiMessage});steps.push({"function":function(vars){vars.margin.process();titles(vars);if(!vars.error.value)if(vars.draw.update){drawDrawer(vars);drawTimeline(vars);drawLegend(vars)}else{if(vars.dev.value)print.time("calculating margins");var drawer=vars.container.value.select("div#d3plus_drawer").node().offsetHeight||vars.container.value.select("div#d3plus_drawer").node().getBoundingClientRect().height;var timeline=vars.g.timeline.node().getBBox();timeline=vars.timeline.value?timeline.height+
vars.ui.padding:0;var legend=vars.g.legend.node().getBBox();legend=vars.legend.value?legend.height+vars.ui.padding:0;vars.margin.bottom+=drawer+timeline+legend;if(vars.dev.value)print.timeEnd("calculating margins")}history(vars);vars.height.viz-=vars.margin.top+vars.margin.bottom;vars.width.viz-=vars.margin.left+vars.margin.right},"message":uiMessage});if(!vars.error.value)steps.push({"function":focusTooltip,"message":uiMessage});steps.push({"function":svgUpdate,"message":drawMessage});if(!vars.error.value&&
vars.draw.update)steps.push({"function":[runType,shapes],"message":drawMessage});steps.push({"function":finish,"message":drawMessage});return steps}},{"../../core/console/print.coffee":52,"../../core/data/color.js":54,"../../core/data/format.js":56,"../../core/data/keys.coffee":58,"../../core/data/load.coffee":59,"../../core/fetch/data.js":64,"../../core/parse/edges.js":94,"../../core/parse/nodes.js":97,"../../object/validate.coffee":171,"../../string/format.js":172,"../../tooltip/remove.coffee":202,
"./errorCheck.js":212,"./finish.js":213,"./focus/tooltip.coffee":214,"./shapes/draw.js":224,"./svg/enter.js":237,"./svg/update.js":238,"./types/run.coffee":241,"./ui/drawer.js":242,"./ui/history.coffee":243,"./ui/legend.js":244,"./ui/timeline.coffee":246,"./ui/titles.js":247}],212:[function(require,module,exports){var fetchText=require("../../core/fetch/text.js"),print=require("../../core/console/print.coffee"),rejected=require("../../core/methods/rejected.coffee"),stringFormat=require("../../string/format.js"),
stringList=require("../../string/list.coffee");module.exports=function(vars){if(vars.dev.value)print.time("checking for errors");var reqs=["id"],app_reqs=vars.types[vars.type.value].requirements;if(app_reqs)if(!(app_reqs instanceof Array))reqs.push(app_reqs);else reqs=reqs.concat(vars.types[vars.type.value].requirements);var missing=[];reqs.forEach(function(r){if(typeof r==="string"){if(!vars[r].value)missing.push('"'+r+'"')}else if(typeof r==="function"){var reqReturn=r(vars);if(!reqReturn.status&&
reqReturn.text)missing.push('"'+reqReturn.text+'"')}});if(missing.length>1){var str=vars.format.locale.value.error.methods,app=vars.format.locale.value.visualization[vars.type.value]||vars.type.value,and=vars.format.locale.value.ui.and;missing=stringList(missing,and);vars.error.internal=stringFormat(str,app,missing)}else if(missing.length===1){var str=vars.format.locale.value.error.method,app=vars.format.locale.value.visualization[vars.type.value]||vars.type.value;vars.error.internal=stringFormat(str,
app,missing[0])}if(!vars.error.internal&&reqs.indexOf("edges")>=0&&reqs.indexOf("focus")>=0){var connections=vars.edges.connections(vars.focus.value[0],vars.id.value);if(connections.length==0){var name=fetchText(vars,vars.focus.value[0],vars.depth.value),str=vars.format.locale.value.error.connections;vars.error.internal=stringFormat(str,'"'+name+'"')}}var reqs=["d3"];if(vars.types[vars.type.value].libs)reqs=reqs.concat(vars.types[vars.type.value].libs);var missing=[];reqs.forEach(function(r){if(!window[r])missing.push('"'+
r+'"')});if(missing.length>1){var str=vars.format.locale.value.error.libs,app=vars.format.locale.value.visualization[vars.type.value],and=vars.format.locale.value.ui.and;missing=stringList(missing,and);vars.error.internal=stringFormat(str,app,missing)}else if(missing.length===1){var str=vars.format.locale.value.error.lib,app=vars.format.locale.value.visualization[vars.type.value];vars.error.internal=stringFormat(str,app,missing[0])}var shapes=vars.shape.accepted(vars);if(!(shapes instanceof Array))shapes=
[shapes];var shape=vars.shape.value;if(!shape||rejected(vars,shapes,shape,"shape"))vars.self.shape(shapes[0]);if("modes"in vars.types[vars.type.value]){var modes=vars.types[vars.type.value].modes;if(!(modes instanceof Array))modes=[modes];var mode=vars.type.mode.value;if(!mode||rejected(vars,modes,mode,"mode"))vars.self.type({"mode":modes[0]})}if(vars.dev.value)print.timeEnd("checking for errors")}},{"../../core/console/print.coffee":52,"../../core/fetch/text.js":66,"../../core/methods/rejected.coffee":90,
"../../string/format.js":172,"../../string/list.coffee":173}],213:[function(require,module,exports){var edges=require("./shapes/edges.js"),paths=require("./shapes/paths.js"),flash=require("./ui/message.js"),focusViz=require("./focus/viz.js"),methodReset=require("../../core/methods/reset.coffee"),print=require("../../core/console/print.coffee"),shapeLabels=require("./shapes/labels.js"),titleCase=require("../../string/title.coffee");var bounds=require("./zoom/bounds.coffee");var labels=require("./zoom/labels.coffee");
var mouse=require("./zoom/mouse.coffee");module.exports=function(vars){if(vars.draw.first)setTimeout(function(){focusViz(vars)},vars.draw.timing);else focusViz(vars);if(!vars.error.value){var zoom=vars.zoom.viewport||vars.zoom.bounds;if(vars.types[vars.type.value].zoom&&vars.zoom.value&&zoom){if(vars.dev.value)print.time("calculating zoom");if(vars.draw.first||vars.zoom.reset)bounds(vars,zoom,0);else if(vars.type.changed||vars.focus.changed||vars.height.changed||vars.width.changed||vars.nodes.changed||
vars.legend.changed||vars.timeline.changed||vars.ui.changed)bounds(vars,zoom);if(vars.dev.value)print.timeEnd("calculating zoom")}else{vars.zoom.bounds=[[0,0],[vars.width.viz,vars.height.viz]];vars.zoom.scale=1;bounds(vars)}}var w=vars.zoom.size?vars.zoom.size.width:vars.width.viz,h=vars.zoom.size?vars.zoom.size.height:vars.height.viz,x=vars.zoom.bounds?vars.zoom.bounds[0][0]:0,y=vars.zoom.bounds?vars.zoom.bounds[0][1]:0;vars.g.overlay.attr("width",w).attr("height",h).attr("x",x).attr("y",y);if(!vars.error.value)if(vars.draw.update){if(vars.edges.path)paths(vars);
else edges(vars);shapeLabels(vars,"data");if(vars.edges.label&&!vars.edges.path)setTimeout(function(){shapeLabels(vars,"edges")},vars.draw.timing+200)}else if((vars.labels.value||vars.labels.changed)&&vars.types[vars.type.value].zoom&&vars.zoom.value&&vars.draw.timing)setTimeout(function(){labels(vars)},vars.draw.timing);if(!vars.error.value){var reqs=vars.types[vars.type.value].requirements||[];if(!(reqs instanceof Array))reqs=[reqs];var data_req=reqs.indexOf("data")>=0;if(!vars.error.internal)if((!vars.data.viz||
!vars.returned.nodes.length)&&data_req)vars.error.internal=vars.format.locale.value.error.data}var prev=vars.type.previous;if(prev&&vars.type.value!=prev&&vars.g.apps[prev]){if(vars.dev.value)print.time('hiding "'+prev+'"');if(vars.draw.timing)vars.g.apps[prev].transition().duration(vars.draw.timing).attr("opacity",0);else vars.g.apps[prev].attr("opacity",0);if(vars.dev.value)print.timeEnd()}if(!vars.error.value){var new_opacity=data_req&&vars.data.viz.length===0||vars.error.internal||vars.error.value?
0:vars.focus.value.length&&vars.types[vars.type.value].zoom&&vars.zoom.value?1-vars.tooltip.curtain.opacity:1;var timing=vars.draw.timing;vars.group.transition().duration(timing).attr("opacity",new_opacity);vars.g.data.transition().duration(timing).attr("opacity",new_opacity);vars.g.edges.transition().duration(timing).attr("opacity",new_opacity)}if(vars.error.value)flash(vars,vars.error.value);else if(vars.error.internal){vars.error.internal=titleCase(vars.error.internal);print.warning(vars.error.internal);
flash(vars,vars.error.internal);vars.error.internal=null}else flash(vars);setTimeout(function(){methodReset(vars);if(vars.types[vars.type.value].zoom&&vars.zoom.value){vars.g.zoom.datum(vars).call(vars.zoom.behavior.on("zoom",mouse));if(!vars.zoom.scroll.value)vars.g.zoom.on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("wheel.zoom",null);if(!vars.zoom.click.value)vars.g.zoom.on("dblclick.zoom",null);if(!vars.zoom.pan.value)vars.g.zoom.on("mousedown.zoom",null).on("mousemove.zoom",
null)}else vars.g.zoom.call(vars.zoom.behavior.on("zoom",null)).on("dblclick.zoom",null).on("mousedown.zoom",null).on("mousemove.zoom",null).on("mousewheel.zoom",null).on("MozMousePixelScroll.zoom",null).on("touchstart.zoom",null).on("wheel.zoom",null)},vars.draw.timing)}},{"../../core/console/print.coffee":52,"../../core/methods/reset.coffee":92,"../../string/title.coffee":175,"./focus/viz.js":215,"./shapes/edges.js":225,"./shapes/labels.js":227,"./shapes/paths.js":229,"./ui/message.js":245,"./zoom/bounds.coffee":248,
"./zoom/labels.coffee":250,"./zoom/mouse.coffee":251}],214:[function(require,module,exports){var createTooltip,fetchValue,print,removeTooltip;createTooltip=require("../tooltip/create.js");fetchValue=require("../../../core/fetch/value.coffee");print=require("../../../core/console/print.coffee");removeTooltip=require("../../../tooltip/remove.coffee");module.exports=function(vars){var data,focus,offset;focus=vars.focus;if(!vars.error.internal&&focus.value.length===1&&focus.value.length&&!vars.small&&
focus.tooltip.value){if(vars.dev.value)print.time("drawing focus tooltip");data=vars.data.pool.filter(function(d){return fetchValue(vars,d,vars.id.value)===focus.value[0]});if(data.length>=1)data=data[0];else{data={};data[vars.id.value]=focus.value[0]}offset=vars.labels.padding;createTooltip({anchor:"top left",arrow:false,data:data,fullscreen:false,id:"visualization_focus",length:"long",maxheight:vars.height.viz-offset*2,mouseevents:true,offset:0,vars:vars,width:vars.tooltip.large,x:vars.width.value-
vars.margin.right-offset,y:vars.margin.top+offset});vars.width.viz-=vars.tooltip.large+offset*2;if(vars.dev.value)print.timeEnd("drawing focus tooltip")}else removeTooltip("visualization_focus")}},{"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,"../../../tooltip/remove.coffee":202,"../tooltip/create.js":239}],215:[function(require,module,exports){var events=require("../../../client/pointer.coffee"),ie=require("../../../client/ie.js"),fetchValue=require("../../../core/fetch/value.coffee"),
print=require("../../../core/console/print.coffee"),uniqueValues=require("../../../util/uniques.coffee");module.exports=function(vars){vars.g.edge_focus.selectAll("g").remove();vars.g.data_focus.selectAll("g").remove();if(vars.focus.value.length&&vars.types[vars.type.value].zoom&&vars.zoom.value){if(vars.dev.value)print.time("drawing focus elements");var edges=vars.g.edges.selectAll("g");if(edges.size()>0){edges.each(function(l){var source=l[vars.edges.source][vars.id.value],target=l[vars.edges.target][vars.id.value];
if(source==vars.focus.value[0]||target==vars.focus.value[0]){var elem=vars.g.edge_focus.node().appendChild(this.cloneNode(true));d3.select(elem).datum(l).attr("opacity",1).selectAll("line, path").datum(l)}});var marker=vars.edges.arrows.value;vars.g.edge_focus.selectAll("line, path").attr("vector-effect","non-scaling-stroke").style("stroke",vars.color.focus).style("stroke-width",function(){if(ie&&vars.types[vars.type.value].zoom)return 0;return vars.edges.size.value?d3.select(this).style("stroke-width"):
vars.data.stroke.width*2}).attr("marker-start",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+e.d3plus.bucket;else var d="";return direction=="source"&&marker?"url(#d3plus_edge_marker_focus"+d+")":"none"}).attr("marker-end",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+e.d3plus.bucket;else var d="";return direction=="target"&&marker?"url(#d3plus_edge_marker_focus"+d+")":"none"});vars.g.edge_focus.selectAll("text").style("fill",
vars.color.focus)}var focii=uniqueValues(vars.edges.connections(vars.focus.value[0],vars.id.value,true),vars.id.value,fetchValue,vars);focii.push(vars.focus.value[0]);var x_bounds=[],y_bounds=[],x_buffer=[0],y_buffer=[0];var groups=vars.g.data.selectAll("g").each(function(d){if(focii.indexOf(d[vars.id.value])>=0){var elem=vars.g.data_focus.node().appendChild(this.cloneNode(true));var elem=d3.select(elem).datum(d).attr("opacity",1);if(vars.shape.value=="coordinates")vars.zoom.viewport=vars.path.bounds(vars.zoom.coords[d.d3plus.id]);
else if("d3plus"in d){if("x"in d.d3plus)x_bounds.push(d.d3plus.x);if("y"in d.d3plus)y_bounds.push(d.d3plus.y);if("r"in d.d3plus){x_buffer.push(d.d3plus.r);y_buffer.push(d.d3plus.r)}else{if("width"in d.d3plus)x_buffer.push(d.d3plus.width/2);if("height"in d.d3plus)y_buffer.push(d.d3plus.height/2)}}for(e in events){var evt=d3.select(this).on(events[e]);if(evt)elem.on(events[e],evt)}}});if(x_bounds.length&&y_bounds.length){var xcoords=d3.extent(x_bounds),ycoords=d3.extent(y_bounds),xmax=d3.max(x_buffer),
ymax=d3.max(y_buffer);vars.zoom.viewport=[[xcoords[0]-xmax,ycoords[0]-ymax],[xcoords[1]+xmax,ycoords[1]+ymax]]}vars.g.data_focus.selectAll("path").style("stroke-width",ie&&vars.types[vars.type.value].zoom?0:vars.data.stroke.width*2);if(vars.dev.value)print.timeEnd("drawing focus elements")}else vars.zoom.viewport=false}},{"../../../client/ie.js":37,"../../../client/pointer.coffee":38,"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,"../../../util/uniques.coffee":209}],
216:[function(require,module,exports){var angles,largestRect,path2poly,shapeStyle;shapeStyle=require("./style.coffee");largestRect=require("../../../geom/largestRect.coffee");path2poly=require("../../../geom/path2poly.coffee");angles={start:{},end:{}};module.exports=function(vars,selection,enter,exit){var arc,arcTween,data,newarc;arc=d3.svg.arc().innerRadius(0).outerRadius(function(d){return d.d3plus.r}).startAngle(function(d){return d.d3plus.startAngle}).endAngle(function(d){return d.d3plus.endAngle});
data=function(d){var poly,rect;if(vars.labels.value)if(d.d3plus.label)d.d3plus_label=d.d3plus.label;else{poly=path2poly(arc(d));rect=largestRect(poly,{angle:0});if(rect[0])d.d3plus_label={w:rect[0].width,h:rect[0].height,x:rect[0].cx,y:rect[0].cy};else delete d.d3plus_label}return[d]};if(vars.draw.timing){newarc=d3.svg.arc().innerRadius(0).outerRadius(function(d){return d.d3plus.r}).startAngle(function(d){if(angles.start[d.d3plus.id]===void 0)angles.start[d.d3plus.id]=0;if(isNaN(angles.start[d.d3plus.id]))angles.start[d.d3plus.id]=
d.d3plus.startAngle;return angles.start[d.d3plus.id]}).endAngle(function(d){if(angles.end[d.d3plus.id]===void 0)angles.end[d.d3plus.id]=0;if(isNaN(angles.end[d.d3plus.id]))angles.end[d.d3plus.id]=d.d3plus.endAngle;return angles.end[d.d3plus.id]});arcTween=function(arcs,newAngle){return arcs.attrTween("d",function(d){var e,interpolateE,interpolateS,s;if(newAngle===void 0){s=d.d3plus.startAngle;e=d.d3plus.endAngle}else if(newAngle===0){s=0;e=0}interpolateS=d3.interpolate(angles.start[d.d3plus.id],s);
interpolateE=d3.interpolate(angles.end[d.d3plus.id],e);return function(t){angles.start[d.d3plus.id]=interpolateS(t);angles.end[d.d3plus.id]=interpolateE(t);return newarc(d)}})};enter.append("path").attr("class","d3plus_data").call(shapeStyle,vars).attr("d",newarc);selection.selectAll("path.d3plus_data").data(data).transition().duration(vars.draw.timing).call(shapeStyle,vars).call(arcTween);exit.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(arcTween,0)}else{enter.append("path").attr("class",
"d3plus_data");selection.selectAll("path.d3plus_data").data(data).call(shapeStyle,vars).attr("d",arc)}}},{"../../../geom/largestRect.coffee":159,"../../../geom/path2poly.coffee":161,"./style.coffee":233}],217:[function(require,module,exports){var fetchText=require("../../../core/fetch/text.js"),fontSizes=require("../../../font/sizes.coffee"),largestRect=require("../../../geom/largestRect.coffee"),shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){var area=d3.svg.area().x(function(d){return d.d3plus.x}).y0(function(d){return d.d3plus.y0}).y1(function(d){return d.d3plus.y}).interpolate(vars.shape.interpolate.value);
var startArea=d3.svg.area().x(function(d){return d.d3plus.x}).y0(function(d){return d.d3plus.y0}).y1(function(d){return d.d3plus.y0}).interpolate(vars.shape.interpolate.value);enter.append("path").attr("class","d3plus_data").attr("d",function(d){return startArea(d.values)}).call(shapeStyle,vars);var style={"font-weight":vars.labels.font.weight,"font-family":vars.labels.font.family.value};selection.selectAll("path.d3plus_data").data(function(d){if(vars.labels.value&&d.values.length>1){var max=d3.max(d.values,
function(v){return v.d3plus.y0-v.d3plus.y}),lr=false;if(max>vars.labels.font.size){var tops=[],bottoms=[],names=fetchText(vars,d);d.values.forEach(function(v){tops.push([v.d3plus.x,v.d3plus.y]);bottoms.push([v.d3plus.x,v.d3plus.y0])});tops=tops.concat(bottoms.reverse());var ratio=null;if(names.length){var size=fontSizes(names[0],style);ratio=size[0].width/size[0].height}lr=largestRect(tops,{"angle":d3.range(-70,71,1),"aspectRatio":ratio,"tolerance":0})}if(lr&&lr[0]){var label={"w":~~lr[0].width,"h":~~lr[0].height,
"x":~~lr[0].cx,"y":~~lr[0].cy,"angle":lr[0].angle*-1,"padding":2,"names":names};if(lr[0].angle!==0)label.translate={"x":label.x,"y":label.y};else label.translate=false;if(label.w>=10&&label.h>=10)d.d3plus_label=label}}return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).attr("d",function(d){return area(d.values)}).call(shapeStyle,vars);else selection.selectAll("path.d3plus_data").attr("d",function(d){return area(d.values)}).call(shapeStyle,
vars)}},{"../../../core/fetch/text.js":66,"../../../font/sizes.coffee":101,"../../../geom/largestRect.coffee":159,"./style.coffee":233}],218:[function(require,module,exports){var fetchText=require("../../../core/fetch/text.js"),largestRect=require("../../../geom/largestRect.coffee"),shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){function init(paths){paths.attr("transform","scale(1)")}function update(paths){paths.attr("transform",function(d){var smaller_dim=
Math.min(d.d3plus.width,d.d3plus.height);var scale=Math.floor(smaller_dim/16);return"scale("+scale+")"})}enter.append("path").attr("class","d3plus_data").attr("d","M5-6.844L3.594-5.407L-2,0.188l-1.594-1.594L-5-2.844L-7.844,0l1.438,1.406l3,3L-2,5.843l1.406-1.438l7-7L7.844-4L5-6.844z").call(init).call(shapeStyle,vars);selection.selectAll("path.d3plus_data").data(function(d){return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(update).call(shapeStyle,
vars);else selection.selectAll("path.d3plus_data").call(update).call(shapeStyle,vars)}},{"../../../core/fetch/text.js":66,"../../../geom/largestRect.coffee":159,"./style.coffee":233}],219:[function(require,module,exports){var fetchColor,fetchValue,lighter,segments;fetchValue=require("../../../core/fetch/value.coffee");fetchColor=require("../../../core/fetch/color.coffee");lighter=require("../../../color/lighter.coffee");segments=require("./segments.coffee");module.exports=function(d,vars,stroke){var active,
shape,temp,total;shape=d.d3plus.shape||vars.shape.value;if(vars.shape.value==="line"&&shape!=="circle")return"none";else if(vars.shape.value==="area"||shape==="active"||vars.shape.value==="line")return fetchColor(vars,d);else if(shape==="temp")if(stroke)return fetchColor(vars,d);else return"url(#d3plus_hatch_"+d.d3plus.id+")";else if(d.d3plus["static"])return lighter(fetchColor(vars,d),.75);active=segments(vars,d,"active");temp=segments(vars,d,"temp");total=segments(vars,d,"total");if(!vars.active.value&&
!vars.temp.value||active===true||active&&total&&active>=total&&!temp||active&&!total)return fetchColor(vars,d);else if(vars.active.spotlight.value)return vars.color.missing;else return lighter(fetchColor(vars,d),.75)}},{"../../../color/lighter.coffee":45,"../../../core/fetch/color.coffee":63,"../../../core/fetch/value.coffee":67,"./segments.coffee":232}],220:[function(require,module,exports){var copy,distance,fetchText,fontSizes,labels,largestRect,path2poly,shapeStyle;copy=require("../../../util/copy.coffee");
distance=require("../../../network/distance.coffee");fetchText=require("../../../core/fetch/text.js");fontSizes=require("../../../font/sizes.coffee");largestRect=require("../../../geom/largestRect.coffee");path2poly=require("../../../geom/path2poly.coffee");shapeStyle=require("./style.coffee");labels={};module.exports=function(vars,selection,enter,exit){var projection,size_change;projection=d3.geo[vars.coords.projection.value]();if(projection.center)projection.center(vars.coords.center);if(!vars.zoom.scale)vars.zoom.scale=
1;vars.zoom.area=1/vars.zoom.scale/vars.zoom.scale;vars.path=d3.geo.path().projection(projection);if(vars.draw.timing)selection.selectAll("path.d3plus_data").attr("d",vars.path).transition().duration(vars.draw.timing).call(shapeStyle,vars);else selection.selectAll("path.d3plus_data").attr("d",vars.path).call(shapeStyle,vars);enter.append("path").attr("id",function(d){return d.id}).attr("class","d3plus_data").attr("d",vars.path).call(shapeStyle,vars);size_change=vars.old_height!==vars.height.viz||
vars.height.changed||vars.old_width!==vars.width.viz||vars.width.changed;vars.old_height=vars.height.viz;vars.old_width=vars.width.viz;if(vars.coords.changed||size_change||vars.coords.mute.changed||vars.coords.solo.changed||vars.type.changed||vars.text.changed||vars.coords.projection.changed||vars.labels.changed){vars.zoom.bounds=null;vars.zoom.reset=true;vars.zoom.coords={};return selection.each(function(d){var areaM,areas,b,c,center,coords,dist_cutoff,dist_values,distances,i,j,largest,len,names,
path,ratio,rect,reduced,ref,size,style;if(vars.coords.simplify.value&&d.geometry.coordinates.length>1){distances=[];areas=[];areaM=0;largest=copy(d);reduced=copy(d);d.geometry.coordinates=d.geometry.coordinates.filter(function(c,i){var a;reduced.geometry.coordinates=[c];a=vars.path.area(reduced);if(a>0){areas.push(a);if(a>areaM){largest.geometry.coordinates=[c];areaM=a}return true}else return false});center=vars.path.centroid(largest);ref=d.geometry.coordinates;for(i=j=0,len=ref.length;j<len;i=++j){c=
ref[i];reduced.geometry.coordinates=[c];distances.push(distance(vars.path.centroid(reduced),center))}dist_values=distances.reduce(function(arr,dist,i){if(dist)arr.push(areas[i]/dist);return arr},[]);dist_cutoff=d3.quantile(dist_values,vars.coords.threshold.value);reduced.geometry.coordinates=d.geometry.coordinates.filter(function(c,i){var a,dist;dist=distances[i];a=areas[i];return dist===0||a/dist>=dist_cutoff});coords=largest.geometry.coordinates[0];if(coords&&largest.geometry.type==="MultiPolygon"){coords=
coords[0];largest.geometry.coordinates[0]=coords;largest.geometry.type="Polygon"}}else{reduced=d;largest=d;coords=d.geometry.coordinates[0]}vars.zoom.coords[d.d3plus.id]=reduced;delete d.d3plus_label;if(vars.labels.value){names=fetchText(vars,d);if(coords&&names.length){path=path2poly(vars.path(largest));style={"font-weight":vars.labels.font.weight,"font-family":vars.labels.font.family.value};ratio=null;if(names[0].split(" ").length===1){size=fontSizes(names[0],style)[0];ratio=size.width/size.height}rect=
largestRect(path,{angle:0,aspectRatio:ratio});if(rect){rect=rect[0];d.d3plus_label={anchor:"middle",valign:"center",h:rect.height,w:rect.width,x:rect.cx,y:rect.cy,names:names}}}}labels[d.id]=d.d3plus_label;b=vars.path.bounds(reduced);if(!vars.zoom.bounds)return vars.zoom.bounds=b;else{if(vars.zoom.bounds[0][0]>b[0][0])vars.zoom.bounds[0][0]=b[0][0];if(vars.zoom.bounds[0][1]>b[0][1])vars.zoom.bounds[0][1]=b[0][1];if(vars.zoom.bounds[1][0]<b[1][0])vars.zoom.bounds[1][0]=b[1][0];if(vars.zoom.bounds[1][1]<
b[1][1])return vars.zoom.bounds[1][1]=b[1][1]}})}else if(!vars.focus.value.length){vars.zoom.viewport=false;return selection.each(function(d){return d.d3plus_label=labels[d.id]})}}},{"../../../core/fetch/text.js":66,"../../../font/sizes.coffee":101,"../../../geom/largestRect.coffee":159,"../../../geom/path2poly.coffee":161,"../../../network/distance.coffee":164,"../../../util/copy.coffee":206,"./style.coffee":233}],221:[function(require,module,exports){var shapeStyle=require("./style.coffee");module.exports=
function(vars,selection,enter,exit){function init(paths){paths.attr("d",d3.svg.symbol().type("cross").size(10))}function update(paths){paths.attr("d",d3.svg.symbol().type("cross").size(function(d){var smaller_dim=Math.min(d.d3plus.width,d.d3plus.height);return d3.scale.pow().exponent(2)(smaller_dim/2)}))}enter.append("path").attr("class","d3plus_data").call(init).call(shapeStyle,vars);selection.selectAll("path.d3plus_data").data(function(d){return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(update).call(shapeStyle,
vars);else selection.selectAll("path.d3plus_data").call(update).call(shapeStyle,vars)}},{"./style.coffee":233}],222:[function(require,module,exports){var shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){function init(paths){paths.attr("d",d3.svg.symbol().type("diamond").size(10))}function update(paths){paths.attr("d",d3.svg.symbol().type("diamond").size(function(d){var smaller_dim=Math.min(d.d3plus.width,d.d3plus.height);return d3.scale.pow().exponent(2)(smaller_dim/
2)}))}enter.append("path").attr("class","d3plus_data").call(init).call(shapeStyle,vars);selection.selectAll("path.d3plus_data").data(function(d){return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(update).call(shapeStyle,vars);else selection.selectAll("path.d3plus_data").call(update).call(shapeStyle,vars)}},{"./style.coffee":233}],223:[function(require,module,exports){var shapeStyle=require("./style.coffee");module.exports=function(vars,
selection,enter,exit){if(!vars.arcs)vars.arcs={"donut":{},"active":{},"temp":{}};var arc=d3.svg.arc().startAngle(0).endAngle(function(d){var a=vars.arcs[d.d3plus.shape][d.d3plus.id].a;return a>Math.PI*2?Math.PI*2:a}).innerRadius(function(d){if(d.d3plus["static"])return 0;var r=vars.arcs[d.d3plus.shape][d.d3plus.id].r;return r*vars.data.donut.size}).outerRadius(function(d){return vars.arcs[d.d3plus.shape][d.d3plus.id].r});function size(path,mod,rad,ang){if(!mod)var mod=0;if(typeof rad!="number")var rad=
undefined;if(typeof ang!="number")var ang=undefined;path.attrTween("d",function(d){if(rad==undefined)var r=d.d3plus.r?d.d3plus.r:d3.max([d.d3plus.width,d.d3plus.height]);else var r=rad;if(ang==undefined)var a=d.d3plus.segments[d.d3plus.shape];else var a=ang;if(!vars.arcs[d.d3plus.shape][d.d3plus.id]){vars.arcs[d.d3plus.shape][d.d3plus.id]={"r":0};vars.arcs[d.d3plus.shape][d.d3plus.id].a=Math.PI*2}var radius=d3.interpolate(vars.arcs[d.d3plus.shape][d.d3plus.id].r,r+mod),angle=d3.interpolate(vars.arcs[d.d3plus.shape][d.d3plus.id].a,
a);return function(t){vars.arcs[d.d3plus.shape][d.d3plus.id].r=radius(t);vars.arcs[d.d3plus.shape][d.d3plus.id].a=angle(t);return arc(d)}})}function data(d){if(d.d3plus.label)d.d3plus_label=d.d3plus.label;else delete d.d3plus_label;return[d]}if(vars.draw.timing){exit.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(size,0,0).each("end",function(d){delete vars.arcs[d.d3plus.shape][d.d3plus.id]});selection.selectAll("path.d3plus_data").data(data).transition().duration(vars.draw.timing).call(size).call(shapeStyle,
vars);enter.append("path").attr("class","d3plus_data").transition().duration(0).call(size,0,0).call(shapeStyle,vars).transition().duration(vars.draw.timing).call(size).call(shapeStyle,vars)}else{exit.selectAll("path.d3plus_data").each(function(d){delete vars.arcs[d.d3plus.shape][d.d3plus.id]});enter.append("path").attr("class","d3plus_data");selection.selectAll("path.d3plus_data").data(data).call(size).call(shapeStyle,vars)}}},{"./style.coffee":233}],224:[function(require,module,exports){var child=
require("../../../util/child.coffee"),closest=require("../../../util/closest.coffee"),createTooltip=require("../tooltip/create.js"),events=require("../../../client/pointer.coffee"),fetchValue=require("../../../core/fetch/value.coffee"),fetchColor=require("../../../core/fetch/color.coffee"),fetchText=require("../../../core/fetch/text.js"),legible=require("../../../color/legible.coffee"),print=require("../../../core/console/print.coffee"),removeTooltip=require("../../../tooltip/remove.coffee"),segments=
require("./segments.coffee"),shapeFill=require("./fill.js"),stringStrip=require("../../../string/strip.js"),touch=require("../../../client/touch.coffee"),touchEvent=require("../zoom/propagation.coffee"),uniqueValues=require("../../../util/uniques.coffee"),validObject=require("../../../object/validate.coffee"),zoomDirection=require("../zoom/direction.coffee");var drawShape={"arc":require("./arc.coffee"),"area":require("./area.js"),"check":require("./check.js"),"coordinates":require("./coordinates.coffee"),
"cross":require("./cross.js"),"diamond":require("./diamond.js"),"donut":require("./donut.js"),"line":require("./line.js"),"radial":require("./radial.coffee"),"rect":require("./rect.coffee"),"triangle_down":require("./triangle_down.js"),"triangle_up":require("./triangle_up.js"),"whisker":require("./whisker.coffee")};module.exports=function(vars){var data=vars.returned.nodes||[],edges=vars.returned.edges||[];vars.draw.timing=data.length<vars.data.large&&edges.length<vars.edges.large?vars.timing.transitions:
0;var shapeLookup={"arc":"arc","area":"area","check":"check","circle":"rect","coordinates":"coordinates","cross":"cross","donut":"donut","diamond":"diamond","line":"line","plus":"cross","radial":"radial","rect":"rect","square":"rect","triangle_down":"triangle_down","triangle":"triangle_up","triangle_up":"triangle_up","whisker":"whisker"};var shapes={};data.forEach(function(d){var s=d.d3plus&&d.d3plus.shape?d.d3plus.shape:vars.shape.value;if(s in shapeLookup){if(d.d3plus)d.d3plus.shape=s;s=shapeLookup[s];
if(!shapes[s])shapes[s]=[];shapes[s].push(d)}});function id(d){if(!d.d3plus.id){d.d3plus.id="";for(var i=0;i<=vars.depth.value;i++)d.d3plus.id+=fetchValue(vars,d,vars.id.nesting[i])+"_";d.d3plus.id+=shape;["x","y","x2","y2"].forEach(function(axis){if(vars[axis].scale.value=="discrete"){var val=fetchValue(vars,d,vars[axis].value);if(val.constructor===Date)val=val.getTime();d.d3plus.id+="_"+val}});if(d.d3plus.suffix)d.d3plus.id+="_"+d.d3plus.suffix;d.d3plus.id=stringStrip(d.d3plus.id)}return d}function transform(g,
grow){var scales=vars.types[vars.type.value].scale,scale=1;if(scales)if(validObject[scales]&&vars.shape.value in scales)scale=scales[vars.shape.value];else if(typeof scales=="function")scale=scales(vars,vars.shape.value);else if(typeof scales=="number")scale=scales;scale=grow?scale:1;g.attr("transform",function(d){if(["line","area","coordinates"].indexOf(shape)<0){var x=d.d3plus.x||0,y=d.d3plus.y||0;return"translate("+x+","+y+")scale("+scale+")"}else return"scale("+scale+")"})}function className(g){g.attr("class",
function(d){var c=vars["class"].value?" "+fetchValue(vars,d,vars["class"].value):"";return"d3plus_"+shape+c})}for(var s in shapeLookup)if(!(shapeLookup[s]in shapes)||d3.keys(shapes).length===0){var oldShapes=vars.g.data.selectAll("g.d3plus_"+shapeLookup[s]);if(vars.draw.timing)oldShapes.transition().duration(vars.draw.timing).attr("opacity",0).remove();else oldShapes.remove()}var labels=[],shares=[];for(var shape in shapes){var selection=vars.g.data.selectAll("g.d3plus_"+shape).data(shapes[shape],
function(d){if(!d.d3plus)d.d3plus={};if(shape==="coordinates"){d.d3plus.id=d.id;return d.id}if(!d.d3plus.id)if(d.values){d.values.forEach(function(v){v=id(v);v.d3plus.shape="circle"});d.d3plus.id=d.key}else{d=id(d);if(!d.d3plus.segments){d.d3plus.segments={"donut":Math.PI*2};var active=segments(vars,d,"active"),temp=segments(vars,d,"temp"),total=segments(vars,d,"total");if(total){if(active)d.d3plus.segments.active=active/total*(Math.PI*2);else d.d3plus.segments.active=0;if(temp)d.d3plus.segments.temp=
temp/total*(Math.PI*2)+d.d3plus.segments.active;else d.d3plus.segments.temp=0}}}return d.d3plus?d.d3plus.id:false});if(vars.draw.timing)var exit=selection.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();else var exit=selection.exit().remove();if(vars.draw.timing)selection.transition().duration(vars.draw.timing).call(transform).call(className);else selection.call(transform).call(className);var opacity=vars.draw.timing?0:1;var enter=selection.enter().append("g").attr("opacity",
opacity).call(transform).call(className);if(vars.draw.timing)enter.transition().duration(vars.draw.timing).attr("opacity",1);selection.order();if(vars.dev.value)print.time('drawing "'+shape+'" shapes');drawShape[shape](vars,selection,enter,exit,transform);if(vars.dev.value)print.timeEnd('drawing "'+shape+'" shapes');if(["rect","donut"].indexOf(shape)>=0&&vars.types[vars.type.value].fill){if(vars.dev.value)print.time('filling "'+shape+'" shapes');shapeFill(vars,selection,enter,exit,transform);if(vars.dev.value)print.timeEnd('filling "'+
shape+'" shapes')}}function edge_update(d){if(d&&vars.g.edges.selectAll("g").size()>0){vars.g.edge_hover.selectAll("*").remove();vars.g.edges.selectAll("g").each(function(l){var id=d[vars.id.value],source=l[vars.edges.source][vars.id.value],target=l[vars.edges.target][vars.id.value];if(source==id||source=="left_"+id||source=="right_"+id||target==id||target=="left_"+id||target=="right_"+id){var elem=vars.g.edge_hover.node().appendChild(this.cloneNode(true));d3.select(elem).datum(l).attr("opacity",
1).selectAll("line, path").datum(l)}});var marker=vars.edges.arrows.value;vars.g.edge_hover.attr("opacity",0).selectAll("line, path").style("stroke",vars.color.primary).style("stroke-width",function(d){if(vars.edges.path&&d.dy)return Math.max(1,d.dy);return vars.edges.size.value?d3.select(this).style("stroke-width"):vars.data.stroke.width*2}).attr("marker-start",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+e.d3plus.bucket;else var d="";return direction==
"source"&&marker?"url(#d3plus_edge_marker_highlight"+d+")":"none"}).attr("marker-end",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+e.d3plus.bucket;else var d="";return direction=="target"&&marker?"url(#d3plus_edge_marker_highlight"+d+")":"none"});vars.g.edge_hover.selectAll("text").style("fill",vars.color.primary);if(vars.draw.timing){vars.g.edge_hover.transition().duration(vars.timing.mouseevents).attr("opacity",1);vars.g.edges.transition().duration(vars.timing.mouseevents).attr("opacity",
.5)}else vars.g.edge_hover.attr("opacity",1)}else if(vars.draw.timing){vars.g.edge_hover.transition().duration(vars.timing.mouseevents).attr("opacity",0).transition().selectAll("*").remove();vars.g.edges.transition().duration(vars.timing.mouseevents).attr("opacity",1)}else vars.g.edge_hover.selectAll("*").remove()}edge_update();if(vars.tooltip.value)vars.g.data.selectAll("g").on(events.over,function(d){if(touch)touchEvent(vars,d3.event);if(!d3.event.buttons&&vars.mouse.value&&vars.mouse.over.value&&
!vars.draw.frozen&&(!d.d3plus||!d.d3plus["static"]))if(typeof vars.mouse.over.value==="function")vars.mouse.over.value(d,vars.self);else{var zoomDir=zoomDirection(d.d3plus_data||d,vars);var pointer=typeof vars.mouse.viz==="function"||typeof vars.mouse.viz[events.click]==="function"||vars.zoom.value&&(vars.types[vars.type.value].zoom||d.d3plus.threshold&&d.d3plus.merged||zoomDir===1||zoomDir===-1&&vars.history.states.length&&!vars.tooltip.value["long"]);d3.select(this).style("cursor",pointer?"pointer":
"auto").transition().duration(vars.timing.mouseevents).call(transform,true);d3.select(this).selectAll(".d3plus_data").transition().duration(vars.timing.mouseevents).attr("opacity",1);vars.covered=false;if(d.values&&vars.axes.discrete){var index=vars.axes.discrete==="x"?0:1,mouse=d3.mouse(vars.container.value.node())[index],positions=uniqueValues(d.values,function(x){return x.d3plus[vars.axes.discrete]}),match=closest(positions,mouse);d.d3plus_data=d.values[positions.indexOf(match)];d.d3plus=d.values[positions.indexOf(match)].d3plus}var tooltip_data=
d.d3plus_data?d.d3plus_data:d;createTooltip({"vars":vars,"data":tooltip_data});if(typeof vars.mouse.viz=="function")vars.mouse.viz(d.d3plus_data||d,vars);else if(vars.mouse.viz[events.over])vars.mouse.viz[events.over](d.d3plus_data||d,vars);edge_update(d)}else removeTooltip(vars.type.value)}).on(events.move,function(d){if(touch)touchEvent(vars,d3.event);if(!d3.event.buttons&&vars.mouse.value&&vars.mouse.move.value&&!vars.draw.frozen&&(!d.d3plus||!d.d3plus["static"]))if(typeof vars.mouse.move.value===
"function")vars.mouse.move.value(d,vars.self);else{var zoomDir=zoomDirection(d.d3plus_data||d,vars);var pointer=typeof vars.mouse.viz==="function"||typeof vars.mouse.viz[events.click]==="function"||vars.zoom.value&&(vars.types[vars.type.value].zoom||d.d3plus.threshold&&d.d3plus.merged||zoomDir===1||zoomDir===-1&&vars.history.states.length&&!vars.tooltip.value["long"]);d3.select(this).style("cursor",pointer?"pointer":"auto");var tooltipType=vars.types[vars.type.value].tooltip||"follow";if(d.values&&
vars.axes.discrete){var index=vars.axes.discrete==="x"?0:1,mouse=d3.mouse(vars.container.value.node())[index],positions=uniqueValues(d.values,function(x){return x.d3plus[vars.axes.discrete]}),match=closest(positions,mouse);d.d3plus_data=d.values[positions.indexOf(match)];d.d3plus=d.values[positions.indexOf(match)].d3plus}var tooltip_data=d.d3plus_data?d.d3plus_data:d;createTooltip({"vars":vars,"data":tooltip_data});if(typeof vars.mouse.viz=="function")vars.mouse.viz(d.d3plus_data||d,vars);else if(vars.mouse.viz[events.move])vars.mouse.viz[events.move](d.d3plus_data||
d,vars)}else removeTooltip(vars.type.value)}).on(events.out,function(d){if(touch)touchEvent(vars,d3.event);if(!d3.event.buttons&&vars.mouse.value&&vars.mouse.out.value)if(typeof vars.mouse.out.value==="function")vars.mouse.out.value(d,vars.self);else{var childElement=child(this,d3.event.toElement);if(!childElement&&!vars.draw.frozen&&(!d.d3plus||!d.d3plus["static"])){d3.select(this).transition().duration(vars.timing.mouseevents).call(transform);d3.select(this).selectAll(".d3plus_data").transition().duration(vars.timing.mouseevents).attr("opacity",
vars.data.opacity);if(!vars.covered)removeTooltip(vars.type.value);if(typeof vars.mouse.viz=="function")vars.mouse.viz(d.d3plus_data||d,vars);else if(vars.mouse.viz[events.out])vars.mouse.viz[events.out](d.d3plus_data||d,vars);edge_update()}}else removeTooltip(vars.type.value)});else{var mouseEvent=function(){touchEvent(vars,d3.event)};vars.g.data.selectAll("g").on(events.over,mouseEvent).on(events.move,mouseEvent).on(events.out,mouseEvent)}d3.select(window).on("scroll.d3plus",function(){removeTooltip(vars.type.value)});
vars.g.data.selectAll("g").on(events.click,function(d){if(!(vars.mouse.viz&&vars.mouse.viz.click===false)&&vars.mouse.value&&vars.mouse.click.value&&!d3.event.defaultPrevented&&!vars.draw.frozen&&(!d.d3plus||!d.d3plus["static"]))if(typeof vars.mouse.click.value==="function")vars.mouse.click.value(d,vars.self);else{if(d.values&&vars.axes.discrete){var index=vars.axes.discrete==="x"?0:1,mouse=d3.mouse(vars.container.value.node())[index],positions=uniqueValues(d.values,function(x){return x.d3plus[vars.axes.discrete]}),
match=closest(positions,mouse);d.d3plus_data=d.values[positions.indexOf(match)];d.d3plus=d.values[positions.indexOf(match)].d3plus}if(typeof vars.mouse.viz=="function")vars.mouse.viz(d.d3plus_data||d,vars);else if(vars.mouse.viz[events.out])vars.mouse.viz[events.out](d.d3plus_data||d,vars);else if(vars.mouse.viz[events.click])vars.mouse.viz[events.click](d.d3plus_data||d,vars);var depth_delta=zoomDirection(d.d3plus_data||d,vars),previous=vars.id.solo.value,title=fetchText(vars,d)[0],color=legible(fetchColor(vars,
d)),prev_sub=vars.title.sub.value||false,prev_color=vars.title.sub.font.color,prev_total=vars.title.total.font.color;if(d.d3plus.threshold&&d.d3plus.merged&&vars.zoom.value){vars.history.states.push(function(){vars.self.id({"solo":previous}).title({"sub":{"font":{"color":prev_color},"value":prev_sub},"total":{"font":{"color":prev_total}}}).draw()});vars.self.id({"solo":previous.concat(uniqueValues(d.d3plus.merged,vars.id.value,fetchValue,vars))}).title({"sub":{"font":{"color":color},"value":title},
"total":{"font":{"color":color}}}).draw()}else if(depth_delta===1&&vars.zoom.value){var id=fetchValue(vars,d.d3plus_data||d,vars.id.value);vars.history.states.push(function(){vars.self.depth(vars.depth.value-1).id({"solo":previous}).title({"sub":{"font":{"color":prev_color},"value":prev_sub},"total":{"font":{"color":prev_total}}}).draw()});vars.self.depth(vars.depth.value+1).id({"solo":previous.concat(id)}).title({"sub":{"font":{"color":color},"value":title},"total":{"font":{"color":color}}}).draw()}else if(depth_delta===
-1&&vars.zoom.value&&vars.history.states.length&&!vars.tooltip.value["long"])vars.history.back();else if(vars.types[vars.type.value].zoom&&vars.zoom.value){edge_update();d3.select(this).transition().duration(vars.timing.mouseevents).call(transform);d3.select(this).selectAll(".d3plus_data").transition().duration(vars.timing.mouseevents).attr("opacity",vars.data.opacity);removeTooltip(vars.type.value);vars.draw.update=false;if(!d||d[vars.id.value]==vars.focus.value[0])vars.self.focus(false).draw();
else vars.self.focus(d[vars.id.value]).draw()}else if(vars.types[vars.type.value].requirements.indexOf("focus")<0){edge_update();var tooltip_data=d.d3plus_data?d.d3plus_data:d;createTooltip({"vars":vars,"data":tooltip_data})}}})}},{"../../../client/pointer.coffee":38,"../../../client/touch.coffee":43,"../../../color/legible.coffee":44,"../../../core/console/print.coffee":52,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/validate.coffee":171,
"../../../string/strip.js":174,"../../../tooltip/remove.coffee":202,"../../../util/child.coffee":204,"../../../util/closest.coffee":205,"../../../util/uniques.coffee":209,"../tooltip/create.js":239,"../zoom/direction.coffee":249,"../zoom/propagation.coffee":252,"./arc.coffee":216,"./area.js":217,"./check.js":218,"./coordinates.coffee":220,"./cross.js":221,"./diamond.js":222,"./donut.js":223,"./fill.js":226,"./line.js":228,"./radial.coffee":230,"./rect.coffee":231,"./segments.coffee":232,"./triangle_down.js":234,
"./triangle_up.js":235,"./whisker.coffee":236}],225:[function(require,module,exports){var buckets=require("../../../util/buckets.coffee"),offset=require("../../../geom/offset.coffee");module.exports=function(vars){var edges=vars.returned.edges||[],scale=vars.zoom.behavior.scaleExtent()[0];if(typeof vars.edges.size.value==="string"){var strokeDomain=d3.extent(edges,function(e){return e[vars.edges.size.value]}),maxSize=d3.min(vars.returned.nodes||[],function(n){return n.d3plus.r})*(vars.edges.size.scale*
2);vars.edges.scale=d3.scale.sqrt().domain(strokeDomain).range([vars.edges.size.min,maxSize*scale])}else{var defaultWidth=typeof vars.edges.size.value=="number"?vars.edges.size.value:vars.edges.size.min;vars.edges.scale=function(){return defaultWidth}}var o=vars.edges.opacity.value;var o_type=typeof o;if(vars.edges.opacity.changed&&o_type==="string")vars.edges.opacity.scale.value.domain(d3.extent(edges,function(d){return d[o]})).range([vars.edges.opacity.min.value,1]);function init(l){l.attr("opacity",
0).style("stroke-width",0).style("stroke",vars.background.value).style("fill","none")}function style(edges){var marker=vars.edges.arrows.value;edges.attr("opacity",function(d){return o_type==="number"?o:o_type==="function"?o(d,vars):vars.edges.opacity.scale.value(d[o])}).style("stroke-width",function(e){return vars.edges.scale(e[vars.edges.size.value])}).style("stroke",vars.edges.color).attr("marker-start",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+
e.d3plus.bucket;else var d="";return direction=="source"&&marker?"url(#d3plus_edge_marker_default"+d+")":"none"}).attr("marker-end",function(e){var direction=vars.edges.arrows.direction.value;if("bucket"in e.d3plus)var d="_"+e.d3plus.bucket;else var d="";return direction=="target"&&marker?"url(#d3plus_edge_marker_default"+d+")":"none"}).attr("vector-effect","non-scaling-stroke").attr("pointer-events","none")}function line(l){l.attr("x1",function(d){return d[vars.edges.source].d3plus.edges[d[vars.edges.target][vars.id.value]].x}).attr("y1",
function(d){return d[vars.edges.source].d3plus.edges[d[vars.edges.target][vars.id.value]].y}).attr("x2",function(d){return d[vars.edges.target].d3plus.edges[d[vars.edges.source][vars.id.value]].x}).attr("y2",function(d){return d[vars.edges.target].d3plus.edges[d[vars.edges.source][vars.id.value]].y})}var curve=d3.svg.line().interpolate(vars.edges.interpolate.value);function spline(l){l.attr("d",function(d){return curve(d.d3plus.spline)})}function label(d){delete d.d3plus_label;if(vars.g.edges.selectAll("line, path").size()<
vars.edges.large&&vars.edges.label&&d[vars.edges.label]){if("spline"in d.d3plus)var length=this.getTotalLength(),center=this.getPointAtLength(length/2),prev=this.getPointAtLength(length/2-length*.1),next=this.getPointAtLength(length/2+length*.1),radians=Math.atan2(next.y-prev.y,next.x-prev.x),angle=radians*(180/Math.PI),bounding=this.parentNode.getBBox(),width=length*.8,x=center.x,y=center.y;else var bounds=this.getBBox(),source=d[vars.edges.source],target=d[vars.edges.target],start={"x":source.d3plus.edges[target[vars.id.value]].x,
"y":source.d3plus.edges[target[vars.id.value]].y},end={"x":target.d3plus.edges[source[vars.id.value]].x,"y":target.d3plus.edges[source[vars.id.value]].y},xdiff=end.x-start.x,ydiff=end.y-start.y,center={"x":end.x-xdiff/2,"y":end.y-ydiff/2},radians=Math.atan2(ydiff,xdiff),angle=radians*(180/Math.PI),length=Math.sqrt(xdiff*xdiff+ydiff*ydiff),width=length,x=center.x,y=center.y;width+=vars.labels.padding*2;var m=0;if(vars.edges.arrows.value){m=typeof vars.edges.arrows.value==="number"?vars.edges.arrows.value:
8;m=m/vars.zoom.behavior.scaleExtent()[1];width-=m*2}if(angle<-90||angle>90)angle-=180;if(width*vars.zoom.behavior.scaleExtent()[0]>20)d.d3plus_label={"x":x,"y":y,"translate":{"x":x,"y":y},"w":width,"h":15+vars.labels.padding*2,"angle":angle,"anchor":"middle","valign":"center","color":vars.edges.color,"resize":false,"names":[vars.format.value(d[vars.edges.label])],"background":1}}}var markerData=vars.edges.arrows.value?typeof vars.edges.size.value=="string"?["default_0","default_1","default_2","highlight_0",
"highlight_1","highlight_2","focus_0","focus_1","focus_2"]:["default","highlight","focus"]:[];if(typeof vars.edges.size.value=="string"){var b=buckets(vars.edges.scale.range(),4),markerSize=[];for(var i=0;i<3;i++)markerSize.push(b[i+1]+(b[1]-b[0])*(i+2)*2)}else{var m=typeof vars.edges.arrows.value==="number"?vars.edges.arrows.value:8;var markerSize=typeof vars.edges.size.value==="number"?vars.edges.size.value/m:m}var marker=vars.defs.selectAll(".d3plus_edge_marker").data(markerData,String);var marker_style=
function(path){path.attr("d",function(id){var depth=id.split("_");if(depth.length==2&&vars.edges.scale){depth=parseInt(depth[1]);var m=markerSize[depth]}else var m=markerSize;if(vars.edges.arrows.direction.value=="target")return"M 0,-"+m/2+" L "+m*.85+",0 L 0,"+m/2+" L 0,-"+m/2;else return"M 0,-"+m/2+" L -"+m*.85+",0 L 0,"+m/2+" L 0,-"+m/2}).attr("fill",function(d){var type=d.split("_")[0];if(type=="default")return vars.edges.color;else if(type=="focus")return vars.color.focus;else return vars.color.primary}).attr("transform",
"scale("+1/scale+")")};if(vars.draw.timing){marker.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();marker.select("path").transition().duration(vars.draw.timing).attr("opacity",1).call(marker_style)}else{marker.exit().remove();marker.select("path").attr("opacity",1).call(marker_style)}var opacity=vars.draw.timing?0:1;var enter=marker.enter().append("marker").attr("id",function(d){return"d3plus_edge_marker_"+d}).attr("class","d3plus_edge_marker").attr("orient","auto").attr("markerUnits",
"userSpaceOnUse").style("overflow","visible").append("path").attr("opacity",opacity).attr("vector-effect","non-scaling-stroke").call(marker_style);if(vars.draw.timing)enter.transition().duration(vars.draw.timing).attr("opacity",1);var strokeBuckets=typeof vars.edges.size.value=="string"?buckets(vars.edges.scale.domain(),4):null,direction=vars.edges.arrows.direction.value;var line_data=edges.filter(function(l){if(!l.d3plus)l.d3plus={};l.d3plus.id="edge_"+l[vars.edges.source][vars.id.value]+"_"+l[vars.edges.target][vars.id.value];
if(l.d3plus.spline!==true){if(strokeBuckets){var size=l[vars.edges.size.value];l.d3plus.bucket=size<strokeBuckets[1]?0:size<strokeBuckets[2]?1:2;var marker=markerSize[l.d3plus.bucket]*.85/scale}else{delete l.d3plus.bucket;var marker=markerSize*.85/scale}var source=l[vars.edges.source],target=l[vars.edges.target];if(!source.d3plus||!target.d3plus)return false;var sourceAngle=Math.atan2(source.d3plus.y-target.d3plus.y,source.d3plus.x-target.d3plus.x),targetAngle=Math.atan2(target.d3plus.y-source.d3plus.y,
target.d3plus.x-source.d3plus.x),sourceRadius=direction=="source"&&vars.edges.arrows.value?source.d3plus.r+marker:source.d3plus.r,targetRadius=direction=="target"&&vars.edges.arrows.value?target.d3plus.r+marker:target.d3plus.r,sourceOffset=offset(sourceAngle,sourceRadius,vars.shape.value),targetOffset=offset(targetAngle,targetRadius,vars.shape.value);if(!("edges"in source.d3plus))source.d3plus.edges={};source.d3plus.edges[target[vars.id.value]]={"x":source.d3plus.x-sourceOffset.x,"y":source.d3plus.y-
sourceOffset.y};if(!("edges"in target.d3plus))target.d3plus.edges={};target.d3plus.edges[source[vars.id.value]]={"x":target.d3plus.x-targetOffset.x,"y":target.d3plus.y-targetOffset.y};return true}return false});var lines=vars.g.edges.selectAll("g.d3plus_edge_line").data(line_data,function(d){return d.d3plus.id});var spline_data=edges.filter(function(l){if(l.d3plus.spline){if(strokeBuckets){var size=l[vars.edges.size.value];l.d3plus.bucket=size<strokeBuckets[1]?0:size<strokeBuckets[2]?1:2;var marker=
markerSize[l.d3plus.bucket]*.85/scale}else{delete l.d3plus.bucket;var marker=markerSize*.85/scale}var source=l[vars.edges.source],target=l[vars.edges.target],sourceEdge=source.d3plus.edges?source.d3plus.edges[target[vars.id.value]]||{}:{},targetEdge=target.d3plus.edges?target.d3plus.edges[source[vars.id.value]]||{}:{},sourceMod=vars.edges.arrows.value&&direction=="source"?marker:0,targetMod=vars.edges.arrows.value&&direction=="target"?marker:0,angleTweak=.1,sourceTweak=source.d3plus.x>target.d3plus.x?
1-angleTweak:1+angleTweak,targetTweak=source.d3plus.x>target.d3plus.x?1+angleTweak:1-angleTweak,sourceAngle=typeof sourceEdge.angle==="number"?sourceEdge.angle:Math.atan2(source.d3plus.y-target.d3plus.y,source.d3plus.x-target.d3plus.x)*sourceTweak,sourceOffset=offset(sourceAngle,source.d3plus.r+sourceMod,vars.shape.value),targetAngle=typeof targetEdge.angle==="number"?targetEdge.angle:Math.atan2(target.d3plus.y-source.d3plus.y,target.d3plus.x-source.d3plus.x)*targetTweak,targetOffset=offset(targetAngle,
target.d3plus.r+targetMod,vars.shape.value),start=[source.d3plus.x-sourceOffset.x,source.d3plus.y-sourceOffset.y],startOffset=sourceEdge.offset?offset(sourceAngle,sourceEdge.offset):false,startPoint=startOffset?[start[0]-startOffset.x,start[1]-startOffset.y]:start,end=[target.d3plus.x-targetOffset.x,target.d3plus.y-targetOffset.y],endOffset=targetEdge.offset?offset(targetAngle,targetEdge.offset):false,endPoint=endOffset?[end[0]-endOffset.x,end[1]-endOffset.y]:end,xd=endPoint[0]-startPoint[0],yd=endPoint[1]-
startPoint[1],sourceDistance=typeof sourceEdge.radius==="number"?sourceEdge.radius:Math.sqrt(xd*xd+yd*yd)/4,targetDistance=typeof targetEdge.radius==="number"?targetEdge.radius:Math.sqrt(xd*xd+yd*yd)/4,startAnchor=offset(sourceAngle,sourceDistance-source.d3plus.r-sourceMod*2),endAnchor=offset(targetAngle,targetDistance-target.d3plus.r-targetMod*2);l.d3plus.spline=[start,end];var testAngle=Math.abs(Math.atan2(source.d3plus.y-target.d3plus.y,source.d3plus.x-target.d3plus.x)).toFixed(5),testStart=Math.abs(sourceAngle).toFixed(5),
testEnd=Math.abs(targetAngle-Math.PI).toFixed(5);if(testStart!==testEnd||[testStart,testEnd].indexOf(testAngle)<0){l.d3plus.spline.splice(1,0,[startPoint[0]-startAnchor.x,startPoint[1]-startAnchor.y],[endPoint[0]-endAnchor.x,endPoint[1]-endAnchor.y]);if(startOffset)l.d3plus.spline.splice(1,0,startPoint);if(endOffset)l.d3plus.spline.splice(l.d3plus.spline.length-1,0,endPoint)}return true}return false});var splines=vars.g.edges.selectAll("g.d3plus_edge_path").data(spline_data,function(d){return d.d3plus.id});
if(vars.draw.timing){lines.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();splines.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();lines.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(vars.draw.timing/2).attr("opacity",0).remove();splines.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(vars.draw.timing/2).attr("opacity",0).remove();lines.selectAll("line").data(function(d){return[d]}).transition().duration(vars.draw.timing).call(line).call(style).each("end",
label);splines.selectAll("path").data(function(d){return[d]}).transition().duration(vars.draw.timing).call(spline).call(style).each("end",label);lines.enter().append("g").attr("class","d3plus_edge_line").append("line").call(line).call(init).transition().duration(vars.draw.timing).call(style).each("end",label);splines.enter().append("g").attr("class","d3plus_edge_path").append("path").call(spline).call(init).transition().duration(vars.draw.timing).call(style).each("end",label)}else{lines.exit().remove();
splines.exit().remove();lines.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove();splines.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove();lines.selectAll("line").data(function(d){return[d]}).call(line).call(style).call(label);splines.selectAll("path").data(function(d){return[d]}).call(spline).call(style).call(label);lines.enter().append("g").attr("class","d3plus_edge_line").append("line").call(line).call(init).call(style).call(label);splines.enter().append("g").attr("class",
"d3plus_edge_path").append("path").call(spline).call(init).call(style).call(label)}}},{"../../../geom/offset.coffee":160,"../../../util/buckets.coffee":203}],226:[function(require,module,exports){var copy=require("../../../util/copy.coffee"),fetchColor=require("../../../core/fetch/color.coffee"),fetchValue=require("../../../core/fetch/value.coffee"),segments=require("./segments.coffee"),shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){function init(nodes){nodes.attr("x",
0).attr("y",0).attr("width",0).attr("height",0)}function update(nodes,mod){if(!mod)mod=0;nodes.attr("x",function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return-w/2-mod/2}).attr("y",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return-h/2-mod/2}).attr("width",function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return w+mod}).attr("height",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return h+mod}).attr("rx",function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;
var rounded=["circle","donut"].indexOf(vars.shape.value)>=0;return rounded?(w+mod)/2:0}).attr("ry",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;var rounded=["circle","donut"].indexOf(vars.shape.value)>=0;return rounded?(h+mod)/2:0}).attr("shape-rendering",function(d){if(["square"].indexOf(vars.shape.value)>=0)return vars.shape.rendering.value;else return"auto"})}if(!vars.arcs)vars.arcs={"donut":{},"active":{},"temp":{}};var arc=d3.svg.arc().startAngle(0).endAngle(function(d){var a=vars.arcs[d.d3plus.shape][d.d3plus.id].a;
return a>Math.PI*2?Math.PI*2:a}).innerRadius(function(d){if(!d.d3plus["static"]&&vars.shape.value==="donut"){var r=vars.arcs[d.d3plus.shape][d.d3plus.id].r;return r*vars.data.donut.size}else return 0}).outerRadius(function(d){var r=vars.arcs[d.d3plus.shape][d.d3plus.id].r;return vars.shape.value==="donut"?r:r*2});function size(path,mod,rad,ang){if(!mod)mod=0;if(typeof rad!="number")rad=undefined;if(typeof ang!="number")ang=undefined;path.attrTween("d",function(d){if(rad===undefined)var r=d.d3plus.r?
d.d3plus.r:d3.max([d.d3plus.width,d.d3plus.height]);else var r=rad;if(ang===undefined)var a=d.d3plus.segments[d.d3plus.shape];else var a=ang;if(!vars.arcs[d.d3plus.shape][d.d3plus.id]){vars.arcs[d.d3plus.shape][d.d3plus.id]={"r":0};vars.arcs[d.d3plus.shape][d.d3plus.id].a=d.d3plus.shape==="donut"?Math.PI*2:0}var radius=d3.interpolate(vars.arcs[d.d3plus.shape][d.d3plus.id].r,r+mod),angle=d3.interpolate(vars.arcs[d.d3plus.shape][d.d3plus.id].a,a);return function(t){vars.arcs[d.d3plus.shape][d.d3plus.id].r=
radius(t);vars.arcs[d.d3plus.shape][d.d3plus.id].a=angle(t);return arc(d)}})}selection.each(function(d){var active=segments(vars,d,"active"),temp=segments(vars,d,"temp"),total=segments(vars,d,"total"),group=d3.select(this),color=fetchColor(vars,d);var fill_data=[],hatch_data=[];if(total&&vars.types[vars.type.value].fill){if(temp){var c=copy(d);c.d3plus.shape="temp";fill_data.push(c);hatch_data=["temp"]}if(active&&(active<total||temp)){var c=copy(d);c.d3plus.shape="active";fill_data.push(c)}}function hatch_lines(l){l.attr("stroke",
color).attr("stroke-width",1).attr("shape-rendering",vars.shape.rendering.value)}var pattern=vars.defs.selectAll("pattern#d3plus_hatch_"+d.d3plus.id).data(hatch_data);if(vars.draw.timing){pattern.selectAll("rect").transition().duration(vars.draw.timing).style("fill",color);pattern.selectAll("line").transition().duration(vars.draw.timing).style("stroke",color)}else{pattern.selectAll("rect").style("fill",color);pattern.selectAll("line").style("stroke",color)}var pattern_enter=pattern.enter().append("pattern").attr("id",
"d3plus_hatch_"+d.d3plus.id).attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","10").attr("height","10").append("g");pattern_enter.append("rect").attr("x","0").attr("y","0").attr("width","10").attr("height","10").attr("fill",color).attr("fill-opacity",.25);pattern_enter.append("line").attr("x1","0").attr("x2","10").attr("y1","0").attr("y2","10").call(hatch_lines);pattern_enter.append("line").attr("x1","-1").attr("x2","1").attr("y1","9").attr("y2","11").call(hatch_lines);
pattern_enter.append("line").attr("x1","9").attr("x2","11").attr("y1","-1").attr("y2","1").call(hatch_lines);var clip_data=fill_data.length?[d]:[];var clip=group.selectAll("#d3plus_clip_"+d.d3plus.id).data(clip_data);clip.enter().insert("clipPath",".d3plus_mouse").attr("id","d3plus_clip_"+d.d3plus.id).append("rect").attr("class","d3plus_clipping").call(init);if(vars.draw.timing){clip.selectAll("rect").transition().duration(vars.draw.timing).call(update);clip.exit().transition().delay(vars.draw.timing).remove()}else{clip.selectAll("rect").call(update);
clip.exit().remove()}var fills=group.selectAll("path.d3plus_fill").data(fill_data);fills.transition().duration(vars.draw.timing).call(shapeStyle,vars).call(size);fills.enter().insert("path","rect.d3plus_mouse").attr("class","d3plus_fill").attr("clip-path","url(#d3plus_clip_"+d.d3plus.id+")").transition().duration(0).call(shapeStyle,vars).call(size,0,undefined,0).transition().duration(vars.draw.timing).call(size).call(shapeStyle,vars);fills.exit().transition().duration(vars.draw.timing).call(size,
0,undefined,0).remove()})}},{"../../../core/fetch/color.coffee":63,"../../../core/fetch/value.coffee":67,"../../../util/copy.coffee":206,"./segments.coffee":232,"./style.coffee":233}],227:[function(require,module,exports){var copy=require("../../../util/copy.coffee"),fetchText=require("../../../core/fetch/text.js"),fetchValue=require("../../../core/fetch/value.coffee"),mix=require("../../../color/mix.coffee"),print=require("../../../core/console/print.coffee"),rtl=require("../../../client/rtl.coffee"),
segments=require("./segments.coffee"),shapeColor=require("./color.coffee"),stringList=require("../../../string/list.coffee"),textColor=require("../../../color/text.coffee"),textWrap=require("../../../textwrap/textwrap.coffee");module.exports=function(vars,group){var scale=vars.types[vars.type.value].zoom?vars.zoom.behavior.scaleExtent():[1,1],selection=vars.g[group].selectAll("g");var opacity=function(elem){elem.attr("opacity",function(d){var size=parseFloat(d3.select(this).attr("font-size"),10);
d.visible=size*(vars.zoom.scale/scale[1])>=2;return d.visible?1:0})};var remove=function(text){if(vars.draw.timing)text.transition().duration(vars.draw.timing).attr("opacity",0).remove();else text.remove()};var style=function(text){var salign=vars.labels.valign.value==="bottom"?"top":"bottom";text.attr("font-weight",vars.labels.font.weight).attr("font-family",vars.labels.font.family.value).attr("stroke","none").attr("pointer-events",function(t){return t.mouse?"auto":"none"}).attr("fill",function(t){if(t.color)return t.color;
var color=shapeColor(t.parent,vars),legible=textColor(color),opacity=t.text?.15:1;return mix(color,legible,.2,opacity)}).each(function(t){if(t.resize instanceof Array)var min=t.resize[0],max=t.resize[1];var size=t.resize,resize=true;if(t.text){if(!(size instanceof Array)){size=[9,50];resize=t.resize}var y=t.y-t.h*scale[1]/2+t.padding/2;if(salign==="bottom")y+=t.h*scale[1]/2;textWrap().align("center").container(d3.select(this)).height(t.h*scale[1]/2).padding(t.padding/2).resize(resize).size(size).text(vars.format.value(t.text*
100,{"key":"share","vars":vars})).width(t.w*scale[1]).valign(salign).x(t.x-t.w*scale[1]/2+t.padding/2).y(y).draw()}else{if(!(t.resize instanceof Array)){size=[7,40*(scale[1]/scale[0])];resize=t.resize}var yOffset=vars.labels.valign.value==="bottom"?t.share:0;textWrap().align(t.anchor||vars.labels.align.value).container(d3.select(this)).height(t.h*scale[1]-t.share).padding(t.padding/2).resize(resize).size(size).shape(t.shape||"square").text(t.names).valign(vars.labels.valign.value).width(t.w*scale[1]).x(t.x-
t.w*scale[1]/2+t.padding/2).y(t.y-t.h*scale[1]/2+t.padding/2+yOffset).draw()}}).attr("transform",function(t){var translate=d3.select(this).attr("transform")||"";var a=t.angle||0,x=t.translate&&t.translate.x?t.translate.x:0,y=t.translate&&t.translate.y?t.translate.y:0;if(translate.length)translate=translate.split(")").slice(-3).join(")");return"rotate("+a+","+x+","+y+")scale("+1/scale[1]+")translate("+(t.x*scale[1]-t.x)+","+(t.y*scale[1]-t.y)+")"+translate})};if(group==="edges"||vars.labels.value){if(vars.dev.value){var timerString=
"drawing "+group+" labels";print.time(timerString)}selection.each(function(d){var disabled=d.d3plus&&"label"in d.d3plus&&!d.d3plus.label,label=d.d3plus_label||null,share=d.d3plus_share,names=d.d3plus.text?d.d3plus.text:label&&label.names?label.names:vars.labels.text.value?fetchValue(vars,d,vars.labels.text.value):fetchText(vars,d),group=label&&"group"in label?label.group:d3.select(this),share_size=0,fill=vars.types[vars.type.value].fill;if(!(names instanceof Array))names=[names];if(label)if(["line",
"area"].indexOf(vars.shape.value)>=0)var background=true;else if(d&&"d3plus"in d)var active=segments(vars,d,"active"),temp=segments(vars,d,"temp"),total=segments(vars,d,"total"),background=!temp&&!active||active>=total||!active&&temp>=total;if(!disabled&&(label&&label.force||background||!fill)){if(share&&d.d3plus.share&&share.w-vars.labels.padding*2>=10&&share.h-vars.labels.padding*2>=10&&vars.labels.valign.value!="middle"){share.resize=vars.labels.resize.value===false?false:share&&"resize"in share?
share.resize:true;share.padding=vars.labels.padding;share.text=d.d3plus.share;share.parent=d;var text=group.selectAll("text#d3plus_share_"+d.d3plus.id).data([share],function(t){return t.w+""+t.h+""+t.text});if(vars.draw.timing&&vars.zoom.scale===1){text.transition().duration(vars.draw.timing/2).call(style);text.enter().append("text").attr("id","d3plus_share_"+d.d3plus.id).attr("class","d3plus_share").attr("opacity",0).call(style).transition().duration(vars.draw.timing/2).delay(vars.draw.timing/2).attr("opacity",
1)}else{text.attr("opacity",1).call(style);text.enter().append("text").attr("id","d3plus_share_"+d.d3plus.id).attr("class","d3plus_share").attr("opacity",1).call(style)}share_size=text.node().getBBox().height+vars.labels.padding;text.exit().call(remove)}else group.selectAll("text.d3plus_share").call(remove);if(label){label.resize=vars.labels.resize.value===false?false:label&&"resize"in label?label.resize:true;label.padding=typeof label.padding==="number"?label.padding:vars.labels.padding}if(label&&
label.w*scale[1]-label.padding>=20&&label.h*scale[1]-label.padding>=10&&names.length){var and=vars.format.locale.value.ui.and,more=vars.format.locale.value.ui.more;for(var i=0;i<names.length;i++)if(names[i]instanceof Array)names[i]=stringList(names[i],and,3,more);label.names=names;label.share=share_size;label.parent=d;var text=group.selectAll("text#d3plus_label_"+d.d3plus.id).data([label],function(t){if(!t)return false;return t.w+"_"+t.h+"_"+t.x+"_"+t.y+"_"+t.names.join("_")}),fontSize=label.resize?
undefined:vars.labels.font.size*scale[0]+"px";if(vars.draw.timing&&vars.zoom.scale===1){text.transition().duration(vars.draw.timing/2).call(style).call(opacity);text.enter().append("text").attr("font-size",fontSize).attr("id","d3plus_label_"+d.d3plus.id).attr("class","d3plus_label").attr("opacity",0).call(style).transition().duration(vars.draw.timing/2).delay(vars.draw.timing/2).call(opacity)}else{text.attr("opacity",1).call(style).call(opacity);text.enter().append("text").attr("font-size",fontSize).attr("id",
"d3plus_label_"+d.d3plus.id).attr("class","d3plus_label").call(style).call(opacity)}text.exit().call(remove);if(text.size()===0||text.selectAll("tspan").size()===0){delete d.d3plus_label;d3.select(this).selectAll("text#d3plus_label_"+d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove);vars.g.labels.selectAll("text#d3plus_label_"+d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove)}else{if(label.background){var background_data=["background"];var box=text.node().getBBox();var bounds=
{"height":box.height,"width":box.width,"x":box.x,"y":box.y};bounds.width+=vars.labels.padding*scale[0];bounds.height+=vars.labels.padding*scale[0];bounds.x-=vars.labels.padding*scale[0]/2;bounds.y-=vars.labels.padding*scale[0]/2;var y=text.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0];y=y.replace(/([^a-z])\s([^a-z])/gi,"$1,$2");y=y.split(",");if(y.length>1){y=y[y.length-1];y=y.substring(0,y.length-1);bounds.y+=y}}else var background_data=[],bounds={};var bg=group.selectAll("rect#d3plus_label_bg_"+
d.d3plus.id).data(background_data),bg_opacity=typeof label.background==="number"?label.background:typeof label.background==="string"?1:.6;function bg_style(elem){var color=typeof label.background==="string"?label.background:vars.background.value==="none"?"#ffffff":vars.background.value,fill=typeof label.background==="string"?label.background:color,transform=text.attr("transform").split(")");transform.pop();transform.pop();transform.push("");transform=transform.join(")");elem.attr("fill",fill).attr(bounds).attr("transform",
transform)}if(vars.draw.timing){bg.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();bg.transition().duration(vars.draw.timing).attr("opacity",bg_opacity).call(bg_style);bg.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+d.d3plus.id).attr("class","d3plus_label_bg").attr("opacity",0).call(bg_style).transition().duration(vars.draw.timing).attr("opacity",bg_opacity)}else{bg.exit().remove();bg.enter().insert("rect",".d3plus_label").attr("id","d3plus_label_bg_"+
d.d3plus.id).attr("class","d3plus_label_bg");bg.attr("opacity",bg_opacity).call(bg_style)}}}else{delete d.d3plus_label;d3.select(this).selectAll("text#d3plus_label_"+d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove);vars.g.labels.selectAll("text#d3plus_label_"+d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove)}}else{delete d.d3plus_label;d3.select(this).selectAll("text#d3plus_label_"+d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove);vars.g.labels.selectAll("text#d3plus_label_"+
d.d3plus.id+", rect#d3plus_label_bg_"+d.d3plus.id).call(remove)}});if(vars.dev.value)print.timeEnd(timerString)}else{if(vars.dev.value){var timerString="removing "+group+" labels";print.time(timerString)}selection.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove);vars.g.labels.selectAll("text.d3plus_label, rect.d3plus_label_bg").call(remove);if(vars.dev.value)print.timeEnd(timerString)}}},{"../../../client/rtl.coffee":40,"../../../color/mix.coffee":46,"../../../color/text.coffee":50,
"../../../core/console/print.coffee":52,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../string/list.coffee":173,"../../../textwrap/textwrap.coffee":199,"../../../util/copy.coffee":206,"./color.coffee":219,"./segments.coffee":232}],228:[function(require,module,exports){var copy=require("../../../util/copy.coffee"),closest=require("../../../util/closest.coffee"),events=require("../../../client/pointer.coffee"),shapeStyle=require("./style.coffee"),fetchValue=require("../../../core/fetch/value.coffee");
module.exports=function(vars,selection,enter,exit){var line=d3.svg.line().x(function(d){return d.d3plus.x}).y(function(d){return d.d3plus.y}).interpolate(vars.shape.interpolate.value);var stroke=vars.size.value||vars.data.stroke.width*2,discrete=vars[vars.axes.discrete],hitarea=function(l){var s=stroke;if(s.constructor!==Number){var v=fetchValue(vars,l,stroke);if(v&&v.length)s=d3.max(v);else s=vars.data.stroke.width}return s<15?15:s};var ticks=discrete.ticks.values.map(function(d){if(d.constructor===
Date)return d.getTime();else return d});selection.each(function(d){var lastIndex=false,segments=[],nodes=[],temp=copy(d),group=d3.select(this);temp.values=[];temp.segment_key=temp.key;d.values.forEach(function(v,i,arr){var k=fetchValue(vars,v,discrete.value);if(k.constructor===Date)k=k.getTime();var index=ticks.indexOf(closest(ticks,k));if(lastIndex===false||lastIndex===index-1){temp.values.push(v);temp.segment_key+="_"+index}else{if(temp.values.length>1)segments.push(temp);else nodes.push(temp.values[0]);
temp=copy(d);temp.values=[v]}if(i===arr.length-1)if(temp.values.length>1)segments.push(temp);else nodes.push(temp.values[0]);lastIndex=index});var paths=group.selectAll("path.d3plus_line").data(segments,function(d){if(!d.d3plus)d.d3plus={};d.d3plus.shape="line";return d.segment_key});var rects=group.selectAll("rect.d3plus_anchor").data(nodes,function(d){if(!d.d3plus)d.d3plus={};d.d3plus.r=vars.data.stroke.width*2;return d.d3plus.id});if(vars.draw.timing){paths.exit().transition().duration(vars.draw.timing).attr("opacity",
0).remove();paths.transition().duration(vars.draw.timing).attr("d",function(d){return line(d.values)}).call(shapeStyle,vars);paths.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round").attr("d",function(d){return line(d.values)}).call(shapeStyle,vars).attr("opacity",0).transition().duration(vars.draw.timing).attr("opacity",1);rects.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(d){return d.d3plus.id}).call(init).call(shapeStyle,vars);rects.transition().duration(vars.draw.timing).call(update).call(shapeStyle,
vars);rects.exit().transition().duration(vars.draw.timing).call(init).remove()}else{paths.exit().remove();paths.enter().append("path").attr("class","d3plus_line").style("stroke-linecap","round");paths.attr("d",function(d){return line(d.values)}).call(shapeStyle,vars);rects.enter().append("rect").attr("class","d3plus_anchor").attr("id",function(d){return d.d3plus.id});rects.exit().remove();rects.call(update).call(shapeStyle,vars)}var mouse=group.selectAll("path.d3plus_mouse").data(segments,function(d){return d.segment_key});
mouse.enter().append("path").attr("class","d3plus_mouse").attr("d",function(l){return line(l.values)}).style("stroke","black").style("stroke-width",hitarea).style("fill","none").style("stroke-linecap","round").attr("opacity",0);mouse.on(events.over,function(m){if(!vars.draw.frozen)mouseStyle(vars,this,stroke,2)}).on(events.out,function(d){if(!vars.draw.frozen)mouseStyle(vars,this,stroke,0)});if(vars.draw.timing)mouse.transition().duration(vars.draw.timing).attr("d",function(l){return line(l.values)}).style("stroke-width",
hitarea);else mouse.attr("d",function(l){return line(l.values)}).style("stroke-width",hitarea);mouse.exit().remove()})};function init(n){n.attr("x",function(d){return d.d3plus.x}).attr("y",function(d){return d.d3plus.y}).attr("width",0).attr("height",0)}function update(n,mod){if(mod===undefined)mod=0;n.attr("x",function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return d.d3plus.x-(w/2+mod/2)}).attr("y",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return d.d3plus.y-(h/2+mod/2)}).attr("width",
function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return w+mod}).attr("height",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return h+mod}).attr("rx",function(d){var w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return(w+mod)/2}).attr("ry",function(d){var h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return(h+mod)/2})}function mouseStyle(vars,elem,stroke,mod){var timing=vars.draw.timing?vars.timing.mouseevents:0;if(mod===undefined)mod=0;if(timing){d3.select(elem.parentNode).selectAll("path.d3plus_line").transition().duration(timing).style("stroke-width",
function(l){var s=stroke;if(s.constructor!==Number){var v=fetchValue(vars,l,stroke);if(v&&v.length)s=d3.max(v);else s=vars.data.stroke.width}return s+mod});d3.select(elem.parentNode).selectAll("rect").transition().duration(timing).style("stroke-width",function(l){var s=stroke;if(s.constructor!==Number){var v=fetchValue(vars,l,stroke);if(v&&v.length)s=d3.max(v);else s=vars.data.stroke.width}return s}).call(update,mod)}else{d3.select(elem.parentNode).selectAll("path.d3plus_line").style("stroke-width",
function(l){var s=stroke;if(s.constructor!==Number){var v=fetchValue(vars,l,stroke);if(v&&v.length)s=d3.max(v);else s=vars.data.stroke.width}return s+mod});d3.select(elem.parentNode).selectAll("rect").style("stroke-width",function(l){var s=stroke;if(s.constructor!==Number){var v=fetchValue(vars,l,stroke);if(v&&v.length)s=d3.max(v);else s=vars.data.stroke.width}return s}).call(update,mod)}}},{"../../../client/pointer.coffee":38,"../../../core/fetch/value.coffee":67,"../../../util/closest.coffee":205,
"../../../util/copy.coffee":206,"./style.coffee":233}],229:[function(require,module,exports){module.exports=function(vars){var edges=vars.returned.edges||[];var paths=vars.g.edges.selectAll("g.d3plus_edge_path").data(edges,function(d){d.d3plus.id="path_"+d[vars.edges.source][vars.id.value]+"_"+d[vars.edges.target][vars.id.value];return d.d3plus.id});function pathStyles(p){p.attr("d",vars.edges.path).style("stroke-width",function(d){return Math.max(1,d.dy)}).style("stroke","#ddd").style("fill","none").attr("transform",
function(d){return"translate("+d.d3plus.x+","+d.d3plus.y+")"})}if(vars.draw.timing){paths.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();paths.selectAll("text.d3plus_label, rect.d3plus_label_bg").transition().duration(vars.draw.timing/2).attr("opacity",0).remove();paths.selectAll("path").data(function(d){return[d]}).transition().duration(vars.draw.timing).call(pathStyles);paths.enter().append("g").attr("class","d3plus_edge_path").append("path").style("stroke-width",0).transition().duration(vars.draw.timing).call(pathStyles)}else{paths.exit().remove();
paths.selectAll("text.d3plus_label, rect.d3plus_label_bg").remove();paths.selectAll("path").data(function(d){return[d]}).call(pathStyles);paths.enter().append("g").attr("class","d3plus_edge_path").append("path").call(pathStyles)}}},{}],230:[function(require,module,exports){var angles,interpolates,radii,shapeStyle;shapeStyle=require("./style.coffee");radii={};angles={};interpolates={r:{},a:{}};module.exports=function(vars,selection,enter,exit){var data,newRadial,nextLevel,radial,radialTween;nextLevel=
vars.id.nesting[vars.depth.value+1];radial=d3.svg.line.radial().interpolate("linear-closed").radius(function(d){return d.d3plus.r}).angle(function(d){return d.d3plus.a});data=function(d){if(vars.labels.value)if(d.d3plus.label)d.d3plus_label=d.d3plus.label;else delete d.d3plus_label;return[d]};if(vars.draw.timing){selection.each(function(d){var c,j,len,ref,results;ref=d[nextLevel];results=[];for(j=0,len=ref.length;j<len;j++){c=ref[j];results.push(c.d3plus.id=c[vars.id.value]+"_"+c[nextLevel])}return results});
newRadial=d3.svg.line.radial().interpolate("linear-closed").radius(function(d,i){if(radii[d.d3plus.id]===void 0)radii[d.d3plus.id]=0;if(isNaN(radii[d.d3plus.id]))radii[d.d3plus.id]=d.d3plus.r;return radii[d.d3plus.id]}).angle(function(d,i){if(angles[d.d3plus.id]===void 0)angles[d.d3plus.id]=d.d3plus.a;if(isNaN(angles[d.d3plus.id]))angles[d.d3plus.id]=d.d3plus.a;return angles[d.d3plus.id]});radialTween=function(arcs,newRadius){return arcs.attrTween("d",function(d){var a,c,i,j,len,r,ref;ref=d[nextLevel];
for(i=j=0,len=ref.length;j<len;i=++j){c=ref[i];a=c.d3plus.a;if(newRadius===void 0)r=c.d3plus.r;else if(newRadius===0)r=0;interpolates.a[c.d3plus.id]=d3.interpolate(angles[c.d3plus.id],a);interpolates.r[c.d3plus.id]=d3.interpolate(radii[c.d3plus.id],r)}return function(t){var k,len1,ref1;ref1=d[nextLevel];for(i=k=0,len1=ref1.length;k<len1;i=++k){c=ref1[i];angles[c.d3plus.id]=interpolates.a[c.d3plus.id](t);radii[c.d3plus.id]=interpolates.r[c.d3plus.id](t)}return newRadial(d[nextLevel])}})};enter.append("path").attr("class",
"d3plus_data").call(shapeStyle,vars).attr("d",function(d){return newRadial(d[nextLevel])});selection.selectAll("path.d3plus_data").data(data).transition().duration(vars.draw.timing).call(shapeStyle,vars).call(radialTween);exit.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(radialTween,0)}else{enter.append("path").attr("class","d3plus_data");selection.selectAll("path.d3plus_data").data(data).call(shapeStyle,vars).attr("d",function(d){return radial(d[nextLevel])})}}},{"./style.coffee":233}],
231:[function(require,module,exports){var shapeStyle;shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){var data,init,update;data=function(d){var h,w;if(vars.labels.value&&!d.d3plus.label){w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;d.d3plus_label={w:w,h:h,x:0,y:0};d.d3plus_share={w:w,h:h,x:0,y:0};d.d3plus_label.shape=d.d3plus.shape==="circle"?"circle":"square"}else if(d.d3plus.label)d.d3plus_label=d.d3plus.label;else delete d.d3plus_label;
return[d]};init=function(nodes){return nodes.attr("x",function(d){if(d.d3plus.init&&"x"in d.d3plus.init)return d.d3plus.init.x;else if(d.d3plus.init&&"width"in d.d3plus.init)return-d.d3plus.width/2;else return 0}).attr("y",function(d){if(d.d3plus.init&&"y"in d.d3plus.init)return d.d3plus.init.y;else if(d.d3plus.init&&"height"in d.d3plus.init)return-d.d3plus.height/2;else return 0}).attr("width",function(d){if(d.d3plus.init&&"width"in d.d3plus.init)return d.d3plus.init.width;else return 0}).attr("height",
function(d){if(d.d3plus.init&&"height"in d.d3plus.init)return d.d3plus.init.height;else return 0})};update=function(nodes){return nodes.attr("x",function(d){var w;w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;return-w/2}).attr("y",function(d){var h;h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;return-h/2}).attr("width",function(d){if(d.d3plus.r)return d.d3plus.r*2;else return d.d3plus.width}).attr("height",function(d){if(d.d3plus.r)return d.d3plus.r*2;else return d.d3plus.height}).attr("rx",function(d){var rounded,
w;rounded=d.d3plus.shape==="circle";w=d.d3plus.r?d.d3plus.r*2:d.d3plus.width;if(rounded)return(w+2)/2;else return 0}).attr("ry",function(d){var h,rounded;rounded=d.d3plus.shape==="circle";h=d.d3plus.r?d.d3plus.r*2:d.d3plus.height;if(rounded)return(h+2)/2;else return 0}).attr("transform",function(d){if("rotate"in d.d3plus)return"rotate("+d.d3plus.rotate+")";else return""}).attr("shape-rendering",function(d){if(d.d3plus.shape==="square"&&!("rotate"in d.d3plus))return vars.shape.rendering.value;else return"auto"})};
if(vars.draw.timing){enter.append("rect").attr("class","d3plus_data").call(init).call(shapeStyle,vars);selection.selectAll("rect.d3plus_data").data(data).transition().duration(vars.draw.timing).call(update).call(shapeStyle,vars);return exit.selectAll("rect.d3plus_data").transition().duration(vars.draw.timing).call(init)}else{enter.append("rect").attr("class","d3plus_data");return selection.selectAll("rect.d3plus_data").data(data).call(update).call(shapeStyle,vars)}}},{"./style.coffee":233}],232:[function(require,
module,exports){var fetchValue;fetchValue=require("../../../core/fetch/value.coffee");module.exports=function(vars,d,segment){var ret;ret=vars[segment].value;if(ret)if(segment in d.d3plus)return d.d3plus[segment];else return fetchValue(vars,d,ret);else return d.d3plus[segment]}},{"../../../core/fetch/value.coffee":67}],233:[function(require,module,exports){var color,ie,value;color=require("./color.coffee");ie=require("../../../client/ie.js");value=require("../../../core/fetch/value.coffee");module.exports=
function(nodes,vars){return nodes.attr("fill",function(d){if(d.d3plus&&d.d3plus.spline)return"none";else return color(d,vars)}).style("stroke",function(d){var c;if(d.d3plus&&d.d3plus.stroke)return d.d3plus.stroke;else{c=d.values?color(d.values[0],vars):color(d,vars,true);return d3.rgb(c).darker(.6)}}).style("stroke-width",function(d){var v;if(ie&&vars.types[vars.type.value].zoom)return 0;if(d.d3plus.shape==="line"&&vars.size.value){if(vars.size.value.constructor===Number)return vars.size.value;v=
value(vars,d,vars.size.value);if(v&&v.length)return d3.max(v)}return vars.data.stroke.width}).attr("opacity",vars.data.opacity).attr("vector-effect","non-scaling-stroke")}},{"../../../client/ie.js":37,"../../../core/fetch/value.coffee":67,"./color.coffee":219}],234:[function(require,module,exports){var shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){function init(paths){paths.attr("d",d3.svg.symbol().type("triangle-down").size(10))}function update(paths){paths.attr("d",
d3.svg.symbol().type("triangle-down").size(function(d){var smaller_dim=Math.min(d.d3plus.width,d.d3plus.height);return d3.scale.pow().exponent(2)(smaller_dim/2)}))}enter.append("path").attr("class","d3plus_data").call(init).call(shapeStyle,vars);selection.selectAll("path.d3plus_data").data(function(d){return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(update).call(shapeStyle,vars);else selection.selectAll("path.d3plus_data").call(update).call(shapeStyle,
vars)}},{"./style.coffee":233}],235:[function(require,module,exports){var shapeStyle=require("./style.coffee");module.exports=function(vars,selection,enter,exit){function init(paths){paths.attr("d",d3.svg.symbol().type("triangle-up").size(10))}function update(paths){paths.attr("d",d3.svg.symbol().type("triangle-up").size(function(d){var smaller_dim=Math.min(d.d3plus.width,d.d3plus.height);return d3.scale.pow().exponent(2)(smaller_dim/2)}))}enter.append("path").attr("class","d3plus_data").call(init).call(shapeStyle,
vars);selection.selectAll("path.d3plus_data").data(function(d){return[d]});if(vars.draw.timing)selection.selectAll("path.d3plus_data").transition().duration(vars.draw.timing).call(update).call(shapeStyle,vars);else selection.selectAll("path.d3plus_data").call(update).call(shapeStyle,vars)}},{"./style.coffee":233}],236:[function(require,module,exports){module.exports=function(vars,selection,enter,exit){var d,data,init,marker,orient,pos,position,size,style;data=function(d){if(d.d3plus.text)d.d3plus_label=
{w:size,h:size,x:0,y:0,background:"#fff",resize:false,angle:["left","right"].indexOf(d.d3plus.position)>=0?90:0};else if(d.d3plus.label)d.d3plus_label=d.d3plus.label;else delete d.d3plus_label;return[d]};style=function(line){return line.style("stroke-width",vars.data.stroke.width).style("stroke","#444").attr("fill","none").attr("shape-rendering",vars.shape.rendering.value)};init=function(line){return line.attr("x1",0).attr("x2",0).attr("y1",0).attr("y2",0)};position=function(line){return line.attr("x1",
function(d){var offset,w,x;if(["top","bottom"].indexOf(d.d3plus.position)>=0)return 0;else{offset=d.d3plus.offset||0;w=d.d3plus.width||0;x=offset<0?-w:w;return x+offset}}).attr("x2",function(d){if(["top","bottom"].indexOf(d.d3plus.position)>=0)return 0;else return d.d3plus.offset||0}).attr("y1",function(d){var h,offset,y;if(["left","right"].indexOf(d.d3plus.position)>=0)return 0;else{offset=d.d3plus.offset||0;h=d.d3plus.height||0;y=offset<0?-h:h;return y+offset}}).attr("y2",function(d){if(["left",
"right"].indexOf(d.d3plus.position)>=0)return 0;else return d.d3plus.offset||0}).attr("marker-start","url(#d3plus_whisker_marker)")};marker=vars.defs.selectAll("#d3plus_whisker_marker").data([0]);marker.enter().append("marker").attr("id","d3plus_whisker_marker").attr("markerUnits","userSpaceOnUse").style("overflow","visible").append("line");d=selection.datum();if(d){pos=d.d3plus.position;orient=["top","bottom"].indexOf(pos)>=0?"horizontal":"vertical";size=orient==="horizontal"?d.d3plus.width:d.d3plus.height}else{orient=
"horizontal";size=0}marker.select("line").attr("x1",orient==="horizontal"?-size/2:0).attr("x2",orient==="horizontal"?size/2:0).attr("y1",orient==="vertical"?-size/2:0).attr("y2",orient==="vertical"?size/2:0).call(style).style("stroke-width",vars.data.stroke.width*2);if(vars.draw.timing){enter.append("line").attr("class","d3plus_data").call(style).call(init);selection.selectAll("line.d3plus_data").data(data).transition().duration(vars.draw.timing).call(style).call(position);exit.selectAll("line.d3plus_data").transition().duration(vars.draw.timing).call(init)}else{enter.append("line").attr("class",
"d3plus_data");selection.selectAll("line.d3plus_data").data(data).call(style).call(position)}}},{}],237:[function(require,module,exports){var events=require("../../../client/pointer.coffee"),prefix=require("../../../client/prefix.coffee"),print=require("../../../core/console/print.coffee"),touch=require("../../../client/touch.coffee"),touchEvent=require("../zoom/propagation.coffee");module.exports=function(vars){if(vars.dev.value)print.time("creating SVG elements");vars.svg=vars.container.value.selectAll("svg#d3plus").data([0]);
vars.svg.enter().insert("svg","#d3plus_message").attr("id","d3plus").attr("width",vars.width.value).attr("height",vars.height.value).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink");vars.g.bg=vars.svg.selectAll("rect#bg").data(["bg"]);vars.g.bg.enter().append("rect").attr("id","bg").attr("fill",vars.background.value).attr("stroke","none").attr("width",vars.width.value).attr("height",vars.height.value);vars.g.timeline=vars.svg.selectAll("g#timeline").data(["timeline"]);
vars.g.timeline.enter().append("g").attr("id","timeline").attr("transform","translate(0,"+vars.height.value+")");vars.g.legend=vars.svg.selectAll("g#key").data(["key"]);vars.g.legend.enter().append("g").attr("id","key").attr("transform","translate(0,"+vars.height.value+")");vars.g.footer=vars.svg.selectAll("g#footer").data(["footer"]);vars.g.footer.enter().append("g").attr("id","footer").attr("transform","translate(0,"+vars.height.value+")");var clipID="clipping_"+vars.container.id;vars.g.clipping=
vars.svg.selectAll("#clipping").data(["clipping"]);vars.g.clipping.enter().append("clipPath").attr("id",clipID).append("rect").attr("width",vars.width.viz).attr("height",vars.height.viz);vars.g.container=vars.svg.selectAll("g#container").data(["container"]);vars.g.container.enter().append("g").attr("id","container").attr("clip-path","url(#"+clipID+")").attr("transform","translate("+vars.margin.left+","+vars.margin.top+")");vars.g.zoom=vars.g.container.selectAll("g#zoom").data(["zoom"]);vars.g.zoom.enter().append("g").attr("id",
"zoom");vars.g.viz=vars.g.zoom.selectAll("g#d3plus_viz").data(["d3plus_viz"]);vars.g.viz.enter().append("g").attr("id","d3plus_viz");vars.g.overlay=vars.g.viz.selectAll("rect#d3plus_overlay").data([{"id":"d3plus_overlay"}]);vars.g.overlay.enter().append("rect").attr("id","d3plus_overlay").attr("width",vars.width.value).attr("height",vars.height.value).attr("opacity",0);vars.g.overlay.on(events.move,function(d){if(touch)touchEvent(vars,d3.event);if(vars.types[vars.type.value].zoom&&vars.zoom.pan.value&&
vars.zoom.behavior.scaleExtent()[0]<vars.zoom.scale)d3.select(this).style("cursor",prefix()+"grab");else d3.select(this).style("cursor","auto")}).on(events.up,function(d){if(touch)touchEvent(vars,d3.event);if(vars.types[vars.type.value].zoom&&vars.zoom.pan.value&&vars.zoom.behavior.scaleExtent()[0]<vars.zoom.scale)d3.select(this).style("cursor",prefix()+"grab");else d3.select(this).style("cursor","auto")}).on(events.down,function(d){if(touch)touchEvent(vars,d3.event);if(vars.types[vars.type.value].zoom&&
vars.zoom.pan.value&&vars.zoom.behavior.scaleExtent()[0]<vars.zoom.scale)d3.select(this).style("cursor",prefix()+"grabbing");else d3.select(this).style("cursor","auto")});vars.g.app=vars.g.viz.selectAll("g#app").data(["app"]);vars.g.app.enter().append("g").attr("id","app");vars.g.edges=vars.g.viz.selectAll("g#edges").data(["edges"]);vars.g.edges.enter().append("g").attr("id","edges").attr("opacity",0);vars.g.edge_focus=vars.g.viz.selectAll("g#focus").data(["focus"]);vars.g.edge_focus.enter().append("g").attr("id",
"focus");vars.g.edge_hover=vars.g.viz.selectAll("g#edge_hover").data(["edge_hover"]);vars.g.edge_hover.enter().append("g").attr("id","edge_hover").attr("opacity",0);vars.g.data=vars.g.viz.selectAll("g#data").data(["data"]);vars.g.data.enter().append("g").attr("id","data").attr("opacity",0);vars.g.data_focus=vars.g.viz.selectAll("g#data_focus").data(["data_focus"]);vars.g.data_focus.enter().append("g").attr("id","data_focus");vars.g.labels=vars.g.viz.selectAll("g#d3plus_labels").data(["d3plus_labels"]);
vars.g.labels.enter().append("g").attr("id","d3plus_labels");vars.defs=vars.svg.selectAll("defs").data(["defs"]);vars.defs.enter().append("defs");if(vars.dev.value)print.timeEnd("creating SVG elements")}},{"../../../client/pointer.coffee":38,"../../../client/prefix.coffee":39,"../../../client/touch.coffee":43,"../../../core/console/print.coffee":52,"../zoom/propagation.coffee":252}],238:[function(require,module,exports){var print=require("../../../core/console/print.coffee");module.exports=function(vars){if(vars.dev.value)print.time("updating SVG elements");
if(vars.draw.timing){vars.container.value.transition().duration(vars.draw.timing).style("width",vars.width.value+"px").style("height",vars.height.value+"px");vars.svg.transition().duration(vars.draw.timing).attr("width",vars.width.value).attr("height",vars.height.value);vars.g.bg.transition().duration(vars.draw.timing).attr("width",vars.width.value).attr("height",vars.height.value).attr("fill",vars.background.value);vars.g.clipping.select("rect").transition().duration(vars.draw.timing).attr("width",
vars.width.viz).attr("height",vars.height.viz);vars.g.container.transition().duration(vars.draw.timing).attr("transform","translate("+vars.margin.left+","+vars.margin.top+")")}else{vars.container.value.style("width",vars.width.value+"px").style("height",vars.height.value+"px");vars.svg.attr("width",vars.width.value).attr("height",vars.height.value);vars.g.bg.attr("width",vars.width.value).attr("height",vars.height.value).attr("fill",vars.background.value);vars.g.clipping.select("rect").attr("width",
vars.width.viz).attr("height",vars.height.viz);vars.g.container.attr("transform","translate("+vars.margin.left+","+vars.margin.top+")")}if(vars.dev.value)print.timeEnd("updating SVG elements")}},{"../../../core/console/print.coffee":52}],239:[function(require,module,exports){var arraySort=require("../../../array/sort.coffee"),createTooltip=require("../../../tooltip/create.js"),dataNest=require("../../../core/data/nest.js"),fetchData=require("./data.js"),fetchColor=require("../../../core/fetch/color.coffee"),
fetchText=require("../../../core/fetch/text.js"),fetchValue=require("../../../core/fetch/value.coffee"),mergeObject=require("../../../object/merge.coffee"),removeTooltip=require("../../../tooltip/remove.coffee"),segments=require("../shapes/segments.coffee"),scroll=require("../../../client/scroll.js"),uniques=require("../../../util/uniques.coffee"),validObject=require("../../../object/validate.coffee"),zoomDirection=require("../zoom/direction.coffee");module.exports=function(params){if(!("d3plus"in
params.data))params.data.d3plus={};var vars=params.vars,d=params.data,dataDepth="d3plus"in d&&"depth"in d.d3plus?d.d3plus.depth:vars.depth.value,ex=params.ex,mouse=params.mouseevents?params.mouseevents:false,arrow="arrow"in params?params.arrow:true,id=fetchValue(vars,d,vars.id.value),tooltip_id=params.id||vars.type.value;if(d3.event&&d3.event.type=="click"&&(vars.tooltip.html.value||vars.tooltip.value["long"])&&!("fullscreen"in params)){var fullscreen=true,arrow=false,mouse=true,length="long",footer=
vars.footer.value;vars.covered=true}else{var fullscreen=false,align=params.anchor||vars.tooltip.anchor,length=params.length||"short",zoom=zoomDirection(d,vars);if(zoom===-1)var key=vars.id.nesting[dataDepth-1],parent=fetchValue(vars,id,key);var text="";if(!(!vars.mouse.click.value||vars.mouse.viz&&vars.mouse.viz.click===false))if(zoom===1&&vars.zoom.value)var text=vars.format.value(vars.format.locale.value.ui.expand);else if(zoom===-1&&vars.zoom.value&&vars.history.states.length&&!vars.tooltip.value["long"])var text=
vars.format.value(vars.format.locale.value.ui.collapse);else if(!vars.small&&length=="short"&&(vars.tooltip.html.value||vars.tooltip.value["long"])&&(vars.focus.value.length!==1||vars.focus.value[0]!=id))var text=vars.format.locale.value.ui.moreInfo;else if(length=="long")var text=vars.footer.value||"";var footer=text.length?vars.format.value(text,{"key":"footer","vars":vars}):false}if("x"in params)var x=params.x;else if(vars.types[vars.type.value].tooltip==="static"){var x=d.d3plus.x;if(vars.zoom.translate&&
vars.zoom.scale)x=vars.zoom.translate[0]+x*vars.zoom.scale;x+=vars.margin.left;if(params.length!=="long"){y+=scroll.x();x+=vars.container.value.node().getBoundingClientRect().left;x+=parseFloat(vars.container.value.style("padding-left"),10)}}else var x=d3.mouse(d3.select("html").node())[0];if("y"in params)var y=params.y;else if(vars.types[vars.type.value].tooltip=="static"){var y=d.d3plus.y;if(vars.zoom.translate&&vars.zoom.scale)y=vars.zoom.translate[1]+y*vars.zoom.scale;y+=vars.margin.top;if(params.length!==
"long"){y+=scroll.y();y+=vars.container.value.node().getBoundingClientRect().top;y+=parseFloat(vars.container.value.style("padding-top"),10)}}else var y=d3.mouse(d3.select("html").node())[1];if("offset"in params)var offset=params.offset;else if(vars.types[vars.type.value].tooltip=="static"){var offset=d.d3plus.r?d.d3plus.r:d.d3plus.height/2;if(vars.zoom.scale)offset=offset*vars.zoom.scale}else var offset=3;function make_tooltip(html){var titleDepth="depth"in params?params.depth:dataDepth;var ex={},
children,depth=vars.id.nesting[titleDepth+1]in d?titleDepth+1:titleDepth,nestKey=vars.id.nesting[depth],nameList="merged"in d.d3plus?d.d3plus.merged:d[nestKey];if(!(nameList instanceof Array))nameList=[nameList];var dataValue=fetchValue(vars,d,vars.size.value);if(vars.tooltip.children.value){nameList=nameList.slice(0);if(nameList.length>1&&validObject(nameList[0]))nameList=dataNest(vars,nameList,[nestKey]);if(vars.size.value&&validObject(nameList[0])){var namesNoValues=[];var namesWithValues=nameList.filter(function(n){var val=
fetchValue(vars,n,vars.size.value);if(val!==null&&(!("d3plus"in n)||!n.d3plus.merged))return true;else namesNoValues.push(n)});arraySort(namesWithValues,vars.size.value,"desc",[],vars);nameList=namesWithValues.concat(namesNoValues)}var limit=length==="short"?3:vars.data.large,listLength=nameList.length,max=d3.min([listLength,limit]),objs=[];children={"values":[]};for(var i=0;i<max;i++){if(!nameList.length)break;var obj=nameList.shift(),name=fetchText(vars,obj,depth)[0],id=validObject(obj)?fetchValue(vars,
obj,nestKey,depth):obj;if(id!==d[vars.id.nesting[titleDepth]]&&name&&!children[name]){var value=validObject(obj)?fetchValue(vars,obj,vars.size.value,nestKey):null,color=fetchColor(vars,obj,nestKey);children[name]=value&&!(value instanceof Array)?vars.format.value(value,{"key":vars.size.value,"vars":vars,"data":obj}):"";var child={};child[name]=children[name];children.values.push(child);if(color){if(!children.d3plus_colors)children.d3plus_colors={};children.d3plus_colors[name]=color}}else i--}if(listLength>
max)children.d3plusMore=listLength-max}if(d.d3plus.tooltip)ex=mergeObject(ex,d.d3plus.tooltip);function getLabel(method){return typeof vars[method].value==="string"?vars[method].value:vars.format.locale.value.method[method]}if(vars.tooltip.size.value){if(dataValue&&typeof vars.size.value!=="number")ex[getLabel("size")]=dataValue;if(vars.axes.opposite&&vars[vars.axes.opposite].value!==vars.size.value)ex[getLabel(vars.axes.opposite)]=fetchValue(vars,d,vars[vars.axes.opposite].value);if(vars.axes.opposite&&
vars[vars.axes.opposite+"2"].value!==vars.size.value)ex[getLabel(vars.axes.opposite+"2")]=fetchValue(vars,d,vars[vars.axes.opposite+"2"].value);if(vars.color.valueScale)ex[getLabel("color")]=fetchValue(vars,d,vars.color.value)}var active=segments(vars,d,"active"),temp=segments(vars,d,"temp"),total=segments(vars,d,"total");if(typeof active=="number"&&active>0&&total)ex[getLabel("active")]=active+"/"+total+" ("+vars.format.value(active/total*100,{"key":"share","vars":vars,"data":d})+")";if(typeof temp==
"number"&&temp>0&&total)ex[getLabel("temp")]=temp+"/"+total+" ("+vars.format.value(temp/total*100,{"key":"share","vars":vars,"data":d})+")";if(vars.tooltip.share.value&&d.d3plus.share)ex.share=vars.format.value(d.d3plus.share*100,{"key":"share","vars":vars,"data":d});var depth="depth"in params?params.depth:dataDepth,title=params.title||fetchText(vars,d,depth)[0],icon=uniques(d,vars.icon.value,fetchValue,vars,vars.id.nesting[depth]),tooltip_data=fetchData(vars,d,length,ex,children,depth);if(icon.length===
1&&typeof icon[0]==="string")icon=icon[0];else icon=false;if(tooltip_data.length>0||footer||(!d.d3plus_label&&length=="short"&&title||d.d3plus_label&&(!("visible"in d.d3plus_label)||"visible"in d.d3plus_label&&d.d3plus_label.visible===false))){if(!title)title=vars.format.value(id,{"key":vars.id.value,"vars":vars});var depth="d3plus"in d&&"merged"in d.d3plus?dataDepth-1:"depth"in params?params.depth:dataDepth;if(depth<0)depth=0;depth=vars.id.nesting[depth];if(typeof vars.icon.style.value=="string")var icon_style=
vars.icon.style.value;else if(typeof vars.icon.style.value=="object"&&vars.icon.style.value[depth])var icon_style=vars.icon.style.value[depth];else var icon_style="default";var width=vars.tooltip.small;if(params.width)width=params.width;else if(fullscreen)width=vars.tooltip.large;var parent=!fullscreen&&params.length!=="long"||fullscreen&&vars.tooltip.fullscreen.value?d3.select("body"):vars.container.value;if(!params.description&&d&&vars.tooltip.sub.value)params.description=fetchValue(vars,d,vars.tooltip.sub.value);
createTooltip({"align":align,"arrow":arrow,"locale":vars.format.locale.value,"background":vars.tooltip.background,"curtain":vars.tooltip.curtain.color,"curtainopacity":vars.tooltip.curtain.opacity,"fontcolor":vars.tooltip.font.color,"fontfamily":vars.tooltip.font.family.value,"fontsize":vars.tooltip.font.size,"fontweight":vars.tooltip.font.weight,"data":tooltip_data,"color":fetchColor(vars,d),"allColors":true,"footer":params.footer===false?params.footer:footer,"fullscreen":fullscreen,"html":html,
"js":params.js,"icon":icon,"id":tooltip_id,"max_height":params.maxheight,"max_width":width,"mouseevents":mouse,"offset":offset,"parent":parent,"stacked":vars.tooltip.stacked.value,"style":icon_style,"title":title,"description":params.description,"width":!params.width&&!fullscreen&&tooltip_data.length==0?"auto":width,"x":x,"y":y})}else removeTooltip(tooltip_id)}if(fullscreen||params.length==="long")if(typeof vars.tooltip.html.value=="string")make_tooltip(vars.tooltip.html.value);else if(typeof vars.tooltip.html.value==
"function")make_tooltip(vars.tooltip.html.value(id));else if(vars.tooltip.html.value&&typeof vars.tooltip.html.value=="object"&&vars.tooltip.html.value.url){var tooltip_url=vars.tooltip.html.value.url;if(typeof tooltip_url==="function")tooltip_url=tooltip_url(id);d3.json(tooltip_url,function(data){var html=vars.tooltip.html.value.callback?vars.tooltip.html.value.callback(data):data;make_tooltip(html)})}else make_tooltip(params.html);else make_tooltip(params.html)}},{"../../../array/sort.coffee":34,
"../../../client/scroll.js":41,"../../../core/data/nest.js":60,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/merge.coffee":170,"../../../object/validate.coffee":171,"../../../tooltip/create.js":200,"../../../tooltip/remove.coffee":202,"../../../util/uniques.coffee":209,"../shapes/segments.coffee":232,"../zoom/direction.coffee":249,"./data.js":240}],240:[function(require,module,exports){var copy=require("../../../util/copy.coffee"),
fetchValue=require("../../../core/fetch/value.coffee"),fetchColor=require("../../../core/fetch/color.coffee"),fetchText=require("../../../core/fetch/text.js"),legible=require("../../../color/legible.coffee"),mergeObject=require("../../../object/merge.coffee"),prefix=require("../../../client/prefix.coffee"),stringFormat=require("../../../string/format.js"),validObject=require("../../../object/validate.coffee");module.exports=function(vars,id,length,extras,children,depth){if(vars.small)return[];if(!length)var length=
"long";if(length=="long")var other_length="short";else var other_length="long";var extra_data={};if(extras&&typeof extras=="string")extras=[extras];else if(extras&&typeof extras=="object"){extra_data=mergeObject(extra_data,extras);var extras=[];for(var k in extra_data)extras.push(k)}else if(!extras)var extras=[];var tooltip_highlights=[];if(vars.tooltip.value instanceof Array)var a=vars.tooltip.value;else if(typeof vars.tooltip.value=="string")var a=[vars.tooltip.value];else{if(vars.tooltip.value[vars.id.nesting[depth]])var a=
vars.tooltip.value[vars.id.nesting[depth]];else var a=vars.tooltip.value;if(!(a instanceof Array))if(a[length])a=a[length];else if(a[other_length])a=[];else a=mergeObject({"":[]},a);if(typeof a=="string")a=[a];else if(!(a instanceof Array))a=mergeObject({"":[]},a)}function format_key(key,group){if(vars.attrs.value[group])var id_var=group;else var id_var=null;if(group)group=vars.format.value(group);var value=extra_data[key]||fetchValue(vars,id,key,id_var);if(validObject(value))tooltip_data.push({"name":vars.format.value(key),
"value":vars.format.value(value.value,{"key":value.key,"vars":vars}),"group":group});else if(value!=null&&value!="undefined"&&!(value instanceof Array)&&(typeof value==="string"&&value.indexOf("d3plus_other")<0||!(typeof value==="string"))){var name=vars.format.locale.value.ui[key]?vars.format.value(vars.format.locale.value.ui[key]):vars.format.value(key),h=tooltip_highlights.indexOf(key)>=0;if(value instanceof Array)value.forEach(function(v){v=vars.format.value(v,{"key":key,"vars":vars,"data":id})});
else value=vars.format.value(value,{"key":key,"vars":vars,"data":id});var obj={"name":name,"value":value,"highlight":h,"group":group};if(vars.descs.value)if(typeof vars.descs.value==="function"){var descReturn=vars.descs.value(key);if(typeof descReturn==="string")obj.desc=descReturn}else if(key in vars.descs.value)obj.desc=vars.descs.value[key];tooltip_data.push(obj)}}var tooltip_data=[];if(a.constructor===Array)a={"":a};if(vars.id.nesting.length&&depth<vars.id.nesting.length-1){var a=copy(a);vars.id.nesting.forEach(function(n,
i){if(i>depth&&a[n])delete a[n]})}for(var group in a){if(a[group].constructor!==Array)a[group]=[a[group]];for(var i=extras.length;i>0;i--)if(a[group].indexOf(extras[i-1])>=0)extras.splice(i-1,1)}if(vars.tooltip.value["long"]&&typeof vars.tooltip.value["long"]=="object"){var placed=[];for(var group in vars.tooltip.value["long"])for(var i=extras.length;i>0;i--){var e=extras[i-1];if(vars.tooltip.value["long"][group].indexOf(e)>=0){if(!a[group])a[group]=[];a[group].push(e);extras.splice(i-1,1)}}}if(extras.length){if(!a[""])a[""]=
[];a[""]=a[""].concat(extras)}for(var group in a)a[group].forEach(function(t){format_key(t,group)});if(children){var title=vars.format.locale.value.ui.including,colors=children.d3plus_colors;children.values.forEach(function(child){var name=d3.keys(child)[0];tooltip_data.push({"group":vars.format.value(title),"highlight":colors&&colors[name]?colors[name]:false,"name":name,"value":child[name]})});if(children.d3plusMore)tooltip_data.push({"group":vars.format.value(title),"highlight":true,"name":stringFormat(vars.format.locale.value.ui.more,
children.d3plusMore),"value":""})}if(vars.tooltip.connections.value&&length==="long"){var connections=vars.edges.connections(id[vars.id.value],vars.id.value,true);if(connections.length)connections.forEach(function(conn){var c=vars.data.viz.filter(function(d){return d[vars.id.value]===conn[vars.id.value]});var c=c.length?c[0]:conn;var name=fetchText(vars,c)[0],color=fetchColor(vars,c),size=vars.tooltip.font.size,radius=vars.shape.value=="square"?0:size;styles=["background-color: "+color,"border-color: "+
legible(color),"border-style: solid","border-width: "+vars.data.stroke.width+"px","display: inline-block","height: "+size+"px","left: 0px","position: absolute","width: "+size+"px","top: 0px",prefix()+"border-radius: "+radius+"px"];node="<div style='"+styles.join("; ")+";'></div>";var nodeClick=function(){vars.self.focus([c[vars.id.value]]).draw()};tooltip_data.push({"group":vars.format.value(vars.format.locale.value.ui.primary),"highlight":false,"link":nodeClick,"name":"<div id='d3plustooltipfocuslink_"+
c[vars.id.value]+"' class='d3plus_tooltip_focus_link' style='position:relative;padding-left:"+size*1.5+"px;'>"+node+name+"</div>"})})}return tooltip_data}},{"../../../client/prefix.coffee":39,"../../../color/legible.coffee":44,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/merge.coffee":170,"../../../object/validate.coffee":171,"../../../string/format.js":172,"../../../util/copy.coffee":206}],241:[function(require,module,
exports){var print;print=require("../../../core/console/print.coffee");module.exports=function(vars){var app,d,dataRequired,drawable,i,len,ref,requirements,returned,visualization;vars.group=vars.g.apps[vars.type.value];vars.mouse.viz=false;vars.edges.path=false;visualization=vars.types[vars.type.value];requirements=visualization.requirements||[];dataRequired=requirements.indexOf("data")>=0;drawable=!dataRequired||dataRequired&&vars.data.viz.length;if(!vars.error.internal&&drawable){app=vars.format.locale.value.visualization[vars.type.value];
if(vars.dev.value)print.time("running "+app);ref=vars.data.viz;for(i=0,len=ref.length;i<len;i++){d=ref[i];if(d.d3plus){delete d.d3plus.shape;delete d.d3plus.label;delete d.d3plus.rotate;delete d.d3plus.share}}returned=visualization(vars);if(vars.dev.value)print.timeEnd("running "+app)}else returned=null;vars.returned={nodes:[],edges:null};if(returned instanceof Array)vars.returned.nodes=returned;else if(returned){if(returned.nodes)vars.returned.nodes=returned.nodes;if(returned.edges)vars.returned.edges=
returned.edges}}},{"../../../core/console/print.coffee":52}],242:[function(require,module,exports){var copy=require("../../../util/copy.coffee"),form=require("../../../form/form.js"),print=require("../../../core/console/print.coffee"),validObject=require("../../../object/validate.coffee");module.exports=function(vars){var enabled=vars.ui.value&&vars.ui.value.length,position=vars.ui.position.value;if(vars.dev.value&&enabled)print.time("drawing custom UI elements");var drawer=vars.container.value.selectAll("div#d3plus_drawer").data(["d3plus_drawer"]);
drawer.enter().append("div").attr("id","d3plus_drawer");var positionStyles={};vars.ui.position.accepted.forEach(function(p){positionStyles[p]=p==position?vars.margin.bottom+"px":"auto"});drawer.style("text-align",vars.ui.align.value).style("position","absolute").style("width",vars.width.value-vars.ui.padding*2+"px").style("height","auto").style(positionStyles);var ui=drawer.selectAll("div.d3plus_drawer_ui").data(enabled?vars.ui.value:[],function(d){return d.method||false});ui.exit().remove();ui.enter().append("div").attr("class",
"d3plus_drawer_ui").style("display","inline-block");ui.style("padding",vars.ui.padding+"px").each(function(d){if(!d.form)d.form=form().container(d3.select(this)).data({"sort":false}).id("id").text("text");var focus,callback;if(typeof d.method==="string"&&d.method in vars){focus=vars[d.method].value;callback=function(value){if(value!==vars[d.method].value)vars.self[d.method](value).draw()}}else{focus=d.value[0];if(validObject(focus))focus=focus[d3.keys(focus)[0]];if(typeof d.method==="function")callback=
function(value){d.method(value,vars.self)}}var data=[],title;if(d.label)title=d.label;else if(typeof d.method==="string"&&d.method in vars)title=vars.format.locale.value.method[d.method]||d.method;d.value.forEach(function(o){var obj={};if(validObject(o)){obj.id=o[d3.keys(o)[0]];obj.text=vars.format.value(d3.keys(o)[0])}else{obj.id=o;obj.text=vars.format.value(o)}data.push(obj)});var font=copy(vars.ui.font);font.align=copy(vars.font.align);font.secondary=copy(font);d.form.data(data).font(font).focus(d.value.length>
1?focus:false).focus({"callback":callback}).format(vars.format.locale.language).format({"number":vars.format.number.value,"text":vars.format.text.value}).title(vars.format.value(title)).type(d.type||"auto").ui({"align":vars.ui.align.value,"border":vars.ui.border,"color":{"primary":vars.ui.color.primary.value,"secondary":vars.ui.color.secondary.value},"padding":vars.ui.padding,"margin":0}).width(d.width||false).draw()});var drawerHeight=drawer.node().offsetHeight||drawer.node().getBoundingClientRect().height;
if(drawerHeight)vars.margin[position]+=drawerHeight;if(vars.dev.value&&enabled)print.timeEnd("drawing custom UI elements")}},{"../../../core/console/print.coffee":52,"../../../form/form.js":103,"../../../object/validate.coffee":171,"../../../util/copy.coffee":206}],243:[function(require,module,exports){var events,lighter,print,stylesheet;events=require("../../../client/pointer.coffee");lighter=require("../../../color/lighter.coffee");print=require("../../../core/console/print.coffee");stylesheet=
require("../../../client/css.coffee");module.exports=function(vars){var button,color,containerPadding,enter,family,left,min_height,padding,size,stripY,style,titleClass,titleGroup,top,weight;if(!vars.small&&vars.history.states.length>0){if(vars.dev.value)print.time("drawing back button");button=vars.container.value.selectAll("div#d3plus_back_button").data(["d3plus_back_button"]).style("position","relative").style("z-index",1900);size=vars.title.sub.font.size;color=vars.title.sub.font.color;family=
vars.title.sub.font.family.value;weight=vars.title.sub.font.weight;padding=vars.title.sub.padding;titleClass=false;if(vars.title.sub.value&&["start","left"].indexOf(vars.title.sub.font.align)<0)titleClass="sub";else if(vars.title.total.value&&["start","left"].indexOf(vars.title.total.font.align)<0)titleClass="total";else if(vars.title.value&&["start","left"].indexOf(vars.title.font.align)<0)titleClass="title";if(titleClass){stripY=function(elem){var y;y=elem.attr("transform").match(/translate\(([^a-z]+)\)/gi)[0];
y=y.replace(/([^a-z])\s([^a-z])/gi,"$1,$2");y=y.split(",");y=y[y.length-1];return parseFloat(y.substring(0,y.length-1))};titleGroup=vars.svg.select(".d3plus_title."+titleClass);top=stripY(titleGroup)+stripY(titleGroup.select("text"))}else{top=vars.margin.top-vars.title.padding;min_height=size+padding*2;vars.margin.top+=min_height}containerPadding=parseFloat(vars.container.value.style("padding-top"),10);top+=containerPadding;containerPadding=parseFloat(vars.container.value.style("padding-left"),10);
left=vars.margin.left+size/2+containerPadding;style=function(elem){return elem.style("position","absolute").style("left",left+"px").style("top",top+"px").style("color",color).style("font-family",family).style("font-weight",weight).style("font-size",size+"px")};enter=button.enter().append("div").attr("id","d3plus_back_button").style("opacity",0).call(style).html(function(){var arrow;if(stylesheet("font-awesome")&&vars.icon.back.value.indexOf("fa-")===0){arrow="<i class='fa "+vars.icon.back.value;arrow+=
"' style='margin-top:2px;margin-right:4px;'></i>"}else arrow=vars.icon.back.value+" ";return arrow+vars.format.value(vars.format.locale.value.ui.back)});button.on(events.over,function(){if(!vars.small&&vars.history.states.length>0)return d3.select(this).style("cursor","pointer").transition().duration(vars.timing.mouseevents).style("color",lighter(color,.25))}).on(events.out,function(){if(!vars.small&&vars.history.states.length>0)return d3.select(this).style("cursor","auto").transition().duration(vars.timing.mouseevents).style("color",
color)}).on(events.click,function(){return vars.history.back()}).transition().duration(vars.draw.timing).style("opacity",1).call(style);if(vars.dev.value)return print.timeEnd("drawing back button")}else return vars.container.value.selectAll("div#d3plus_back_button").transition().duration(vars.draw.timing).style("opacity",0).remove()}},{"../../../client/css.coffee":36,"../../../client/pointer.coffee":38,"../../../color/lighter.coffee":45,"../../../core/console/print.coffee":52}],244:[function(require,
module,exports){var arraySort=require("../../../array/sort.coffee"),buckets=require("../../../util/buckets.coffee"),copy=require("../../../util/copy.coffee"),createTooltip=require("../tooltip/create.js"),dataNest=require("../../../core/data/nest.js"),dataURL=require("../../../util/dataURL.coffee"),events=require("../../../client/pointer.coffee"),fetchValue=require("../../../core/fetch/value.coffee"),fetchColor=require("../../../core/fetch/color.coffee"),fetchText=require("../../../core/fetch/text.js"),
print=require("../../../core/console/print.coffee"),removeTooltip=require("../../../tooltip/remove.coffee"),textColor=require("../../../color/text.coffee"),uniqueValues=require("../../../util/uniques.coffee"),scroll=require("../../../client/scroll.js"),stringStrip=require("../../../string/strip.js"),textWrap=require("../../../textwrap/textwrap.coffee"),touch=require("../../../client/touch.coffee"),validObject=require("../../../object/validate.coffee");module.exports=function(vars){var key_display=
true,square_size=0;if(!vars.error.internal&&vars.color.value&&!vars.small&&vars.legend.value)if(!vars.color.valueScale){if(vars.dev.value)print.time("grouping data by colors");var data;if(vars.nodes.value&&vars.types[vars.type.value].requirements.indexOf("nodes")>=0){data=copy(vars.nodes.restriced||vars.nodes.value);if(vars.data.viz.length)for(var i=0;i<data.length;i++){var appData=vars.data.viz.filter(function(a){return a[vars.id.value]===data[i][vars.id.value]});if(appData.length)data[i]=appData[0]}}else data=
vars.data.viz;if(data.length&&"key"in data[0]&&"values"in data[0])data=d3.merge(data.map(function(d){return d.values}));var colorFunction=function(d){return fetchColor(vars,d,colorDepth)},colorDepth=0,colorKey=vars.id.value;var colorIndex=vars.id.nesting.indexOf(vars.color.value);if(colorIndex>=0){colorDepth=colorIndex;colorKey=vars.id.nesting[colorIndex]}else for(var n=0;n<=vars.depth.value;n++){colorDepth=n;colorKey=vars.id.nesting[n];var uniqueIDs=uniqueValues(data,function(d){return fetchValue(vars,
d,colorKey)}),uniqueColors=uniqueValues(data,colorFunction);if(uniqueIDs.length>=uniqueColors.length&&uniqueColors.length>1)break}var legendNesting=[vars.color.value];var colors=dataNest(vars,data,legendNesting,false);if(vars.dev.value)print.timeEnd("grouping data by color");var available_width=vars.width.value;square_size=vars.legend.size;var key_width=square_size*colors.length+vars.ui.padding*(colors.length+1);if(square_size instanceof Array){if(vars.dev.value)print.time("calculating legend size");
for(var i=square_size[1];i>=square_size[0];i--){key_width=i*colors.length+vars.ui.padding*(colors.length+1);if(available_width>=key_width){square_size=i;break}}if(vars.dev.value)print.timeEnd("calculating legend size")}else if(typeof square_size!="number"&&square_size!==false)square_size=30;if(available_width<key_width||colors.length==1)key_display=false;else{key_width-=vars.ui.padding*2;if(vars.dev.value)print.time("sorting legend");var order=vars[vars.legend.order.value].value;var sort_color=vars.color.value;
if(!order)order=vars[vars.color.value].value;else if(vars.legend.order.value!=="color")sort_color=[];arraySort(colors,order,vars.legend.order.sort.value,sort_color,vars,colorDepth);if(vars.dev.value)print.timeEnd("sorting legend");if(vars.dev.value)print.time("drawing legend");var start_x;if(vars.legend.align=="start")start_x=vars.ui.padding;else if(vars.legend.align=="end")start_x=available_width-vars.ui.padding-key_width;else start_x=available_width/2-key_width/2;vars.g.legend.selectAll("g.d3plus_scale").transition().duration(vars.draw.timing).attr("opacity",
0).remove();function position(group){group.attr("transform",function(g,i){var x=start_x+i*(vars.ui.padding+square_size);return"translate("+x+","+vars.ui.padding+")"})}function style(rect){rect.attr("width",square_size).attr("height",square_size).attr("fill",function(g){d3.select(this.parentNode).select("text").remove();var icon=uniqueValues(g,vars.icon.value,fetchValue,vars,colorKey),color=fetchColor(vars,g,colorKey);if(vars.legend.icons.value&&icon.length===1&&typeof icon[0]==="string"){icon=icon[0];
var short_url=stringStrip(icon+"_"+color),iconStyle=vars.icon.style.value,icon_style,pattern=vars.defs.selectAll("pattern#"+short_url).data([short_url]);if(typeof iconStyle==="string")icon_style=vars.icon.style.value;else if(validObject(iconStyle)&&iconStyle[colorKey])icon_style=iconStyle[colorKey];else icon_style="default";color=icon_style=="knockout"?color:"none";pattern.select("rect").transition().duration(vars.draw.timing).attr("fill",color).attr("width",square_size).attr("height",square_size);
pattern.select("image").transition().duration(vars.draw.timing).attr("width",square_size).attr("height",square_size);var pattern_enter=pattern.enter().append("pattern").attr("id",short_url).attr("width",square_size).attr("height",square_size);pattern_enter.append("rect").attr("fill",color).attr("width",square_size).attr("height",square_size);pattern_enter.append("image").attr("xlink:href",icon).attr("width",square_size).attr("height",square_size).each(function(d){if(icon.indexOf("/")===0||icon.indexOf(window.location.hostname)>=
0)dataURL(icon,function(base64){pattern.select("image").attr("xlink:href",base64)});else pattern.select("image").attr("xlink:href",icon)});return"url(#"+short_url+")"}else{if(vars.legend.labels.value){var names;if(vars.legend.text.value)names=[fetchValue(vars,g,vars.legend.text.value,colorDepth)];else names=fetchText(vars,g,colorDepth);if(names.length===1&&!(names[0]instanceof Array)&&names[0].length){var text=d3.select(this.parentNode).append("text"),size=vars.legend.font.size;if(!(size instanceof
Array))size=[size];text.attr("font-size",size[size.length-1]+"px").attr("font-weight",vars.legend.font.weight).attr("font-family",vars.legend.font.family.value).attr("stroke","none").attr("fill",textColor(color)).attr("x",0).attr("y",0).each(function(t){textWrap().align("middle").container(d3.select(this)).height(square_size).padding(vars.ui.padding).resize(size.length>1).size(size).text(names[0]).width(square_size).valign("middle").draw()});if(text.select("tspan").empty())text.remove()}}return color}})}
var colorInt={};var keys=vars.g.legend.selectAll("g.d3plus_color").data(colors,function(d){var c=fetchColor(vars,d,colorKey);if(!(c in colorInt))colorInt[c]=-1;colorInt[c]++;return colorInt[c]+"_"+c});keys.enter().append("g").attr("class","d3plus_color").attr("opacity",0).call(position).append("rect").attr("class","d3plus_color").call(style);keys.order().transition().duration(vars.draw.timing).call(position).attr("opacity",1).selectAll("rect.d3plus_color").call(style);keys.exit().transition().duration(vars.draw.timing).attr("opacity",
0).remove();if(vars.legend.tooltip.value)keys.on(events.over,function(d,i){d3.select(this).style("cursor","pointer");var bounds=this.getBoundingClientRect(),x=bounds.left+square_size/2+scroll.x(),y=bounds.top+square_size/2+scroll.y()+5;var id=fetchValue(vars,d,colorKey),idIndex=vars.id.nesting.indexOf(colorKey),title=idIndex>=0?fetchText(vars,d,idIndex)[0]:vars.format.value(fetchValue(vars,d,vars.color.value,colorKey),{"key":vars.color.value,"vars":vars,"data":d});var html,js;if(vars.legend.filters.value&&
!(id instanceof Array)){html="<div style='text-align:center;'>";var loc=vars.format.locale.value;html+="<div class='mute'>"+vars.format.value(loc.method.mute)+"</div>";html+="<div class='solo'>"+vars.format.value(loc.method.solo)+"</div>";html+="</div>";js=function(tooltip){var style={"border":"1px solid #ccc","display":"inline-block","margin":"1px 2px","padding":"3px 5px"};tooltip.select(".mute").style(style).on(events.over,function(){d3.select(this).style("cursor","pointer")}).on(events.click,function(){var mute=
vars.id.mute.value;vars.history.states.push(function(){vars.self.id({"mute":mute}).draw()});vars.self.id({"mute":id}).draw()});tooltip.select(".solo").style(style).on(events.over,function(){d3.select(this).style("cursor","pointer")}).on(events.click,function(){var solo=vars.id.solo.value;vars.history.states.push(function(){vars.self.id({"solo":solo}).draw()});vars.self.id({"solo":id}).draw()})}}createTooltip({"data":d,"html":html,"js":js,"depth":colorDepth,"footer":false,"vars":vars,"x":x,"y":y,"mouseevents":this,
"title":title,"offset":square_size*.4})}).on(events.out,function(d){removeTooltip(vars.type.value)});if(vars.dev.value)print.timeEnd("drawing legend")}}else if(vars.color.valueScale){if(vars.dev.value)print.time("drawing color scale");vars.g.legend.selectAll("g.d3plus_color").transition().duration(vars.draw.timing).attr("opacity",0).remove();var values=vars.color.valueScale.domain(),colors=vars.color.valueScale.range();if(values.length<=2)values=buckets(values,6);var scale=vars.g.legend.selectAll("g.d3plus_scale").data(["scale"]);
scale.enter().append("g").attr("class","d3plus_scale").attr("opacity",0);var heatmap=scale.selectAll("#d3plus_legend_heatmap").data(["heatmap"]);heatmap.enter().append("linearGradient").attr("id","d3plus_legend_heatmap").attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%").attr("spreadMethod","pad");var stops=heatmap.selectAll("stop").data(d3.range(0,colors.length));stops.enter().append("stop").attr("stop-opacity",1);stops.attr("offset",function(i){return Math.round(i/(colors.length-
1)*100)+"%"}).attr("stop-color",function(i){return colors[i]});stops.exit().remove();var gradient=scale.selectAll("rect#gradient").data(["gradient"]);gradient.enter().append("rect").attr("id","gradient").attr("x",function(d){if(vars.legend.align=="middle")return vars.width.value/2;else if(vars.legend.align=="end")return vars.width.value;else return 0}).attr("y",vars.ui.padding).attr("width",0).attr("height",vars.legend.gradient.height).attr("stroke",vars.legend.font.color).attr("stroke-width",1).style("fill",
"url(#d3plus_legend_heatmap)");var text=scale.selectAll("text.d3plus_tick").data(d3.range(0,values.length));text.enter().append("text").attr("class","d3plus_tick").attr("stroke","none").attr("x",function(d){if(vars.legend.align=="middle")return vars.width.value/2;else if(vars.legend.align=="end")return vars.width.value;else return 0}).attr("y",function(d){return this.getBBox().height+vars.legend.gradient.height+vars.ui.padding*2});var label_width=0;text.order().attr("font-weight",vars.legend.font.weight).attr("font-family",
vars.legend.font.family.value).attr("font-size",vars.legend.font.size+"px").style("text-anchor",vars.legend.font.align).attr("fill",vars.legend.font.color).text(function(d){return vars.format.value(values[d],{"key":vars.color.value,"vars":vars})}).attr("y",function(d){return this.getBBox().height+vars.legend.gradient.height+vars.ui.padding*2}).each(function(d){var w=this.offsetWidth;if(w>label_width)label_width=w});label_width+=vars.labels.padding*2;var key_width=label_width*(values.length-1);if(key_width+
label_width<vars.width.value){if(key_width+label_width<vars.width.value/2){key_width=vars.width.value/2;label_width=key_width/values.length;key_width-=label_width}var start_x;if(vars.legend.align=="start")start_x=vars.ui.padding;else if(vars.legend.align=="end")start_x=vars.width.value-vars.ui.padding-key_width;else start_x=vars.width.value/2-key_width/2;text.transition().duration(vars.draw.timing).attr("x",function(d){return start_x+label_width*d});text.exit().transition().duration(vars.draw.timing).attr("opacity",
0).remove();var ticks=scale.selectAll("rect.d3plus_tick").data(d3.range(0,values.length));ticks.enter().append("rect").attr("class","d3plus_tick").attr("x",function(d){if(vars.legend.align=="middle")return vars.width.value/2;else if(vars.legend.align=="end")return vars.width.value;else return 0}).attr("y",vars.ui.padding).attr("width",0).attr("height",vars.ui.padding+vars.legend.gradient.height).attr("fill",vars.legend.font.color);ticks.transition().duration(vars.draw.timing).attr("x",function(d){var mod=
d===0?1:0;return start_x+label_width*d-mod}).attr("y",vars.ui.padding).attr("width",1).attr("height",vars.ui.padding+vars.legend.gradient.height).attr("fill",vars.legend.font.color);ticks.exit().transition().duration(vars.draw.timing).attr("width",0).remove();gradient.transition().duration(vars.draw.timing).attr("x",function(d){if(vars.legend.align=="middle")return vars.width.value/2-key_width/2;else if(vars.legend.align=="end")return vars.width.value-key_width-vars.ui.padding;else return vars.ui.padding}).attr("y",
vars.ui.padding).attr("width",key_width).attr("height",vars.legend.gradient.height);scale.transition().duration(vars.draw.timing).attr("opacity",1);if(vars.dev.value)print.timeEnd("drawing color scale")}else key_display=false}else key_display=false;else key_display=false;if(vars.legend.value&&key&&key_display){if(vars.dev.value)print.time("positioning legend");if(square_size)var key_height=square_size+vars.ui.padding;else var key_box=vars.g.legend.node().getBBox(),key_height=key_box.height+key_box.y;
if(vars.margin.bottom===0)vars.margin.bottom+=vars.ui.padding;vars.margin.bottom+=key_height;vars.g.legend.transition().duration(vars.draw.timing).attr("transform","translate(0,"+(vars.height.value-vars.margin.bottom)+")");if(vars.dev.value)print.timeEnd("positioning legend")}else{if(vars.dev.value)print.time("hiding legend");vars.g.legend.transition().duration(vars.draw.timing).attr("transform","translate(0,"+vars.height.value+")");if(vars.dev.value)print.timeEnd("hiding legend")}}},{"../../../array/sort.coffee":34,
"../../../client/pointer.coffee":38,"../../../client/scroll.js":41,"../../../client/touch.coffee":43,"../../../color/text.coffee":50,"../../../core/console/print.coffee":52,"../../../core/data/nest.js":60,"../../../core/fetch/color.coffee":63,"../../../core/fetch/text.js":66,"../../../core/fetch/value.coffee":67,"../../../object/validate.coffee":171,"../../../string/strip.js":174,"../../../textwrap/textwrap.coffee":199,"../../../tooltip/remove.coffee":202,"../../../util/buckets.coffee":203,"../../../util/copy.coffee":206,
"../../../util/dataURL.coffee":208,"../../../util/uniques.coffee":209,"../tooltip/create.js":239}],245:[function(require,module,exports){var events=require("../../../client/pointer.coffee"),textColor=require("../../../color/text.coffee");module.exports=function(vars,message){message=vars.messages.value?message:null;var size=vars.messages.style.value||(message===vars.error.internal?"large":vars.messages.style.backup);if(size==="large")var font=vars.messages,position="center";else{if(vars.footer.value)var font=
vars.footer;else if(vars.title.value)var font=vars.title;else if(vars.title.sub.value)var font=vars.title.sub;else if(vars.title.total.value)var font=vars.title.total;else var font=vars.title.sub;var position=font.position}var font={"color":font.font.color,"font-family":font.font.family.value,"font-weight":font.font.weight,"font-size":font.font.size+"px","padding":font.padding+"px"};var bg=vars.messages.background.value;if(!bg){bg=vars.background.value;if(bg==="none"||bg==="transparent")bg=textColor(font.color)}function style(elem){elem.style(font).style("position",
"absolute").style("background-color",bg).style("text-align","center").style("left",function(){return position=="center"?"50%":"0px"}).style("width",function(){return position=="center"?"auto":vars.width.value+"px"}).style("margin-left",function(){return position=="center"?-(this.offsetWidth/2)+"px":"0px"}).style("top",function(){if(position=="center")return"50%";else if(position=="top")return"0px";else return"auto"}).style("bottom",function(){if(position=="bottom")return"0px";else return"auto"}).style("margin-top",
function(){if(size=="large"){var height=this.offsetHeight||this.getBoundingClientRect().height;return-height/2+"px"}return"0px"})}vars.g.message=vars.container.value.selectAll("div#d3plus_message").data(["message"]);var enter=vars.g.message.enter().append("div").attr("id","d3plus_message").attr("opacity",0);enter.append("div").attr("class","d3plus_message_text").style("display","block");vars.g.message.select(".d3plus_message_text").text(message?message:vars.g.message.text());var online=navigator.onLine,
square=75;var branding=vars.g.message.selectAll(".d3plus_message_branding").data(vars.messages.branding.value&&position==="center"?[0]:[]);branding.enter().append("div").attr("class","d3plus_message_branding").style("margin-top","15px").style("padding-top","0px").style("display","block").style("font-size","11px").style("background-size",square+"px").style("background-position","center 10px").style("background-repeat","no-repeat").style("cursor","pointer").on(events.click,function(){window.open("http://www.d3plus.org/",
"_blank")});var logo=d3.hsl(bg).l<.5?vars.messages.branding.image.dark:vars.messages.branding.image.light;branding.text(online?"Powered by:":"Powered by D3plus").style("background-color",online?bg:"transparent").style("background-image",online?"url('"+logo+"')":"none").style("min-width",online?square+"px":"auto").style("height",online?square+"px":"auto");branding.exit().remove();vars.g.message.style("display",message?"inline-block":"none").call(style).style("opacity",message?1:0)}},{"../../../client/pointer.coffee":38,
"../../../color/text.coffee":50}],246:[function(require,module,exports){var closest,css,events,fontSizes,mix,playInterval,prefix,print,textColor,timeDetect;closest=require("../../../util/closest.coffee");css=require("../../../client/css.coffee");fontSizes=require("../../../font/sizes.coffee");events=require("../../../client/pointer.coffee");mix=require("../../../color/mix.coffee");prefix=require("../../../client/prefix.coffee");print=require("../../../core/console/print.coffee");textColor=require("../../../color/text.coffee");
timeDetect=require("../../../core/data/time.coffee");playInterval=false;module.exports=function(vars){var availableWidth,background,brush,brushExtent,brush_group,brushed,brushend,d,end,handles,i,init,j,labelWidth,labels,len,max_index,min,min_index,oldWidth,playButton,playIcon,playIconChar,playIconStyle,playStyle,playUpdate,playbackWidth,setYears,start,start_x,step,stopPlayback,tallEnough,text,textFill,textStyle,tickColor,tickStep,ticks,timeFormat,timeReturn,timelineBox,timelineHeight,timelineOffset,
timelineWidth,visible,x,yearHeight,yearMS,year_ticks,years;if(vars.timeline.value&&(!vars.error.internal||!vars.data.missing)&&!vars.small&&vars.data.time&&vars.data.time.values.length>1){if(vars.dev.value)print.time("drawing timeline");textStyle={"font-weight":vars.ui.font.weight,"font-family":vars.ui.font.family.value,"font-size":vars.ui.font.size+"px","text-anchor":"middle"};years=vars.data.time.ticks.map(function(d){return new Date(d)});timeReturn=timeDetect(vars,{values:years,style:textStyle});
visible=timeReturn.values.map(Number);timeFormat=timeReturn.format;if(vars.time.solo.value.length){init=d3.extent(vars.time.solo.value);for(i=j=0,len=init.length;j<len;i=++j){d=init[i];if(d.constructor!==Date){d+="";if(d.length===4&&parseInt(d)+""===d)d+="/01/01";d=new Date(d);init[i]=d}}}else init=d3.extent(years);year_ticks=years.slice();yearHeight=d3.max(timeReturn.sizes.map(function(t){return t.height}));labelWidth=~~d3.max(timeReturn.sizes.map(function(t){return t.width}))+1;labelWidth+=vars.ui.padding*
2;timelineHeight=vars.timeline.height.value||yearHeight+vars.ui.padding*2;timelineWidth=labelWidth*years.length;playbackWidth=timelineHeight;tallEnough=timelineHeight-vars.ui.padding*2>=yearHeight;availableWidth=vars.width.value-vars.ui.padding*2;if(tallEnough&&vars.timeline.play.value)availableWidth-=playbackWidth+vars.ui.padding;if(!tallEnough||visible.length<years.length||availableWidth<labelWidth*visible.length){oldWidth=labelWidth;labelWidth=(availableWidth-labelWidth)/years.length;timelineWidth=
labelWidth*years.length;timelineOffset=1;tickStep=~~(oldWidth/(timelineWidth/visible.length))+1;while(tickStep<visible.length-1){if((visible.length-1)%tickStep===0)break;tickStep++}visible=visible.filter(function(t,i){return i%tickStep===0})}else{timelineOffset=0;min=new Date(years[0]);step=vars.data.time.stepType;min["set"+step](min["get"+step]()+years.length);year_ticks.push(min)}start=new Date(init[0]);start=closest(year_ticks,start);end=new Date(init[1]);if(!timelineOffset)end["set"+vars.data.time.stepType](end["get"+
vars.data.time.stepType]()+1);end=closest(year_ticks,end);yearMS=year_ticks.map(Number);min_index=yearMS.indexOf(+start);max_index=yearMS.indexOf(+end);brushExtent=[start,end];if(vars.timeline.align==="start")start_x=vars.ui.padding;else if(vars.timeline.align==="end")start_x=vars.width.value-vars.ui.padding-timelineWidth;else start_x=vars.width.value/2-timelineWidth/2;if(tallEnough&&vars.timeline.play.value)start_x+=(playbackWidth+vars.ui.padding)/2;stopPlayback=function(){clearInterval(playInterval);
playInterval=false;return playIcon.call(playIconChar,"icon")};brushed=function(){var extent,max_val,min_val;if(d3.event.sourceEvent!==null){if(playInterval)stopPlayback();brushExtent=brush.extent();min_val=closest(year_ticks,brushExtent[0]);max_val=closest(year_ticks,brushExtent[1]);if(min_val===max_val){min_index=yearMS.indexOf(+min_val);if(min_val<brushExtent[0]||min_index===0)max_val=year_ticks[min_index+1];else min_val=year_ticks[min_index-1]}min_index=yearMS.indexOf(+min_val);max_index=yearMS.indexOf(+max_val);
if(max_index-min_index>=1)extent=[min_val,max_val];else if(min_index+1<=years.length)extent=[min_val,year_ticks[min_index+1]];else{extent=[min_val];i=1;while(i<=1){if(min_index+i<=years.length)extent.push(year_ticks[min_index+i]);else extent.unshift(year_ticks[min_index-(min_index+i-years.length)]);i++}extent=[extent[0],extent[extent.length-1]]}brushExtent=extent;text.attr("fill",textFill);return d3.select(this).call(brush.extent(extent))}};setYears=function(){var newYears;if(max_index-min_index===
years.length-timelineOffset)newYears=[];else{newYears=yearMS.filter(function(t,i){return i>=min_index&&i<max_index+timelineOffset});newYears=newYears.map(function(t){return new Date(t)})}playUpdate();return vars.self.time({"solo":newYears}).draw()};brushend=function(){var change,old_max,old_min,solo;if(d3.event.sourceEvent!==null){if(vars.time.solo.value.length){solo=d3.extent(vars.time.solo.value);old_min=yearMS.indexOf(+closest(year_ticks,solo[0]));old_max=yearMS.indexOf(+closest(year_ticks,solo[1]));
change=old_min!==min_index||old_max!==max_index}else change=max_index-min_index!==years.length-timelineOffset;if(change)return setYears()}};playButton=vars.g.timeline.selectAll("rect.d3plus_timeline_play").data(tallEnough&&vars.timeline.play.value?[0]:[]);playStyle=function(btn){return btn.attr("width",playbackWidth+1).attr("height",timelineHeight+1).attr("fill",vars.ui.color.primary.value).attr("stroke",vars.ui.color.primary.value).attr("stroke-width",1).attr("x",start_x-playbackWidth-1-vars.ui.padding).attr("y",
vars.ui.padding)};playButton.enter().append("rect").attr("class","d3plus_timeline_play").attr("shape-rendering","crispEdges").attr("opacity",0).call(playStyle);playButton.transition().duration(vars.draw.timing).call(playStyle);playButton.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();playIcon=vars.g.timeline.selectAll("text.d3plus_timeline_playIcon").data(tallEnough&&vars.timeline.play.value?[0]:[]);playIconChar=function(text,char){var font;char=vars.timeline.play[char];
if(css("font-awesome")){char=char.awesome;font="FontAwesome"}else{char=char.fallback;font="inherit"}return text.style("font-family",font).text(char)};playIconStyle=function(text){var y;y=timelineHeight/2+vars.ui.padding+1;return text.attr("fill",textColor(vars.ui.color.primary.value)).attr("stroke","none").attr(textStyle).attr("x",start_x-(playbackWidth-1)/2-vars.ui.padding).attr("y",y).attr("dy","0.5ex").call(playIconChar,playInterval?"pause":"icon")};playIcon.enter().append("text").attr("class",
"d3plus_timeline_playIcon").call(playIconStyle).style("pointer-events","none").attr("opacity",0);playIcon.call(playIconStyle).transition().duration(vars.draw.timing).attr("opacity",1);playIcon.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();playUpdate=function(){if(max_index-min_index===years.length-timelineOffset){playButton.on(events.hover,null).on(events.click,null).transition().duration(vars.draw.timing).attr("opacity",.3);return playIcon.transition().duration(vars.draw.timing).attr("opacity",
.3)}else{playButton.on(events.over,function(){return d3.select(this).style("cursor","pointer")}).on(events.out,function(){return d3.select(this).style("cursor","auto")}).on(events.click,function(){if(playInterval)return stopPlayback();else{playIcon.call(playIconChar,"pause");if(max_index===years.length){max_index=max_index-min_index;min_index=0}else{min_index++;max_index++}setYears();return playInterval=setInterval(function(){if(max_index===years.length-timelineOffset)return stopPlayback();else{min_index++;
max_index++;return setYears()}},vars.timeline.play.timing.value)}}).transition().duration(vars.draw.timing).attr("opacity",1);return playIcon.transition().duration(vars.draw.timing).attr("opacity",1)}};playUpdate();textFill=function(d){var color,less,opacity;less=timelineOffset?d<=brushExtent[1]:d<brushExtent[1];if(d>=brushExtent[0]&&less){opacity=1;color=textColor(vars.ui.color.secondary.value)}else{opacity=.5;color=textColor(vars.ui.color.primary.value)}if(timelineOffset&&vars.background.value&&
vars.background.value!=="none")color=d3.rgb(textColor(vars.background.value));color=d3.rgb(color);return"rgba("+color.r+","+color.g+","+color.b+","+opacity+")"};background=vars.g.timeline.selectAll("rect.d3plus_timeline_background").data(["background"]);background.enter().append("rect").attr("class","d3plus_timeline_background").attr("shape-rendering","crispEdges").attr("width",timelineWidth+2).attr("height",timelineHeight+2).attr("fill",vars.ui.color.primary.value).attr("x",start_x-1).attr("y",vars.ui.padding);
background.transition().duration(vars.draw.timing).attr("width",timelineWidth+2).attr("height",timelineHeight+2).attr("fill",vars.ui.color.primary.value).attr("x",start_x-1).attr("y",vars.ui.padding);ticks=vars.g.timeline.selectAll("g#ticks").data(["ticks"]);ticks.enter().append("g").attr("id","ticks").attr("transform","translate("+vars.width.value/2+","+vars.ui.padding+")");brush_group=vars.g.timeline.selectAll("g#brush").data(["brush"]);brush_group.enter().append("g").attr("id","brush");labels=
vars.g.timeline.selectAll("g#labels").data(["labels"]);labels.enter().append("g").attr("id","labels");text=labels.selectAll("text").data(years,function(d,i){return i});text.enter().append("text").attr("stroke","none").attr("y",0).attr("dy","0.5ex").attr("x",0);x=d3.time.scale().domain(d3.extent(year_ticks)).rangeRound([0,timelineWidth]);text.order().attr(textStyle).text(function(d,i){if(visible.indexOf(+d)>=0)return timeFormat(d);else return""}).attr("opacity",function(d,i){if(vars.data.time.dataSteps.indexOf(i)>=
0)return 1;else return.4}).attr("fill",textFill).attr("transform",function(d,i){var dx,dy;dx=start_x+x(d);if(!timelineOffset)dx+=labelWidth/2;dy=timelineHeight/2+vars.ui.padding+1;if(timelineOffset)dy+=timelineHeight/2+yearHeight;return"translate("+Math.round(dx)+","+Math.round(dy)+")"});text.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();brush=d3.svg.brush().x(x).extent(brushExtent).on("brush",brushed).on("brushend",brushend);if(vars.axes.discrete&&vars[vars.axes.discrete].value===
vars.time.value)tickColor=vars[vars.axes.discrete].ticks.color;else tickColor=vars.x.ticks.color;ticks.attr("transform","translate("+start_x+","+(vars.ui.padding+1)+")").transition().duration(vars.draw.timing).call(d3.svg.axis().scale(x).orient("top").ticks(function(){return year_ticks}).tickFormat("").tickSize(-timelineHeight).tickPadding(0)).selectAll("line").attr("stroke-width",1).attr("shape-rendering","crispEdges").attr("stroke",function(d){if(visible.indexOf(+d)>=0)return tickColor;else return mix(tickColor,
vars.background.value,.4,1)});ticks.selectAll("path").attr("fill","none");brush_group.attr("transform","translate("+start_x+","+(vars.ui.padding+1)+")").attr("opacity",1).call(brush);text.attr("pointer-events","none");brush_group.selectAll("rect.background").attr("fill","none").style("visibility","visible").attr("height",timelineHeight).attr("shape-rendering","crispEdges").on(events.move,function(){var c;c=vars.timeline.hover.value;if(["grab","grabbing"].indexOf(c)>=0)c=prefix()+c;return d3.select(this).style("cursor",
c)});brush_group.selectAll("rect.extent").attr("opacity",.75).attr("height",timelineHeight).attr("fill",vars.ui.color.secondary.value).attr("shape-rendering","crispEdges").on(events.move,function(){var c;c=vars.timeline.hover.value;if(["grab","grabbing"].indexOf(c)>=0)c=prefix()+c;return d3.select(this).style("cursor",c)});if(vars.timeline.handles.value){handles=brush_group.selectAll("g.resize").selectAll("rect.d3plus_handle").data(["d3plus_handle"]);handles.enter().insert("rect","rect").attr("class",
"d3plus_handle");handles.attr("fill",vars.timeline.handles.color).attr("transform",function(d){var mod;if(this.parentNode.className.baseVal==="resize e")mod=-vars.timeline.handles.size;else mod=0;return"translate("+mod+",0)"}).attr("width",vars.timeline.handles.size).style("visibility","visible").attr("shape-rendering","crispEdges").attr("opacity",vars.timeline.handles.opacity);brush_group.selectAll("g.resize").selectAll("rect").attr("height",timelineHeight)}else brush_group.selectAll("g.resize").remove();
timelineBox=vars.g.timeline.node().getBBox();if(vars.margin.bottom===0)vars.margin.bottom+=vars.ui.padding;vars.margin.bottom+=timelineBox.height+timelineBox.y;vars.g.timeline.transition().duration(vars.draw.timing).attr("transform","translate(0,"+Math.round(vars.height.value-vars.margin.bottom-vars.ui.padding/2)+")");vars.margin.bottom+=vars.ui.padding;if(vars.dev.value)return print.time("drawing timeline")}else return vars.g.timeline.transition().duration(vars.draw.timing).attr("transform","translate(0,"+
vars.height.value+")")}},{"../../../client/css.coffee":36,"../../../client/pointer.coffee":38,"../../../client/prefix.coffee":39,"../../../color/mix.coffee":46,"../../../color/text.coffee":50,"../../../core/console/print.coffee":52,"../../../core/data/time.coffee":62,"../../../font/sizes.coffee":101,"../../../util/closest.coffee":205}],247:[function(require,module,exports){var events=require("../../../client/pointer.coffee"),fetchValue=require("../../../core/fetch/value.coffee"),print=require("../../../core/console/print.coffee"),
rtl=require("../../../client/rtl.coffee"),textWrap=require("../../../textwrap/textwrap.coffee");module.exports=function(vars){var total_key=vars.size.value?vars.size.value:vars.color.type==="number"?vars.color.value:false;if(!vars.data.viz||!vars.title.total.value||vars.small)var total=false;else if(total_key){if(vars.dev.value)print.time("calculating total value");var total_data=vars.data.pool;if(vars.focus.value.length)total_data=vars.data.viz.filter(function(d){return d[vars.id.value]==vars.focus.value[0]});
var agg=vars.aggs.value[total_key]||"sum";var total;if(agg.constructor===Function)total=agg(total_data);else{total_data=total_data.reduce(function(arr,d){var vals=fetchValue(vars,d,total_key);if(vals instanceof Array)arr=arr.concat(vals);else arr.push(vals);return arr},[]);total=d3[agg](total_data)}if(total===0||total===null||total===undefined)total=false;if(typeof total==="number"){var pct="";if(vars.data.mute.length||vars.data.solo.length||vars.focus.value.length){var overall_total=d3.sum(vars.data.value,
function(d){if(vars.time.solo.value.length>0)var match=vars.time.solo.value.indexOf(fetchValue(vars,d,vars.time.value))>=0;else if(vars.time.mute.value.length>0)var match=vars.time.solo.value.indexOf(fetchValue(vars,d,vars.time.value))<0;else var match=true;if(match)return fetchValue(vars,d,total_key)});if(overall_total>total){var pct=total/overall_total*100,ot=vars.format.value(overall_total,{"key":vars.size.value,"vars":vars});pct=" ("+vars.format.value(pct,{"key":"share","vars":vars})+" of "+ot+
")"}}total=vars.format.value(total,{"key":vars.size.value,"vars":vars});var obj=vars.title.total.value,prefix=obj.prefix||vars.format.value(vars.format.locale.value.ui.total)+": ";total=prefix+total;obj.suffix?total=total+obj.suffix:null;total+=pct}if(vars.dev.value)print.timeEnd("calculating total value")}else var total=false;var title_data=[];if(vars.footer.value)title_data.push({"link":vars.footer.link,"style":vars.footer,"type":"footer","value":vars.footer.value});if(!vars.small){if(vars.title.value){var title=
vars.title.value;if(typeof title==="function")title=title(vars.self);title_data.push({"link":vars.title.link,"style":vars.title,"type":"title","value":title})}if(vars.title.sub.value){var title=vars.title.sub.value;if(typeof title==="function")title=title(vars.self);title_data.push({"link":vars.title.sub.link,"style":vars.title.sub,"type":"sub","value":title})}if(vars.title.total.value&&total)title_data.push({"link":vars.title.total.link,"style":vars.title.total,"type":"total","value":total})}function style(title){title.attr("font-size",
function(t){return t.style.font.size}).attr("fill",function(t){return t.link?vars.links.font.color:t.style.font.color}).attr("font-family",function(t){return t.link?vars.links.font.family.value:t.style.font.family.value}).attr("font-weight",function(t){return t.link?vars.links.font.weight:t.style.font.weight}).style("text-decoration",function(t){return t.link?vars.links.font.decoration.value:t.style.font.decoration.value}).style("text-transform",function(t){return t.link?vars.links.font.transform.value:
t.style.font.transform.value})}if(vars.dev.value)print.time("drawing titles");var titles=vars.svg.selectAll("g.d3plus_title").data(title_data,function(t){return t.type});var titleWidth=vars.title.width||vars.width.value-vars.margin.left-vars.margin.right;titles.enter().append("g").attr("class",function(t){return"d3plus_title "+t.type}).attr("opacity",0).append("text").attr("stroke","none").call(style);function getAlign(d){var align=d.style.font.align;if(align=="center")return"middle";else if(align==
"left"&&!rtl||align=="right"&&rtl)return"start";else if(align=="left"&&rtl||align=="right"&&!rtl)return"end";return align}titles.each(function(d){var container=d3.select(this).select("text").call(style);var align=getAlign(d);textWrap().align(align).container(container).height(vars.height.value/8).size(false).text(d.value).width(titleWidth).draw();d.y=vars.margin[d.style.position];vars.margin[d.style.position]+=this.getBBox().height+d.style.padding*2}).on(events.over,function(t){if(t.link)d3.select(this).transition().duration(vars.timing.mouseevents).style("cursor",
"pointer").select("text").attr("fill",vars.links.hover.color).attr("font-family",vars.links.hover.family.value).attr("font-weight",vars.links.hover.weight).style("text-decoration",vars.links.hover.decoration.value).style("text-transform",vars.links.hover.transform.value)}).on(events.out,function(t){if(t.link)d3.select(this).transition().duration(vars.timing.mouseevents).style("cursor","auto").select("text").call(style)}).on(events.click,function(t){if(t.link){var target=t.link.charAt(0)!="/"?"_blank":
"_self";window.open(t.link,target)}}).attr("opacity",1).attr("transform",function(t){var pos=t.style.position,y=pos=="top"?0+t.y:vars.height.value-t.y;if(pos=="bottom")y-=this.getBBox().height+t.style.padding;else y+=t.style.padding;var align=getAlign(t);if(align==="start")var x=vars.margin.left+vars.title.padding;else{var w=d3.select(this).select("text").node().getBBox().width;if(align==="middle")x=vars.width.value/2-titleWidth/2;else x=vars.width.value-titleWidth-vars.margin.right-vars.title.padding}return"translate("+
x+","+y+")"});titles.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();if(vars.margin.top>0)vars.margin.top+=vars.title.padding;if(vars.margin.bottom>0)vars.margin.bottom+=vars.title.padding;var min=vars.title.height;if(min&&vars.margin[vars.title.position]<min)vars.margin[vars.title.position]=min;if(vars.dev.value)print.timeEnd("drawing titles")}},{"../../../client/pointer.coffee":38,"../../../client/rtl.coffee":40,"../../../core/console/print.coffee":52,"../../../core/fetch/value.coffee":67,
"../../../textwrap/textwrap.coffee":199}],248:[function(require,module,exports){var labels,transform;labels=require("./labels.coffee");transform=require("./transform.coffee");module.exports=function(vars,b,timing){var aspect,extent,fit,max_scale,min,padding,scale,translate,type;if(!b)b=vars.zoom.bounds;if(typeof timing!=="number")timing=vars.timing.transitions;vars.zoom.size={height:b[1][1]-b[0][1],width:b[1][0]-b[0][0]};type=vars.types[vars.type.value];fit=vars.coords.fit.value;if(fit==="auto"||
type.requirements.indexOf("coords")<0)aspect=d3.max([vars.zoom.size.width/vars.width.viz,vars.zoom.size.height/vars.height.viz]);else aspect=vars.zoom.size[fit]/vars["app_"+fit];min=d3.min([vars.width.viz,vars.height.viz]);padding=type.zoom?vars.coords.padding*2:0;scale=(min-padding)/min/aspect;extent=vars.zoom.behavior.scaleExtent();if(extent[0]===extent[1]||b===vars.zoom.bounds)vars.zoom.behavior.scaleExtent([scale,scale*16]);max_scale=vars.zoom.behavior.scaleExtent()[1];if(scale>max_scale)scale=
max_scale;vars.zoom.scale=scale;translate=[vars.width.viz/2-vars.zoom.size.width*scale/2-b[0][0]*scale,vars.height.viz/2-vars.zoom.size.height*scale/2-b[0][1]*scale];vars.zoom.translate=translate;vars.zoom.behavior.translate(translate).scale(scale);vars.zoom.size={height:vars.zoom.bounds[1][1]-vars.zoom.bounds[0][1],width:vars.zoom.bounds[1][0]-vars.zoom.bounds[0][0]};vars.zoom.reset=false;if(vars.labels.value||vars.labels.changed)labels(vars);return transform(vars,timing)}},{"./labels.coffee":250,
"./transform.coffee":253}],249:[function(require,module,exports){module.exports=function(data,vars){var depth,max_depth,nextDepth;max_depth=vars.id.nesting.length-1;depth=vars.depth.value;nextDepth=vars.id.nesting[depth+1];if(vars.types[vars.type.value].nesting===false)return 0;else if((data.d3plus.merged||nextDepth in data&&depth<max_depth)&&(!data||nextDepth in data))return 1;else if((depth===max_depth&&depth>0||data&&nextDepth&&!(nextDepth in data))&&(vars.small||!vars.tooltip.html.value))return-1;
else return 0}},{}],250:[function(require,module,exports){var print;print=require("../../../core/console/print.coffee");module.exports=function(vars){var opacity,scale;if(vars.dev.value)print.time("determining label visibility");scale=vars.zoom.behavior.scaleExtent();opacity=function(text){return text.attr("opacity",function(d){var size;if(!d)d={};size=parseFloat(d3.select(this).attr("font-size"),10);d.visible=size*(vars.zoom.scale/scale[1])>=2;if(d.visible)return 1;else return 0})};if(vars.draw.timing)vars.g.viz.selectAll("text.d3plus_label").transition().duration(vars.draw.timing).call(opacity);
else vars.g.viz.selectAll("text.d3plus_label").call(opacity);if(vars.dev.value)return print.timeEnd("determining label visibility")}},{"../../../core/console/print.coffee":52}],251:[function(require,module,exports){var labels,removeTooltip,transform;labels=require("./labels.coffee");removeTooltip=require("../../../tooltip/remove.coffee");transform=require("./transform.coffee");module.exports=function(vars){var delay,eventType,limits,scale,translate,xmax,xmin,xoffset,ymax,ymin,yoffset;eventType=d3.event.sourceEvent?
d3.event.sourceEvent.type:null;translate=d3.event.translate;scale=d3.event.scale;limits=vars.zoom.bounds;xoffset=(vars.width.viz-vars.zoom.size.width*scale)/2;xmin=xoffset>0?xoffset:0;xmax=xoffset>0?vars.width.viz-xoffset:vars.width.viz;yoffset=(vars.height.viz-vars.zoom.size.height*scale)/2;ymin=yoffset>0?yoffset:0;ymax=yoffset>0?vars.height.viz-yoffset:vars.height.viz;if(translate[0]+limits[0][0]*scale>xmin)translate[0]=-limits[0][0]*scale+xmin;else if(translate[0]+limits[1][0]*scale<xmax)translate[0]=
xmax-limits[1][0]*scale;if(translate[1]+limits[0][1]*scale>ymin)translate[1]=-limits[0][1]*scale+ymin;else if(translate[1]+limits[1][1]*scale<ymax)translate[1]=ymax-limits[1][1]*scale;vars.zoom.behavior.translate(translate).scale(scale);vars.zoom.translate=translate;vars.zoom.scale=scale;if(eventType==="wheel")removeTooltip(vars.type.value);if(vars.labels.value||vars.labels.changed)if(eventType==="wheel"){delay=vars.draw.timing?100:250;clearTimeout(vars.zoom.wheel);vars.zoom.wheel=setTimeout(function(){return labels(vars)},
delay)}else labels(vars);if(eventType==="dblclick")return transform(vars,vars.timing.transitions);else return transform(vars,0)}},{"../../../tooltip/remove.coffee":202,"./labels.coffee":250,"./transform.coffee":253}],252:[function(require,module,exports){module.exports=function(vars,event){var enabled,zoom,zoomable,zoomed;zoom=vars.zoom;if(!event)event=d3.event;zoomed=zoom.scale>zoom.behavior.scaleExtent()[0];enabled=vars.types[vars.type.value].zoom&&zoom.value&&zoom.scroll.value;zoomable=event.touches&&
event.touches.length>1&&enabled;if(!zoomable&&!zoomed)event.stopPropagation()}},{}],253:[function(require,module,exports){module.exports=function(vars,timing){var translate;if(typeof timing!=="number")timing=vars.timing.transitions;translate="translate("+vars.zoom.translate+")";translate+="scale("+vars.zoom.scale+")";if(timing)return vars.g.viz.transition().duration(timing).attr("transform",translate);else return vars.g.viz.attr("transform",translate)}},{}],254:[function(require,module,exports){var filter;
filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Function,Object,String],deprecates:"active_var",mute:filter(true),solo:filter(true),spotlight:{accepted:[Boolean],deprecates:"spotlight",value:false},value:false}},{"../../core/methods/filter.coffee":80}],255:[function(require,module,exports){module.exports={accepted:[Object],deprecated:"nesting_aggs",objectAccess:false,value:{}}},{}],256:[function(require,module,exports){var process;process=require("../../core/methods/process/data.coffee");
module.exports={accepted:[false,Array,Object,String],delimiter:{accepted:String,value:"|"},filetype:{accepted:[false,"json","xml","html","csv","dsv","tsv","txt"],value:false},keys:{},process:process,value:false}},{"../../core/methods/process/data.coffee":86}],257:[function(require,module,exports){var rendering;rendering=require("../../core/methods/rendering.coffee");module.exports={background:{color:"#fafafa",rendering:rendering(),stroke:{color:"#ccc",width:1}},mirror:{accepted:[Boolean],deprecates:["mirror_axis",
"mirror_axes"],value:false},ticks:{accepted:[Boolean],value:true}}},{"../../core/methods/rendering.coffee":91}],258:[function(require,module,exports){module.exports={accepted:[String],value:"#ffffff"}},{}],259:[function(require,module,exports){module.exports={accepted:[Function,String],value:false}},{}],260:[function(require,module,exports){var filter,scale;filter=require("../../core/methods/filter.coffee");scale=require("../../color/scale.coffee");module.exports={accepted:[false,Array,Function,Object,
String],deprecates:"color_var",focus:"#444444",heatmap:["#282F6B","#419391","#AFD5E8","#EACE3F","#B35C1E","#B22200"],missing:"#eeeeee",mute:filter(true),primary:"#d74b03",range:["#B22200","#FFEE8D","#759143"],scale:{accepted:[Array,Function,"d3plus","category10","category20","category20b","category20c"],process:function(value){if(value instanceof Array)return d3.scale.ordinal().range(value);else if(value==="d3plus")return scale;else if(typeof value==="string")return d3.scale[value]();else return value},
value:"d3plus"},solo:filter(true),secondary:"#e5b3bb",value:false}},{"../../color/scale.coffee":48,"../../core/methods/filter.coffee":80}],261:[function(require,module,exports){module.exports={"accepted":[Array,Function,String],"index":{"accepted":[Boolean],"value":true},"process":function(value,vars){if(typeof value==="string")value=[value];return value},"value":false}},{}],262:[function(require,module,exports){arguments[4][107][0].apply(exports,arguments)},{"dup":107}],263:[function(require,module,
exports){var d3selection;d3selection=require("../../util/d3selection.coffee");module.exports={accepted:[false,Array,Object,String],id:"default",process:function(value,vars){if(value===false)return false;if(vars.container.id==="default")vars.self.container({id:"d3plus_"+ +new Date});if(d3selection(value))return value.append("div");else if(value instanceof Array)return d3.select(value[0][0]).append("div");else return d3.select(value).append("div")},value:false}},{"../../util/d3selection.coffee":207}],
264:[function(require,module,exports){var filter,process;filter=require("../../core/methods/filter.coffee");process=require("../../core/methods/process/data.coffee");module.exports={accepted:[false,Array,Function,Object,String],center:[0,0],filetype:{accepted:["json"],value:"json"},fit:{accepted:["auto","height","width"],value:"auto"},key:false,mute:filter(false),padding:20,process:process,projection:{accepted:["albers","albersUsa","azimuthalEqualArea","azimuthalEquidistant","conicConformal","conicEqualArea",
"conicEquidistant","equirectangular","gnomonic","mercator","orthographic","stereographic","transverseMercator",Function],value:"mercator"},simplify:{accepted:[Boolean],value:true},solo:filter(false),threshold:{accepted:[Number],value:.9},value:false}},{"../../core/methods/filter.coffee":80,"../../core/methods/process/data.coffee":86}],265:[function(require,module,exports){var fetchValue,ie,stringStrip;fetchValue=require("../../core/fetch/value.coffee");ie=require("../../client/ie.js");stringStrip=
require("../../string/strip.js");module.exports={accepted:[void 0,true,Array,String],chainable:false,data:[],process:function(value,vars){var blob,c,col,columns,csv_data,csv_to_return,d,dataString,encodedUri,i,j,k,l,len,len1,len2,len3,len4,len5,len6,len7,link,m,max_filename_len,n,node,o,p,q,ref,ref1,ref2,row,title,titles,val;if(vars.returned===void 0)return[];value=value||vars.cols.value;if(value instanceof Array)columns=value;else if(typeof value==="string")columns=[value];csv_to_return=[];titles=
[];if(vars.title.value){title=vars.title.value;if(typeof title==="function")title=title(vars.self);title=stringStrip(title);max_filename_len=250;title=title.substr(0,max_filename_len)}else title="D3plus Visualization Data";if(value===true){columns=d3.keys(vars.data.keys);csv_to_return.push(columns);ref=vars.data.value;for(j=0,len=ref.length;j<len;j++){d=ref[j];row=[];for(k=0,len1=columns.length;k<len1;k++){c=columns[k];val=d[c];if(vars.data.keys[c]==="string")val='"'+val+'"';row.push(val)}csv_to_return.push(row)}}else{if(!columns){columns=
[vars.id.value];if(vars.time.value)columns.push(vars.time.value);if(vars.size.value)columns.push(vars.size.value);if(vars.text.value)columns.push(vars.text.value)}for(l=0,len2=columns.length;l<len2;l++){c=columns[l];titles.push(vars.format.value(c))}csv_to_return.push(titles);ref1=vars.returned.nodes;for(m=0,len3=ref1.length;m<len3;m++){node=ref1[m];if(node.values!=null&&node.values instanceof Array){ref2=node.values;for(n=0,len4=ref2.length;n<len4;n++){val=ref2[n];row=[];for(o=0,len5=columns.length;o<
len5;o++){col=columns[o];val=fetchValue(vars,val,col);if(typeof val==="string")val='"'+val+'"';row.push(val)}csv_to_return.push(row)}}else{row=[];for(p=0,len6=columns.length;p<len6;p++){col=columns[p];row.push(fetchValue(vars,node,col))}csv_to_return.push(row)}}}csv_data="data:text/csv;charset=utf-8,";for(i=q=0,len7=csv_to_return.length;q<len7;i=++q){c=csv_to_return[i];dataString=c.join(",");csv_data+=i<csv_to_return.length?dataString+"\n":dataString}if(ie){blob=new Blob([csv_data],{type:"text/csv;charset=utf-8;"});
navigator.msSaveBlob(blob,title+".csv")}else{encodedUri=encodeURI(csv_data);link=document.createElement("a");link.setAttribute("href",encodedUri);link.setAttribute("download",title+".csv");link.click()}this.data=csv_to_return;return columns},value:void 0}},{"../../client/ie.js":37,"../../core/fetch/value.coffee":67,"../../string/strip.js":174}],266:[function(require,module,exports){var process;process=require("../../core/methods/process/data.coffee");module.exports={accepted:[false,Array,Function,
String],cache:{},delimiter:{accepted:[String],value:"|"},donut:{size:.35},filetype:{accepted:[false,"json","xml","html","csv","dsv","tsv","txt"],value:false},filters:[],keys:{},mute:[],large:400,opacity:.9,padding:{accepted:[Number],value:1},process:function(value,vars){return process(value,vars,this)},solo:[],stroke:{width:1},value:false}},{"../../core/methods/process/data.coffee":86}],267:[function(require,module,exports){module.exports={accepted:[Function,Number],value:0}},{}],268:[function(require,
module,exports){module.exports={accepted:[false,Function,Object],value:false}},{}],269:[function(require,module,exports){arguments[4][111][0].apply(exports,arguments)},{"dup":111}],270:[function(require,module,exports){var print=require("../../core/console/print.coffee"),stringFormat=require("../../string/format.js");module.exports={"accepted":[undefined,Function],"first":true,"frozen":false,"process":function(value,vars){if(this.initialized===false){this.initialized=true;return value}if(value===
undefined&&typeof this.value==="function")value=this.value;if(vars.container.value===false){var str=vars.format.locale.value.dev.setContainer;print.warning(str,"container")}else if(vars.container.value.empty()){var str=vars.format.locale.value.dev.noContainer;print.warning(stringFormat(str,'"'+vars.container.value+'"'),"container")}else{if(vars.dev.value)print.time("total draw time");vars.container.value.call(vars.self)}if(typeof value==="function"&&vars.history.chain.length){var changesObject={};
changes.forEach(function(c){var method=c.method;delete c.method;changesObject[method]=c});value(changesObject);vars.history.chain=[]}return value},"update":true,"value":undefined}},{"../../core/console/print.coffee":52,"../../string/format.js":172}],271:[function(require,module,exports){var process=require("../../core/methods/process/data.coffee");module.exports={"accepted":[false,Array,Function,String],"arrows":{"accepted":[Boolean,Number],"direction":{"accepted":["source","target"],"value":"target"},
"value":false},"color":"#d0d0d0","connections":function(focus,id,objects){var self=this;if(!self.value)return[];if(!id)var id="id";var edges=self.restricted||self.value,targets=[];if(!focus)return edges;var connections=edges.filter(function(edge){var match=false;if(edge[self.source][id]==focus){match=true;if(objects)targets.push(edge[self.target])}else if(edge[self.target][id]==focus){match=true;if(objects)targets.push(edge[self.source])}return match});return objects?targets:connections},"delimiter":{"accepted":[String],
"value":"|"},"filetype":{"accepted":[false,"json","xml","html","csv","dsv","tsv","txt"],"value":false},"interpolate":{"accepted":["basis","cardinal","linear","monotone","step"],"value":"basis"},"label":false,"large":100,"limit":{"accepted":[false,Function,Number],"value":false},"opacity":{"accepted":[Function,Number,String],"min":{"accepted":[Number],"value":.25},"scale":{"accepted":[Function],"value":d3.scale.linear()},"value":1},"process":process,"size":{"accepted":[false,Number,String],"min":1,
"scale":.5,"value":false},"source":"source","strength":{"accepted":[false,Function,Number,String],"value":false},"target":"target","value":false}},{"../../core/methods/process/data.coffee":86}],272:[function(require,module,exports){module.exports={accepted:[Boolean,String],value:false}},{}],273:[function(require,module,exports){module.exports={accepted:[false,Array,Function,Number,String],deprecates:"highlight",process:function(value){if(value===false)return[];else if(value instanceof Array)return value;
else return[value]},tooltip:{accepted:[Boolean],value:true},value:[]}},{}],274:[function(require,module,exports){var align,decoration,family,transform;align=require("../../core/methods/font/align.coffee");decoration=require("../../core/methods/font/decoration.coffee");family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={align:align(),color:"#444444",decoration:decoration(),family:family(),secondary:{align:align(),color:"#444444",
decoration:decoration(),family:family(),size:12,spacing:0,transform:transform(),weight:200},size:12,spacing:0,transform:transform(),weight:200}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],275:[function(require,module,exports){var decoration,family,transform;family=require("../../core/methods/font/family.coffee");decoration=require("../../core/methods/font/decoration.coffee");
transform=require("../../core/methods/font/transform.coffee");module.exports={accepted:[false,Number,String],font:{align:"center",color:"#444",decoration:decoration(),family:family(),size:11,transform:transform(),weight:200},link:false,padding:0,position:"bottom",value:false}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],276:[function(require,module,exports){var formatNumber,locale,mergeObject,titleCase;
formatNumber=require("../../number/format.coffee");locale=require("../../core/locale/locale.coffee");mergeObject=require("../../object/merge.coffee");titleCase=require("../../string/title.coffee");module.exports={accepted:[Function,String],affixes:{accepted:[Object],objectAccess:false,value:{}},deprecates:["number_format","text_format"],locale:{accepted:function(){return d3.keys(locale)},process:function(value){var defaultLocale,returnObject;defaultLocale="en_US";returnObject=locale[defaultLocale];
if(value!==defaultLocale)returnObject=mergeObject(returnObject,locale[value]);this.language=value;return returnObject},value:"en_US"},number:{accepted:[false,Function],value:false},process:function(value,vars){if(typeof value==="string")vars.self.format({locale:value});else if(typeof value==="function")return value;return this.value},text:{accepted:[false,Function],value:false},value:function(value,opts){var f,v,vars;if(!opts)opts={};if(!opts.locale)opts.locale=this.locale.value;vars=opts.vars||{};
if(vars.time&&vars.time.value&&opts.key===vars.time.value){v=value.constructor===Date?value:new Date(value);return vars.data.time.format(v)}else if(typeof value==="number"){f=this.number.value||formatNumber;return f(value,opts)}else if(typeof value==="string"){f=this.text.value||titleCase;return f(value,opts)}else return JSON.stringify(value)}}},{"../../core/locale/locale.coffee":78,"../../number/format.coffee":169,"../../object/merge.coffee":170,"../../string/title.coffee":175}],277:[function(require,
module,exports){module.exports={accepted:[false,Number],max:600,secondary:false,small:200,value:false}},{}],278:[function(require,module,exports){var align,decoration,family,filter,orientMap,position,rendering,transform;align=require("../../../core/methods/font/align.coffee");decoration=require("../../../core/methods/font/decoration.coffee");family=require("../../../core/methods/font/family.coffee");filter=require("../../../core/methods/filter.coffee");position=require("../../../core/methods/font/position.coffee");
rendering=require("../../../core/methods/rendering.coffee");transform=require("../../../core/methods/font/transform.coffee");orientMap={x:"bottom",x2:"top",y:"left",y2:"right"};module.exports=function(axis){return{accepted:[Array,Boolean,Function,Object,String],affixes:{accepted:[Boolean],separator:{accepted:[Boolean,Array],value:true},value:false},axis:{accepted:[Boolean],color:"#444",font:{color:false,decoration:decoration(false),family:family(""),size:false,spacing:0,transform:transform(false),
weight:false},rendering:rendering(),value:true},dataFilter:true,deprecates:[axis+"axis",axis+"axis_val",axis+"axis_var"],domain:{accepted:[false,Array],value:false},grid:{accepted:[Boolean],color:"#ccc",rendering:rendering(),value:true},label:{accepted:[Boolean,String],fetch:function(vars){if(this.value===true)return vars.format.value(vars[axis].value,{key:axis,vars:vars});return this.value},font:{color:"#444",decoration:decoration(),family:family(),size:12,spacing:0,transform:transform(),weight:200},
padding:3,value:true},lines:{accept:[false,Array,Number,Object],dasharray:{accepted:[Array,String],process:function(value){if(value instanceof Array){value=value.filter(function(d){return!isNaN(d)});value=value.length?value.join(", "):"none"}return value},value:"10, 10"},color:"#888",font:{align:align("right"),color:"#444",background:{accepted:[Boolean],value:true},decoration:decoration(),family:family(),padding:{accepted:[Number],value:10},position:position("middle"),size:12,transform:transform(),
weight:200},process:Array,rendering:rendering(),width:1,value:[]},mouse:{accept:[Boolean],dasharray:{accepted:[Array,String],process:function(value){if(value instanceof Array){value=value.filter(function(d){return!isNaN(d)});value=value.length?value.join(", "):"none"}return value},value:"none"},rendering:rendering(),width:2,value:true},mute:filter(true),orient:{accepted:["top","right","bottom","left"],value:orientMap[axis]},padding:{accepted:[Number],value:.1},persist:{position:{accepted:[Boolean],
value:false},size:{accepted:[Boolean],value:true}},range:{accepted:[false,Array],value:false},scale:{accepted:["linear","log","discrete","share"],deprecates:["layout","unique_axis",axis+"axis_scale"],process:function(value,vars){var i,len,ref,scale;ref=["log","discrete","share"];for(i=0,len=ref.length;i<len;i++){scale=ref[i];if(scale===value)vars.axes[scale]=axis;else if(vars.axes[scale]===axis)vars.axes[scale]=false}if(value==="discrete")vars.axes.opposite=axis.indexOf("x")===0?"y":"x";return value},
value:"linear"},solo:filter(true),stacked:{accepted:[Boolean],process:function(value,vars){if(!value&&vars.axes.stacked===axis)vars.axes.stacked=false;else if(value)vars.axes.stacked=axis;return value},value:false},ticks:{accepted:[false,Array],color:"#ccc",font:{color:"#666",decoration:decoration(),family:family(),size:10,spacing:0,transform:transform(),weight:200},labels:{accepted:[Boolean,Array],value:true},rendering:rendering(),size:10,width:1,value:false},value:false,zerofill:{accepted:[Boolean],
value:false}}}},{"../../../core/methods/filter.coffee":80,"../../../core/methods/font/align.coffee":81,"../../../core/methods/font/decoration.coffee":82,"../../../core/methods/font/family.coffee":83,"../../../core/methods/font/position.coffee":84,"../../../core/methods/font/transform.coffee":85,"../../../core/methods/rendering.coffee":91}],279:[function(require,module,exports){module.exports={accepted:[Boolean],back:function(){if(this.states.length)return this.states.pop()()},chain:[],reset:function(){var results;
results=[];while(this.states.length)results.push(this.states.pop()());return results},states:[],value:true}},{}],280:[function(require,module,exports){var process;process=require("../../core/methods/process/icon.coffee");module.exports={accepted:[false,Array,Function,Object,String],back:{accepted:[false,String],fallback:"&#x276e;",opacity:1,process:process,rotate:0,value:"fa-angle-left"},deprecates:"icon_var",style:{accepted:[Object,String],deprecates:"icon_style",value:"default"},value:false}},{"../../core/methods/process/icon.coffee":88}],
281:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[Array,String],dataFilter:true,deprecates:["id_var","nesting"],grouping:{accepted:[Boolean],value:true},mute:filter(true),nesting:["id"],solo:filter(true),value:"id"}},{"../../core/methods/filter.coffee":80}],282:[function(require,module,exports){var decoration,family,transform;decoration=require("../../core/methods/font/decoration.coffee");family=require("../../core/methods/font/family.coffee");
transform=require("../../core/methods/font/transform.coffee");module.exports={accepted:[Boolean],align:{accepted:["start","middle","end","left","center","right"],process:function(value){var css;css=["left","center","right"].indexOf(value);if(css>=0)value=this.accepted[css];return value},value:"middle"},color:{accepted:[false,String],value:false},font:{decoration:decoration(),family:family(),size:11,transform:transform(),weight:200},padding:7,resize:{accepted:[Boolean],value:true},text:{accepted:[false,
Function,String],value:false},segments:2,valign:{accepted:[false,"top","middle","bottom"],value:"middle"},value:true}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],283:[function(require,module,exports){var family;family=require("../../core/methods/font/family.coffee");module.exports={accepted:[Boolean],align:"middle",filters:{accepted:[Boolean],value:false},font:{align:"middle",color:"#444444",family:family(),
size:[8,14],weight:200},gradient:{height:10},icons:{accepted:[Boolean],value:true},labels:{accepted:[Boolean],value:true},order:{accepted:["color","id","size","text"],sort:{accepted:["asc","desc"],value:"asc"},value:"color"},size:[8,30],tooltip:{accepted:[Boolean],value:true},text:{accepted:[false,Function,String],value:false},value:true}},{"../../core/methods/font/family.coffee":83}],284:[function(require,module,exports){var decoration,family,transform;decoration=require("../../core/methods/font/decoration.coffee");
family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={font:{color:"#444444",decoration:decoration(),family:family(),transform:transform(),weight:200},hover:{color:"#444444",decoration:decoration(),family:family(),transform:transform(),weight:200}}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],285:[function(require,module,exports){arguments[4][122][0].apply(exports,
arguments)},{"../../core/methods/process/margin.coffee":89,"dup":122}],286:[function(require,module,exports){var decoration,family,transform;decoration=require("../../core/methods/font/decoration.coffee");family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={accepted:[Boolean,String],background:{accepted:[false,String],value:false},branding:{accepted:[Boolean],image:{dark:"http://d3plus.org/assets/img/icon-transparent-invert.png",
light:"http://d3plus.org/assets/img/icon-transparent.png"},value:false},font:{color:"#444",decoration:decoration(),family:family(),size:16,transform:transform(),weight:200},padding:5,style:{accepted:[false,"small","large"],value:false},value:true}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],287:[function(require,module,exports){module.exports={accepted:[Boolean],click:{accepted:[Boolean,Function],value:true},
move:{accepted:[Boolean,Function],value:true},out:{accepted:[Boolean,Function],value:true},over:{accepted:[Boolean,Function],value:true},value:true}},{}],288:[function(require,module,exports){var process;process=require("../../core/methods/process/data.coffee");module.exports={accepted:[false,Array,Function,String],delimiter:{accepted:[String],value:"|"},filetype:{accepted:[false,"json","xml","html","csv","dsv","tsv","txt"],value:false},overlap:.6,process:process,value:false}},{"../../core/methods/process/data.coffee":86}],
289:[function(require,module,exports){module.exports={accepted:[Boolean,Function,String],agg:{accepted:[false,Function,"sum","min","max","mean","median"],value:false},deprecates:["sort"],sort:{accepted:["asc","desc"],value:"desc"},value:false}},{}],290:[function(require,module,exports){module.exports={"accepted":[Boolean],"value":false,"timeout":400,"process":function(value,vars){var resize,resizeEnd;if(!value)return false;resize=null;resizeEnd=function(){var height,mainNode,width;mainNode=vars.container.value.node().parentNode.getBoundingClientRect();
width=mainNode.width;height=mainNode.height;vars.width.value=width;vars.height.value=height;return vars.self(vars.container.value)};d3.select(window).on("resize."+vars.container.id,function(_this){return function(e){clearTimeout(resize);return resize=setTimeout(resizeEnd,_this.timeout)}}(this));return value}}},{}],291:[function(require,module,exports){var rendering;rendering=require("../../core/methods/rendering.coffee");module.exports={accepted:function(vars){var list;list=vars.types[vars.type.value].shapes;
if(list&&!(list instanceof Array))list=[list];if(list.length)return list;else return["square"]},interpolate:{accepted:["basis","basis-open","cardinal","cardinal-open","linear","monotone","step","step-before","step-after"],deprecates:"stack_type",value:"linear"},rendering:rendering(),value:false}},{"../../core/methods/rendering.coffee":91}],292:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Function,Number,Object,String],
dataFilter:true,deprecates:["value","value_var"],mute:filter(true),scale:{accepted:[Function],deprecates:"size_scale",max:{accepted:[Function,Number],value:function(vars){return Math.floor(d3.max([d3.min([vars.width.viz,vars.height.viz])/15,6]))}},min:{accepted:[Function,Number],value:3},value:d3.scale.sqrt()},solo:filter(true),threshold:{accepted:[Boolean,Function,Number],value:false},value:false}},{"../../core/methods/filter.coffee":80}],293:[function(require,module,exports){module.exports={value:false}},
{}],294:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[false,Function,Object,String],deprecates:["else_var","else"],mute:filter(true),solo:filter(true),value:false}},{"../../core/methods/filter.coffee":80}],295:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[Array,Boolean,Function,Object,String],deprecates:["name_array","text_var"],nesting:true,mute:filter(true),
solo:filter(true),value:false}},{"../../core/methods/filter.coffee":80}],296:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");module.exports={accepted:[Array,Boolean,Function,Object,String],dataFilter:true,deprecates:["year","year_var"],fixed:{accepted:[Boolean],deprecates:["static_axis","static_axes"],value:true},format:{accepted:[false,Array,Function,String],value:false},mute:filter(false),solo:filter(false),value:false}},{"../../core/methods/filter.coffee":80}],
297:[function(require,module,exports){module.exports={accepted:[Boolean],align:"middle",hover:{accepted:["all-scroll","col-resize","crosshair","default","grab","grabbing","move","pointer"],value:"pointer"},handles:{accepted:[Boolean],color:"#666",opacity:1,size:3,stroke:"#666",value:true},height:{accepted:[false,Number],value:false},play:{accepted:[Boolean],icon:{accepted:[false,String],awesome:"\uf04b",fallback:"\u25ba"},pause:{accepted:[false,String],awesome:"\uf04c",fallback:"\u275a\u275a"},timing:{accepted:[Number],
value:1500},value:true},value:true}},{}],298:[function(require,module,exports){module.exports={mouseevents:60,transitions:600,ui:200}},{}],299:[function(require,module,exports){var decoration,family,stringStrip,transform;decoration=require("../../core/methods/font/decoration.coffee");family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");stringStrip=require("../../string/strip.js");module.exports={accepted:[false,Function,String],font:{align:"center",
color:"#444444",decoration:decoration(),family:family(),size:16,transform:transform(),weight:400},height:false,link:false,padding:2,position:"top",process:function(value,vars){var id;if(vars.container.id.indexOf("default")===0&&value){id=stringStrip(value).toLowerCase();vars.self.container({id:id})}return value},sub:{accepted:[false,Function,String],deprecates:"sub_title",font:{align:"center",color:"#444444",decoration:decoration(),family:family(),size:12,transform:transform(),weight:200},link:false,
padding:1,position:"top",value:false},total:{accepted:[Boolean,Object],deprecates:"total_bar",font:{align:"center",color:"#444444",decoration:decoration(),family:family(),size:12,transform:transform(),weight:200,value:false},link:false,padding:1,position:"top",value:false},width:false,value:false}},{"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85,"../../string/strip.js":174}],300:[function(require,module,exports){var family,
transform;family=require("../../core/methods/font/family.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={accepted:[Boolean,Array,Function,Object,String],anchor:"top center",background:"#ffffff",children:{accepted:[Boolean],value:true},connections:{accepted:[Boolean],value:true},curtain:{color:"#ffffff",opacity:.8},deprecates:"tooltip_info",extent:{accepted:[Boolean],value:true},font:{color:"#444",family:family(),size:12,transform:transform(),weight:200},fullscreen:{accepted:[Boolean],
value:false},html:{accepted:[false,Function,Object,String],deprecates:"click_function",value:false},iqr:{accepted:[Boolean],value:true},large:250,share:{accepted:[Boolean],value:true},size:{accepted:[Boolean],value:true},small:225,stacked:{accepted:[Boolean],value:false},sub:{accepted:[false,Function,String],value:false},value:true}},{"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],301:[function(require,module,exports){var filter;filter=require("../../core/methods/filter.coffee");
module.exports={accepted:[false,Function,Object,String],deprecates:["total_var"],mute:filter(true),solo:filter(true),value:false}},{"../../core/methods/filter.coffee":80}],302:[function(require,module,exports){module.exports={accepted:function(vars){return d3.keys(vars.types)},mode:{accepted:function(vars){return vars.types[vars.type.value].modes||[false]},value:false},value:"tree_map"}},{}],303:[function(require,module,exports){var align,decoration,family,transform;family=require("../../core/methods/font/family.coffee");
align=require("../../core/methods/font/align.coffee");decoration=require("../../core/methods/font/decoration.coffee");transform=require("../../core/methods/font/transform.coffee");module.exports={accepted:[Array,Boolean],align:align("center"),border:1,color:{primary:{process:function(value,vars){var primary;primary=this.value;if(!vars.ui.color.secondary.value)vars.ui.color.secondary.value=d3.rgb(primary).darker(.75).toString();return value},value:"#ffffff"},secondary:{value:false}},display:{acceped:["block",
"inline-block"],value:"inline-block"},font:{align:"center",color:"#444",decoration:decoration(),family:family(),size:11,transform:transform(),weight:200},margin:5,padding:5,position:{accepted:["top","right","bottom","left"],value:"bottom"},value:false}},{"../../core/methods/font/align.coffee":81,"../../core/methods/font/decoration.coffee":82,"../../core/methods/font/family.coffee":83,"../../core/methods/font/transform.coffee":85}],304:[function(require,module,exports){module.exports={accepted:[false,
Number],secondary:false,small:200,value:false}},{}],305:[function(require,module,exports){module.exports={"accepted":[Boolean],"behavior":d3.behavior.zoom().scaleExtent([1,1]).duration(0),"click":{"accepted":[Boolean],"value":true},"pan":{"accepted":[Boolean],"value":true},"scroll":{"accepted":[Boolean],"deprecates":"scroll_zoom","value":true},"value":true}},{}],306:[function(require,module,exports){var area,closest,fetchValue,graph,nest,sort,stack,threshold;closest=require("../../util/closest.coffee");
fetchValue=require("../../core/fetch/value.coffee");graph=require("./helpers/graph/draw.coffee");nest=require("./helpers/graph/nest.coffee");sort=require("../../array/sort.coffee");stack=require("./helpers/graph/stack.coffee");threshold=require("../../core/data/threshold.js");area=function(vars){var d,data,discrete,domains,i,j,len,len1,opposite,point,ref;graph(vars,{buffer:vars.axes.opposite,zero:true});domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=0)return[];data=
sort(vars.data.viz,null,null,null,vars);discrete=vars[vars.axes.discrete];opposite=vars[vars.axes.opposite];for(i=0,len=data.length;i<len;i++){point=data[i];if(!point.d3plus)point.d3plus={};ref=point.values;for(j=0,len1=ref.length;j<len1;j++){d=ref[j];if(!d.d3plus)d.d3plus={};d.d3plus.x=discrete.scale.viz(fetchValue(vars,d,discrete.value));d.d3plus.x+=vars.axes.margin.left;d.d3plus.y=opposite.scale.viz(fetchValue(vars,d,opposite.value));d.d3plus.y+=vars.axes.margin.top;if(d.d3plus.merged instanceof
Array){if(!point.d3plus.merged)point.d3plus.merged=[];point.d3plus.merged=point.d3plus.merged.concat(d.d3plus.merged)}if(d.d3plus.text&&!point.d3plus.text)point.d3plus.text=d.d3plus.text}}return stack(vars,data)};area.filter=function(vars,data){return nest(vars,threshold(vars,data,vars[vars.axes.discrete].value))};area.requirements=["data","x","y"];area.setup=function(vars){var axis,size,y;if(!vars.axes.discrete){axis=vars.time.value===vars.y.value?"y":"x";vars.self[axis]({scale:"discrete"})}if(!vars[vars.axes.discrete].zerofill.value)vars.self[vars.axes.discrete]({zerofill:true});
if(!vars[vars.axes.opposite].stacked.value&&vars.type.value==="stacked")vars.self[vars.axes.opposite]({stacked:true});y=vars[vars.axes.opposite];size=vars.size;if(!y.value&&size.value||size.changed&&size.previous===y.value)return vars.self[vars.axes.opposite](size.value);else if(!size.value&&y.value||y.changed&&y.previous===size.value)return vars.self.size(y.value)};area.shapes=["area"];area.threshold=function(vars){return 20/vars.height.viz};area.tooltip="static";module.exports=area},{"../../array/sort.coffee":34,
"../../core/data/threshold.js":61,"../../core/fetch/value.coffee":67,"../../util/closest.coffee":205,"./helpers/graph/draw.coffee":313,"./helpers/graph/nest.coffee":319,"./helpers/graph/stack.coffee":320}],307:[function(require,module,exports){var bar,buckets,fetchValue,graph,nest,stack,uniques,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};buckets=require("../../util/buckets.coffee");fetchValue=require("../../core/fetch/value.coffee");
graph=require("./helpers/graph/draw.coffee");nest=require("./helpers/graph/nest.coffee");stack=require("./helpers/graph/stack.coffee");uniques=require("../../util/uniques.coffee");bar=function(vars){var bars,base,cMargin,d,data,discrete,discreteVal,divisions,domains,h,i,ids,j,k,l,len,len1,len2,length,maxBars,maxSize,mod,nested,newSize,oMargin,offset,oppMethod,oppVal,opposite,p,padding,point,ref,ref1,space,value,w,x,zero;discrete=vars.axes.discrete;h=discrete==="x"?"height":"width";w=discrete==="x"?
"width":"height";opposite=vars.axes.opposite;cMargin=discrete==="x"?"left":"top";oMargin=discrete==="x"?"top":"left";graph(vars,{buffer:true,zero:opposite});domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=0)return[];nested=vars.data.viz;if(vars.axes.stacked)for(j=0,len=nested.length;j<len;j++){point=nested[j];stack(vars,point.values)}space=vars.axes[w]/vars[vars.axes.discrete].ticks.values.length;padding=vars[vars.axes.discrete].padding.value;if(padding<1)padding*=
space;if(padding*2>space)padding=space*.1;maxSize=space-padding*2;if(!vars.axes.stacked)if(vars[discrete].persist.position.value){if(ref=vars[discrete].value,indexOf.call(vars.id.nesting,ref)>=0)divisions=d3.max(nested,function(b){return b.values.length});else divisions=uniques(nested,vars.id.value,fetchValue,vars).length;maxSize/=divisions;offset=space/2-maxSize/2-padding;x=d3.scale.ordinal();if(divisions===1)x.domain([0]).range([0]);else x.domain([0,divisions-1]).range([-offset,offset])}else x=
d3.scale.linear();data=[];zero=0;if(vars[discrete].persist.position.value&&!vars.axes.stacked){ids=uniques(d3.merge(nested.map(function(d){return d.values})),vars.id.value,fetchValue,vars,vars.id.value,false);x.domain(ids);if(ids.length===1)x.range([0]);else x.range(buckets(x.range(),ids.length))}maxBars=d3.max(nested,function(b){return b.values.length});for(k=0,len1=nested.length;k<len1;k++){p=nested[k];if(vars.axes.stacked){bars=1;newSize=maxSize}else if(vars[discrete].persist.position.value){bars=
divisions;newSize=maxSize}else{bars=p.values.length;if(vars[discrete].persist.size.value){newSize=maxSize/maxBars;offset=space/2-(maxBars-bars)*(newSize/2)-newSize/2-padding}else{newSize=maxSize/bars;offset=space/2-newSize/2-padding}x.domain([0,bars-1]);x.range([-offset,offset])}ref1=p.values;for(i=l=0,len2=ref1.length;l<len2;i=++l){d=ref1[i];if(vars.axes.stacked)mod=0;else if(vars[discrete].persist.position.value)mod=x(fetchValue(vars,d,vars.id.value));else mod=x(i%bars);oppMethod=vars[opposite];
if(vars.axes.stacked){value=d.d3plus[opposite];base=d.d3plus[opposite+"0"]}else{oppVal=fetchValue(vars,d,oppMethod.value);if(oppVal===null){oppMethod=vars[opposite+"2"];oppVal=fetchValue(vars,d,oppMethod.value)}if(oppVal===0)continue;if(oppMethod.scale.value==="log")zero=oppVal<0?-1:1;value=oppMethod.scale.viz(oppVal);base=oppMethod.scale.viz(zero)}discreteVal=fetchValue(vars,d,vars[discrete].value);d.d3plus[discrete]=vars[discrete].scale.viz(discreteVal);d.d3plus[discrete]+=vars.axes.margin[cMargin]+
mod;length=base-value;d.d3plus[opposite]=base-length/2;if(!vars.axes.stacked)d.d3plus[opposite]+=vars.axes.margin[oMargin];delete d.d3plus.r;d.d3plus[w]=newSize;d.d3plus[h]=Math.abs(length);d.d3plus.init={};d.d3plus.init[opposite]=oppMethod.scale.viz(zero);d.d3plus.init[opposite]-=d.d3plus[opposite];d.d3plus.init[opposite]+=vars.axes.margin[oMargin];d.d3plus.init[w]=d.d3plus[w];if(vars.text.value)delete d.d3plus.label;else d.d3plus.label=false;data.push(d)}}return data};bar.filter=function(vars,data){return nest(vars,
data,vars[vars.axes.discrete].value)};bar.requirements=["data","x","y"];bar.setup=function(vars){var axis,size,y;if(!vars.axes.discrete){axis=vars.time.value===vars.y.value?"y":"x";vars.self[axis]({scale:"discrete"})}y=vars[vars.axes.opposite];size=vars.size;if(!y.value&&size.value||size.changed&&size.previous===y.value)return vars.self[vars.axes.opposite](size.value);else if(!size.value&&y.value||y.changed&&y.previous===size.value)return vars.self.size(y.value)};bar.shapes=["square"];module.exports=
bar},{"../../core/fetch/value.coffee":67,"../../util/buckets.coffee":203,"../../util/uniques.coffee":209,"./helpers/graph/draw.coffee":313,"./helpers/graph/nest.coffee":319,"./helpers/graph/stack.coffee":320}],308:[function(require,module,exports){var box,fetchValue,graph,strip,uniques;fetchValue=require("../../core/fetch/value.coffee");graph=require("./helpers/graph/draw.coffee");strip=require("../../string/strip.js");uniques=require("../../util/uniques.coffee");box=function(vars){var disMargin,
discrete,domains,h,medians,mergeData,mode,noData,oppMargin,opposite,returnData,size,space,w;graph(vars,{buffer:true});domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=0)return[];discrete=vars.axes.discrete;opposite=vars.axes.opposite;disMargin=discrete==="x"?vars.axes.margin.left:vars.axes.margin.top;oppMargin=opposite==="x"?vars.axes.margin.left:vars.axes.margin.top;h=discrete==="x"?"height":"width";w=discrete==="x"?"width":"height";space=vars.axes[w]/vars[discrete].ticks.values.length;
size=vars.size.value;size=typeof size==="number"?size:100;space=d3.min([space-vars.labels.padding*2,size]);mode=vars.type.mode.value;if(!(mode instanceof Array))mode=[mode,mode];mergeData=function(arr){var key,obj,vals;obj={};for(key in vars.data.keys){vals=uniques(arr,key,fetchValue,vars);obj[key]=vals.length===1?vals[0]:vals}return obj};noData=false;medians=[];returnData=[];d3.nest().key(function(d){return fetchValue(vars,d,vars[discrete].value)}).rollup(function(leaves){var bottom,bottomLabel,
bottomWhisker,boxData,d,diff1,diff2,first,i,iqr,j,key,label,len,len1,median,medianBuffer,medianData,medianHeight,medianText,outliers,scale,second,tooltipData,top,topLabel,topWhisker,uniqs,val,values,x,y;scale=vars[opposite].scale.viz;values=leaves.map(function(d){return fetchValue(vars,d,vars[opposite].value)});values.sort(function(a,b){return a-b});uniqs=uniques(values);first=d3.quantile(values,.25);median=d3.quantile(values,.5);second=d3.quantile(values,.75);tooltipData={};if(mode[1]==="tukey"){iqr=
first-second;top=second-iqr*1.5;topLabel="top tukey"}else if(mode[1]==="extent"){top=d3.max(values);topLabel="maximum"}else if(typeof mode[1]==="number"){top=d3.quantile(values,(100-mode[1])/100);topLabel=mode[1]+" percentile"}top=d3.min([d3.max(values),top]);if(vars.tooltip.extent.value)tooltipData[topLabel]={key:vars[opposite].value,value:top};if(vars.tooltip.iqr.value){tooltipData["third quartile"]={key:vars[opposite].value,value:second};tooltipData["median"]={key:vars[opposite].value,value:median};
tooltipData["first quartile"]={key:vars[opposite].value,value:first}}if(mode[0]==="tukey"){iqr=first-second;bottom=first+iqr*1.5;bottomLabel="bottom tukey"}else if(mode[0]==="extent"){bottom=d3.min(values);bottomLabel="minimum"}else if(typeof mode[0]==="number"){bottom=d3.quantile(values,mode[0]/100);bottomLabel=mode[0]+" percentile"}bottom=d3.max([d3.min(values),bottom]);if(vars.tooltip.extent.value)tooltipData[bottomLabel]={key:vars[opposite].value,value:bottom};boxData=[];bottomWhisker=[];topWhisker=
[];outliers=[];for(i=0,len=leaves.length;i<len;i++){d=leaves[i];val=fetchValue(vars,d,vars[opposite].value);if(val>=first&&val<=second)boxData.push(d);else if(val>=bottom&&val<first)bottomWhisker.push(d);else if(val<=top&&val>second)topWhisker.push(d);else outliers.push(d)}key=fetchValue(vars,leaves[0],vars[discrete].value);x=vars[discrete].scale.viz(key);x+=disMargin;label=vars.format.value(key,{key:vars[discrete].value,vars:vars});if(key.constructor===Date)key=key.getTime();key=strip(key);boxData=
mergeData(boxData);boxData.d3plus={color:"white",id:"box_"+key,init:{},label:false,shape:"square",stroke:"#444",text:"Interquartile Range for "+label};boxData.d3plus[w]=space;boxData.d3plus.init[w]=space;boxData.d3plus[h]=Math.abs(scale(first)-scale(second));boxData.d3plus[discrete]=x;y=d3.min([scale(first),scale(second)])+boxData.d3plus[h]/2;y+=oppMargin;boxData.d3plus[opposite]=y;boxData.d3plus.tooltip=tooltipData;returnData.push(boxData);medianData={d3plus:{id:"median_line_"+key,position:h==="height"?
"top":"right",shape:"whisker","static":true}};medianText=vars.format.value(median,{key:vars[opposite].value,vars:vars});label={background:"#fff",names:[medianText],padding:0,resize:false,x:0,y:0};diff1=Math.abs(scale(median)-scale(first));diff2=Math.abs(scale(median)-scale(second));medianHeight=d3.min([diff1,diff2])*2;medianBuffer=vars.data.stroke.width*2+vars.labels.padding*2;label[w==="width"?"w":"h"]=space-medianBuffer;label[h==="width"?"w":"h"]=medianHeight-medianBuffer;medianData.d3plus.label=
label;medianData.d3plus[w]=space;medianData.d3plus[discrete]=x;medianData.d3plus[opposite]=scale(median)+oppMargin;returnData.push(medianData);bottomWhisker=mergeData(bottomWhisker);bottomWhisker.d3plus={id:"bottom_whisker_line_"+key,offset:boxData.d3plus[h]/2,position:h==="height"?"bottom":"left",shape:"whisker","static":true};if(opposite==="x")bottomWhisker.d3plus.offset*=-1;bottomWhisker.d3plus[h]=Math.abs(scale(bottom)-scale(first));bottomWhisker.d3plus[w]=space;bottomWhisker.d3plus[discrete]=
x;bottomWhisker.d3plus[opposite]=y;returnData.push(bottomWhisker);topWhisker=mergeData(topWhisker);topWhisker.d3plus={id:"top_whisker_line_"+key,offset:boxData.d3plus[h]/2,position:h==="height"?"top":"right",shape:"whisker","static":true};if(opposite==="y")topWhisker.d3plus.offset*=-1;topWhisker.d3plus[h]=Math.abs(scale(top)-scale(second));topWhisker.d3plus[w]=space;topWhisker.d3plus[discrete]=x;topWhisker.d3plus[opposite]=y;returnData.push(topWhisker);for(j=0,len1=outliers.length;j<len1;j++){d=outliers[j];
d.d3plus[discrete]=x;d.d3plus[opposite]=scale(fetchValue(vars,d,vars.y.value));d.d3plus[opposite]+=oppMargin;d.d3plus.r=4;d.d3plus.shape=vars.shape.value}noData=!outliers.length&&top-bottom===0;medians.push(median);returnData=returnData.concat(outliers);return leaves}).entries(vars.data.viz);if(noData&&uniques(medians).length===1)return[];else return returnData};box.modes=["tukey","extent",Array,Number];box.requirements=["data","x","y"];box.shapes=["circle","check","cross","diamond","square","triangle",
"triangle_up","triangle_down"];box.setup=function(vars){var axis;if(!vars.axes.discrete){axis=vars.time.value===vars.y.value?"y":"x";return vars.self[axis]({scale:"discrete"})}};module.exports=box},{"../../core/fetch/value.coffee":67,"../../string/strip.js":174,"../../util/uniques.coffee":209,"./helpers/graph/draw.coffee":313}],309:[function(require,module,exports){var arraySort,bubbles,fetchColor,fetchText,fetchValue,groupData,legible;arraySort=require("../../array/sort.coffee");fetchValue=require("../../core/fetch/value.coffee");
fetchColor=require("../../core/fetch/color.coffee");fetchText=require("../../core/fetch/text.js");legible=require("../../color/legible.coffee");groupData=require("../../core/data/group.coffee");bubbles=function(vars){var column_height,column_width,columns,d,data,dataLength,domain,domainMax,domainMin,downscale,groupedData,i,j,k,l,labelHeight,len,len1,len2,obj,pack,padding,row,rows,screenRatio,size,size_max,size_min,t,temp,xPadding,xoffset,yMod,yPadding,yoffset;groupedData=groupData(vars,vars.data.viz);
groupedData=arraySort(groupedData,null,null,null,vars);dataLength=groupedData.length;if(dataLength<4){columns=dataLength;rows=1}else{screenRatio=vars.width.viz/vars.height.viz;columns=Math.ceil(Math.sqrt(dataLength*screenRatio));rows=Math.ceil(Math.sqrt(dataLength/screenRatio))}if(dataLength>0)while((rows-1)*columns>=dataLength)rows--;column_width=vars.width.viz/columns;column_height=vars.height.viz/rows;if(vars.size.value){domainMin=d3.min(vars.data.viz,function(d){return fetchValue(vars,d,vars.size.value,
vars.id.value,"min")});domainMax=d3.max(vars.data.viz,function(d){return fetchValue(vars,d,vars.size.value,vars.id.value)});domain=[domainMin,domainMax]}else domain=[0,0];padding=5;size_max=d3.min([column_width,column_height])/2-padding*2;labelHeight=vars.labels.value&&!vars.small&&size_max>=40?d3.max([20,d3.min([size_max*.25,50])]):0;size_max-=labelHeight;size_min=d3.min([size_max,vars.size.scale.min.value]);size=vars.size.scale.value.domain(domain).rangeRound([size_min,size_max]);pack=d3.layout.pack().children(function(d){return d.values}).padding(padding).radius(function(d){return size(d)}).size([column_width-
padding*2,column_height-padding*2-labelHeight]).value(function(d){return d.value});data=[];row=0;for(i=j=0,len=groupedData.length;j<len;i=++j){d=groupedData[i];temp=pack.nodes(d);xoffset=column_width*i%vars.width.viz;yoffset=column_height*row;for(k=0,len1=temp.length;k<len1;k++){t=temp[k];if(t.children){obj={d3plus:{}};obj[vars.id.value]=t.key}else obj=t.d3plus;obj.d3plus.depth=vars.id.grouping.value?t.depth:vars.depth.value;obj.d3plus.x=t.x;obj.d3plus.xOffset=xoffset;obj.d3plus.y=t.y;obj.d3plus.yOffset=
yoffset+labelHeight;obj.d3plus.r=t.r;data.push(obj)}if((i+1)%columns===0)row++}downscale=size_max/d3.max(data,function(d){return d.d3plus.r});xPadding=pack.size()[0]/2;yPadding=pack.size()[1]/2;for(l=0,len2=data.length;l<len2;l++){d=data[l];d.d3plus.x=(d.d3plus.x-xPadding)*downscale+xPadding+d.d3plus.xOffset;d.d3plus.y=(d.d3plus.y-yPadding)*downscale+yPadding+d.d3plus.yOffset;d.d3plus.r=d.d3plus.r*downscale;delete d.d3plus.xOffset;delete d.d3plus.yOffset;d.d3plus["static"]=d.d3plus.depth<vars.depth.value&&
vars.id.grouping.value;if(labelHeight&&(d.d3plus.depth===0||vars.id.grouping.value===false)){d.d3plus.text=fetchText(vars,d[vars.id.value],d.d3plus.depth);yMod=labelHeight>vars.labels.padding*3?vars.labels.padding:0;d.d3plus.label={x:0,y:-(size_max+yMod+labelHeight/2),w:size_max*2,h:labelHeight-yMod,padding:0,resize:true,color:legible(fetchColor(vars,d,d.d3plus.depth)),force:true}}else delete d.d3plus.label}return data.sort(function(a,b){return a.d3plus.depth-b.d3plus.depth})};bubbles.fill=true;bubbles.requirements=
["data"];bubbles.scale=1.05;bubbles.shapes=["circle","donut"];module.exports=bubbles},{"../../array/sort.coffee":34,"../../color/legible.coffee":44,"../../core/data/group.coffee":57,"../../core/fetch/color.coffee":63,"../../core/fetch/text.js":66,"../../core/fetch/value.coffee":67}],310:[function(require,module,exports){var chart,print;print=require("../../../core/console/print.coffee");chart=function(vars){var type,types;types={circle:"scatter",donut:"scatter",line:"line",square:"scatter",area:"stacked"};
type=types[vars.shape.value];print.warning('The "chart" visualization type has been deprecated and will be removed in version 2.0. Please use the "'+type+'" visualization type.');vars.self.type(type).draw()};chart.shapes=["circle","donut","line","square","area"];module.exports=chart},{"../../../core/console/print.coffee":52}],311:[function(require,module,exports){var geo_map;geo_map=function(vars){var coords,features,key,mute,solo,topo;coords=vars.coords.value;key=vars.coords.key||d3.keys(coords.objects)[0];
topo=topojson.feature(coords,coords.objects[key]);features=topo.features;solo=vars.coords.solo.value;mute=vars.coords.mute.value;features=features.filter(function(f){f[vars.id.value]=f.id;if(solo.length)return solo.indexOf(f.id)>=0;else if(mute.length)return mute.indexOf(f.id)<0;else return true});return features};geo_map.libs=["topojson"];geo_map.nesting=false;geo_map.requirements=["coords"];geo_map.scale=1;geo_map.shapes=["coordinates"];geo_map.zoom=true;module.exports=geo_map},{}],312:[function(require,
module,exports){var color,legible,print;color=require("../../../../core/fetch/color.coffee");legible=require("../../../../color/legible.coffee");print=require("../../../../core/console/print.coffee");module.exports=function(vars){var axes,axis,axisData,data,i,len,ref,style,tick,ticks,timing;axes=vars.axes;data=axes.stacked||!axes.ticks.value?[]:vars.data.viz;timing=data.length*2>vars.data.large?0:vars.draw.timing;style=function(line,axis){if(axis.indexOf("y")===0)line.attr("x1",-2).attr("x2",-8).attr("y1",
function(d){return d.d3plus.y-axes.margin.top}).attr("y2",function(d){return d.d3plus.y-axes.margin.top});else line.attr("x1",function(d){return d.d3plus.x-axes.margin.left}).attr("x2",function(d){return d.d3plus.x-axes.margin.left}).attr("y1",axes.height+2).attr("y2",axes.height+8);return line.style("stroke",function(d){return legible(color(vars,d))}).style("stroke-width",vars.data.stroke.width).attr("shape-rendering",vars.shape.rendering.value)};if(vars.dev.value)print.time("creating axis tick groups");
ticks=vars.group.select("g#d3plus_graph_plane").selectAll("g.d3plus_data_tick").data(data,function(d){var mod;mod=axes.discrete?"_"+d.d3plus[axes.discrete]:"";return"tick_"+d[vars.id.value]+"_"+d.d3plus.depth+mod});ticks.enter().append("g").attr("class","d3plus_data_tick").attr("opacity",0);if(vars.dev.value)print.timeEnd("creating axis tick groups");ref=["x","y"];for(i=0,len=ref.length;i<len;i++){axis=ref[i];if(vars.dev.value&&timing)print.time("creating "+axis+" ticks");axisData=timing&&axis!==
axes.discrete?data:[];tick=ticks.selectAll("line.d3plus_data_"+axis).data(axisData,function(d){return"tick_"+d[vars.id.value]+"_"+d.d3plus.depth});if(vars.dev.value&&timing)print.timeEnd("creating "+axis+" ticks");if(vars.dev.value&&timing)print.time("styling "+axis+" ticks");if(timing>0)tick.transition().duration(timing).call(style,axis);else tick.call(style,axis);tick.enter().append("line").attr("class","d3plus_data_"+axis).call(style,axis);if(vars.dev.value&&timing)print.timeEnd("styling "+axis+
" ticks")}if(timing>0){ticks.transition().duration(timing).attr("opacity",1);ticks.exit().transition().duration(timing).attr("opacity",0).remove()}else{ticks.attr("opacity",1);ticks.exit().remove()}}},{"../../../../color/legible.coffee":44,"../../../../core/console/print.coffee":52,"../../../../core/fetch/color.coffee":63}],313:[function(require,module,exports){var axes,draw,mouse,plot;axes=require("./includes/axes.coffee");draw=require("./includes/svg.coffee");mouse=require("./includes/mouse.coffee");
plot=require("./includes/plot.coffee");module.exports=function(vars,opts){if(opts===void 0)opts={};axes(vars,opts);plot(vars,opts);draw(vars,opts);vars.mouse.viz=opts.mouse===true?mouse:false}},{"./includes/axes.coffee":314,"./includes/mouse.coffee":316,"./includes/plot.coffee":317,"./includes/svg.coffee":318}],314:[function(require,module,exports){var arraySort,axisRange,buckets,buffer,dataChange,fetchData,fetchValue,getData,getScale,print,sizeScale,uniques;arraySort=require("../../../../../array/sort.coffee");
buffer=require("./buffer.coffee");buckets=require("../../../../../util/buckets.coffee");fetchData=require("../../../../../core/fetch/data.js");fetchValue=require("../../../../../core/fetch/value.coffee");print=require("../../../../../core/console/print.coffee");uniques=require("../../../../../util/uniques.coffee");module.exports=function(vars,opts){var axes,axis,changed,domains,i,j,len,len1,oppAxis,range,reorder,zero;changed=dataChange(vars);if(changed||!vars.axes.dataset)vars.axes.dataset=getData(vars);
vars.axes.scale=opts.buffer&&opts.buffer!==true?sizeScale(vars,opts.buffer):false;axes=vars.width.viz>vars.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"];for(i=0,len=axes.length;i<len;i++){axis=axes[i];oppAxis=axis.indexOf("x")===0?"y":"x";reorder=vars.order.changed||vars.order.sort.changed||vars.order.value===true&&vars[oppAxis].changed;if(vars[axis].value&&(!vars[axis].ticks.values||changed||reorder)){if(vars.dev.value)print.time("calculating "+axis+" axis");vars[axis].reset=true;vars[axis].ticks.values=
false;if(axis===vars.axes.discrete&&vars[axis].value!==vars.time.value)vars[axis].ticks.values=uniques(vars.axes.dataset,vars[axis].value,fetchValue,vars);zero=opts.zero===true||axis.indexOf(opts.zero)===0?true:false;range=axisRange(vars,axis,zero);if(axis.indexOf("y")===0)range=range.reverse();vars[axis].scale.viz=getScale(vars,axis,range);vars[axis].domain.viz=range;if(vars.dev.value)print.timeEnd("calculating "+axis+" axis")}}if(vars.axes.mirror.value){domains=d3.extent(vars.y.domain.viz.concat(vars.x.domain.viz));
vars.x.domain.viz=domains;vars.x.scale.viz.domain(domains);domains=domains.slice().reverse();vars.y.domain.viz=domains;vars.y.scale.viz.domain(domains)}if(opts.buffer)for(j=0,len1=axes.length;j<len1;j++){axis=axes[j];if(axis!==vars.axes.discrete)buffer(vars,axis,opts.buffer)}};dataChange=function(vars){var axis,changed,check,i,j,k,l,len,len1,len2,ref,sub,subs;changed=vars.time.fixed.value&&(vars.time.solo.changed||vars.time.mute.changed);if(!changed)changed=vars.id.solo.changed||vars.id.mute.changed;
if(changed)return changed;check=["data","time","id","depth","type","x","y","x2","y2"];for(i=0,len=check.length;i<len;i++){k=check[i];if(vars[k].changed){changed=true;break}}if(changed)return changed;subs=["mute","range","scale","solo","stacked","zerofill"];ref=["x","y","x2","y2"];for(j=0,len1=ref.length;j<len1;j++){axis=ref[j];for(l=0,len2=subs.length;l<len2;l++){sub=subs[l];if(vars[axis][sub].changed){changed=true;break}}}return changed};getData=function(vars){var d,depths;if(vars.time.fixed.value)return vars.data.viz;
else{depths=d3.range(0,vars.id.nesting.length);return d3.merge([function(){var i,len,results;results=[];for(i=0,len=depths.length;i<len;i++){d=depths[i];results.push(fetchData(vars,"all",d))}return results}()])}};axisRange=function(vars,axis,zero,buffer){var agg,aggType,allNegative,allPositive,axisSums,counts,d,group,i,j,k,l,len,len1,len2,len3,m,min,oppAxis,ref,ref1,ref2,ref3,sort,sortKey,splitData,v,val,values;oppAxis=axis.indexOf("x")===0?"y":"x";if(vars[axis].range.value&&vars[axis].range.value.length===
2)return vars[axis].range.value.slice();else if(vars[axis].scale.value==="share"){vars[axis].ticks.values=d3.range(0,1.1,.1);return[0,1]}else if(vars[axis].stacked.value){splitData=[];ref=vars.axes.dataset;for(i=0,len=ref.length;i<len;i++){d=ref[i];if(d.values)splitData=splitData.concat(d.values);else splitData.push(d)}axisSums=d3.nest().key(function(d){return fetchValue(vars,d,vars[oppAxis].value)}).rollup(function(leaves){var negatives,positives;positives=d3.sum(leaves,function(d){var val;val=fetchValue(vars,
d,vars[axis].value);if(val>0)return val;else return 0});negatives=d3.sum(leaves,function(d){var val;val=fetchValue(vars,d,vars[axis].value);if(val<0)return val;else return 0});return[negatives,positives]}).entries(splitData);values=d3.merge(axisSums.map(function(d){return d.values}));return d3.extent(values)}else if(vars[axis].value===vars.time.value)if(vars.time.solo.value.length)return d3.extent(vars.time.solo.value).map(function(v){if(v.constructor!==Date){v=v+"";if(v.length===4&&parseInt(v)+""===
v)v+="/01/01";return new Date(v)}else return v});else return d3.extent(vars.data.time.ticks);else{values=[];ref1=vars.axes.dataset;for(j=0,len1=ref1.length;j<len1;j++){d=ref1[j];val=fetchValue(vars,d,vars[axis].value);if(val instanceof Array)values=values.concat(val);else values.push(val)}values=values.filter(function(d){return d!==null});if(axis===vars.axes.discrete){if(vars.order.value===true)sortKey=vars[oppAxis].value;else sortKey=vars.order.value;if(sortKey){sort=vars.order.sort.value;agg=vars.order.agg.value||
vars.aggs.value[sortKey]||"max";aggType=typeof agg;counts=values.reduce(function(obj,val){obj[val]=[];return obj},{});ref2=vars.axes.dataset;for(l=0,len2=ref2.length;l<len2;l++){d=ref2[l];if(d.values){ref3=d.values;for(m=0,len3=ref3.length;m<len3;m++){v=ref3[m];group=fetchValue(vars,v,vars[axis].value);counts[group].push(fetchValue(vars,v,sortKey))}}else{group=fetchValue(vars,d,vars[axis].value);counts[group].push(fetchValue(vars,d,sortKey))}}for(k in counts){v=counts[k];if(aggType==="string")counts[k]=
d3[agg](v);else if(aggType==="function")counts[k]=agg(v,sortKey)}counts=arraySort(d3.entries(counts),"value",sort);counts=counts.reduce(function(arr,v){arr.push(v.key);return arr},[]);return counts}else return uniques(values).sort()}else{values.sort(function(a,b){return a-b});if(vars[axis].scale.value==="log"){if(values[0]===0)values[0]=1;if(values[values.length-1]===0)values[values.length-1]=-1}if(zero){allPositive=values.every(function(v){return v>0});allNegative=values.every(function(v){return v<
0});if(allPositive||allNegative){min=allPositive?1:-1;values.push(vars[axis].scale.value==="log"?min:0)}}return d3.extent(values)}}};getScale=function(vars,axis,range){var rangeArray,rangeMax,scaleType,t;rangeMax=axis.indexOf("x")===0?vars.width.viz:vars.height.viz;scaleType=vars[axis].scale.value;if(["discrete","share"].indexOf(scaleType)>=0)scaleType="linear";t=10;if(typeof range[0]==="string"){scaleType="ordinal";rangeArray=buckets([0,rangeMax],range.length)}else{rangeArray=[0,rangeMax];if(vars[axis].scale.value===
"linear")t=Math.floor(rangeMax/(vars[axis].ticks.font.size*4))}vars[axis].scale.ticks=t;return d3.scale[scaleType]().domain(range).range(rangeArray)};sizeScale=function(vars,value){var domain,max,min;if(value===true)value="size";if(value in vars)value=vars[value].value;min=vars.size.scale.min.value;if(typeof min==="function")min=min(vars);max=vars.size.scale.max.value;if(typeof max==="function")max=max(vars);if(value===false)return vars.size.scale.value.rangeRound([max,max]);else if(typeof value===
"number")return vars.size.scale.value.rangeRound([value,value]);else if(value){if(vars.dev.value)print.time("calculating buffer scale");domain=d3.extent(vars.axes.dataset,function(d){var val;val=fetchValue(vars,d,value);if(!val)return 0;else return val});if(domain[0]===domain[1])min=max;if(vars.dev.value)print.timeEnd("calculating buffer scale");return vars.size.scale.value.domain(domain).rangeRound([min,max])}}},{"../../../../../array/sort.coffee":34,"../../../../../core/console/print.coffee":52,
"../../../../../core/fetch/data.js":64,"../../../../../core/fetch/value.coffee":67,"../../../../../util/buckets.coffee":203,"../../../../../util/uniques.coffee":209,"./buffer.coffee":315}],315:[function(require,module,exports){var buckets,closest;buckets=require("../../../../../util/buckets.coffee");closest=require("../../../../../util/closest.coffee");module.exports=function(vars,axis,buffer){var add,additional,allNegative,allPositive,closestTime,copy,d,diff,difference,domain,domainCompare,domainHigh,
domainLow,i,lowerDiff,lowerMod,lowerScale,lowerValue,maxSize,opp,orig_domain,range,rangeMax,second,strings,timeIndex,upperDiff,upperMod,upperScale,upperValue,zero;if(vars[axis].scale.value!=="share"&&!vars[axis].range.value&&vars[axis].reset)if(axis===vars.axes.discrete){domain=vars[axis].scale.viz.domain();if(typeof domain[0]==="string"){i=domain.length;while(i>=0){domain.splice(i,0,"d3plus_buffer_"+i);i--}range=vars[axis].scale.viz.range();range=buckets(d3.extent(range),domain.length);return vars[axis].scale.viz.domain(domain).range(range)}else{if(axis.indexOf("y")===
0)domain=domain.slice().reverse();if(vars[axis].ticks.values.length===1)if(vars[axis].value===vars.time.value&&vars.data.time.ticks.length!==1){closestTime=closest(vars.data.time.ticks,domain[0]);timeIndex=vars.data.time.ticks.indexOf(closestTime);if(timeIndex>0)domain[0]=vars.data.time.ticks[timeIndex-1];else{diff=vars.data.time.ticks[timeIndex+1]-closestTime;domain[0]=new Date(closestTime.getTime()-diff)}if(timeIndex<vars.data.time.ticks.length-1)domain[1]=vars.data.time.ticks[timeIndex+1];else{diff=
closestTime-vars.data.time.ticks[timeIndex-1];domain[1]=new Date(closestTime.getTime()+diff)}}else{domain[0]-=1;domain[1]+=1}else if(vars.axes.scale){difference=Math.abs(domain[1]-domain[0]);additional=difference/(vars[axis].ticks.values.length-1);additional=additional/2;rangeMax=vars[axis].scale.viz.range()[1];maxSize=vars.axes.scale.range()[1]*1.5;domainLow=vars[axis].scale.viz.invert(-maxSize);domainHigh=vars[axis].scale.viz.invert(rangeMax+maxSize);if(domain[0]-additional<domainLow){domain[0]=
domain[0]-additional;domain[1]=domain[1]+additional}else{domain=[domainLow,domainHigh];if(axis.indexOf("y")===0)domain=domain.reverse();domainCompare=vars[axis].scale.viz.domain();domainCompare=domainCompare[1]-domainCompare[0];if(!domainCompare){domain[0]-=1;domain[1]+=1}}}else if(vars[axis].value===vars.time.value){difference=Math.abs(domain[1]-domain[0]);additional=difference/(vars[axis].ticks.values.length-1);additional=additional/2;domain[0]=domain[0]-additional;domain[1]=domain[1]+additional}else{difference=
Math.abs(domain[1]-domain[0]);add=difference/2;i=domain.length;orig_domain=domain.slice();while(i>=0){d=i?orig_domain[i-1]+add:orig_domain[i]-add;domain.splice(i,0,d);i--}range=vars[axis].scale.viz.range();range=buckets(d3.extent(range),domain.length);vars[axis].scale.viz.domain(domain).range(range)}if(axis.indexOf("y")===0)domain=domain.reverse();return vars[axis].scale.viz.domain(domain)}}else if(buffer==="x"&&axis.indexOf("x")===0||buffer==="y"&&axis.indexOf("y")===0||buffer===true){domain=vars[axis].scale.viz.domain();
allPositive=domain[0]>=0&&domain[1]>=0;allNegative=domain[0]<=0&&domain[1]<=0;if(vars[axis].scale.value==="log"){zero=allPositive?1:-1;if(allPositive&&axis.indexOf("y")===0)domain=domain.slice().reverse();lowerScale=Math.pow(10,parseInt(Math.abs(domain[0])).toString().length-1)*zero;lowerMod=domain[0]%lowerScale;lowerDiff=lowerMod;if(lowerMod&&lowerDiff/lowerScale<=.1)lowerDiff+=lowerScale*zero;lowerValue=lowerMod===0?lowerScale:lowerDiff;domain[0]-=lowerValue;if(domain[0]===0)domain[0]=zero;upperScale=
Math.pow(10,parseInt(Math.abs(domain[1])).toString().length-1)*zero;upperMod=domain[1]%upperScale;upperDiff=Math.abs(upperScale-upperMod);if(upperMod&&upperDiff/upperScale<=.1)upperDiff+=upperScale*zero;upperValue=upperMod===0?upperScale:upperDiff;domain[1]+=upperValue;if(domain[1]===0)domain[1]=zero;if(allPositive&&axis.indexOf("y")===0)domain=domain.reverse()}else{zero=0;if(axis.indexOf("y")===0)domain=domain.slice().reverse();strings=domain.filter(function(d){return d.constructor===String});additional=
Math.abs(domain[1]-domain[0])*.05||1;if(!strings.length){domain[0]=domain[0]-additional;domain[1]=domain[1]+additional;if(allPositive&&domain[0]<zero||allNegative&&domain[0]>zero)domain[0]=zero;if(allPositive&&domain[1]<zero||allNegative&&domain[1]>zero)domain[1]=zero}if(axis.indexOf("y")===0)domain=domain.reverse()}return vars[axis].scale.viz.domain(domain)}else if(vars.axes.scale){copy=false;if(vars.axes.mirror.value){opp=axis.indexOf("y")===0?"x":"y";copy=vars[opp].scale.viz;second=vars.width.viz>
vars.height.viz?"x":"y"}if(axis===second&&copy)domain=copy.domain().slice().reverse();else{rangeMax=vars[axis].scale.viz.range()[1];maxSize=vars.axes.scale.range()[1];domainLow=vars[axis].scale.viz.invert(-maxSize*1.5);domainHigh=vars[axis].scale.viz.invert(rangeMax+maxSize*1.5);domain=[domainLow,domainHigh];if(axis.indexOf("y")===0)domain=domain.reverse();domainCompare=vars[axis].scale.viz.domain();domainCompare=domainCompare[1]-domainCompare[0];if(!domainCompare){domain[0]-=1;domain[1]+=1}if(axis.indexOf("y")===
0)domain=domain.reverse()}return vars[axis].scale.viz.domain(domain)}}},{"../../../../../util/buckets.coffee":203,"../../../../../util/closest.coffee":205}],316:[function(require,module,exports){var copy,events,fetchColor,fetchValue,legible,textColor;copy=require("../../../../../util/copy.coffee");events=require("../../../../../client/pointer.coffee");fetchColor=require("../../../../../core/fetch/color.coffee");fetchValue=require("../../../../../core/fetch/value.coffee");legible=require("../../../../../color/legible.coffee");
textColor=require("../../../../../color/text.coffee");module.exports=function(node,vars){var clickRemove,color,create,graph,lineData,lineInit,lineStyle,lineUpdate,lines,r,rectStyle,rects,s,textStyle,texts,timing,x,y;clickRemove=d3.event.type===events.click&&(vars.tooltip.value["long"]||vars.tooltip.html.value);create=[events.over,events.move].indexOf(d3.event.type)>=0;x=node.d3plus.x;y=node.d3plus.y;r=node.d3plus.r||0;s=vars.types[vars.type.value].scale||1;r=r*s;graph=vars.axes;timing=vars.draw.timing?
vars.timing.mouseevents:0;if(!clickRemove&&create){color=legible(fetchColor(vars,node));lineData=["x","y","x2","y2"].filter(function(axis){var val;val=fetchValue(vars,node,vars[axis].value);return val&&!(val instanceof Array)&&axis!==vars.axes.stacked&&vars[axis].mouse.value&&axis!==vars.axes.discrete})}else lineData=[];lineInit=function(line){return line.attr("x1",function(d){if(d.indexOf("x")===0)return x;else return x-r}).attr("y1",function(d){if(d.indexOf("y")===0)return y;else return y+r}).attr("x2",
function(d){if(d.indexOf("x")===0)return x;else return x-r}).attr("y2",function(d){if(d.indexOf("y")===0)return y;else return y+r}).attr("opacity",0)};lineStyle=function(line){return line.style("stroke",function(d){if(vars.shape.value==="area")return"white";else return color}).attr("stroke-dasharray",function(d){return vars[d].mouse.dasharray.value}).attr("shape-rendering",function(d){return vars[d].mouse.rendering.value}).style("stroke-width",function(d){return vars[d].mouse.width})};lineUpdate=
function(line){return line.attr("x1",function(d){if(d.indexOf("x")===0)return x;else return x-r}).attr("y1",function(d){if(d.indexOf("y")===0)return y;else return y+r}).attr("x2",function(d){if(d.indexOf("x")===0)return x;else if(node.d3plus.x0)return node.d3plus.x0;else if(d==="y")return graph.margin.left-vars[d].ticks.size;else return graph.margin.left+graph.width+vars[d].ticks.size}).attr("y2",function(d){if(d.indexOf("y")===0)return y;else if(node.d3plus.y0)return node.d3plus.y0;else if(d==="x")return graph.height+
graph.margin.top+vars[d].ticks.size;else return graph.margin.top-vars[d].ticks.size}).style("opacity",1)};lines=vars.g.labels.selectAll("line.d3plus_mouse_axis_label").data(lineData);if(timing){lines.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(lineInit).call(lineStyle);lines.transition().duration(timing).call(lineUpdate).call(lineStyle);lines.exit().transition().duration(timing).call(lineInit).remove()}else{lines.call(lineUpdate).call(lineStyle);
lines.enter().append("line").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").call(lineInit).call(lineStyle);lines.exit().remove()}textStyle=function(text){return text.attr("font-size",function(d){return vars[d].ticks.font.size+"px"}).attr("font-family",function(d){return vars[d].ticks.font.family.value}).attr("font-weight",function(d){return vars[d].ticks.font.weight}).attr("x",function(d){if(d.indexOf("x")===0)return x;else if(d==="y")return graph.margin.left-5-vars[d].ticks.size;
else return graph.margin.left+graph.width+5+vars[d].ticks.size}).attr("y",function(d){if(d.indexOf("y")===0)return y;else if(node.d3plus.y0)return node.d3plus.y+(node.d3plus.y0-node.d3plus.y)/2+graph.margin.top-6;else if(d==="x")return graph.height+graph.margin.top+5+vars[d].ticks.size;else return graph.margin.top-5-vars[d].ticks.size-vars[d].ticks.font.size*1.35}).attr("fill",vars.shape.value==="area"?"white":textColor(color))};texts=vars.g.labels.selectAll("text.d3plus_mouse_axis_label").data(lineData);
texts.enter().append("text").attr("class","d3plus_mouse_axis_label").attr("id",function(d){return d+"_d3plusmouseaxislabel"}).attr("dy",function(d){if(d.indexOf("y")===0)return vars[d].ticks.font.size*.35;else return vars[d].ticks.font.size}).style("text-anchor",function(d){if(d==="y")return"end";else if(d==="y2")return"start";else return"middle"}).attr("opacity",0).attr("pointer-events","none").call(textStyle);texts.text(function(d){var axis,val;axis=vars.axes.stacked||d;val=fetchValue(vars,node,
vars[axis].value);return vars.format.value(val,{key:vars[axis].value,vars:vars,labels:vars[axis].affixes.value})});if(timing){texts.transition().duration(timing).delay(timing).attr("opacity",1).call(textStyle);texts.exit().transition().duration(timing).attr("opacity",0).remove()}else{texts.attr("opacity",1).call(textStyle);texts.exit().remove()}rectStyle=function(rect){var getText;getText=function(axis){var l;l=d3.select("text#"+axis+"_d3plusmouseaxislabel");if(l.size())return l.node().getBBox();
else return{"width":0,"height":0}};return rect.attr("x",function(d){var width;width=getText(d).width;if(d.indexOf("x")===0)return x-width/2-5;else if(d==="y")return graph.margin.left-vars[d].ticks.size-width-10;else return graph.margin.left+graph.width+vars[d].ticks.size}).attr("y",function(d){var height;height=getText(d).height;if(d.indexOf("y")===0)return y-(height/2+5);else if(node.d3plus.y0)return node.d3plus.y+(node.d3plus.y0-node.d3plus.y)/2+graph.margin.top-(height/2+5);else if(d==="x")return graph.height+
graph.margin.top+vars[d].ticks.size;else return graph.margin.top-vars[d].ticks.size-height-10}).attr("width",function(d){return getText(d).width+10}).attr("height",function(d){return getText(d).height+10}).style("stroke",vars.shape.value==="area"?"transparent":color).attr("fill",color).attr("shape-rendering",function(d){return vars[d].mouse.rendering.value}).style("stroke-width",function(d){return vars[d].mouse.width})};rects=vars.g.labels.selectAll("rect.d3plus_mouse_axis_label").data(lineData);
if(timing){rects.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events","none").attr("opacity",0).call(rectStyle);rects.transition().duration(timing).delay(timing).attr("opacity",1).call(rectStyle);return rects.exit().transition().duration(timing).attr("opacity",0).remove()}else{rects.attr("opacity",1).call(rectStyle);rects.enter().insert("rect","text.d3plus_mouse_axis_label").attr("class","d3plus_mouse_axis_label").attr("pointer-events",
"none").call(rectStyle);return rects.exit().remove()}}},{"../../../../../client/pointer.coffee":38,"../../../../../color/legible.coffee":44,"../../../../../color/text.coffee":50,"../../../../../core/fetch/color.coffee":63,"../../../../../core/fetch/value.coffee":67,"../../../../../util/copy.coffee":206}],317:[function(require,module,exports){var buckets,buffer,createAxis,fetchValue,fontSizes,formatPower,labelPadding,resetMargins,superscript,textwrap,timeDetect,uniques;buckets=require("../../../../../util/buckets.coffee");
buffer=require("./buffer.coffee");fetchValue=require("../../../../../core/fetch/value.coffee");fontSizes=require("../../../../../font/sizes.coffee");textwrap=require("../../../../../textwrap/textwrap.coffee");timeDetect=require("../../../../../core/data/time.coffee");uniques=require("../../../../../util/uniques.coffee");module.exports=function(vars,opts){var axes,axis,axisStyle,extent,j,k,len,len1,newtick,opp,otherScale,scale,step,tens,tick,ticks,timeReturn,values;vars.axes.margin=resetMargins(vars);
vars.axes.height=vars.height.viz;vars.axes.width=vars.width.viz;axes=vars.width.viz>vars.height.viz?["y","y2","x","x2"]:["x","x2","y","y2"];for(j=0,len=axes.length;j<len;j++){axis=axes[j];if(vars[axis].value){if(vars[axis].ticks.values===false)if(vars[axis].value===vars.time.value){ticks=vars.time.solo.value;if(ticks.length)ticks=ticks.map(function(d){if(d.constructor!==Date){d=d+"";if(d.length===4&&parseInt(d)+""===d)d+="/01/01";d=new Date(d)}return d});else ticks=vars.data.time.values;extent=d3.extent(ticks);
step=vars.data.time.stepType;ticks=[extent[0]];tick=extent[0];while(tick<extent[1]){newtick=new Date(tick);tick=new Date(newtick["set"+step](newtick["get"+step]()+1));ticks.push(tick)}vars[axis].ticks.values=ticks}else if(axis.indexOf("2")===1){otherScale=vars[axis.slice(0,1)].scale.viz;scale=vars[axis].scale.viz;ticks=vars[axis.slice(0,1)].scale.ticks;vars[axis].ticks.values=otherScale.ticks(ticks).map(function(t){return parseFloat(d3.format(".5f")(scale.invert(otherScale(t))))})}else vars[axis].ticks.values=
vars[axis].scale.viz.ticks(vars[axis].scale.ticks);if(!vars[axis].ticks.values.length){values=fetchValue(vars,vars.data.viz,vars[axis].value);if(!(values instanceof Array))values=[values];vars[axis].ticks.values=values}opp=axis.indexOf("x")===0?"y":"x";if(vars[axis].ticks.values.length===1||opts.buffer&&opts.buffer!==opp&&axis===vars.axes.discrete&&vars[axis].reset===true)buffer(vars,axis,opts.buffer);vars[axis].reset=false;if(vars[axis].value===vars.time.value){axisStyle={"font-family":vars[axis].ticks.font.family.value,
"font-weight":vars[axis].ticks.font.weight,"font-size":vars[axis].ticks.font.size+"px","text-transform":vars[axis].ticks.font.transform.value,"letter-spacing":vars[axis].ticks.font.spacing+"px"};timeReturn=timeDetect(vars,{values:vars[axis].ticks.values,limit:vars.width.viz,style:axisStyle});if(vars[axis].ticks.value)vars[axis].ticks.visible=vars[axis].ticks.value.map(Number);else if(vars[axis].ticks.labels.value.constructor===Array)vars[axis].ticks.visible=vars[axis].ticks.labels.value.map(Number);
else vars[axis].ticks.visible=timeReturn.values.map(Number);vars[axis].ticks.format=timeReturn.format}else if(vars[axis].ticks.value){vars[axis].ticks.values=vars[axis].ticks.value;if(vars[axis].ticks.labels.value.constructor===Array)vars[axis].ticks.visible=vars[axis].ticks.labels.value;else vars[axis].ticks.visible=vars[axis].ticks.value}else if(vars[axis].ticks.labels.value.constructor===Array)vars[axis].ticks.visible=vars[axis].ticks.labels.value;else if(vars[axis].scale.value==="log"){ticks=
vars[axis].ticks.values;tens=ticks.filter(function(t){return Math.abs(t).toString().charAt(0)==="1"});if(tens.length<3)vars[axis].ticks.visible=ticks;else vars[axis].ticks.visible=tens}else vars[axis].ticks.visible=vars[axis].ticks.values}}if(!vars.small)labelPadding(vars);for(k=0,len1=axes.length;k<len1;k++){axis=axes[k];vars[axis].axis.svg=createAxis(vars,axis)}};resetMargins=function(vars){if(vars.small)return{top:0,right:0,bottom:0,left:0};else return{top:10,right:10,bottom:10,left:10}};labelPadding=
function(vars){var axis,j,k,lastTick,len,len1,margin,ref,ref1,rightLabel,rightMod,x2Domain,xAttrs,xAxisHeight,xAxisWidth,xDomain,xLabel,xLabelAttrs,xMaxWidth,xSizes,xText,xValues,y2Domain,yAttrs,yAxisWidth,yDomain,yLabel,yLabelAttrs,yText,yValues;xDomain=vars.x.scale.viz.domain();yDomain=vars.y.scale.viz.domain();if(vars.x2.value)x2Domain=vars.x2.scale.viz.domain();if(vars.y2.value)y2Domain=vars.y2.scale.viz.domain();ref=["y","y2"];for(j=0,len=ref.length;j<len;j++){axis=ref[j];if(vars[axis].value){margin=
axis==="y"?"left":"right";yAttrs={"font-size":vars[axis].ticks.font.size+"px","font-family":vars[axis].ticks.font.family.value,"font-weight":vars[axis].ticks.font.weight,"text-transform":vars[axis].ticks.font.transform.value,"letter-spacing":vars[axis].ticks.font.spacing+"px"};yValues=vars[axis].ticks.visible;if(vars[axis].scale.value==="log")yText=yValues.map(function(d){return formatPower(d)});else if(vars[axis].scale.value==="share")yText=yValues.map(function(d){return vars.format.value(d*100,
{key:"share",vars:vars,output:axis})});else if(vars[axis].value===vars.time.value)yText=yValues.map(function(d,i){return vars[axis].ticks.format(new Date(d))});else{if(typeof yValues[0]==="string")yValues=vars[axis].scale.viz.domain().filter(function(d){return d.indexOf("d3plus_buffer_")!==0});yText=yValues.map(function(d){return vars.format.value(d,{key:vars[axis].value,vars:vars,labels:vars[axis].affixes.value,output:axis})})}if(vars[axis].ticks.labels.value){vars[axis].ticks.hidden=false;yAxisWidth=
d3.max(fontSizes(yText,yAttrs),function(d){return d.width});yAxisWidth=Math.ceil(yAxisWidth+vars.labels.padding);vars.axes.margin[margin]+=yAxisWidth}else vars[axis].ticks.hidden=true;yLabel=vars[axis].label.fetch(vars);if(yLabel){yLabelAttrs={"font-family":vars[axis].label.font.family.value,"font-weight":vars[axis].label.font.weight,"font-size":vars[axis].label.font.size+"px","text-transform":vars[axis].label.font.transform.value,"letter-spacing":vars[axis].label.font.spacing+"px"};vars[axis].label.height=
fontSizes([yLabel],yLabelAttrs)[0].height}else vars[axis].label.height=0;if(vars[axis].label.value){vars.axes.margin[margin]+=vars[axis].label.height;vars.axes.margin[margin]+=vars[axis].label.padding*2}}}vars.axes.width-=vars.axes.margin.left+vars.axes.margin.right;vars.x.scale.viz.range(buckets([0,vars.axes.width],xDomain.length));if(x2Domain)vars.x2.scale.viz.range(buckets([0,vars.axes.width],x2Domain.length));ref1=["x","x2"];for(k=0,len1=ref1.length;k<len1;k++){axis=ref1[k];if(vars[axis].value){margin=
axis==="x"?"bottom":"top";if(vars[axis].ticks.labels.value){vars[axis].ticks.hidden=false;xAttrs={"font-size":vars[axis].ticks.font.size+"px","font-family":vars[axis].ticks.font.family.value,"font-weight":vars[axis].ticks.font.weight,"text-transform":vars[axis].ticks.font.transform.value,"letter-spacing":vars[axis].ticks.font.spacing+"px"};xValues=vars[axis].ticks.visible;if(vars[axis].scale.value==="log")xText=xValues.map(function(d){return formatPower(d)});else if(vars[axis].scale.value==="share")xText=
xValues.map(function(d){return vars.format.value(d*100,{key:"share",vars:vars,output:axis})});else if(vars[axis].value===vars.time.value)xText=xValues.map(function(d,i){return vars[axis].ticks.format(new Date(d))});else{if(typeof xValues[0]==="string")xValues=vars[axis].scale.viz.domain().filter(function(d){return d.indexOf("d3plus_buffer_")!==0});xText=xValues.map(function(d){return vars.format.value(d,{key:vars[axis].value,vars:vars,labels:vars[axis].affixes.value,output:axis})})}xSizes=fontSizes(xText,
xAttrs);xAxisWidth=d3.max(xSizes,function(d){return d.width});xAxisHeight=d3.max(xSizes,function(d){return d.height});if(xValues.length===1)xMaxWidth=vars.axes.width;else{xMaxWidth=vars[axis].scale.viz(xValues[1])-vars[axis].scale.viz(xValues[0]);xMaxWidth=Math.abs(xMaxWidth)}if(xAxisWidth>xMaxWidth&&xText.join("").indexOf(" ")>0){vars[axis].ticks.wrap=true;xSizes=fontSizes(xText,xAttrs,{mod:function(elem){return textwrap().container(d3.select(elem)).height(vars.axes.height/2).width(xMaxWidth).draw()}});
xAxisWidth=d3.max(xSizes,function(d){return d.width});xAxisHeight=d3.max(xSizes,function(d){return d.height})}else vars[axis].ticks.wrap=false;vars[axis].ticks.baseline="auto";if(xAxisWidth<=xMaxWidth)vars[axis].ticks.rotate=0;else if(xAxisWidth<vars.axes.height/2){xSizes=fontSizes(xText,xAttrs,{mod:function(elem){return textwrap().container(d3.select(elem)).width(vars.axes.height/2).height(xMaxWidth).draw()}});xAxisHeight=d3.max(xSizes,function(d){return d.width});xAxisWidth=d3.max(xSizes,function(d){return d.height});
vars[axis].ticks.rotate=-90}else{xAxisWidth=0;xAxisHeight=0}if(!(xAxisWidth&&xAxisHeight)){vars[axis].ticks.hidden=true;vars[axis].ticks.rotate=0}xAxisWidth=Math.ceil(xAxisWidth);xAxisHeight=Math.ceil(xAxisHeight);vars[axis].ticks.maxHeight=xAxisHeight;vars[axis].ticks.maxWidth=xAxisWidth;vars.axes.margin[margin]+=xAxisHeight+vars.labels.padding;lastTick=vars[axis].ticks.visible[vars[axis].ticks.visible.length-1];rightLabel=vars[axis].scale.viz(lastTick);rightLabel+=xAxisWidth/2+vars.axes.margin.left;
if(rightLabel>vars.width.value){rightMod=rightLabel-vars.width.value+vars.axes.margin.right;vars.axes.width-=rightMod;vars.axes.margin.right+=rightMod}}else vars[axis].ticks.hidden=true;xLabel=vars[axis].label.fetch(vars);if(xLabel){xLabelAttrs={"font-family":vars[axis].label.font.family.value,"font-weight":vars[axis].label.font.weight,"font-size":vars[axis].label.font.size+"px","text-transform":vars[axis].label.font.transform.value,"letter-spacing":vars[axis].label.font.spacing+"px"};vars[axis].label.height=
fontSizes([xLabel],xLabelAttrs)[0].height}else vars[axis].label.height=0;if(vars[axis].label.value){vars.axes.margin[margin]+=vars[axis].label.height;vars.axes.margin[margin]+=vars[axis].label.padding*2}}}vars.axes.height-=vars.axes.margin.top+vars.axes.margin.bottom;vars.x.scale.viz.range(buckets([0,vars.axes.width],xDomain.length));if(x2Domain)vars.x2.scale.viz.range(buckets([0,vars.axes.width],x2Domain.length));vars.y.scale.viz.range(buckets([0,vars.axes.height],yDomain.length));if(y2Domain)return vars.y2.scale.viz.range(buckets([0,
vars.axes.height],y2Domain.length))};createAxis=function(vars,axis){return d3.svg.axis().tickSize(vars[axis].ticks.size).tickPadding(5).orient(vars[axis].orient.value).scale(vars[axis].scale.viz).tickValues(vars[axis].ticks.values).tickFormat(function(d,i){var c,scale;if(vars[axis].ticks.hidden)return null;scale=vars[axis].scale.value;c=d.constructor===Date?+d:d;if(vars[axis].ticks.visible.indexOf(c)>=0)if(scale==="share")return vars.format.value(d*100,{key:"share",vars:vars,labels:vars[axis].affixes.value,
output:axis});else if(d.constructor===Date)return vars[axis].ticks.format(d);else if(scale==="log")return formatPower(d);else return vars.format.value(d,{key:vars[axis].value,vars:vars,labels:vars[axis].affixes.value,output:axis});else return null})};superscript="\u2070\u00b9\u00b2\u00b3\u2074\u2075\u2076\u2077\u2078\u2079";formatPower=function(d){var n,p,t;p=Math.round(Math.log(Math.abs(d))/Math.LN10);t=Math.abs(d).toString().charAt(0);n=10+" "+(p+"").split("").map(function(c){return superscript[c]}).join("");
if(t!=="1")n=t+" x "+n;if(d<0)return"-"+n;else return n}},{"../../../../../core/data/time.coffee":62,"../../../../../core/fetch/value.coffee":67,"../../../../../font/sizes.coffee":101,"../../../../../textwrap/textwrap.coffee":199,"../../../../../util/buckets.coffee":203,"../../../../../util/uniques.coffee":209,"./buffer.coffee":315}],318:[function(require,module,exports){var mix,textwrap,validObject;mix=require("../../../../../color/mix.coffee");textwrap=require("../../../../../textwrap/textwrap.coffee");
validObject=require("../../../../../object/validate.coffee");module.exports=function(vars){var affixes,alignMap,axis,axisData,axisGroup,axisLabel,bg,bgStyle,d,domain,domains,getFontStyle,grid,gridData,groupEnter,j,k,l,label,labelData,labelStyle,len,len1,len2,len3,len4,line,lineData,lineFont,lineGroup,lineRects,lineStyle,lines,linetexts,m,mirror,n,opp,plane,planeTrans,position,realData,rectData,rectStyle,ref,ref1,ref2,ref3,rotated,sep,style,textData,textPad,textPos,tickFont,tickPosition,tickStyle,
userLines,valid,xStyle,yStyle;domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=0)return null;bgStyle={width:vars.axes.width,height:vars.axes.height,fill:vars.axes.background.color,stroke:vars.axes.background.stroke.color,"stroke-width":vars.axes.background.stroke.width,"shape-rendering":vars.axes.background.rendering.value};alignMap={left:"start",center:"middle",right:"end"};axisData=vars.small?[]:[0];tickPosition=function(tick,axis){return tick.attr("x1",function(d){if(axis.indexOf("x")===
0)return vars.x.scale.viz(d);else return 0}).attr("x2",function(d){if(axis.indexOf("x")===0)return vars.x.scale.viz(d);else return vars.axes.width}).attr("y1",function(d){if(axis.indexOf("y")===0)return vars.y.scale.viz(d);else return 0}).attr("y2",function(d){if(axis.indexOf("y")===0)return vars.y.scale.viz(d);else return vars.axes.height})};tickStyle=function(tick,axis,grid){var color,log;color=grid?vars[axis].grid.color:vars[axis].ticks.color;log=vars[axis].scale.value==="log";return tick.attr("stroke",
function(d){var visible;if(d===0)return vars[axis].axis.color;if(d.constructor===Date)d=+d;visible=vars[axis].ticks.visible.indexOf(d)>=0;if(visible&&(!log||Math.abs(d).toString().charAt(0)==="1"))return color;else if(grid&&vars.axes.background.color!=="transparent")return mix(color,vars.axes.background.color,.4,1);else if(vars.background.value!=="transparent")return mix(color,vars.background.value,.4,1);else return mix(color,"white",.4,1)}).attr("stroke-width",vars[axis].ticks.width).attr("shape-rendering",
vars[axis].ticks.rendering.value)};getFontStyle=function(axis,val,style){var type;type=val===0?"axis":"ticks";val=vars[axis][type].font[style];if(val&&(val.length||typeof val==="number"))return val;else return vars[axis].ticks.font[style]};tickFont=function(tick,axis){var log;log=vars[axis].scale.value==="log";return tick.attr("font-size",function(d){return getFontStyle(axis,d,"size")+"px"}).attr("stroke","none").attr("fill",function(d){var color;color=getFontStyle(axis,d,"color");if(!log||Math.abs(d).toString().charAt(0)===
"1")return color;else return mix(color,vars.background.value,.4,1)}).attr("font-family",function(d){return getFontStyle(axis,d,"family").value}).attr("font-weight",function(d){return getFontStyle(axis,d,"weight")}).style("text-transform",function(d){return getFontStyle(axis,d,"transform").value}).style("letter-spacing",function(d){return getFontStyle(axis,d,"spacing")+"px"})};lineStyle=function(line,axis){var max,opp;max=axis.indexOf("x")===0?"height":"width";opp=axis.indexOf("x")===0?"y":"x";return line.attr(opp+
"1",0).attr(opp+"2",vars.axes[max]).attr(axis+"1",function(d){return d.coords.line}).attr(axis+"2",function(d){return d.coords.line}).attr("stroke",function(d){return d.color||vars[axis].lines.color}).attr("stroke-width",vars[axis].lines.width).attr("shape-rendering",vars[axis].lines.rendering.value).attr("stroke-dasharray",vars[axis].lines.dasharray.value)};lineFont=function(text,axis){var opp;opp=axis.indexOf("x")===0?"y":"x";return text.attr(opp,function(d){return d.coords.text[opp]+"px"}).attr(axis,
function(d){return d.coords.text[axis]+"px"}).attr("dy",vars[axis].lines.font.position.value).attr("text-anchor",alignMap[vars[axis].lines.font.align.value]).attr("transform",function(d){return d.transform}).attr("font-size",vars[axis].lines.font.size+"px").attr("fill",function(d){return d.color||vars[axis].lines.color}).attr("font-family",vars[axis].lines.font.family.value).attr("font-weight",vars[axis].lines.font.weight)};planeTrans="translate("+vars.axes.margin.left+","+vars.axes.margin.top+")";
plane=vars.group.selectAll("g#d3plus_graph_plane").data([0]);plane.transition().duration(vars.draw.timing).attr("transform",planeTrans);plane.enter().append("g").attr("id","d3plus_graph_plane").attr("transform",planeTrans);bg=plane.selectAll("rect#d3plus_graph_background").data([0]);bg.transition().duration(vars.draw.timing).attr(bgStyle);bg.enter().append("rect").attr("id","d3plus_graph_background").attr("x",0).attr("y",0).attr(bgStyle);mirror=plane.selectAll("path#d3plus_graph_mirror").data([0]);
mirror.enter().append("path").attr("id","d3plus_graph_mirror").attr("fill","#000").attr("fill-opacity",.03).attr("stroke-width",1).attr("stroke","#ccc").attr("stroke-dasharray","10,10").attr("opacity",0);mirror.transition().duration(vars.draw.timing).attr("opacity",function(){if(vars.axes.mirror.value)return 1;else return 0}).attr("d",function(){var h,w;w=bgStyle.width;h=bgStyle.height;return"M "+w+" "+h+" L 0 "+h+" L "+w+" 0 Z"});rotated=vars.x.ticks.rotate!==0;xStyle=function(group,axis){var groups,
offset;offset=axis==="x"?vars.axes.height:0;groups=group.attr("transform","translate(0,"+offset+")").call(vars[axis].axis.svg.scale(vars[axis].scale.viz)).selectAll("g.tick");groups.selectAll("line").attr("y2",function(d){var y2;if(d.constructor===Date)d=+d;y2=d3.select(this).attr("y2");if(vars[axis].ticks.visible.indexOf(d)>=0)return y2;else return y2/2});return groups.select("text").style("text-anchor",rotated&&axis==="x"?"end":rotated?"start":"middle").call(tickFont,axis).each(function(d){d3.select(this).attr("dy",
"0px").attr("font-size",function(d){return getFontStyle(axis,d,"size")+"px"});if(d.constructor===Date)d=+d;if(!vars[axis].ticks.hidden&&vars[axis].ticks.visible.indexOf(d)>=0)return textwrap().container(d3.select(this)).rotate(vars[axis].ticks.rotate).align(rotated?"end":"center").valign(rotated?"middle":axis==="x"?"top":"bottom").width(vars[axis].ticks.maxWidth).height(vars[axis].ticks.maxHeight).padding(0).x(-vars[axis].ticks.maxWidth/2).y(axis==="x2"?-(vars[axis].ticks.maxHeight+vars.labels.padding*
2):0).draw()})};yStyle=function(group,axis){var groups,offset;offset=axis==="y2"?vars.axes.width:0;groups=group.attr("transform","translate("+offset+", 0)").call(vars[axis].axis.svg.scale(vars[axis].scale.viz)).selectAll("g.tick");groups.selectAll("line").attr("y2",function(d){var y2;if(d.constructor===Date)d=+d;y2=d3.select(this).attr("y2");if(vars.x.ticks.visible.indexOf(d)>=0)return y2;else return y2/2});return groups.select("text").call(tickFont,axis)};ref=["x","x2","y","y2"];for(j=0,len=ref.length;j<
len;j++){axis=ref[j];style=axis.indexOf("x")===0?xStyle:yStyle;realData=axisData.length&&vars[axis].value?[0]:[];axisGroup=plane.selectAll("g#d3plus_graph_"+axis+"ticks").data(realData);axisGroup.transition().duration(vars.draw.timing).call(style,axis);axisGroup.selectAll("line").transition().duration(vars.draw.timing).call(tickStyle,axis);groupEnter=axisGroup.enter().append("g").attr("id","d3plus_graph_"+axis+"ticks").call(style,axis);groupEnter.selectAll("path").attr("fill","none").attr("stroke",
"none");groupEnter.selectAll("line").call(tickStyle,axis);axisGroup.exit().transition().duration(vars.data.timing).attr("opacity",0).remove()}labelStyle=function(label,axis){return label.attr("x",axis.indexOf("x")===0?vars.width.viz/2:-(vars.axes.height/2+vars.axes.margin.top)).attr("y",axis==="x"?vars.height.viz-vars[axis].label.height/2-vars[axis].label.padding:axis==="y2"?vars.width.viz-vars[axis].label.height/2-vars[axis].label.padding:vars[axis].label.height/2+vars[axis].label.padding).attr("transform",
axis.indexOf("y")===0?"rotate(-90)":null).attr("font-family",vars[axis].label.font.family.value).attr("font-weight",vars[axis].label.font.weight).attr("font-size",vars[axis].label.font.size+"px").attr("fill",vars[axis].label.font.color).style("text-anchor","middle").attr("dominant-baseline","central").style("text-transform",vars[axis].label.font.transform.value).style("letter-spacing",vars[axis].label.font.spacing+"px")};ref1=["x","y"];for(k=0,len1=ref1.length;k<len1;k++){axis=ref1[k];if(vars[axis].grid.value)if(vars[axis].ticks.value)gridData=
vars[axis].ticks.value;else gridData=vars[axis].ticks.values;else{gridData=[];opp=axis==="x"?"y":"x";if(vars[axis].ticks.values.indexOf(0)>=0&&vars[opp].axis.value)gridData=[0]}grid=plane.selectAll("g#d3plus_graph_"+axis+"grid").data([0]);grid.enter().append("g").attr("id","d3plus_graph_"+axis+"grid");lines=grid.selectAll("line").data(gridData,function(d,i){if(d.constructor===Date)return d.getTime();else return d});lines.transition().duration(vars.draw.timing).call(tickPosition,axis).call(tickStyle,
axis,true);lines.enter().append("line").style("opacity",0).call(tickPosition,axis).call(tickStyle,axis,true).transition().duration(vars.draw.timing).delay(vars.draw.timing/2).style("opacity",1);lines.exit().transition().duration(vars.draw.timing/2).style("opacity",0).remove()}ref2=["x","x2","y","y2"];for(l=0,len2=ref2.length;l<len2;l++){axis=ref2[l];if(vars[axis].value){axisLabel=vars[axis].label.fetch(vars);labelData=axisData&&axisLabel?[0]:[];affixes=vars.format.affixes.value[vars[axis].value];
if(axisLabel&&!vars[axis].affixes.value&&affixes){sep=vars[axis].affixes.separator.value;if(sep===true)sep=["[","]"];else if(sep===false)sep=["",""];axisLabel+=" "+sep[0]+affixes[0]+" "+affixes[1]+sep[1]}}else{axisLabel="";labelData=[]}label=vars.group.selectAll("text#d3plus_graph_"+axis+"label").data(labelData);label.text(axisLabel).transition().duration(vars.draw.timing).call(labelStyle,axis);label.enter().append("text").attr("stroke","none").attr("id","d3plus_graph_"+axis+"label").text(axisLabel).call(labelStyle,
axis);label.exit().transition().duration(vars.data.timing).attr("opacity",0).remove()}ref3=["x","y","x2","y2"];for(m=0,len3=ref3.length;m<len3;m++){axis=ref3[m];if(vars[axis].value){lineGroup=plane.selectAll("g#d3plus_graph_"+axis+"_userlines").data([0]);lineGroup.enter().append("g").attr("id","d3plus_graph_"+axis+"_userlines");domain=vars[axis].scale.viz.domain();if(axis.indexOf("y")===0)domain=domain.slice().reverse();textData=[];lineData=[];userLines=vars[axis].lines.value||[];for(n=0,len4=userLines.length;n<
len4;n++){line=userLines[n];d=validObject(line)?line.position:line;if(axis===vars.axes.discrete)valid=domain.indexOf(d)>=0;else valid=d>=domain[0]&&d<=domain[1];if(valid){d=!validObject(line)?{"position":d}:line;d.coords={line:vars[axis].scale.viz(d.position)};lineData.push(d);if(d.text){d.axis=axis;d.padding=vars[axis].lines.font.padding.value*.5;d.align=vars[axis].lines.font.align.value;position=vars[axis].lines.font.position.text;textPad=position==="middle"?0:d.padding*2;if(position==="top")textPad=
-textPad;if(axis.indexOf("x")===0){textPos=d.align==="left"?vars.axes.height:d.align==="center"?vars.axes.height/2:0;if(d.align==="left")textPos-=d.padding*2;if(d.align==="right")textPos+=d.padding*2}else{textPos=d.align==="left"?0:d.align==="center"?vars.axes.width/2:vars.axes.width;if(d.align==="right")textPos-=d.padding*2;if(d.align==="left")textPos+=d.padding*2}d.coords.text={};d.coords.text[axis.indexOf("x")===0?"y":"x"]=textPos;d.coords.text[axis]=vars[axis].scale.viz(d.position)+textPad;d.transform=
axis.indexOf("x")===0?"rotate(-90,"+d.coords.text.x+","+d.coords.text.y+")":null;textData.push(d)}}}lines=lineGroup.selectAll("line.d3plus_graph_"+axis+"line").data(lineData,function(d){return d.position});lines.enter().append("line").attr("class","d3plus_graph_"+axis+"line").attr("opacity",0).call(lineStyle,axis);lines.transition().duration(vars.draw.timing).attr("opacity",1).call(lineStyle,axis);lines.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();linetexts=lineGroup.selectAll("text.d3plus_graph_"+
axis+"line_text").data(textData,function(d){return d.position});linetexts.enter().append("text").attr("class","d3plus_graph_"+axis+"line_text").attr("id",function(d){var id;id=d.position+"";id=id.replace("-","neg");id=id.replace(".","p");return"d3plus_graph_"+axis+"line_text_"+id}).attr("opacity",0).call(lineFont,axis);linetexts.text(function(d){return d.text}).transition().duration(vars.draw.timing).attr("opacity",1).call(lineFont,axis);linetexts.exit().transition().duration(vars.draw.timing).attr("opacity",
0).remove();rectStyle=function(rect){var getText;getText=function(d){var id;id=d.position+"";id=id.replace("-","neg");id=id.replace(".","p");return plane.select("text#d3plus_graph_"+d.axis+"line_text_"+id).node().getBBox()};return rect.attr("x",function(d){return getText(d).x-d.padding}).attr("y",function(d){return getText(d).y-d.padding}).attr("transform",function(d){return d.transform}).attr("width",function(d){return getText(d).width+d.padding*2}).attr("height",function(d){return getText(d).height+
d.padding*2}).attr("fill",vars.axes.background.color!=="transparent"?vars.axes.background.color:"white")};rectData=vars[axis].lines.font.background.value?textData:[];lineRects=lineGroup.selectAll("rect.d3plus_graph_"+axis+"line_rect").data(rectData,function(d){return d.position});lineRects.enter().insert("rect","text.d3plus_graph_"+axis+"line_text").attr("class","d3plus_graph_"+axis+"line_rect").attr("pointer-events","none").attr("opacity",0).call(rectStyle);lineRects.transition().delay(vars.draw.timing).each("end",
function(d){return d3.select(this).transition().duration(vars.draw.timing).attr("opacity",1).call(rectStyle)});lineRects.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove()}}}},{"../../../../../color/mix.coffee":46,"../../../../../object/validate.coffee":171,"../../../../../textwrap/textwrap.coffee":199}],319:[function(require,module,exports){var fetchValue,stringStrip,uniqueValues;fetchValue=require("../../../../core/fetch/value.coffee");stringStrip=require("../../../../string/strip.js");
uniqueValues=require("../../../../util/uniques.coffee");module.exports=function(vars,data,keys){var discrete,extras,key,opposite,serialized,ticks,timeAxis;if(keys===void 0)keys=vars.id.nesting.slice(0,vars.depth.value+1);else if(keys.constructor!==Array)keys=[keys];if(extras===void 0)extras=[];if(!data)data=vars.data.viz;discrete=vars[vars.axes.discrete];opposite=vars[vars.axes.opposite];timeAxis=discrete.value===vars.time.value;if(timeAxis){ticks=vars.data.time.ticks;key=vars.time.solo.value.length?
"solo":"mute";if(vars.time[key].value.length){serialized=vars.time[key].value.slice().map(function(f){if(f.constructor!==Date){f=f+"";if(f.length===4&&parseInt(f)+""===f)f+="/01/01";f=new Date(f)}return+f});ticks=ticks.filter(function(f){if(key==="solo")return serialized.indexOf(+f)>=0;else return serialized.indexOf(+f)<0})}}else if(discrete.ticks.values)ticks=discrete.ticks.values;else ticks=uniqueValues(data,discrete.value,fetchValue,vars);return d3.nest().key(function(d){var id,j,len,return_id,
val;return_id="nesting";for(j=0,len=keys.length;j<len;j++){id=keys[j];val=fetchValue(vars,d,id);if(val instanceof Array)val=val.join("_");return_id+="_"+stringStrip(val)}return return_id}).rollup(function(leaves){var availables,filler,i,j,k,len,len1,obj,ref,tester,tick,timeVar;availables=uniqueValues(leaves,discrete.value,fetchValue,vars);timeVar=availables.length&&availables[0].constructor===Date;if(timeVar)availables=availables.map(Number);if(discrete.zerofill.value){if(discrete.scale.value==="log")if(opposite.scale.viz.domain().every(function(d){return d<
0}))filler=-1;else filler=1;else filler=0;for(i=j=0,len=ticks.length;j<len;i=++j){tick=ticks[i];tester=timeAxis?+tick:tick;if(availables.indexOf(tester)<0){obj={d3plus:{}};ref=vars.id.nesting;for(k=0,len1=ref.length;k<len1;k++){key=ref[k];if(key in leaves[0])obj[key]=leaves[0][key]}obj[discrete.value]=tick;obj[opposite.value]=0;obj[opposite.value]=filler;leaves.splice(i,0,obj)}}}if(typeof leaves[0][discrete.value]==="string")return leaves;else return leaves.sort(function(a,b){var ad,ao,bd,bo,xsort;
ad=fetchValue(vars,a,discrete.value);bd=fetchValue(vars,b,discrete.value);xsort=ad-bd;if(xsort)return xsort;ao=fetchValue(vars,a,opposite.value);bo=fetchValue(vars,b,opposite.value);return ao-bo})}).entries(data)}},{"../../../../core/fetch/value.coffee":67,"../../../../string/strip.js":174,"../../../../util/uniques.coffee":209}],320:[function(require,module,exports){var fetchValue;fetchValue=require("../../../../core/fetch/value.coffee");module.exports=function(vars,data){var d,flip,i,j,len,len1,
margin,neg,negativeData,offset,opposite,positiveData,scale,stack,stacked,v,val;stacked=vars.axes.stacked||vars.axes.opposite;flip=vars[stacked].scale.viz(0);scale=vars[stacked].scale.value;opposite=stacked==="x"?"y":"x";margin=stacked==="y"?vars.axes.margin.top:vars.axes.margin.left;offset=scale==="share"?"expand":"zero";stack=d3.layout.stack().values(function(d){return d.values||[d]}).offset(offset).x(function(d){return d.d3plus[opposite]}).y(function(d){return flip-vars[stacked].scale.viz(fetchValue(vars,
d,vars[stacked].value))}).out(function(d,y0,y){var negative,value;value=fetchValue(vars,d,vars[stacked].value);negative=value<0;if(scale==="share"){d.d3plus[stacked+"0"]=(1-y0)*flip;d.d3plus[stacked]=d.d3plus[stacked+"0"]-y*flip}else{d.d3plus[stacked+"0"]=flip;if(vars.axes.stacked)d.d3plus[stacked+"0"]-=y0;d.d3plus[stacked]=d.d3plus[stacked+"0"]-y}d.d3plus[stacked]+=margin;return d.d3plus[stacked+"0"]+=margin});positiveData=[];negativeData=[];for(i=0,len=data.length;i<len;i++){d=data[i];val=fetchValue(vars,
d,vars[stacked].value);if(val instanceof Array){neg=true;for(j=0,len1=val.length;j<len1;j++){v=val[j];if(v>=0){neg=false;break}}if(neg)negativeData.push(d);else positiveData.push(d)}else{if(val>=0)positiveData.push(d);if(val<0)negativeData.push(d)}}if(positiveData.length===0||negativeData.length===0)return stack(data);else{if(positiveData.length)positiveData=stack(positiveData);if(negativeData.length)negativeData=stack(negativeData);return positiveData.concat(negativeData)}}},{"../../../../core/fetch/value.coffee":67}],
321:[function(require,module,exports){var fetchValue,graph,line,nest,sort,stack;fetchValue=require("../../core/fetch/value.coffee");graph=require("./helpers/graph/draw.coffee");nest=require("./helpers/graph/nest.coffee");sort=require("../../array/sort.coffee");stack=require("./helpers/graph/stack.coffee");line=function(vars){var d,data,domains,i,j,len,len1,point,ref,xval,yval;graph(vars,{buffer:vars.axes.opposite,mouse:true});domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=
0)return[];data=sort(vars.data.viz,null,null,null,vars);for(i=0,len=data.length;i<len;i++){point=data[i];ref=point.values;for(j=0,len1=ref.length;j<len1;j++){d=ref[j];xval=fetchValue(vars,d,vars.x.value);if(xval){d.d3plus.x2=false;d.d3plus.x=vars.x.scale.viz(xval)}else{d.d3plus.x2=true;d.d3plus.x=vars.x2.scale.viz(fetchValue(vars,d,vars.x2.value))}d.d3plus.x+=vars.axes.margin.left;yval=fetchValue(vars,d,vars.y.value);if(yval){d.d3plus.y2=false;d.d3plus.y=vars.y.scale.viz(yval)}else{d.d3plus.y2=true;
d.d3plus.y=vars.y2.scale.viz(fetchValue(vars,d,vars.y2.value))}d.d3plus.y+=vars.axes.margin.top}}if(vars.axes.stacked)return stack(vars,data);else return data};line.filter=function(vars,data){return nest(vars,data)};line.requirements=["data","x","y"];line.setup=function(vars){var axis;if(!vars.axes.discrete){axis=vars.time.value===vars.y.value?"y":"x";vars.self[axis]({scale:"discrete"})}};line.shapes=["line"];line.tooltip="static";module.exports=line},{"../../array/sort.coffee":34,"../../core/fetch/value.coffee":67,
"./helpers/graph/draw.coffee":313,"./helpers/graph/nest.coffee":319,"./helpers/graph/stack.coffee":320}],322:[function(require,module,exports){var smallestGap=require("../../network/smallestGap.coffee"),fetchValue=require("../../core/fetch/value.coffee");var network=function(vars){var nodes=vars.nodes.restricted||vars.nodes.value,edges=vars.edges.restricted||vars.edges.value;var x_range=d3.extent(nodes,function(n){return n.x}),y_range=d3.extent(nodes,function(n){return n.y});var val_range=[1,1];if(typeof vars.size.value===
"number")val_range=[vars.size.value,vars.size.value];else if(vars.size.value)val_range=d3.extent(nodes,function(d){var val=fetchValue(vars,d,vars.size.value);return val===0?null:val});if(typeof val_range[0]=="undefined")val_range=[1,1];if(typeof vars.size.value==="number"){var max_size=vars.size.value;var min_size=vars.size.value}else{var max_size=smallestGap(nodes,{"accessor":function(n){return[n.x,n.y]}});var limit=max_size/2;var overlap=vars.size.value?vars.nodes.overlap:.4;max_size=max_size*overlap;
if(vars.edges.arrows.value)max_size=max_size*.5;if(val_range[0]===val_range[1]){var min_size=limit;max_size=limit}else{var width=x_range[1]+max_size*1.1-(x_range[0]-max_size*1.1),height=y_range[1]+max_size*1.1-(y_range[0]-max_size*1.1),aspect=width/height,app=vars.width.viz/vars.height.viz;if(app>aspect)var scale=vars.height.viz/height;else var scale=vars.width.viz/width;var min_size=max_size*.25;if(min_size*scale<2)min_size=2/scale}}var radius=vars.size.scale.value.domain(val_range).range([min_size,
max_size]);vars.zoom.bounds=[[x_range[0]-max_size*1.1,y_range[0]-max_size*1.1],[x_range[1]+max_size*1.1,y_range[1]+max_size*1.1]];var data=[],lookup={};nodes.forEach(function(n){var d=vars.data.viz.filter(function(a){return a[vars.id.value]==n[vars.id.value]})[0];var obj=d||{};obj[vars.id.value]=n[vars.id.value];obj.d3plus={};obj.d3plus.x=n.x;obj.d3plus.y=n.y;var val=fetchValue(vars,obj,vars.size.value);obj.d3plus.r=val?radius(val):radius.range()[0];lookup[obj[vars.id.value]]={"x":obj.d3plus.x,"y":obj.d3plus.y,
"r":obj.d3plus.r};data.push(obj)});data.sort(function(a,b){return b.d3plus.r-a.d3plus.r});edges.forEach(function(l,i){if(l.d3plus)delete l.d3plus.spline;l[vars.edges.source].d3plus={};var source=lookup[l[vars.edges.source][vars.id.value]];l[vars.edges.source].d3plus.r=source.r;l[vars.edges.source].d3plus.x=source.x;l[vars.edges.source].d3plus.y=source.y;l[vars.edges.target].d3plus={};var target=lookup[l[vars.edges.target][vars.id.value]];l[vars.edges.target].d3plus.r=target.r;l[vars.edges.target].d3plus.x=
target.x;l[vars.edges.target].d3plus.y=target.y});return{"nodes":data,"edges":edges}};network.nesting=false;network.requirements=["nodes","edges"];network.scale=1.05;network.shapes=["circle","square","donut"];network.tooltip="static";network.zoom=true;module.exports=network},{"../../core/fetch/value.coffee":67,"../../network/smallestGap.coffee":167}],323:[function(require,module,exports){var fetchValue,shortestPath,uniqueValues,viz,indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in
this&&this[i]===item)return i;return-1};shortestPath=require("../../network/shortestPath.coffee");fetchValue=require("../../core/fetch/value.coffee");uniqueValues=require("../../util/uniques.coffee");viz=function(vars){var base,base1,base2,base3,col,colIndex,columnWidth,columns,edge,edgeInt,edges,i,id,j,k,l,labelSpace,lastDir,lastHop,len,len1,len2,len3,len4,len5,len6,len7,m,maxRadius,minRadius,n,newPath,next,nextDir,nextHop,nextIndex,node,o,p,path,pathInt,pathLookup,paths,prev,prevIndex,q,ref,ref1,
ref2,ref3,ref4,ref5,ref6,ref7,rowHeight,rows,size,sizeDomain,val,x,xDiff,y,yDomain;edges=[];pathLookup={};pathLookup[vars.focus.value[0]]=0;pathLookup[vars.focus.value[1]]=0;paths={all:[[vars.focus.value[0]],[vars.focus.value[1]]]};ref=viz.paths;for(pathInt=j=0,len=ref.length;j<len;pathInt=++j){path=ref[pathInt];edges=edges.concat(path.edges);lastHop=vars.focus.value[0];paths[pathInt]=[lastHop];ref1=path.edges;for(edgeInt=k=0,len1=ref1.length;k<len1;edgeInt=++k){edge=ref1[edgeInt];edge[vars.edges.source]=
vars.data.viz.filter(function(d){return edge[vars.edges.source][vars.id.value]===d[vars.id.value]})[0];edge[vars.edges.target]=vars.data.viz.filter(function(d){return edge[vars.edges.target][vars.id.value]===d[vars.id.value]})[0];nextDir=edge[vars.edges.source][vars.id.value]===lastHop?"target":"source";nextHop=edge[vars.edges[nextDir]][vars.id.value];if(pathLookup[nextHop]===void 0)pathLookup[nextHop]=pathInt;paths[pathInt].push(nextHop);lastHop=nextHop}}rows=0;for(pathInt in paths){path=paths[pathInt];
if(pathInt!=="all"){newPath=0;for(i=l=0,len2=path.length;l<len2;i=++l){id=path[i];if(i!==0&&i!==path.length-1&&pathLookup[id]===parseFloat(pathInt)){newPath=1;prev=path[i-1];next=path[i+1];prevIndex=null;nextIndex=null;ref2=paths.all;for(colIndex=m=0,len3=ref2.length;m<len3;colIndex=++m){col=ref2[colIndex];if(indexOf.call(col,prev)>=0)prevIndex=colIndex;if(indexOf.call(col,next)>=0)nextIndex=colIndex}if(prevIndex!==null&&nextIndex===null)if(prevIndex+1===paths.all.length-1)paths.all.splice(prevIndex+
1,0,[id]);else paths.all[prevIndex+1].push(id);else if(nextIndex-prevIndex===1)paths.all.splice(nextIndex,0,[id]);else if(nextIndex-prevIndex>1)paths.all[nextIndex-1].push(id)}}rows+=newPath}}rowHeight=Math.floor(vars.height.viz/rows);yDomain=[];i=0;while(i<rows){if(i%2===0)yDomain.push(i);else yDomain.unshift(i);i++}labelSpace=vars.size.value&&!vars.small?30:0;y=d3.scale.ordinal().domain(yDomain).range(d3.range(rowHeight/2-labelSpace,vars.height.viz+rowHeight/2-labelSpace,(vars.height.viz-rowHeight)/
(rows-1)));columns=paths["all"].length;columnWidth=Math.floor(vars.width.viz/columns);x=d3.scale.linear().domain([0,columns-1]).rangeRound([columnWidth/2,vars.width.viz-columnWidth/2]);minRadius=5;maxRadius=d3.min([columnWidth,rowHeight-labelSpace])*.4;sizeDomain=d3.extent(vars.data.viz,function(node){var val;val=fetchValue(vars,node,vars.size.value);return val||0});size=vars.size.scale.value.domain(sizeDomain).rangeRound([minRadius,maxRadius]);ref3=vars.data.viz;for(n=0,len4=ref3.length;n<len4;n++){node=
ref3[n];if(node.d3plus==null)node.d3plus={};ref4=paths["all"];for(colIndex=o=0,len5=ref4.length;o<len5;colIndex=++o){col=ref4[colIndex];if(ref5=node[vars.id.value],indexOf.call(col,ref5)>=0)node.d3plus.x=x(colIndex)}node.d3plus.y=y(pathLookup[node[vars.id.value]]);if(vars.size.value){val=fetchValue(vars,node,vars.size.value);node.d3plus.r=val?size(val):minRadius}else node.d3plus.r=maxRadius;if(node.d3plus.r<columnWidth*.1&&!vars.small)node.d3plus.label={x:0,y:node.d3plus.r+vars.labels.padding*2,w:columnWidth*
.6,h:labelSpace+maxRadius-node.d3plus.r,resize:false};else delete node.d3plus.label}ref6=viz.paths;for(pathInt=p=0,len6=ref6.length;p<len6;pathInt=++p){path=ref6[pathInt];lastHop=vars.focus.value[0];ref7=path.edges;for(edgeInt=q=0,len7=ref7.length;q<len7;edgeInt=++q){edge=ref7[edgeInt];nextDir=edge[vars.edges.source][vars.id.value]===lastHop?"target":"source";lastDir=nextDir==="target"?"source":"target";nextHop=edge[vars.edges[nextDir]][vars.id.value];if(pathLookup[lastHop]!==pathLookup[nextHop]){edge.d3plus=
{spline:true};if((base=edge[vars.edges.source]).d3plus==null)base.d3plus={};if((base1=edge[vars.edges.source].d3plus).edges==null)base1.edges={};if((base2=edge[vars.edges.target]).d3plus==null)base2.d3plus={};if((base3=edge[vars.edges.target].d3plus).edges==null)base3.edges={};xDiff=edge[nextDir].d3plus.x-edge[lastDir].d3plus.x;edge[lastDir].d3plus.edges[edge[nextDir][vars.id.value]]={angle:Math.PI,radius:columnWidth/2};edge[nextDir].d3plus.edges[edge[lastDir][vars.id.value]]={angle:0,radius:columnWidth/
2,offset:xDiff-columnWidth}}else delete edge.d3plus;lastHop=nextHop}}return{nodes:vars.data.viz,edges:edges}};viz.filter=function(vars,data){var added,d,edge,edges,id,ids,j,k,l,len,len1,len2,obj,path,ref,ref1,returnData,source,target;edges=vars.edges.filtered||vars.edges.value;viz.paths=shortestPath(edges,vars.focus.value[0],{target:vars.focus.value[1],distance:vars.edges.size.value||void 0,nodeid:vars.id.value,startpoint:vars.edges.source,endpoint:vars.edges.target,K:vars.edges.limit.value||5});
viz.nodes=[];added=[];ref=viz.paths;for(j=0,len=ref.length;j<len;j++){path=ref[j];ref1=path.edges;for(k=0,len1=ref1.length;k<len1;k++){edge=ref1[k];source=edge[vars.edges.source];target=edge[vars.edges.target];if(added.indexOf(source[vars.id.value])<0){viz.nodes.push(source);added.push(source[vars.id.value])}if(added.indexOf(target[vars.id.value])<0){viz.nodes.push(target);added.push(target[vars.id.value])}}}ids=uniqueValues(viz.nodes,vars.id.value,fetchValue,vars);returnData=[];for(l=0,len2=ids.length;l<
len2;l++){id=ids[l];d=data.filter(function(d){return d[vars.id.value]===id});if(!d[0]){obj={d3plus:{}};obj[vars.id.value]=id;returnData.push(obj)}else returnData.push(d[0])}return returnData};viz.nesting=false;viz.requirements=[function(vars){return{status:vars.focus.value.length===2,text:vars.format.locale.value.method.focus+" x 2"}},"edges"];viz.scale=1;viz.shapes=["circle","square","donut"];viz.tooltip="static";module.exports=viz},{"../../core/fetch/value.coffee":67,"../../network/shortestPath.coffee":166,
"../../util/uniques.coffee":209}],324:[function(require,module,exports){var comparator,dataThreshold,groupData,pie;comparator=require("../../array/comparator.coffee");dataThreshold=require("../../core/data/threshold.js");groupData=require("../../core/data/group.coffee");pie=function(vars){var d,groupedData,i,item,len,pieData,pieLayout,radius,returnData;pieLayout=d3.layout.pie().value(function(d){return d.value}).sort(function(a,b){if(vars.order.value)return comparator(a.d3plus,b.d3plus,[vars.order.value],
vars.order.sort.value,[],vars);else if(vars.id.nesting.length>1)return comparator(a.d3plus,b.d3plus,vars.id.nesting.concat([vars.size.value]),void 0,[],vars);else return comparator(a.d3plus,b.d3plus,[vars.size.value],"desc",[],vars)});groupedData=groupData(vars,vars.data.viz,[]);pieData=pieLayout(groupedData);returnData=[];radius=d3.min([vars.width.viz,vars.height.viz])/2-vars.labels.padding*2;for(i=0,len=pieData.length;i<len;i++){d=pieData[i];item=d.data.d3plus;item.d3plus.startAngle=d.startAngle;
item.d3plus.endAngle=d.endAngle;item.d3plus.r=radius;item.d3plus.x=vars.width.viz/2;item.d3plus.y=vars.height.viz/2;item.d3plus.share=(d.endAngle-d.startAngle)/(Math.PI*2);returnData.push(item)}return returnData};pie.filter=dataThreshold;pie.requirements=["data","size"];pie.shapes=["arc"];pie.threshold=function(vars){return 40*40/(vars.width.viz*vars.height.viz)};module.exports=pie},{"../../array/comparator.coffee":32,"../../core/data/group.coffee":57,"../../core/data/threshold.js":61}],325:[function(require,
module,exports){var buckets,comparator,dataThreshold,fetchText,fetchValue,fontSizes,offset,radar,sort,textwrap,uniques;comparator=require("../../array/comparator.coffee");sort=require("../../array/sort.coffee");dataThreshold=require("../../core/data/threshold.js");fetchText=require("../../core/fetch/text.js");fetchValue=require("../../core/fetch/value.coffee");fontSizes=require("../../font/sizes.coffee");offset=require("../../geom/offset.coffee");textwrap=require("../../textwrap/textwrap.coffee");
buckets=require("../../util/buckets.coffee");uniques=require("../../util/uniques.coffee");radar=function(vars){var a,a2,anchor,angle,buffer,c,center,children,d,data,first,grid,gridStyle,i,idIndex,ids,intervals,j,k,l,labelData,labelGroup,labelHeight,labelIndex,labelStyle,labelWidth,labels,len,len1,len2,len3,m,maxData,maxRadius,n,nextDepth,nextLevel,o,ov,radius,ref,ref1,righty,ringData,ringStyle,rings,second,sizes,text,textStyle,top,total,x,y;data=vars.data.viz;nextDepth=vars.depth.value+1;nextLevel=
vars.id.nesting[nextDepth];children=function(){var j,len,results;results=[];for(j=0,len=data.length;j<len;j++){d=data[j];results.push(d[nextLevel])}return results}();total=function(){var j,len,results;results=[];for(j=0,len=data.length;j<len;j++){d=data[j];results.push(uniques(data,nextLevel,fetchValue,vars,nextDepth))}return results}();total=uniques(d3.merge(total)).length;angle=Math.PI*2/total;maxRadius=d3.min([vars.width.viz,vars.height.viz])/2;labelHeight=0;labelWidth=0;labels=function(){var j,
len,results;results=[];for(j=0,len=children.length;j<len;j++){c=children[j];results.push(fetchText(vars,c,nextDepth)[0])}return results}();labels=uniques(d3.merge(labels));if(vars.labels.value){first=offset(Math.PI/2,maxRadius);second=offset(angle+Math.PI/2,maxRadius);labelHeight=first.x-second.x-vars.labels.padding*2;textStyle={"fill":vars.x.ticks.font.color,"font-family":vars.x.ticks.font.family.value,"font-weight":vars.x.ticks.font.weight,"font-size":vars.x.ticks.font.size+"px"};sizes=fontSizes(labels,
textStyle,{mod:function(elem){return textwrap().container(d3.select(elem)).width(vars.height.viz/8).height(labelHeight).draw()}});labelWidth=d3.max(sizes,function(d){return d.width});maxRadius-=labelWidth;maxRadius-=vars.labels.padding*2}maxData=function(){var j,len,results;results=[];for(j=0,len=children.length;j<len;j++){c=children[j];results.push(function(){var k,len1,results1;results1=[];for(k=0,len1=c.length;k<len1;k++){d=c[k];results1.push(fetchValue(vars,d,vars.size.value))}return results1}())}return results}();
maxData=d3.max(d3.merge(maxData));radius=d3.scale.linear().domain([0,maxData]).range([0,maxRadius]);ids=function(){var j,len,results;results=[];for(j=0,len=children.length;j<len;j++){c=children[j];results.push(fetchValue(vars,c,nextLevel))}return results}();ids=uniques(d3.merge(ids));idIndex=d3.scale.ordinal().domain(ids).range(d3.range(0,ids.length));for(j=0,len=data.length;j<len;j++){d=data[j];d.d3plus.x=vars.width.viz/2+vars.margin.top;d.d3plus.y=vars.height.viz/2+vars.margin.left;ref=d[nextLevel];
for(i=k=0,len1=ref.length;k<len1;i=++k){a=ref[i];if(!a.d3plus)a.d3plus={};a.d3plus.r=radius(fetchValue(vars,a,vars.size.value));a.d3plus.a=idIndex(fetchValue(vars,a,nextLevel))*angle}}intervals=1;ref1=[10,5,4,2];for(m=0,len2=ref1.length;m<len2;m++){i=ref1[m];if(maxRadius/i>=20){intervals=i;break}}ringData=buckets([maxRadius/intervals,maxRadius],intervals-1).reverse();if(ringData.length===intervals)ringData.shift();rings=vars.group.selectAll(".d3plus_radar_rings").data(ringData,function(d,i){return i});
ringStyle=function(ring){return ring.attr("fill",function(d,i){if(i===0)return vars.axes.background.color;else return"transparent"}).attr("cx",vars.width.viz/2+vars.margin.top).attr("cy",vars.height.viz/2+vars.margin.left).attr("stroke",vars.x.grid.value?vars.x.grid.color:"transparent")};rings.enter().append("circle").attr("class","d3plus_radar_rings").call(ringStyle).attr("r",0);rings.transition().duration(vars.draw.timing).call(ringStyle).attr("r",function(d){return d});rings.exit().transition().duration(vars.draw.timing).attr("opacity",
0).remove();labelIndex=d3.scale.ordinal().domain(labels).range(d3.range(0,labels.length));labelData=[];for(n=0,len3=labels.length;n<len3;n++){l=labels[n];a2=angle*labelIndex(l)-Math.PI/2;a=a2*(180/Math.PI);if(a<-90||a>90){a=a-180;buffer=-(maxRadius+vars.labels.padding*2+labelWidth);anchor="end"}else{buffer=maxRadius+vars.labels.padding*2;anchor="start"}top=a2<0||a2>Math.PI;righty=a2<Math.PI/2;ov=maxRadius;if(vars.labels.value)ov+=vars.labels.padding;o=offset(a2,ov);x=o.x;y=o.y;if(!righty)x-=labelWidth;
if(top)y-=labelHeight;center=[0,Math.PI].indexOf(angle*labelIndex(l))>=0;if(center)x-=labelWidth/2;labelData.push({"text":l,"angle":a,"x":buffer,"anchor":anchor,"offset":o})}labelGroup=vars.group.selectAll("g.d3plus_radar_label_group").data([0]);labelGroup.enter().append("g").attr("class","d3plus_radar_label_group").attr("transform","translate("+vars.width.viz/2+","+vars.height.viz/2+")");labelGroup.transition().duration(vars.draw.timing).attr("transform","translate("+vars.width.viz/2+","+vars.height.viz/
2+")");text=labelGroup.selectAll(".d3plus_radar_labels").data(vars.labels.value?labelData:[],function(d,i){return i});labelStyle=function(label){return label.attr(textStyle).each(function(l,i){return textwrap().container(d3.select(this)).height(labelHeight).width(labelWidth).align(l.anchor).text(l.text).padding(0).valign("middle").x(l.x).y(-labelHeight/2).draw()}).attr("transform",function(t){var translate;translate=d3.select(this).attr("transform")||"";if(translate.length)translate=translate.split(")").slice(-3).join(")");
return"rotate("+t.angle+")"+translate})};text.call(labelStyle);text.enter().append("text").attr("class","d3plus_radar_labels").attr("opacity",0).call(labelStyle).transition().duration(vars.draw.timing).attr("opacity",1);text.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();grid=vars.group.selectAll(".d3plus_radar_lines").data(labelData,function(d,i){return i});gridStyle=function(grid){return grid.attr("stroke",vars.x.grid.color).attr("x1",vars.width.viz/2+vars.margin.left).attr("y1",
vars.height.viz/2+vars.margin.top)};grid.enter().append("line").attr("class","d3plus_radar_lines").call(gridStyle).attr("x2",vars.width.viz/2+vars.margin.left).attr("y2",vars.height.viz/2+vars.margin.top);grid.transition().duration(vars.draw.timing).call(gridStyle).attr("x2",function(d){return vars.width.viz/2+vars.margin.left+d.offset.x}).attr("y2",function(d){return vars.height.viz/2+vars.margin.top+d.offset.y});grid.exit().transition().duration(vars.draw.timing).attr("opacity",0).remove();vars.mouse.viz=
{click:false};return data};radar.requirements=["data","size"];radar.shapes=["radial"];module.exports=radar},{"../../array/comparator.coffee":32,"../../array/sort.coffee":34,"../../core/data/threshold.js":61,"../../core/fetch/text.js":66,"../../core/fetch/value.coffee":67,"../../font/sizes.coffee":101,"../../geom/offset.coffee":160,"../../textwrap/textwrap.coffee":199,"../../util/buckets.coffee":203,"../../util/uniques.coffee":209}],326:[function(require,module,exports){var arraySort=require("../../array/sort.coffee"),
events=require("../../client/pointer.coffee"),fetchValue=require("../../core/fetch/value.coffee"),fetchColor=require("../../core/fetch/color.coffee"),legible=require("../../color/legible.coffee"),removeTooltip=require("../../tooltip/remove.coffee"),smallestGap=require("../../network/smallestGap.coffee"),textColor=require("../../color/text.coffee"),uniqueValues=require("../../util/uniques.coffee");var rings=function(vars){var radius=d3.min([vars.height.viz,vars.width.viz])/2,ring_width=vars.small||
!vars.labels.value?(radius-vars.labels.padding*2)/2:radius/3,primaryRing=vars.small||!vars.labels.value?ring_width*1.4:ring_width,secondaryRing=ring_width*2,edges=[],nodes=[];var center=vars.data.viz.filter(function(d){return d[vars.id.value]===vars.focus.value[0]})[0];if(!center){center={"d3plus":{}};center[vars.id.value]=vars.focus.value[0]}center.d3plus.x=vars.width.viz/2;center.d3plus.y=vars.height.viz/2;center.d3plus.r=primaryRing*.65;var primaries=[],claimed=[vars.focus.value[0]];vars.edges.connections(vars.focus.value[0],
vars.id.value).forEach(function(edge){var c=edge[vars.edges.source][vars.id.value]==vars.focus.value[0]?edge[vars.edges.target]:edge[vars.edges.source];var n=vars.data.viz.filter(function(d){return d[vars.id.value]===c[vars.id.value]})[0];if(!n){n={"d3plus":{}};n[vars.id.value]=c[vars.id.value]}n.d3plus.edges=vars.edges.connections(n[vars.id.value],vars.id.value).filter(function(c){return c[vars.edges.source][vars.id.value]!=vars.focus.value[0]&&c[vars.edges.target][vars.id.value]!=vars.focus.value[0]});
n.d3plus.edge=edge;claimed.push(n[vars.id.value]);primaries.push(n)});var sort=vars.order.value||vars.color.value||vars.size.value||vars.id.value;primaries.sort(function(a,b){var lengthdiff=a.d3plus.edges.length-b.d3plus.edges.length;if(lengthdiff)return lengthdiff;else return arraySort([a,b],sort,vars.order.sort.value,vars.color.value||[],vars)});if(typeof vars.edges.limit.value=="number")primaries=primaries.slice(0,vars.edges.limit.value);else if(typeof vars.edges.limit.value=="function")primaries=
vars.edges.limit.value(primaries);var secondaries=[],total=0;primaries.forEach(function(p){var primaryId=p[vars.id.value];p.d3plus.edges=p.d3plus.edges.filter(function(c){var source=c[vars.edges.source][vars.id.value],target=c[vars.edges.target][vars.id.value];return claimed.indexOf(source)<0&&target==primaryId||claimed.indexOf(target)<0&&source==primaryId});total+=p.d3plus.edges.length||1;p.d3plus.edges.forEach(function(c){var source=c[vars.edges.source],target=c[vars.edges.target];var claim=target[vars.id.value]==
primaryId?source:target;claimed.push(claim[vars.id.value])})});arraySort(primaries,sort,vars.order.sort.value,vars.color.value||[],vars);var offset=0,radian=Math.PI*2,start=0;primaries.forEach(function(p,i){var children=p.d3plus.edges.length||1,space=radian/total*children;if(i==0){start=angle;offset-=space/2}var angle=offset+space/2;angle-=radian/4;p.d3plus.radians=angle;p.d3plus.x=vars.width.viz/2+primaryRing*Math.cos(angle);p.d3plus.y=vars.height.viz/2+primaryRing*Math.sin(angle);offset+=space;
p.d3plus.edges.sort(function(a,b){var a=a[vars.edges.source][vars.id.value]==p[vars.id.value]?a[vars.edges.target]:a[vars.edges.source],b=b[vars.edges.source][vars.id.value]==p[vars.id.value]?b[vars.edges.target]:b[vars.edges.source];return arraySort([a,b],sort,vars.order.sort.value,vars.color.value||[],vars)});p.d3plus.edges.forEach(function(edge,i){var c=edge[vars.edges.source][vars.id.value]==p[vars.id.value]?edge[vars.edges.target]:edge[vars.edges.source],s=radian/total;var d=vars.data.viz.filter(function(a){return a[vars.id.value]===
c[vars.id.value]})[0];if(!d){d={"d3plus":{}};d[vars.id.value]=c[vars.id.value]}a=angle-s*children/2+s/2+s*i;d.d3plus.radians=a;d.d3plus.x=vars.width.viz/2+secondaryRing*Math.cos(a);d.d3plus.y=vars.height.viz/2+secondaryRing*Math.sin(a);secondaries.push(d)})});var primaryDistance=smallestGap(primaries,{"accessor":function(n){return[n.d3plus.x,n.d3plus.y]}}),secondaryDistance=smallestGap(secondaries,{"accessor":function(n){return[n.d3plus.x,n.d3plus.y]}});if(!primaryDistance)primaryDistance=ring_width/
2;if(!secondaryDistance)secondaryDistance=ring_width/4;if(primaryDistance/2-4<8)var primaryMax=d3.min([primaryDistance/2,8]);else var primaryMax=primaryDistance/2-4;if(secondaryDistance/2-4<4)var secondaryMax=d3.min([secondaryDistance/2,4]);else var secondaryMax=secondaryDistance/2-4;if(secondaryMax>ring_width/10)secondaryMax=ring_width/10;if(secondaryMax>primaryMax&&secondaryMax>10)secondaryMax=primaryMax*.75;if(primaryMax>secondaryMax*1.5)primaryMax=secondaryMax*1.5;primaryMax=Math.floor(primaryMax);
secondaryMax=Math.floor(secondaryMax);var ids=uniqueValues(primaries,vars.id.value,fetchValue,vars);ids=ids.concat(uniqueValues(secondaries,vars.id.value,fetchValue,vars));ids.push(vars.focus.value[0]);var data=vars.data.viz.filter(function(d){return ids.indexOf(d[vars.id.value])>=0});if(vars.size.value){var domain=d3.extent(data,function(d){return fetchValue(vars,d,vars.size.value)});if(domain[0]==domain[1])domain[0]=0;var radius=d3.scale.linear().domain(domain).rangeRound([3,d3.min([primaryMax,
secondaryMax])]);var val=fetchValue(vars,center,vars.size.value);center.d3plus.r=radius(val)}else{var radius=d3.scale.linear().domain([1,2]).rangeRound([primaryMax,secondaryMax]);if(vars.edges.label)center.d3plus.r=radius(1)*1.5}secondaries.forEach(function(s){s.d3plus.ring=2;var val=vars.size.value?fetchValue(vars,s,vars.size.value):2;s.d3plus.r=radius(val)});primaries.forEach(function(p){p.d3plus.ring=1;var val=vars.size.value?fetchValue(vars,p,vars.size.value):1;p.d3plus.r=radius(val)});nodes=
[center].concat(primaries).concat(secondaries);primaries.forEach(function(p,i){var check=[vars.edges.source,vars.edges.target],edge=p.d3plus.edge;check.forEach(function(node){edge[node]=nodes.filter(function(n){return n[vars.id.value]==edge[node][vars.id.value]})[0]});delete edge.d3plus;edges.push(edge);vars.edges.connections(p[vars.id.value],vars.id.value).forEach(function(edge){var c=edge[vars.edges.source][vars.id.value]==p[vars.id.value]?edge[vars.edges.target]:edge[vars.edges.source];if(c[vars.id.value]!=
center[vars.id.value]){var target=secondaries.filter(function(s){return s[vars.id.value]==c[vars.id.value]})[0];if(!target){var r=primaryRing;target=primaries.filter(function(s){return s[vars.id.value]==c[vars.id.value]})[0]}else var r=secondaryRing;if(target){edge.d3plus={"spline":true,"translate":{"x":vars.width.viz/2,"y":vars.height.viz/2}};var check=[vars.edges.source,vars.edges.target];check.forEach(function(node,i){edge[node]=nodes.filter(function(n){return n[vars.id.value]==edge[node][vars.id.value]})[0];
if(edge[node].d3plus.edges===undefined)edge[node].d3plus.edges={};var oppID=i===0?edge[vars.edges.target][vars.id.value]:edge[vars.edges.source][vars.id.value];if(edge[node][vars.id.value]==p[vars.id.value])edge[node].d3plus.edges[oppID]={"angle":p.d3plus.radians+Math.PI,"radius":ring_width/2};else edge[node].d3plus.edges[oppID]={"angle":target.d3plus.radians,"radius":ring_width/2}});edges.push(edge)}}})});var labelColor=false;if(vars.background.value&&["transparent","none"].indexOf(vars.background.value)<
0&&d3.hsl(vars.background.value).l<.5)labelColor=textColor(vars.background.value);nodes.forEach(function(n){if(!vars.small&&vars.labels.value)if(n[vars.id.value]!=vars.focus.value[0]){n.d3plus.rotate=n.d3plus.radians*(180/Math.PI);var angle=n.d3plus.rotate,width=ring_width-vars.labels.padding*3-n.d3plus.r;if(angle<-90||angle>90){angle=angle-180;var buffer=-(n.d3plus.r+width/2+vars.labels.padding),anchor="end"}else var buffer=n.d3plus.r+width/2+vars.labels.padding,anchor="start";var background=primaries.indexOf(n)>=
0?true:false;var height=n.d3plus.ring==1?primaryDistance:secondaryDistance;n.d3plus.label={"x":buffer,"y":0,"w":width,"h":height,"angle":angle,"anchor":anchor,"valign":"center","color":labelColor||legible(fetchColor(vars,n)),"resize":[8,vars.labels.font.size],"background":background,"mouse":true}}else if(vars.size.value||vars.edges.label){var height=primaryRing-n.d3plus.r*2-vars.labels.padding*2;n.d3plus.label={"x":0,"y":n.d3plus.r+height/2,"w":primaryRing,"h":height,"color":labelColor||legible(fetchColor(vars,
n)),"resize":[10,40],"background":true,"mouse":true}}else{delete n.d3plus.rotate;delete n.d3plus.label}else{delete n.d3plus.rotate;delete n.d3plus.label}});vars.mouse.viz={};vars.mouse.viz[events.click]=function(d){if(d[vars.id.value]!=vars.focus.value[0]){removeTooltip(vars.type.value);var old_focus=vars.focus.value[0];vars.history.states.push(function(){vars.self.focus(old_focus).draw()});vars.self.focus(d[vars.id.value]).draw()}};return{"edges":edges,"nodes":nodes,"data":data}};rings.filter=function(vars,
data){var primaries=vars.edges.connections(vars.focus.value[0],vars.id.value,true),secondaries=[];primaries.forEach(function(p){secondaries=secondaries.concat(vars.edges.connections(p[vars.id.value],vars.id.value,true))});var connections=primaries.concat(secondaries),ids=uniqueValues(connections,vars.id.value,fetchValue,vars),returnData=[];ids.forEach(function(id){var d=data.filter(function(d){return d[vars.id.value]==id})[0];if(!d){var obj={"d3plus":{}};obj[vars.id.value]=id;returnData.push(obj)}else returnData.push(d)});
return returnData};rings.nesting=false;rings.scale=1;rings.shapes=["circle","square","donut"];rings.requirements=["edges","focus"];rings.tooltip="static";module.exports=rings},{"../../array/sort.coffee":34,"../../client/pointer.coffee":38,"../../color/legible.coffee":44,"../../color/text.coffee":50,"../../core/fetch/color.coffee":63,"../../core/fetch/value.coffee":67,"../../network/smallestGap.coffee":167,"../../tooltip/remove.coffee":202,"../../util/uniques.coffee":209}],327:[function(require,module,
exports){var d3sankey,events,removeTooltip,sankey,uniques;d3sankey=require("./sankey.js");events=require("../../client/pointer.coffee");removeTooltip=require("../../tooltip/remove.coffee");uniques=require("../../util/uniques.coffee");sankey=function(vars){var d,e,edges,focus,i,j,layout,len,len1,n,nodes,padding,placed,returnData,size;focus=vars.focus.value[0];padding=vars.data.stroke.width*2;size=vars.size.value.constructor===Number?vars.size.value:20;edges=vars.edges.connections(focus,vars.id.value).filter(function(e){return e[vars.edges.source][vars.id.value]!==
focus||e[vars.edges.target][vars.id.value]!==focus});nodes=[];placed=[];edges=edges.map(function(e){var s,t;if(e[vars.edges.target][vars.id.value]===focus){s={id:"left_"+e[vars.edges.source][vars.id.value],dupe:"left",data:e[vars.edges.source]};t=e[vars.edges.target]}else{s=e[vars.edges.source];t={id:"right_"+e[vars.edges.target][vars.id.value],dupe:"right",data:e[vars.edges.target]}}if(placed.indexOf(s.id)<0)nodes.push(s);if(placed.indexOf(t.id)<0)nodes.push(t);placed.push(s.id);placed.push(t.id);
return{source:s,target:t,value:e[vars.edges.strength.value]||1}});layout=d3sankey().nodeWidth(size).nodePadding(vars.data.padding.value).size([vars.width.viz-padding*2,vars.height.viz-padding*2]).nodes(nodes).links(edges).layout(2);returnData=[];for(i=0,len=nodes.length;i<len;i++){n=nodes[i];d=n.data||n;d={id:d[vars.id.value]};d.d3plus={x:n.x+n.dx/2+padding,y:n.y+n.dy/2+padding,width:n.dx,height:n.dy,suffix:n.dupe};returnData.push(d)}vars.edges.path=layout.link();for(j=0,len1=edges.length;j<len1;j++){e=
edges[j];e.d3plus={x:padding,y:padding}}vars.mouse.viz={};vars.mouse.viz[events.click]=function(d){var old_focus;if(d[vars.id.value]!==vars.focus.value[0]){removeTooltip(vars.type.value);old_focus=vars.focus.value[0];vars.history.states.push(function(){return vars.self.focus(old_focus).draw()});return vars.self.focus(d[vars.id.value]).draw()}};return{nodes:returnData,edges:edges}};sankey.requirements=["edges","focus","nodes"];sankey.shapes=["square"];module.exports=sankey},{"../../client/pointer.coffee":38,
"../../tooltip/remove.coffee":202,"../../util/uniques.coffee":209,"./sankey.js":328}],328:[function(require,module,exports){module.exports=function(){var sankey={},nodeWidth=24,nodePadding=8,size=[1,1],nodes=[],links=[];sankey.nodeWidth=function(_){if(!arguments.length)return nodeWidth;nodeWidth=+_;return sankey};sankey.nodePadding=function(_){if(!arguments.length)return nodePadding;nodePadding=+_;return sankey};sankey.nodes=function(_){if(!arguments.length)return nodes;nodes=_;return sankey};sankey.links=
function(_){if(!arguments.length)return links;links=_;return sankey};sankey.size=function(_){if(!arguments.length)return size;size=_;return sankey};sankey.layout=function(iterations){computeNodeLinks();computeNodeValues();computeNodeBreadths();computeNodeDepths(iterations);computeLinkDepths();return sankey};sankey.relayout=function(){computeLinkDepths();return sankey};sankey.link=function(){var curvature=.5;function link(d){var x0=d.source.x+d.source.dx,x1=d.target.x,xi=d3.interpolateNumber(x0,x1),
x2=xi(curvature),x3=xi(1-curvature),y0=d.source.y+d.sy+d.dy/2,y1=d.target.y+d.ty+d.dy/2;return"M"+x0+","+y0+"C"+x2+","+y0+" "+x3+","+y1+" "+x1+","+y1}link.curvature=function(_){if(!arguments.length)return curvature;curvature=+_;return link};return link};function computeNodeLinks(){nodes.forEach(function(node){node.sourceLinks=[];node.targetLinks=[]});links.forEach(function(link){var source=link.source,target=link.target;if(typeof source==="number")source=link.source=nodes[link.source];if(typeof target===
"number")target=link.target=nodes[link.target];source.sourceLinks.push(link);target.targetLinks.push(link)})}function computeNodeValues(){nodes.forEach(function(node){node.value=Math.max(d3.sum(node.sourceLinks,value),d3.sum(node.targetLinks,value))})}function computeNodeBreadths(){var remainingNodes=nodes,nextNodes,x=0;while(remainingNodes.length){nextNodes=[];remainingNodes.forEach(function(node){node.x=x;node.dx=nodeWidth;node.sourceLinks.forEach(function(link){if(nextNodes.indexOf(link.target)<
0)nextNodes.push(link.target)})});remainingNodes=nextNodes;++x}moveSinksRight(x);scaleNodeBreadths((size[0]-nodeWidth)/(x-1))}function moveSourcesRight(){nodes.forEach(function(node){if(!node.targetLinks.length)node.x=d3.min(node.sourceLinks,function(d){return d.target.x})-1})}function moveSinksRight(x){nodes.forEach(function(node){if(!node.sourceLinks.length)node.x=x-1})}function scaleNodeBreadths(kx){nodes.forEach(function(node){node.x*=kx})}function computeNodeDepths(iterations){var nodesByBreadth=
d3.nest().key(function(d){return d.x}).sortKeys(d3.ascending).entries(nodes).map(function(d){return d.values});initializeNodeDepth();resolveCollisions();for(var alpha=1;iterations>0;--iterations){relaxRightToLeft(alpha*=.99);resolveCollisions();relaxLeftToRight(alpha);resolveCollisions()}function initializeNodeDepth(){var ky=d3.min(nodesByBreadth,function(nodes){return(size[1]-(nodes.length-1)*nodePadding)/d3.sum(nodes,value)});nodesByBreadth.forEach(function(nodes){nodes.forEach(function(node,i){node.y=
i;node.dy=node.value*ky})});links.forEach(function(link){link.dy=link.value*ky})}function relaxLeftToRight(alpha){nodesByBreadth.forEach(function(nodes,breadth){nodes.forEach(function(node){if(node.targetLinks.length){var y=d3.sum(node.targetLinks,weightedSource)/d3.sum(node.targetLinks,value);node.y+=(y-center(node))*alpha}})});function weightedSource(link){return center(link.source)*link.value}}function relaxRightToLeft(alpha){nodesByBreadth.slice().reverse().forEach(function(nodes){nodes.forEach(function(node){if(node.sourceLinks.length){var y=
d3.sum(node.sourceLinks,weightedTarget)/d3.sum(node.sourceLinks,value);node.y+=(y-center(node))*alpha}})});function weightedTarget(link){return center(link.target)*link.value}}function resolveCollisions(){nodesByBreadth.forEach(function(nodes){var node,dy,y0=0,n=nodes.length,i;nodes.sort(ascendingDepth);for(i=0;i<n;++i){node=nodes[i];dy=y0-node.y;if(dy>0)node.y+=dy;y0=node.y+node.dy+nodePadding}dy=y0-nodePadding-size[1];if(dy>0){y0=node.y-=dy;for(i=n-2;i>=0;--i){node=nodes[i];dy=node.y+node.dy+nodePadding-
y0;if(dy>0)node.y-=dy;y0=node.y}}})}function ascendingDepth(a,b){return a.y-b.y}}function computeLinkDepths(){nodes.forEach(function(node){node.sourceLinks.sort(ascendingTargetDepth);node.targetLinks.sort(ascendingSourceDepth)});nodes.forEach(function(node){var sy=0,ty=0;node.sourceLinks.forEach(function(link){link.sy=sy;sy+=link.dy});node.targetLinks.forEach(function(link){link.ty=ty;ty+=link.dy})});function ascendingSourceDepth(a,b){return a.source.y-b.source.y}function ascendingTargetDepth(a,b){return a.target.y-
b.target.y}}function center(node){return node.y+node.dy/2}function value(link){return link.value}return sankey}},{}],329:[function(require,module,exports){var fetchValue,graph,print,scatter,sort,ticks;fetchValue=require("../../core/fetch/value.coffee");graph=require("./helpers/graph/draw.coffee");print=require("../../core/console/print.coffee");sort=require("../../array/sort.coffee");ticks=require("./helpers/graph/dataTicks.coffee");scatter=function(vars){var d,domains,i,len,ref;graph(vars,{buffer:"size",
mouse:true});domains=vars.x.domain.viz.concat(vars.y.domain.viz);if(domains.indexOf(void 0)>=0)return[];ref=vars.data.viz;for(i=0,len=ref.length;i<len;i++){d=ref[i];d.d3plus.x=vars.x.scale.viz(fetchValue(vars,d,vars.x.value));d.d3plus.x+=vars.axes.margin.left;d.d3plus.y=vars.y.scale.viz(fetchValue(vars,d,vars.y.value));d.d3plus.y+=vars.axes.margin.top;if(typeof vars.size.value==="number"||!vars.size.value)d.d3plus.r=vars.axes.scale(0);else d.d3plus.r=vars.axes.scale(fetchValue(vars,d,vars.size.value))}ticks(vars);
return sort(vars.data.viz,vars.order.value||vars.size.value||vars.id.value,vars.order.sort.value==="desc"?"asc":"desc",vars.color.value||[],vars)};scatter.fill=true;scatter.requirements=["data","x","y"];scatter.scale=1.1;scatter.setup=function(vars){if(vars.time.value&&!vars.axes.discrete){if(vars.time.value===vars.x.value)vars.self.x({scale:"discrete"});if(vars.time.value===vars.y.value)return vars.self.y({scale:"discrete"})}};scatter.shapes=["circle","square","donut"];scatter.tooltip="static";module.exports=
scatter},{"../../array/sort.coffee":34,"../../core/console/print.coffee":52,"../../core/fetch/value.coffee":67,"./helpers/graph/dataTicks.coffee":312,"./helpers/graph/draw.coffee":313}],330:[function(require,module,exports){var fetchValue=require("../../core/fetch/value.coffee");var uniques=require("../../util/uniques.coffee");var copy=require("../../util/copy.coffee");var rand_col=require("../../color/random.coffee");var table=function(vars){var ids=uniques(vars.data.viz,vars.id.value,fetchValue,
vars);var cols=uniques(vars.cols.value);if(cols.indexOf("label")<0&&vars.cols.index.value)cols.unshift("label");var item_height=vars.height.viz/(ids.length+1);var item_width=vars.width.viz/cols.length;vars.group.selectAll("rect").data([0]).enter().append("rect").attr("class","background").attr("height",vars.height.viz).attr("width",vars.width.viz).style("fill",vars.color.missing);var lines_horiz=vars.group.selectAll("line.horiz").data(vars.data.viz);lines_horiz.enter().append("line").attr("class",
"horiz");lines_horiz.attr("x1",0).attr("y1",function(d,row_i){return item_height*row_i+item_height}).attr("x2",vars.width.viz).attr("y2",function(d,row_i){return item_height*row_i+item_height}).style("fill","#fff").style("stroke","#fff");lines_horiz.exit().remove();var lines_vert=vars.group.selectAll("line.vert").data(cols);lines_vert.enter().append("line").attr("class","vert");lines_vert.attr("x1",function(d,col_i){return item_width*col_i+item_width}).attr("y1",0).attr("x2",function(d,col_i){return item_width*
col_i+item_width}).attr("y2",vars.height.viz).style("fill","#fff").style("stroke","#fff");lines_vert.exit().remove();var ret=[];var colors={};cols.forEach(function(col,col_i){var header={"d3plus":{"x":item_width*col_i+item_width/2,"y":item_height/2,"width":item_width,"height":item_height,"id":"d3p_header_"+col.toString().replace(/ /g,"_"),"shape":"square","color":"#fff","text":vars.format.value(col)}};if(col==vars.id.value)header.d3plus.color="#fff";if(col=="label"){header.d3plus.label=false;header.d3plus.color=
"#fff";header.d3plus.stroke="#fff"}ret.push(header);if(vars.data.keys[col]=="number"){var domain_extent=d3.extent(vars.data.viz,function(d){return d[col]});if(domain_extent[0]==domain_extent[1])domain_extent=[domain_extent[0]-1,domain_extent[1]];colors[col]=d3.scale.linear().domain(domain_extent).range([vars.color.missing,rand_col(col)])}else if(vars.data.keys[col]=="boolean")colors[col]=function(bool){return bool?rand_col(col):vars.color.missing}});vars.data.viz.forEach(function(d,row_i){row_i+=
1;cols.forEach(function(col,col_i){var d_clone=copy(d);d_clone.d3plus.id="d3p_"+d_clone[vars.id.value].toString().replace(/ /g,"_")+"_"+col;d_clone.d3plus.x=item_width*col_i+item_width/2;d_clone.d3plus.y=item_height*row_i+item_height/2;d_clone.d3plus.width=item_width;d_clone.d3plus.height=item_height;if(col=="label"){d_clone.d3plus.shape="square";d_clone.d3plus.color="#fff";ret.push(d_clone)}if(d3.keys(d).indexOf(col)>=0&&col in d){if(colors[col])d_clone.d3plus.color=colors[col](d_clone[col]);d_clone.d3plus.text=
vars.format.value(d_clone[col]);if(vars.data.keys[col]=="boolean")d_clone.d3plus.label=false;else if(vars.data.keys[col]=="string"){d_clone.d3plus.color=vars.color.missing;d_clone.d3plus.stroke="#fff";d_clone.d3plus.shape="square"}ret.push(d_clone)}})});return ret};table.shapes=["check","cross","diamond","square","triangle","triangle_up","triangle_down"];table.requirements=["data","cols"];module.exports=table},{"../../color/random.coffee":47,"../../core/fetch/value.coffee":67,"../../util/copy.coffee":206,
"../../util/uniques.coffee":209}],331:[function(require,module,exports){var dataThreshold,groupData,mergeObject,tree_map;dataThreshold=require("../../core/data/threshold.js");groupData=require("../../core/data/group.coffee");mergeObject=require("../../object/merge.coffee");tree_map=function(vars){var d,data,groupedData,i,len,returnData,root;groupedData=groupData(vars,vars.data.viz);data=d3.layout.treemap().mode(vars.type.mode.value).round(true).size([vars.width.viz,vars.height.viz]).children(function(d){return d.values}).padding(vars.data.padding.value).sort(function(a,
b){var sizeDiff;sizeDiff=a.value-b.value;if(sizeDiff===0)return a.id<b.id;else return sizeDiff}).nodes({name:"root",values:groupedData}).filter(function(d){return!d.values&&d.area});if(data.length){root=data[0];while(root.parent)root=root.parent;returnData=[];for(i=0,len=data.length;i<len;i++){d=data[i];d.d3plus.d3plus=mergeObject(d.d3plus.d3plus,{x:d.x+d.dx/2,y:d.y+d.dy/2,width:d.dx,height:d.dy,share:d.value/root.value});returnData.push(d.d3plus)}}return returnData};tree_map.filter=dataThreshold;
tree_map.modes=["squarify","slice","dice","slice-dice"];tree_map.requirements=["data","size"];tree_map.shapes=["square"];tree_map.threshold=function(vars){return 40*40/(vars.width.viz*vars.height.viz)};module.exports=tree_map},{"../../core/data/group.coffee":57,"../../core/data/threshold.js":61,"../../object/merge.coffee":170}],332:[function(require,module,exports){var attach,axis,container,flash,getSteps,print,validObject;attach=require("../core/methods/attach.coffee");axis=require("./methods/helpers/axis.coffee");
flash=require("./helpers/ui/message.js");getSteps=require("./helpers/drawSteps.js");print=require("../core/console/print.coffee");container=require("./helpers/container.coffee");validObject=require("../object/validate.coffee");module.exports=function(){var vars;vars={g:{apps:{}},types:{area:require("./types/area.coffee"),bar:require("./types/bar.coffee"),bubbles:require("./types/bubbles.coffee"),box:require("./types/box.coffee"),chart:require("./types/deprecated/chart.coffee"),geo_map:require("./types/geo_map.coffee"),
line:require("./types/line.coffee"),network:require("./types/network.js"),paths:require("./types/paths.coffee"),pie:require("./types/pie.coffee"),radar:require("./types/radar.coffee"),rings:require("./types/rings.js"),sankey:require("./types/sankey.coffee"),scatter:require("./types/scatter.coffee"),stacked:require("./types/area.coffee"),table:require("./types/table.js"),tree_map:require("./types/tree_map.coffee")}};vars.self=function(selection){selection.each(function(){var lastMessage,nextStep,runFunction,
runStep,small_height,small_width,steps;vars.draw.frozen=true;vars.error.internal=null;if(!("timing"in vars.draw))vars.draw.timing=vars.timing.transitions;if(vars.error.value)vars.draw.timing=0;container(vars);small_width=vars.width.value<=vars.width.small;small_height=vars.height.value<=vars.height.small;vars.small=small_width||small_height;vars.width.viz=vars.width.value;vars.height.viz=vars.height.value;lastMessage=false;nextStep=function(){if(steps.length)runStep();else if(vars.dev.value){print.groupEnd();
print.timeEnd("total draw time");print.log("\n")}};runFunction=function(step,name){name=name||"function";if(step[name]instanceof Array)step[name].forEach(function(f){f(vars,nextStep)});else if(typeof step[name]==="function")step[name](vars,nextStep);if(!step.wait)nextStep()};runStep=function(){var message,run,same,step;step=steps.shift();same=vars.g.message&&lastMessage===step.message;run="check"in step?step.check:true;if(typeof run==="function")run=run(vars);if(run)if(!same){if(vars.dev.value){if(lastMessage!==
false)print.groupEnd();print.group(step.message)}if(typeof vars.messages.value==="string"){lastMessage=vars.messages.value;message=vars.messages.value}else{lastMessage=step.message;message=vars.format.value(step.message)}if(vars.draw.update){flash(vars,message);if(vars.error.value)runFunction(step);else setTimeout(function(){return runFunction(step)},10)}else runFunction(step)}else runFunction(step);else if("otherwise"in step)if(vars.error.value)runFunction(step,"otherwise");else setTimeout(function(){return runFunction(step,
"otherwise")},10);else nextStep()};vars.messages.style.backup=vars.group&&vars.group.attr("opacity")==="1"?"small":"large";steps=getSteps(vars);runStep()});return vars.self};attach(vars,{active:require("./methods/active.coffee"),aggs:require("./methods/aggs.coffee"),attrs:require("./methods/attrs.coffee"),axes:require("./methods/axes.coffee"),background:require("./methods/background.coffee"),"class":require("./methods/class.coffee"),color:require("./methods/color.coffee"),cols:require("./methods/cols.js"),
config:require("./methods/config.coffee"),container:require("./methods/container.coffee"),coords:require("./methods/coords.coffee"),csv:require("./methods/csv.coffee"),data:require("./methods/data.coffee"),depth:require("./methods/depth.coffee"),descs:require("./methods/descs.coffee"),dev:require("./methods/dev.coffee"),draw:require("./methods/draw.js"),edges:require("./methods/edges.js"),error:require("./methods/error.coffee"),focus:require("./methods/focus.coffee"),font:require("./methods/font.coffee"),
footer:require("./methods/footer.coffee"),format:require("./methods/format.coffee"),height:require("./methods/height.coffee"),history:require("./methods/history.coffee"),icon:require("./methods/icon.coffee"),id:require("./methods/id.coffee"),labels:require("./methods/labels.coffee"),legend:require("./methods/legend.coffee"),links:require("./methods/links.coffee"),margin:require("./methods/margin.coffee"),messages:require("./methods/messages.coffee"),mouse:require("./methods/mouse.coffee"),nodes:require("./methods/nodes.coffee"),
order:require("./methods/order.coffee"),resize:require("./methods/resize.coffee"),shape:require("./methods/shape.coffee"),size:require("./methods/size.coffee"),style:require("./methods/style.coffee"),temp:require("./methods/temp.coffee"),text:require("./methods/text.coffee"),time:require("./methods/time.coffee"),timeline:require("./methods/timeline.coffee"),timing:require("./methods/timing.coffee"),title:require("./methods/title.coffee"),tooltip:require("./methods/tooltip.coffee"),total:require("./methods/total.coffee"),
type:require("./methods/type.coffee"),ui:require("./methods/ui.coffee"),width:require("./methods/width.coffee"),x:axis("x"),x2:axis("x2"),y:axis("y"),y2:axis("y2"),zoom:require("./methods/zoom.js")});return vars.self}},{"../core/console/print.coffee":52,"../core/methods/attach.coffee":79,"../object/validate.coffee":171,"./helpers/container.coffee":210,"./helpers/drawSteps.js":211,"./helpers/ui/message.js":245,"./methods/active.coffee":254,"./methods/aggs.coffee":255,"./methods/attrs.coffee":256,"./methods/axes.coffee":257,
"./methods/background.coffee":258,"./methods/class.coffee":259,"./methods/color.coffee":260,"./methods/cols.js":261,"./methods/config.coffee":262,"./methods/container.coffee":263,"./methods/coords.coffee":264,"./methods/csv.coffee":265,"./methods/data.coffee":266,"./methods/depth.coffee":267,"./methods/descs.coffee":268,"./methods/dev.coffee":269,"./methods/draw.js":270,"./methods/edges.js":271,"./methods/error.coffee":272,"./methods/focus.coffee":273,"./methods/font.coffee":274,"./methods/footer.coffee":275,
"./methods/format.coffee":276,"./methods/height.coffee":277,"./methods/helpers/axis.coffee":278,"./methods/history.coffee":279,"./methods/icon.coffee":280,"./methods/id.coffee":281,"./methods/labels.coffee":282,"./methods/legend.coffee":283,"./methods/links.coffee":284,"./methods/margin.coffee":285,"./methods/messages.coffee":286,"./methods/mouse.coffee":287,"./methods/nodes.coffee":288,"./methods/order.coffee":289,"./methods/resize.coffee":290,"./methods/shape.coffee":291,"./methods/size.coffee":292,
"./methods/style.coffee":293,"./methods/temp.coffee":294,"./methods/text.coffee":295,"./methods/time.coffee":296,"./methods/timeline.coffee":297,"./methods/timing.coffee":298,"./methods/title.coffee":299,"./methods/tooltip.coffee":300,"./methods/total.coffee":301,"./methods/type.coffee":302,"./methods/ui.coffee":303,"./methods/width.coffee":304,"./methods/zoom.js":305,"./types/area.coffee":306,"./types/bar.coffee":307,"./types/box.coffee":308,"./types/bubbles.coffee":309,"./types/deprecated/chart.coffee":310,
"./types/geo_map.coffee":311,"./types/line.coffee":321,"./types/network.js":322,"./types/paths.coffee":323,"./types/pie.coffee":324,"./types/radar.coffee":325,"./types/rings.js":326,"./types/sankey.coffee":327,"./types/scatter.coffee":329,"./types/table.js":330,"./types/tree_map.coffee":331}]},{},[162]);window.D3GRPH={_data:{graphIds:[],nodeTypes:["instance","concept-type","relation","relation-type","resource","resource-type","role-type","meta"],edgeTypes:["default","active","alert"],smallRadius:14,mediumRadius:27,largeRadius:45,nodeColors:["#a1d884","#ff7878","#77dd77","#bfc0d1","#a1d884","#ff7878","#ffb96d","#5bc2e7"],edgeColors:["#bbbcbc","#77dd77","#ffbb71"],edgeLabelColors:["#ffffff","#2e4e00","#a95800"]},dx:function(width,n){return width*n},dy:function(height,n){return height*n},getLinkUniqueId:function(graphid,
link){return graphid+"_link_"+link.source.index+"_"+link.target.index},boundingRect:function(id){return document.getElementById(id).getBoundingClientRect()},hypotenuseLength:function(rect){return Math.sqrt(Math.pow(rect.top-rect.bottom,2)+Math.pow(rect.right-rect.left,2))},rotate:function(width,height,d){if(d.target.x<d.source.x)return"rotate(180, "+Math.abs(this.dx(width,d.source.x)+this.dx(width,d.target.x))/2+", "+Math.abs(this.dy(height,d.source.y)+this.dy(height,d.target.y))/2+")";return""},
offset:function(width,height,d){var data=this._data,sourceRadius=data.radius(d.source.type),targetRadius=data.radius(d.target.type),leftRadius=null,rightRadius=null;if(d.source.x<d.target.x){leftRadius=sourceRadius;rightRadius=targetRadius}else if(d.source.x>d.target.x){leftRadius=targetRadius;rightRadius=sourceRadius}else if(d.source.y<d.target.Y){leftRadius=targetRadius;rightRadius=sourceRadius}else{leftRadius=sourceRadius;rightRadius=targetRadius}var length=Math.sqrt(Math.pow(this.dy(height,d.target.y)-
this.dy(height,d.source.y),2)+Math.pow(this.dx(width,d.target.x)-this.dx(width,d.source.x),2)),percent=((length-(leftRadius+rightRadius))/2+leftRadius)/length*100;return percent+"%"},drawGraph:function(width,height){var _this=this,bbox=null,rx=null,ry=null;d3.selectAll("g.node").attr("transform",function(d){return"translate("+_this.dx(width,d.x)+","+_this.dy(height,d.y)+")"});d3.selectAll(".edge").attr("x1",function(d){return _this.dx(width,d.source.x)}).attr("y1",function(d){return _this.dy(height,
d.source.y)}).attr("x2",function(d){return _this.dx(width,d.target.x)}).attr("y2",function(d){return _this.dy(height,d.target.y)});d3.selectAll(".edgepath").attr("d",function(d){return"M"+_this.dx(width,d.source.x)+","+_this.dy(height,d.source.y)+"L "+_this.dx(width,d.target.x)+","+_this.dy(height,d.target.y)});d3.selectAll(".edgelabel").attr("transform",function(d,i){if(d.target.x<d.source.x){bbox=this.getBBox();rx=bbox.x+bbox.width/2;ry=bbox.y+bbox.height/2;return"rotate(180 "+Math.abs(_this.dx(width,
d.source.x)+_this.dx(width,d.target.x))/2+" "+Math.abs(_this.dy(height,d.source.y)+_this.dy(height,d.target.y))/2+")"}else return"rotate(0)"})},resize:function(graphid,force){var width=parseInt(d3.select("#graph_"+graphid).style("width")),height=parseInt(d3.select("#graph_"+graphid).style("height"));d3.select("svg").attr("width",width).attr("height",height);force.size([width,height]).start().stop();this.drawGraph(width,height)},buildGraph:function(obj){var _this=this,data=this._data,width=obj.size.width,
height=obj.size.height,graphid=obj.graph.id,svg=d3.select(obj.node).append("svg").attr("id",function(d){return"graph_"+graphid}).attr("width",width).attr("height",height),force=d3.layout.force().nodes(obj.graph.nodes).links(obj.graph.edges).size([width,height]).start().stop();data.graphIds.push(graphid);svg.append("svg:defs").append("svg:marker").attr("id","default-arrow").attr("viewBox","0 -5 10 10").attr("refX",23).attr("markerWidth",2).attr("markerHeight",2.5).attr("orient","auto").append("svg:path").attr("d",
"M0,-5L10,0L0,5").attr("stroke","#bbbcbc").style("fill","#bbbcbc");svg.append("svg:defs").append("svg:marker").attr("id","active-arrow").attr("viewBox","0 -5 10 10").attr("refX",23).attr("markerWidth",2).attr("markerHeight",2.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("stroke","#77dd77").style("fill","#77dd77");svg.append("svg:defs").append("svg:marker").attr("id","alert-arrow").attr("viewBox","0 -5 10 10").attr("refX",23).attr("markerWidth",2).attr("markerHeight",
2.5).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("stroke","#FFBB71").style("fill","#FFBB71");var edges=svg.selectAll("line").data(obj.graph.edges).enter().append("line").attr("class","edge").attr("stroke",function(d){return data.edgeColor(d.type)}).attr("stroke-width",9).attr("marker-end",function(d){return d.type!=null?"url(#"+d.type+"-arrow)":"url(#default-arrow)"}),edgePaths=svg.selectAll(".edgepath").data(obj.graph.edges).enter().append("path").attr("id",function(d){return _this.getLinkUniqueId(graphid,
d)}).attr({"class":"edgepath","fill-opacity":0,"stroke-opacity":0,"fill":"blue","stroke":"red"}),edgelabels=svg.selectAll(".edgelabel").data(obj.graph.edges).enter().append("text").attr("class","edgelabel").style("font","9px sans-serif").attr("id",function(d){return _this.getLinkUniqueId(graphid,d)+"text"}).attr("transform",function(d){return _this.rotate(width,height,d)}).attr("dy","3");edgelabels.append("textPath").attr("fill",function(d){return data.edgeLabelColor(d.type)}).attr("xlink:href",function(d){return"#"+
_this.getLinkUniqueId(graphid,d)}).attr("startOffset",function(d){return _this.offset(width,height,d)}).attr("text-anchor","middle").text(function(d){return d.text.toUpperCase()});var nodes=svg.selectAll("g.node").data(obj.graph.nodes).enter().append("g").attr("class","node");nodes.append("circle").attr("r",function(d){return data.radius(d.type)}).style("fill",function(d){return data.nodeColor(d.type)}).style("stroke",function(d){return data.borderColor(d.type)}).style("stroke-width",6);nodes.append("text").attr("class",
"textWrap").style("text-anchor","middle").style("fill","white").style("font","12px sans-serif").text(function(d){return d.text}).each(function(d){d3plus.textwrap().align("center").valign("middle").container(d3.select(this)).draw()});d3.select(window).on("resize",function(){for(var i=0;i<data.graphIds.length;i++)_this.resize(data.graphIds[i],force)});this.drawGraph(width,height)},init:function(){var data=this._data,nodeTypes=data.nodeTypes,nodeColors=data.nodeColors,edgeTypes=data.edgeTypes,edgeColors=
data.edgeColors,edgeLabelColors=data.edgeLabelColors,mediumRadius=data.mediumRadius,smallRadius=data.smallRadius;data.nodeColor=d3.scale.ordinal().domain(nodeTypes).range(nodeColors);data.borderColor=d3.scale.ordinal().domain(nodeTypes).range(nodeColors);data.edgeColor=d3.scale.ordinal().domain(edgeTypes).range(edgeColors);data.edgeLabelColor=d3.scale.ordinal().domain(edgeTypes).range(edgeLabelColors);data.radius=d3.scale.ordinal().domain(nodeTypes).range([mediumRadius,mediumRadius,smallRadius,mediumRadius,
mediumRadius,mediumRadius,mediumRadius])}};window.D3GRPH=window.D3GRPH||{};
window.D3GRPH._data.homepageGraphs=[{"id":1,"width":562,"height":400,"nodes":[{"id":0,"type":"meta","text":"relation-type","x":.8,"y":.15},{"id":1,"type":"relation-type","text":"director-ship","x":.5,"y":.1},{"id":2,"type":"relation","text":"\u2022","x":.3,"y":.267},{"id":3,"type":"relation","text":"\u2022","x":.7,"y":.267},{"id":4,"type":"instance","text":"$x: Titanic","x":.1,"y":.533},{"id":5,"type":"instance","text":"$y: James Cameron","x":.5,"y":.533},{"id":6,"type":"instance","text":"$z: Avatar",
"x":.9,"y":.533},{"id":7,"type":"concept-type","text":"person","x":.15,"y":.8},{"id":8,"type":"concept-type","text":"movie","x":.85,"y":.8},{"id":9,"type":"meta","text":"concept-type","x":.5,"y":.9}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":1,"text":"isa"},{"source":3,"target":1,"text":"isa"},{"source":3,"target":5,"text":"director","type":"active"},{"source":3,"target":6,"text":"movie-directed","type":"active"},{"source":2,"target":4,"text":"movie-directed","type":"active"},
{"source":2,"target":5,"text":"director","type":"active"},{"source":4,"target":8,"text":"isa"},{"source":6,"target":8,"text":"isa"},{"source":5,"target":7,"text":"isa"},{"source":7,"target":9,"text":"isa"},{"source":8,"target":9,"text":"isa"}]},{"id":2,"width":562,"height":400,"nodes":[{"id":0,"type":"meta","text":"concept-type","x":.2,"y":.15},{"id":1,"type":"concept-type","text":"movie","x":.1,"y":.5},{"id":2,"type":"instance","text":"$x: id1234","x":.2,"y":.85},{"id":3,"type":"relation","text":"has",
"x":.37,"y":.1},{"id":4,"type":"relation","text":"has","x":.32,"y":.5},{"id":5,"type":"relation","text":"has","x":.37,"y":.9},{"id":6,"type":"resource","text":"8.3","x":.57,"y":.1},{"id":7,"type":"resource","text":"The Martian","x":.5,"y":.5},{"id":8,"type":"resource","text":"30 Sep 2015","x":.57,"y":.9},{"id":9,"type":"resource-type","text":"rating","x":.8,"y":.15},{"id":10,"type":"resource-type","text":"title","x":.7,"y":.5},{"id":11,"type":"resource-type","text":"release-date","x":.8,"y":.85},
{"id":12,"type":"meta","text":"resource-type","x":.9,"y":.5}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":1,"text":"isa","type":"active"},{"source":3,"target":2,"text":"owner"},{"source":4,"target":2,"text":"owner","type":"active"},{"source":5,"target":2,"text":"owner"},{"source":3,"target":6,"text":"value"},{"source":4,"target":7,"text":"value","type":"active"},{"source":5,"target":8,"text":"value"},{"source":6,"target":9,"text":"isa"},{"source":7,"target":10,"text":"isa",
"type":"active"},{"source":8,"target":11,"text":"isa"},{"source":9,"target":12,"text":"isa"},{"source":10,"target":12,"text":"isa"},{"source":11,"target":12,"text":"isa"}]},{"id":3,"width":562,"height":400,"nodes":[{"id":0,"type":"meta","text":"relation-type","x":.5,"y":.1},{"id":1,"type":"relation-type","text":"director-ship","x":.2,"y":.2},{"id":2,"type":"relation-type","text":"casting","x":.8,"y":.2},{"id":3,"type":"relation","text":"\u2022","x":.3,"y":.36},{"id":4,"type":"relation","text":"\u2022",
"x":.7,"y":.36},{"id":5,"type":"instance","text":"$z: Ang Lee","x":.1,"y":.56},{"id":6,"type":"instance","text":"$y: Life of Pi","x":.5,"y":.56},{"id":7,"type":"instance","text":"$y: Irrfan Khan","x":.9,"y":.56},{"id":8,"type":"concept-type","text":"person","x":.2,"y":.8},{"id":9,"type":"concept-type","text":"movie","x":.8,"y":.8},{"id":10,"type":"meta","text":"concept-type","x":.5,"y":.9}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":0,"text":"isa"},{"source":3,"target":1,"text":"isa"},
{"source":3,"target":5,"text":"director","type":"active"},{"source":3,"target":6,"text":"movie-directed","type":"active"},{"source":4,"target":2,"text":"isa"},{"source":4,"target":6,"text":"movie-cast","type":"active"},{"source":4,"target":7,"text":"actor","type":"active"},{"source":7,"target":8,"text":"isa"},{"source":6,"target":9,"text":"isa"},{"source":5,"target":8,"text":"isa"},{"source":9,"target":10,"text":"isa"},{"source":8,"target":10,"text":"isa"}]},{"id":4,"width":562,"height":400,"nodes":[{"id":0,
"type":"meta","text":"concept-type","x":.2,"y":.15},{"id":1,"type":"concept-type","text":"movie","x":.1,"y":.5},{"id":2,"type":"instance","text":"$x","x":.2,"y":.85},{"id":3,"type":"relation","text":"has","x":.4,"y":.1},{"id":4,"type":"relation","text":"has","x":.367,"y":.5},{"id":5,"type":"relation","text":"has","x":.4,"y":.9},{"id":6,"type":"resource","text":"Friday the 13th","x":.6,"y":.1},{"id":7,"type":"resource","text":"Slasher","x":.633,"y":.5},{"id":8,"type":"resource","text":"Horror","x":.6,
"y":.9},{"id":9,"type":"resource-type","text":"title","x":.8,"y":.15},{"id":10,"type":"meta","text":"resource-type","x":.9,"y":.5},{"id":11,"type":"resource-type","text":"genre","x":.8,"y":.85}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":1,"text":"isa"},{"source":3,"target":2,"text":"owner"},{"source":4,"target":2,"text":"owner"},{"source":5,"target":2,"text":"owner","type":"active"},{"source":3,"target":6,"text":"value"},{"source":4,"target":7,"text":"value"},{"source":5,
"target":8,"text":"value","type":"active"},{"source":6,"target":9,"text":"isa"},{"source":7,"target":11,"text":"isa"},{"source":8,"target":11,"text":"isa","type":"active"},{"source":9,"target":10,"text":"isa"},{"source":11,"target":10,"text":"isa"}]},{"id":5,"width":562,"height":400,"nodes":[{"id":0,"type":"meta","text":"concept-type","x":.18,"y":.2},{"id":1,"type":"meta","text":"relation-type","x":.5,"y":.1},{"id":2,"type":"relation-type","text":"director-ship","x":.82,"y":.2},{"id":3,"type":"concept-type",
"text":"movie","x":.1,"y":.6},{"id":4,"type":"relation","text":"$z","x":.5,"y":.6},{"id":5,"type":"concept-type","text":"person","x":.9,"y":.6},{"id":6,"type":"instance","text":"$x: Big Fish","x":.3,"y":.9},{"id":7,"type":"instance","text":"$y: Tim Burton","x":.7,"y":.9}],"edges":[{"source":2,"target":1,"text":"isa"},{"source":3,"target":0,"text":"isa"},{"source":4,"target":2,"text":"isa"},{"source":4,"target":6,"text":"movie-directed","type":"active"},{"source":4,"target":7,"text":"director","type":"active"},
{"source":5,"target":0,"text":"isa"},{"source":6,"target":3,"text":"isa","type":"active"},{"source":7,"target":5,"text":"isa","type":"active"}]}];
window.D3GRPH._data.platformGraphs=[{"id":1,"width":562,"height":400,"nodes":[{"id":0,"type":"concept-type","text":"person","x":.5,"y":.1},{"id":1,"type":"instance","text":"Alice","x":.1,"y":.9},{"id":2,"type":"instance","text":"Bob","x":.9,"y":.9}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":0,"text":"isa"}]},{"id":2,"width":562,"height":400,"nodes":[{"id":0,"type":"concept-type","text":"person","x":.1,"y":.1},{"id":1,"type":"instance","text":"Alice","x":.1,"y":.9},{"id":2,
"type":"instance","text":"Honesty Inc.","x":.9,"y":.9},{"id":3,"type":"relation","text":"\u2022","x":.5,"y":.5},{"id":4,"type":"concept-type","text":"company","x":.9,"y":.1},{"id":5,"type":"relation-type","text":"director-ship","x":.5,"y":.1}],"edges":[{"source":1,"target":0,"text":"isa"},{"source":2,"target":4,"text":"isa"},{"source":3,"target":2,"text":"directed"},{"source":3,"target":1,"text":"director"},{"source":3,"target":5,"text":"isa"}]},{"id":3,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type",
"text":"marriage","x":.5,"y":.1},{"id":1,"type":"role-type","text":"wife","x":.1,"y":.3},{"id":2,"type":"role-type","text":"husband","x":.9,"y":.3},{"id":3,"type":"instance","text":"Alice","x":.1,"y":.7},{"id":4,"type":"relation","text":"\u2022","x":.5,"y":.5},{"id":5,"type":"instance","text":"Bob","x":.9,"y":.7},{"id":6,"type":"concept-type","text":"person","x":.5,"y":.9}],"edges":[{"source":0,"target":1,"text":"has role"},{"source":0,"target":2,"text":"has role"},{"source":4,"target":0,"text":"isa"},
{"source":4,"target":3,"text":"wife"},{"source":4,"target":5,"text":"husband"},{"source":3,"target":6,"text":"isa"},{"source":5,"target":6,"text":"isa"}]},{"id":4,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type","text":"director-ship","x":.5,"y":.1},{"id":1,"type":"role-type","text":"director","x":.1,"y":.1},{"id":2,"type":"role-type","text":"directed","x":.9,"y":.1},{"id":3,"type":"instance","text":"Alice","x":.3,"y":.9},{"id":4,"type":"relation","text":"\u2022","x":.5,"y":.5},{"id":5,
"type":"instance","text":"Honesty Inc.","x":.7,"y":.9},{"id":6,"type":"concept-type","text":"person","x":.1,"y":.55},{"id":7,"type":"concept-type","text":"company","x":.9,"y":.55}],"edges":[{"source":0,"target":1,"text":"has role"},{"source":0,"target":2,"text":"has role"},{"source":4,"target":0,"text":"isa"},{"source":4,"target":3,"text":"director"},{"source":4,"target":5,"text":"directed"},{"source":3,"target":6,"text":"isa"},{"source":5,"target":7,"text":"isa"},{"source":6,"target":1,"text":"plays role"},
{"source":7,"target":2,"text":"plays role"}]},{"id":5,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type","text":"director-ship","x":.5,"y":.1},{"id":1,"type":"role-type","text":"director","x":.1,"y":.5},{"id":2,"type":"role-type","text":"directed","x":.9,"y":.5},{"id":3,"type":"concept-type","text":"person","x":.1,"y":.9},{"id":4,"type":"concept-type","text":"company","x":.9,"y":.9},{"id":5,"type":"meta","text":"relation-type","x":.9,"y":.1},{"id":6,"type":"meta","text":"role-type",
"x":.5,"y":.5},{"id":7,"type":"meta","text":"concept-type","x":.5,"y":.9}],"edges":[{"source":0,"target":1,"text":"has role"},{"source":0,"target":2,"text":"has role"},{"source":3,"target":1,"text":"plays role"},{"source":4,"target":2,"text":"plays role"},{"source":0,"target":5,"text":"isa"},{"source":1,"target":6,"text":"isa"},{"source":2,"target":6,"text":"isa"},{"source":3,"target":7,"text":"isa"},{"source":4,"target":7,"text":"isa"}]},{"id":6,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type",
"text":"director-ship","x":.5,"y":.1},{"id":1,"type":"role-type","text":"director","x":.1,"y":.1},{"id":2,"type":"role-type","text":"directed","x":.9,"y":.1},{"id":3,"type":"relation-type","text":"marriage","x":.5,"y":.9},{"id":4,"type":"role-type","text":"husband","x":.1,"y":.9},{"id":5,"type":"role-type","text":"wife","x":.9,"y":.9},{"id":6,"type":"concept-type","text":"person","x":.3,"y":.5},{"id":7,"type":"concept-type","text":"company","x":.7,"y":.5}],"edges":[{"source":0,"target":1,"text":"has role"},
{"source":0,"target":2,"text":"has role"},{"source":3,"target":4,"text":"has role"},{"source":3,"target":5,"text":"has role"},{"source":6,"target":1,"text":"plays role"},{"source":7,"target":2,"text":"plays role"},{"source":6,"target":4,"text":"plays role"},{"source":6,"target":5,"text":"plays role"}]},{"id":7,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type","text":"marriage","x":.3,"y":.1},{"id":1,"type":"instance","text":"Bob","x":.1,"y":.633},{"id":2,"type":"relation","text":"\u2022",
"x":.3,"y":.367},{"id":3,"type":"instance","text":"Alice","x":.5,"y":.633},{"id":4,"type":"concept-type","text":"person","x":.3,"y":.9},{"id":5,"type":"relation","text":"\u2022","x":.7,"y":.367},{"id":6,"type":"instance","text":"Honesty Inc.","x":.9,"y":.633},{"id":7,"type":"relation-type","text":"director-ship","x":.7,"y":.1},{"id":8,"type":"concept-type","text":"company","x":.7,"y":.9}],"edges":[{"source":2,"target":0,"text":"isa"},{"source":2,"target":1,"text":"husband"},{"source":2,"target":3,
"text":"wife"},{"source":1,"target":4,"text":"isa"},{"source":3,"target":4,"text":"isa"},{"source":5,"target":3,"text":"director"},{"source":5,"target":6,"text":"directed"},{"source":6,"target":8,"text":"isa"},{"source":5,"target":7,"text":"isa"}]},{"id":8,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type","text":"marriage","x":.3,"y":.1},{"id":1,"type":"instance","text":"Bob","x":.1,"y":.633},{"id":2,"type":"relation","text":"\u2022","x":.3,"y":.367},{"id":3,"type":"instance","text":"Alice",
"x":.5,"y":.633},{"id":4,"type":"concept-type","text":"person","x":.3,"y":.9},{"id":5,"type":"relation","text":"\u2022","x":.7,"y":.367},{"id":6,"type":"instance","text":"Honesty Inc.","x":.9,"y":.633},{"id":7,"type":"relation-type","text":"director-ship","x":.7,"y":.1},{"id":8,"type":"concept-type","text":"company","x":.7,"y":.9}],"edges":[{"source":2,"target":0,"text":"isa"},{"source":2,"target":1,"text":"husband","type":"active"},{"source":2,"target":3,"text":"wife","type":"active"},{"source":1,
"target":4,"text":"isa"},{"source":3,"target":4,"text":"isa"},{"source":5,"target":3,"text":"director","type":"active"},{"source":5,"target":6,"text":"directed","type":"active"},{"source":6,"target":8,"text":"isa"},{"source":5,"target":7,"text":"isa"}]},{"id":10,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type","text":"marriage","x":.5,"y":.1},{"id":1,"type":"role-type","text":"husband","x":.1,"y":.5},{"id":2,"type":"role-type","text":"wife","x":.9,"y":.5},{"id":3,"type":"concept-type",
"text":"person","x":.5,"y":.9}],"edges":[{"source":0,"target":1,"text":"has role"},{"source":0,"target":2,"text":"has role"},{"source":3,"target":1,"text":"plays role"},{"source":3,"target":2,"text":"plays role"}]},{"id":11,"width":562,"height":400,"nodes":[{"id":0,"type":"relation","text":"\u2022","x":.5,"y":.1},{"id":1,"type":"relation","text":"\u2022","x":.5,"y":.9},{"id":2,"type":"instance","text":"Honesty Inc.","x":.3,"y":.3},{"id":3,"type":"instance","text":"Evilcorp","x":.3,"y":.7},{"id":4,
"type":"instance","text":"TrustMe.co","x":.1,"y":.9},{"id":5,"type":"concept-type","text":"company","x":.1,"y":.5},{"id":6,"type":"instance","text":"Alice","x":.7,"y":.3},{"id":7,"type":"instance","text":"Bob","x":.7,"y":.7},{"id":8,"type":"concept-type","text":"person","x":.9,"y":.5},{"id":9,"type":"relation-type","text":"director-ship","x":.5,"y":.5}],"edges":[{"source":0,"target":9,"text":"isa"},{"source":1,"target":9,"text":"isa"},{"source":2,"target":5,"text":"isa","type":"active"},{"source":3,
"target":5,"text":"isa","type":"active"},{"source":4,"target":5,"text":"isa","type":"alert"},{"source":0,"target":2,"text":"directed","type":"active"},{"source":1,"target":3,"text":"directed","type":"active"},{"source":0,"target":6,"text":"director","type":"active"},{"source":1,"target":7,"text":"director","type":"active"},{"source":6,"target":8,"text":"isa","type":"active"},{"source":7,"target":8,"text":"isa","type":"active"}]},{"id":12,"width":562,"height":400,"nodes":[{"id":0,"type":"relation-type",
"text":"marriage","x":.5,"y":.1},{"id":1,"type":"instance","text":"Alice","x":.1,"y":.1},{"id":2,"type":"relation","text":"\u2022","x":.5,"y":.35},{"id":3,"type":"instance","text":"Bob","x":.9,"y":.1},{"id":4,"type":"relation","text":"\u2022","x":.35,"y":.4},{"id":5,"type":"relation-type","text":"director-ship","x":.7,"y":.7},{"id":6,"type":"relation","text":"\u2022","x":.65,"y":.4},{"id":7,"type":"instance","text":"Honesty Inc.","x":.1,"y":.5},{"id":8,"type":"relation-type","text":"address","x":.3,
"y":.7},{"id":9,"type":"instance","text":"Evilcorp","x":.9,"y":.5},{"id":10,"type":"relation","text":"\u2022","x":.1,"y":.9},{"id":11,"type":"relation","text":"\u2022","x":.9,"y":.9},{"id":12,"type":"instance","text":"Easy Street","x":.5,"y":.9}],"edges":[{"source":2,"target":0,"text":"isa"},{"source":2,"target":1,"text":"wife","type":"active"},{"source":2,"target":3,"text":"husband","type":"active"},{"source":4,"target":5,"text":"isa"},{"source":6,"target":5,"text":"isa"},{"source":10,"target":8,
"text":"isa"},{"source":11,"target":8,"text":"isa"},{"source":4,"target":1,"text":"director","type":"active"},{"source":6,"target":3,"text":"director","type":"active"},{"source":4,"target":7,"text":"directed","type":"active"},{"source":6,"target":9,"text":"directed","type":"active"},{"source":10,"target":7,"text":"houses","type":"active"},{"source":11,"target":9,"text":"houses","type":"active"},{"source":10,"target":12,"text":"location","type":"active"},{"source":11,"target":12,"text":"location",
"type":"active"}]}];Math.radians=function(degrees){return degrees*Math.PI/180};Math.degrees=function(radians){return radians*180/Math.PI};function selectText(element){var doc=document,text=element,range,selection;if(doc.body.createTextRange){range=document.body.createTextRange();range.moveToElementText(text);range.select()}else if(window.getSelection){selection=window.getSelection();range=document.createRange();range.selectNodeContents(text);selection.removeAllRanges();selection.addRange(range)}}
function serializeObject(el){var o={},a=el.serializeArray();$.each(a,function(){if(o[this.name]!==undefined){if(!o[this.name].push)o[this.name]=[o[this.name]];o[this.name].push(this.value||"")}else o[this.name]=this.value||""});return o}function getParentElement(el,className){if(!el)return;if(el.classList.contains(className))return el;else if(el.nodeName==="BODY"||el.nodeName==="HTML")return false;else return getParentElement(el.parentNode,className)}
function getParentElements(el,className){var array=[],foundEl=getParentElement(el,className);while(foundEl){array.push(foundEl);foundEl=getParentElement(foundEl.parentNode,className)}return array}function getChildren(n,skipMe){var r=[];for(;n;n=n.nextSibling)if(n.nodeType==1&&n!=skipMe)r.push(n);return r}function getSiblings(n){return getChildren(n.parentNode.firstChild,n)}
function f_filterResults(n_win,n_docel,n_body){var n_result=n_win?n_win:0;if(n_docel&&(!n_result||n_result>n_docel))n_result=n_docel;return n_body&&(!n_result||n_result>n_body)?n_body:n_result}function f_clientWidth(){return f_filterResults(window.innerWidth?window.innerWidth:0,document.documentElement?document.documentElement.clientWidth:0,document.body?document.body.clientWidth:0)}
function f_clientHeight(){return f_filterResults(window.innerHeight?window.innerHeight:0,document.documentElement?document.documentElement.clientHeight:0,document.body?document.body.clientHeight:0)}function f_scrollLeft(){return f_filterResults(window.pageXOffset?window.pageXOffset:0,document.documentElement?document.documentElement.scrollLeft:0,document.body?document.body.scrollLeft:0)}
function f_scrollTop(){return f_filterResults(window.pageYOffset?window.pageYOffset:0,document.documentElement?document.documentElement.scrollTop:0,document.body?document.body.scrollTop:0)}
function dontScrollParent(el,turnOff){function catchScroll(ev){var scrollTop=this.scrollTop,scrollHeight=this.scrollHeight,height=this.offsetHeight,delta=ev.wheelDelta,up=delta>0;function prevent(){ev.stopPropagation();ev.preventDefault();ev.returnValue=false;return false}if(!up&&-delta>scrollHeight-height-scrollTop){this.scrollTop=scrollHeight;return prevent()}else if(up&&delta>scrollTop){this.scrollTop=0;return prevent()}}el.removeEventListener("DOMMouseScroll",catchScroll,false);el.removeEventListener("mousewheel",
catchScroll,false);if(!turnOff){el.addEventListener("DOMMouseScroll",catchScroll,false);el.addEventListener("mousewheel",catchScroll,false)}}function webGLAvailable(){var canvas=document.createElement("canvas"),gl,experimental;try{gl=canvas.getContext("webgl")}catch(error){gl=null}if(gl===null)try{gl=canvas.getContext("experimental-webgl");experimental=true}catch(error){gl=null}if(gl===null)return false;return true};window.MNDMPS=window.MNDMPS||{};
window.MNDMPS.ajax={_data:{},call:function(obj){var promise=new Promise(function(resolve,reject){var client=new XMLHttpRequest;client.open(obj.method,obj.url,true);if(obj.contentType)client.setRequestHeader("Content-type",obj.contentType);client.send(obj.data);client.onload=function(){if(this.status>=200&&this.status<300)resolve(this.response);else reject(this.statusText)};client.onerror=function(){reject(this.statusText)}});return promise},getAngelJobs:function(){return this.call({method:"GET",url:"/angel_jobs.php"})},
sendSubscribe:function(obj){return this.call({method:"POST",contentType:"application/json;charset=UTF-8",data:JSON.stringify(obj.data),url:"/mail/"})}};window.MNDMPS=window.MNDMPS||{};
window.MNDMPS.modal={_data:{},open:function(){var _this=window.MNDMPS.modal,data=_this._data;if(data.underlay.classList.contains("display"))return;if(data.sent){data.sent=false;_this.resetForm(data.form)}clearTimeout(data.closeTimeout);data.underlay.classList.add("display");setTimeout(function(){data.underlay.classList.add("active")},25)},close:function(){var _this=window.MNDMPS.modal,data=_this._data;if(!data.underlay.classList.contains("active"))return;data.underlay.classList.remove("active");setTimeout(function(){data.underlay.classList.remove("display")},
200)},closeByKey:function(event){var _this=window.MNDMPS.modal;if(event.which===27)_this.close()},resetForm:function(form){var data=window.MNDMPS.modal._data,inputs=[].slice.call(form.getElementsByTagName("input"),0);inputs.push(form.getElementsByTagName("textarea")[0]);for(var i=0;i<inputs.length;i++)if(inputs[i].type!=="submit")inputs[i].value="";data.sendButton.classList.remove("disabled");data.sendButton.classList.remove("done")},init:function(){var _this=this,data=this._data;data.underlay=document.getElementsByClassName("modal-underlay")[0];
data.modal=data.underlay.children[0];data.form=data.modal.getElementsByTagName("form")[0];data.sendButton=data.form.getElementsByClassName("sendButton")[0];data.sendButton.addEventListener("click",function(event){event.preventDefault();if(this.classList.contains("disabled"))return;this.classList.add("disabled");window.MNDMPS.ajax.sendSubscribe({data:serializeObject($(data.form))}).then(function(response){data.sent=true;data.sendButton.classList.add("done");data.closeTimeout=setTimeout(function(){_this.close()},
1500)},function(error){console.log(error)})},false);data.underlay.addEventListener("click",function(event){if(!event.target.classList.contains("modal-underlay")&&!event.target.classList.contains("modal-close"))return;_this.close()},false);document.addEventListener("keydown",this.closeByKey,false);dontScrollParent(data.underlay)}};window.MNDMPS=window.MNDMPS||{};
window.MNDMPS.map={data:{},center:function(map,latlng,offsetx,offsety){if(!map.getBounds())return;var scale=Math.pow(2,map.getZoom()),nw=new google.maps.LatLng(map.getBounds().getNorthEast().lat(),map.getBounds().getSouthWest().lng()),worldCoordinateCenter=map.getProjection().fromLatLngToPoint(latlng),pixelOffset=new google.maps.Point(offsetx/scale||0,offsety/scale||0),worldCoordinateNewCenter=new google.maps.Point(worldCoordinateCenter.x-pixelOffset.x,worldCoordinateCenter.y+pixelOffset.y),newCenter=
map.getProjection().fromPointToLatLng(worldCoordinateNewCenter);map.setCenter(newCenter)},load:function(){var _this=window.MNDMPS.map,mapStyles=[{"featureType":"water","elementType":"geometry","stylers":[{"color":"#e9e9e9"},{"lightness":17}]},{"featureType":"landscape","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":20}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffffff"},{"lightness":17}]},{"featureType":"road.highway","elementType":"geometry.stroke",
"stylers":[{"color":"#ffffff"},{"lightness":29},{"weight":.2}]},{"featureType":"road.arterial","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":18}]},{"featureType":"road.local","elementType":"geometry","stylers":[{"color":"#ffffff"},{"lightness":16}]},{"featureType":"poi","elementType":"geometry","stylers":[{"color":"#f5f5f5"},{"lightness":21}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#dedede"},{"lightness":21}]},{"elementType":"labels.text.stroke",
"stylers":[{"visibility":"on"},{"color":"#ffffff"},{"lightness":16}]},{"elementType":"labels.text.fill","stylers":[{"saturation":36},{"color":"#333333"},{"lightness":40}]},{"elementType":"labels.icon","stylers":[{"visibility":"off"}]},{"featureType":"transit","elementType":"geometry","stylers":[{"color":"#f2f2f2"},{"lightness":19}]},{"featureType":"administrative","elementType":"geometry.fill","stylers":[{"color":"#fefefe"},{"lightness":20}]},{"featureType":"administrative","elementType":"geometry.stroke",
"stylers":[{"color":"#fefefe"},{"lightness":17},{"weight":1.2}]}],markerIcon={path:"M15.2,5.2v9.5L20,10L15.2,5.2z M10,0L5.2,4.8L10,9.7l4.8-4.8L10,0z M0,10l4.8,4.7V5.2L0,10z M14.8,15.3l-4.4,4.4l3.4,3.4l-0.4,0.3l-8.2-8.2V5.6l4.8,4.8l4.7-4.8V15.3z",fillColor:"#5bc2e7",fillOpacity:1,anchor:new google.maps.Point(12,23),strokeWeight:0,scale:2},myLatlng=new google.maps.LatLng(51.551157,-.114799),mapOptions={zoom:window.MNDMPS.App.data.windowWidth<560?13:15,center:myLatlng,scrollwheel:false,disableDefaultUI:true,
styles:mapStyles,draggable:false},map=new google.maps.Map(document.getElementsByClassName("google-map")[0],mapOptions),marker=new google.maps.Marker({position:myLatlng,map:map,icon:markerIcon,url:"//google.co.uk/maps/place/Mindmaps+Research+Ltd/@51.5512213,-0.1169207,17z/data=!3m1!4b1!4m2!3m1!1s0x48761b7382210035:0x9ca7d8a98838539f"});_this.data.googleMapLatLng=myLatlng;_this.data.googleMap=map;google.maps.event.addListener(marker,"click",function(){window.open(marker.url,"_blank").focus()});google.maps.event.addListener(map,
"idle",function(){if(_this.data.windowWidth<1E3)_this.center(map,myLatlng,(_this.data.windowWidth-map.getDiv().parentNode.getElementsByClassName("info")[0].offsetWidth)/2-(_this.data.windowWidth/2-map.getDiv().parentNode.getElementsByClassName("info")[0].offsetWidth),0)})}};window.MNDMPS=window.MNDMPS||{};
window.MNDMPS.threeD={data:{},init:function(){var _this=this,container=document.getElementsByClassName("splash")[0],SCREEN_WIDTH=f_clientWidth(),SCREEN_HEIGHT=f_clientHeight()*.8,INIT_SCREEN_HEIGHT=f_clientHeight(),renderer=new THREE.WebGLRenderer({antialias:true,alpha:true}),scene=new THREE.Scene,camera=new THREE.OrthographicCamera(SCREEN_WIDTH/-2,SCREEN_WIDTH/2,SCREEN_HEIGHT/2,SCREEN_HEIGHT/-2,1,1200),cameraZ=600,zDepth=100,sky=null,graphGroup=new THREE.Object3D,nodeLinesMesh=null,nodesData=[],
nodesCount=20,maxNodesCount=40,nodeVelocityFactor=.1,nodeLineSegments=Math.pow(maxNodesCount,2),nodePositions=new Float32Array(nodeLineSegments*3),nodesMaterial=new THREE.PointsMaterial,nodes=new THREE.BufferGeometry,particlePositions=new Float32Array(maxNodesCount*3),effectController={minDistance:Math.sqrt(SCREEN_WIDTH*SCREEN_WIDTH+SCREEN_HEIGHT*SCREEN_HEIGHT)/3,limitConnections:true,maxConnections:3},logoGroup=new THREE.Object3D,logoFaceNumber=10,logoFaces=[],logoMaxOpacity=.075,logoUnit=SCREEN_HEIGHT/
100*5,baseHypotenuse=Math.sqrt(Math.pow(logoUnit,2)+Math.pow(logoUnit,2)),graphLineMaterial=new THREE.LineBasicMaterial({color:16777215,linewidth:.8,transparent:true,opacity:.2}),logoMLineMaterial=new THREE.LineBasicMaterial({color:16777215,linewidth:1.6,transparent:true,opacity:.8}),logoGraphVectors=[[0,0,-logoUnit*2],[0,-logoUnit,-logoUnit],[-logoUnit,0,-logoUnit],[0,0,-logoUnit],[logoUnit,0,-logoUnit],[0,logoUnit,-logoUnit],[0,-logoUnit*2,0],[logoUnit*2,0,0],[0,logoUnit*2,0],[-logoUnit*2,0,0],
[-logoUnit,-logoUnit,0],[0,-logoUnit,0],[logoUnit,-logoUnit,0],[-logoUnit,0,0],[0,0,0],[logoUnit,0,0],[-logoUnit,logoUnit,0],[0,logoUnit,0],[logoUnit,logoUnit,0]],logoMVectors=[[-logoUnit,-logoUnit,0],[-logoUnit,0,0],[-logoUnit,logoUnit,0],[0,0,0],[logoUnit,logoUnit,0],[logoUnit,0,0],[logoUnit,-logoUnit,0]],smallNodeMaterial=new THREE.MeshBasicMaterial({color:16777215,transparent:true,opacity:.4}),bigNodeMaterial=new THREE.MeshBasicMaterial({color:16777215,transparent:true,opacity:.8}),logoScale=
1;_this.data.threeDRunning=false;function generateNodes(){var nodeLinesGeometry=new THREE.BufferGeometry;for(var h=0;h<maxNodesCount;h++){var x=Math.random()*SCREEN_WIDTH*1-SCREEN_WIDTH*.5,y=Math.random()*SCREEN_HEIGHT*1-SCREEN_HEIGHT*.5,z=Math.random()*zDepth*2-zDepth*1;particlePositions[h*3+0]=x;particlePositions[h*3+1]=y;particlePositions[h*3+2]=z;nodesData.push({velocity:new THREE.Vector3(-nodeVelocityFactor+Math.random()*nodeVelocityFactor*2,-nodeVelocityFactor+Math.random()*nodeVelocityFactor*
2,-nodeVelocityFactor+Math.random()*nodeVelocityFactor*2),numConnections:0})}nodes.setDrawRange(0,0);nodes.addAttribute("position",(new THREE.BufferAttribute(particlePositions,3)).setDynamic(true));nodeLinesGeometry.addAttribute("position",(new THREE.BufferAttribute(nodePositions,3)).setDynamic(true));nodeLinesGeometry.computeBoundingSphere();nodeLinesGeometry.setDrawRange(0,0);nodeLinesMesh=new THREE.LineSegments(nodeLinesGeometry,graphLineMaterial);graphGroup.add(nodeLinesMesh)}function redrawNodeLines(){var vertexpos=
0,numConnected=0,particleData=null,particleDataB=null;for(var i=0;i<nodesCount;i++)nodesData[i].numConnections=0;for(i=0;i<nodesCount;i++){particleData=nodesData[i];particlePositions[i*3]+=particleData.velocity.x;particlePositions[i*3+1]+=particleData.velocity.y;particlePositions[i*3+2]+=particleData.velocity.z;if(particlePositions[i*3+1]<-SCREEN_HEIGHT/2||particlePositions[i*3+1]>SCREEN_HEIGHT/2)particleData.velocity.y=-particleData.velocity.y;if(particlePositions[i*3]<-SCREEN_WIDTH/2||particlePositions[i*
3]>SCREEN_WIDTH/2)particleData.velocity.x=-particleData.velocity.x;if(particlePositions[i*3+2]<-zDepth||particlePositions[i*3+2]>zDepth*2)particleData.velocity.z=-particleData.velocity.z;if(effectController.limitConnections&&particleData.numConnections>=effectController.maxConnections)continue;for(var j=i+1;j<nodesCount;j++){particleDataB=nodesData[j];if(effectController.limitConnections&&particleDataB.numConnections>=effectController.maxConnections)continue;var dx=particlePositions[i*3]-particlePositions[j*
3],dy=particlePositions[i*3+1]-particlePositions[j*3+1],dz=particlePositions[i*3+2]-particlePositions[j*3+2],dist=Math.sqrt(Math.pow(dx,2)+Math.pow(dy,2)+Math.pow(dz,2));if(dist<effectController.minDistance){particleData.numConnections++;particleDataB.numConnections++;nodePositions[vertexpos++]=particlePositions[i*3];nodePositions[vertexpos++]=particlePositions[i*3+1];nodePositions[vertexpos++]=particlePositions[i*3+2];nodePositions[vertexpos++]=particlePositions[j*3];nodePositions[vertexpos++]=particlePositions[j*
3+1];nodePositions[vertexpos++]=particlePositions[j*3+2];numConnected++}}}nodeLinesMesh.geometry.setDrawRange(0,numConnected*2);nodeLinesMesh.geometry.attributes.position.needsUpdate=true}function edgesAreEqual(set1,set2){if(set1[0][0]===set2[0][0]&&set1[0][1]===set2[0][1]&&set1[0][2]===set2[0][2]&&(set1[1][0]===set2[1][0]&&set1[1][1]===set2[1][1]&&set1[1][2]===set2[1][2])||set1[1][0]===set2[0][0]&&set1[1][1]===set2[0][1]&&set1[1][2]===set2[0][2]&&(set1[0][0]===set2[1][0]&&set1[0][1]===set2[1][1]&&
set1[0][2]===set2[1][2]))return true;return false}function vectorsAreEqual(vector1,vector2){if(vector1[0]===vector2[0]&&vector1[1]===vector2[1]&&vector1[2]===vector2[2])return true;return false}function getDistance(vector1,vector2){return Math.sqrt(Math.pow(vector2[0]-vector1[0],2)+Math.pow(vector2[1]-vector1[1],2)+Math.pow(vector2[2]-vector1[2],2))}function generateLogo(){var logoGraphGeometry=new THREE.BufferGeometry,logoMGeometry=new THREE.BufferGeometry,logoGraphVertices=new Float32Array(Math.pow(logoGraphVectors.length,
2)*3),logoMVertices=new Float32Array(Math.pow(logoMVectors.length,2)*3),tempPairsArray=[],pairsArray=[],logoGraphArray=[],pairsMArray=[],logoMArray=[],littleSpheresArray=[],bigSpheresArray=[],distance=null,found=false;for(var i=0;i<logoMVectors.length;i++)if(logoMVectors[i+1])pairsMArray.push([logoMVectors[i],logoMVectors[i+1]]);for(i=0;i<logoGraphVectors.length;i++)for(var j=0;j<logoGraphVectors.length;j++){if(i===j)continue;tempPairsArray.push([logoGraphVectors[i],logoGraphVectors[j]])}for(i=0;i<
tempPairsArray.length;i++){found=false;for(j=0;j<pairsArray.length;j++)if(edgesAreEqual(tempPairsArray[i],pairsArray[j])){found=true;break}for(j=0;j<pairsMArray.length;j++)if(edgesAreEqual(tempPairsArray[i],pairsMArray[j])){found=true;break}distance=getDistance(tempPairsArray[i][0],tempPairsArray[i][1]);if(distance>logoUnit&&distance%logoUnit===0||distance>baseHypotenuse&&distance%baseHypotenuse===0)found=true;if(!found)pairsArray.push([tempPairsArray[i][0],tempPairsArray[i][1]])}for(i=0;i<pairsArray.length;i++)logoGraphArray.push(pairsArray[i][0],
pairsArray[i][1]);for(i=0;i<logoGraphArray.length;i++){logoGraphVertices[i*3+0]=logoGraphArray[i][0];logoGraphVertices[i*3+1]=logoGraphArray[i][1];logoGraphVertices[i*3+2]=logoGraphArray[i][2]}for(i=0;i<pairsMArray.length;i++)logoMArray.push(pairsMArray[i][0],pairsMArray[i][1]);for(i=0;i<logoMArray.length;i++){logoMVertices[i*3+0]=logoMArray[i][0];logoMVertices[i*3+1]=logoMArray[i][1];logoMVertices[i*3+2]=logoMArray[i][2]}var smallNodeGeometry=null,smallNodeGeometries=new THREE.Geometry,matrix=new THREE.Matrix4;
for(i=0;i<logoGraphVectors.length;i++){found=false;for(j=0;j<logoMVectors.length;j++)if(vectorsAreEqual(logoGraphVectors[i],logoMVectors[j])){found=true;break}if(!found){smallNodeGeometry=new THREE.SphereGeometry(logoUnit/25,8,6);smallNodeGeometry.applyMatrix(matrix.makeTranslation(logoGraphVectors[i][0],logoGraphVectors[i][1],logoGraphVectors[i][2]));smallNodeGeometries.merge(smallNodeGeometry)}}var bigNodeGeometry=null,bigNodeGeometries=new THREE.Geometry;for(i=0;i<logoMVectors.length;i++){found=
false;bigNodeGeometry=new THREE.SphereGeometry(logoUnit/20,8,6);bigNodeGeometry.applyMatrix(matrix.makeTranslation(logoMVectors[i][0],logoMVectors[i][1],logoMVectors[i][2]));bigNodeGeometries.merge(bigNodeGeometry)}logoGraphGeometry.addAttribute("position",new THREE.BufferAttribute(logoGraphVertices,3));logoMGeometry.addAttribute("position",new THREE.BufferAttribute(logoMVertices,3));smallNodeGeometries=(new THREE.BufferGeometry).fromGeometry(smallNodeGeometries);bigNodeGeometries=(new THREE.BufferGeometry).fromGeometry(bigNodeGeometries);
var logoGraphMesh=new THREE.LineSegments(logoGraphGeometry,graphLineMaterial),logoMMesh=new THREE.LineSegments(logoMGeometry,logoMLineMaterial),smallNodeSpheres=new THREE.Mesh(smallNodeGeometries,smallNodeMaterial),bigNodeSpheres=new THREE.Mesh(bigNodeGeometries,bigNodeMaterial);logoGraphMesh.geometry.setDrawRange(0,Math.pow(logoGraphVectors.length,2));logoMMesh.geometry.setDrawRange(0,Math.pow(logoMVectors.length,2));smallNodeSpheres.geometry.setDrawRange(0,smallNodeGeometries.attributes.position.array.length);
bigNodeSpheres.geometry.setDrawRange(0,bigNodeGeometries.attributes.position.array.length);logoGroup.add(logoGraphMesh);logoGroup.add(logoMMesh);logoGroup.add(smallNodeSpheres);logoGroup.add(bigNodeSpheres)}function resize(){_this.data.windowWidth=f_clientWidth();_this.data.windowHeight=f_clientHeight();window.MNDMPS.App.processScroll(f_scrollTop(),f_scrollLeft());SCREEN_WIDTH=_this.data.windowWidth;SCREEN_HEIGHT=_this.data.windowHeight*.8;logoScale=SCREEN_HEIGHT/INIT_SCREEN_HEIGHT;camera.left=SCREEN_WIDTH/
-2;camera.right=SCREEN_WIDTH/2;camera.top=SCREEN_HEIGHT/2;camera.bottom=SCREEN_HEIGHT/-2;camera.updateProjectionMatrix();renderer.setSize(SCREEN_WIDTH,SCREEN_HEIGHT)}function generateRandomFaces(){var colourMesh=null,colour=null,fadeSpeed=null,tempArray=[],tempGeometry=null,tempMaterial=null,tempEl=null;for(var i=0;i<logoFaceNumber;i++){colour=new THREE.Color(Math.random(),Math.random(),Math.random());fadeSpeed=Math.random()/500;tempGeometry=new THREE.Geometry;tempArray=[];while(tempArray.length<
3){tempEl=Math.floor(Math.random()*logoGraphVectors.length);if(tempArray.indexOf(tempEl)<0){tempArray.push(tempEl);tempGeometry.vertices.push(new THREE.Vector3(logoGraphVectors[tempEl][0],logoGraphVectors[tempEl][1],logoGraphVectors[tempEl][2]))}}tempGeometry.faces.push(new THREE.Face3(0,1,2));tempGeometry.faces[0].color=colour;tempGeometry=(new THREE.BufferGeometry).fromGeometry(tempGeometry);tempMaterial=generateFaceMaterial();colourMesh=new THREE.Mesh(tempGeometry,tempMaterial);colourMesh.material.side=
THREE.DoubleSide;colourMesh.fadeInSpeed=fadeSpeed;colourMesh.fadeOutSpeed=-fadeSpeed;colourMesh.fadingOut=false;logoFaces.push(colourMesh);logoGroup.add(colourMesh)}}function generateFaceMaterial(){return new THREE.MeshBasicMaterial({transparent:true,opacity:0,blending:THREE.AdditiveBlending,vertexColors:THREE.VertexColors})}function changeFaceGeometry(mesh){var tempArray=[],tempEl=null,posArray=mesh.geometry.attributes.position.array;for(var i=0;i<logoFaceNumber;i++)while(tempArray.length<3){tempEl=
Math.floor(Math.random()*logoGraphVectors.length);if(tempArray.indexOf(tempEl)<0)tempArray.push(logoGraphVectors[tempEl])}for(i=0;i<tempArray.length;i++){posArray[i*3+0]=tempArray[i][0];posArray[i*3+1]=tempArray[i][1];posArray[i*3+2]=tempArray[i][2]}mesh.geometry.attributes.position.needsUpdate=true}function processRandomFaces(){for(var i=logoFaces.length-1;i>=0;i--)if(logoFaces[i].fadingOut){logoFaces[i].material.opacity+=logoFaces[i].fadeOutSpeed;if(logoFaces[i].material.opacity<=0){changeFaceGeometry(logoFaces[i]);
logoFaces[i].fadingOut=false}}else{logoFaces[i].material.opacity+=logoFaces[i].fadeInSpeed;if(logoFaces[i].material.opacity>=logoMaxOpacity)logoFaces[i].fadingOut=true}}function refreshCamera(){camera.position.x=-(_this.data.mouseX-SCREEN_WIDTH/2)*.01;camera.position.y=(_this.data.mouseY-SCREEN_HEIGHT/2)*.01;camera.position.z=cameraZ;camera.lookAt(scene.position);logoGroup.rotation.set(Math.radians((_this.data.mouseY-SCREEN_HEIGHT/4)*.04),Math.radians((_this.data.mouseX-SCREEN_WIDTH/2)*.03),0)}function refreshScale(){logoGroup.scale.set(logoScale,
logoScale,logoScale)}function refreshPosition(){logoGroup.position.setY(SCREEN_HEIGHT*.13)}_this.data.mouseX=SCREEN_WIDTH/2;_this.data.mouseY=SCREEN_HEIGHT/2;camera.updateProjectionMatrix();camera.position.z=cameraZ;camera.lookAt(scene.position);camera.zoom=2;scene.add(camera);renderer.setPixelRatio(window.devicePixelRatio);renderer.setSize(SCREEN_WIDTH,SCREEN_HEIGHT);container.appendChild(renderer.domElement);generateNodes();graphGroup.position.set(0,0,-200);scene.add(graphGroup);generateLogo();
generateRandomFaces();scene.add(logoGroup);function render(){renderer.render(scene,camera)}function animate(){if(_this.data.threeDRunning){redrawNodeLines();processRandomFaces();refreshCamera();refreshPosition();refreshScale();render()}window.requestAnimationFrame(animate)}function onMouseMove(event){refreshCursorPosition({x:event.pageX,y:event.pageY})}function onTouchStart(event){refreshCursorPosition({x:event.touches[0].pageX,y:event.touches[0].pageY});document.addEventListener("touchmove",onTouchMove,
false)}function onTouchEnd(event){document.removeEventListener("touchmove",onTouchMove,false);refreshCursorPosition({x:event.changedTouches[0].pageX,y:event.changedTouches[0].pageY})}function onTouchMove(event){refreshCursorPosition({x:event.touches[0].pageX,y:event.touches[0].pageY})}function refreshCursorPosition(coordinates){if(!_this.data.threeDRunning)return;_this.data.mouseX=coordinates.x;_this.data.mouseY=coordinates.y;_this.data.mouseX=_this.data.mouseX>_this.data.windowWidth?_this.data.windowWidth:
_this.data.mouseX;_this.data.mouseY=_this.data.mouseY>_this.data.windowHeight?_this.data.windowHeight:_this.data.mouseY}function changeStateThreeD(){if(document.hidden)_this.data.threeDRunning=false;else window.MNDMPS.App.processScroll(f_scrollTop(),f_scrollLeft())}if("ontouchstart"in window||navigator.msMaxTouchPoints){document.addEventListener("touchstart",onTouchStart,false);document.addEventListener("touchend",onTouchEnd,false)}else document.addEventListener("mousemove",onMouseMove,false);window.addEventListener("resize",
function(){resize();setTimeout(function(){var offsetX=0;if(_this.data.windowWidth<1E3)offsetX=(_this.data.windowWidth-_this.data.googleMap.getDiv().parentNode.getElementsByClassName("info")[0].offsetWidth)/2-(_this.data.windowWidth/2-_this.data.googleMap.getDiv().parentNode.getElementsByClassName("info")[0].offsetWidth);window.MNDMPS.map.center(window.MNDMPS.map.data.googleMap,window.MNDMPS.map.data.googleMapLatLng,offsetX,0)},0)},false);document.addEventListener("visibilitychange",changeStateThreeD,
false);resize();animate()}};window.MNDMPS=window.MNDMPS||{};
window.MNDMPS.App={data:{},processScroll:function(scrolledY,scrolledX){if(window.MNDMPS.threeD.data.threeDRunning)this.refreshMousePositionOnScroll(scrolledY,scrolledX);if(scrolledY>this.data.windowHeight*.5-this.data.menuBar.offsetHeight){this.data.menuBar.classList.add("scrolled");window.MNDMPS.threeD.data.threeDRunning=false}else{this.data.menuBar.classList.remove("scrolled");window.MNDMPS.threeD.data.threeDRunning=true}},refreshMousePositionOnScroll:function(scrolledY,scrolledX){this.data.lastScrolledLeft=
this.data.lastScrolledLeft||0;this.data.lastScrolledTop=this.data.lastScrolledTop||0;if(this.data.lastScrolledLeft!==scrolledX){this.data.mouseX-=this.data.lastScrolledLeft;this.data.lastScrolledLeft=scrolledX;this.data.mouseX+=this.data.lastScrolledLeft}if(this.data.lastScrolledTop!=scrolledY){this.data.mouseY-=this.data.lastScrolledTop;this.data.lastScrolledTop=scrolledY;this.data.mouseY+=this.data.lastScrolledTop}this.data.mouseX=this.data.mouseX>this.data.windowWidth?this.data.windowWidth:this.data.mouseX;
this.data.mouseY=this.data.mouseY>this.data.windowHeight?this.data.windowHeight:this.data.mouseY},watchScroll:function(){document.addEventListener("scroll",function(event){window.MNDMPS.App.processScroll(f_scrollTop(),f_scrollLeft())},false)},appendSVGSplash:function(){var container=document.getElementsByClassName("splash")[0],svgSplash=document.createElement("div"),svgContainer=document.createElement("div"),svg='<svg viewBox="0 0 130 130"><style type="text/css">.st0{fill: #ffffff; stroke-width: 0;}.st1{fill: none; stroke: #ffffff; stroke-width: 0.1;}.st2{fill: none; stroke: #ffffff; stroke-width: 0.5;}</style><g class="polygons"><polygon points="77,89 43.6,77.9 75,35"/><polygon points="85,45 65,35 35,55"/><polygon points="55,55 35,35 65,5"/><polygon points="77.9,43.6 65,5 95,35"/><polygon points="53,41 65,5 90.7,47.9"/><polygon points="78.3,61.7 95,35 125,65"/><polygon points="55,75 35,35 83,59"/><polygon points="53,41 5,65 35,35"/><polygon points="47.9,39.3 5,65 47,71"/><polygon points="50,50 65,65 95,35"/><polygon points="80,80 35,65 95,50"/><polygon points="85,85 35,95 47,59"/><polygon points="65,125 47,71 83,89"/><polygon points="86.4,69.3 125,65 95,80"/><polygon points="89,47 125,65 95,95"/><polygon points="95,50 95,95 72.5,42.5"/><polygon points="95,95 85,45 65,93.5"/><polygon points="35,95 72.3,76.3 65,125"/><polygon points="35,75 45,45 5,65"/><polygon points="65,125 95,95 45,85"/><polygon points="35,95 5,65 55,55"/></g><g><line class="st1" x1="5" y1="65" x2="35" y2="35"/><line class="st1" x1="35" y1="35" x2="65" y2="5"/><line class="st1" x1="65" y1="5" x2="95" y2="35"/><line class="st1" x1="95" y1="35" x2="125" y2="65"/><line class="st1" x1="125" y1="65" x2="95" y2="95"/><line class="st1" x1="95" y1="95" x2="65" y2="125"/><line class="st1" x1="65" y1="125" x2="35" y2="95"/><line class="st1" x1="35" y1="95" x2="5" y2="65"/><line class="st1" x1="5" y1="65" x2="35" y2="65"/><line class="st1" x1="35" y1="65" x2="65" y2="65"/><line class="st1" x1="65" y1="65" x2="95" y2="65"/><line class="st1" x1="95" y1="65" x2="125" y2="65"/><line class="st1" x1="95" y1="65" x2="65" y2="95"/><line class="st1" x1="65" y1="95" x2="95" y2="95"/><line class="st1" x1="65" y1="95" x2="65" y2="125"/><line class="st1" x1="65" y1="95" x2="35" y2="95"/><line class="st1" x1="35" y1="65" x2="65" y2="95"/><line class="st1" x1="35" y1="95" x2="65" y2="65"/><line class="st1" x1="65" y1="65" x2="95" y2="95"/><line class="st1" x1="35" y1="65" x2="65" y2="35"/><line class="st1" x1="65" y1="35" x2="95" y2="65"/><line class="st1" x1="65" y1="35" x2="35" y2="35"/><line class="st1" x1="65" y1="35" x2="65" y2="5"/><line class="st1" x1="65" y1="35" x2="95" y2="35"/><line class="st1" x1="95" y1="65" x2="65" y2="5"/><line class="st1" x1="65" y1="5" x2="35" y2="65"/><line class="st1" x1="35" y1="65" x2="65" y2="125"/><line class="st1" x1="65" y1="125" x2="95" y2="65"/><line class="st1" x1="65" y1="95" x2="125" y2="65"/><line class="st1" x1="125" y1="65" x2="65" y2="35"/><line class="st1" x1="65" y1="35" x2="5" y2="65"/><line class="st1" x1="5" y1="65" x2="65" y2="95"/><line class="st1" x1="65" y1="35" x2="35" y2="95"/><line class="st1" x1="65" y1="35" x2="95" y2="95"/><line class="st1" x1="65" y1="95" x2="35" y2="35"/><line class="st1" x1="95" y1="35" x2="65" y2="95"/><line class="st1" x1="65" y1="65" x2="65" y2="35"/><line class="st1" x1="65" y1="65" x2="65" y2="95"/><line class="st1" x1="35" y1="65" x2="95" y2="35"/><line class="st1" x1="35" y1="65" x2="95" y2="95"/><line class="st1" x1="5" y1="65" x2="95" y2="35"/><line class="st1" x1="5" y1="65" x2="95" y2="95"/><line class="st1" x1="65" y1="125" x2="35" y2="35"/><line class="st1" x1="95" y1="35" x2="65" y2="125"/><line class="st1" x1="125" y1="65" x2="35" y2="35"/><line class="st1" x1="125" y1="65" x2="35" y2="95"/><line class="st1" x1="65" y1="5" x2="35" y2="95"/><line class="st1" x1="65" y1="5" x2="95" y2="95"/><line class="st1" x1="95" y1="65" x2="35" y2="35"/><line class="st1" x1="95" y1="65" x2="35" y2="95"/><circle class="st0" cx="65" cy="35" r="1"/><circle class="st0" cx="65" cy="5" r="1"/><circle class="st0" cx="65" cy="95" r="1"/><circle class="st0" cx="65" cy="125" r="1"/><circle class="st0" cx="125" cy="65" r="1"/><circle class="st0" cx="5" cy="65" r="1"/></g><g><line class="st2" x1="35" y1="95" x2="35" y2="65"/><line class="st2" x1="35" y1="65" x2="35" y2="35"/><line class="st2" x1="35" y1="35" x2="65" y2="65"/><line class="st2" x1="65" y1="65" x2="95" y2="35"/><line class="st2" x1="95" y1="35" x2="95" y2="65"/><line class="st2" x1="95" y1="65" x2="95" y2="95"/><circle class="st0" cx="65" cy="65" r="1.5"/><circle class="st0" cx="35" cy="35" r="1.5"/><circle class="st0" cx="35" cy="65" r="1.5"/><circle class="st0" cx="35" cy="95" r="1.5"/><circle class="st0" cx="95" cy="35" r="1.5"/><circle class="st0" cx="95" cy="65" r="1.5"/><circle class="st0" cx="95" cy="95" r="1.5"/></g></svg>';
svgContainer.classList.add("svg-logo");svgContainer.innerHTML=svg;svgSplash.appendChild(svgContainer);svgSplash.classList.add("svg-splash");container.appendChild(svgSplash)},initSlick:function(){$(".slider-container").slick({slidesToShow:1,slidesToScroll:1,cssEase:"ease-in-out",infinite:false,draggable:false,dots:true,easing:"easeInOutQuart",mobileFirst:true,lazyLoad:"progressive",speed:200,zIndex:1,arrows:false,responsive:[{breakpoint:559,settings:{arrows:true}}]})},initPlatformGraphs:function(){var graphs=
window.D3GRPH._data.platformGraphs,nodes=document.getElementsByClassName("graph"),node=nodes[0],size={width:node.offsetWidth,height:node.offsetHeight};for(var i=0;i<graphs.length;i++)window.D3GRPH.buildGraph({node:nodes[i],graph:graphs[i],size:size})},initHomepageGraphs:function(){var graphs=window.D3GRPH._data.homepageGraphs,nodes=document.getElementsByClassName("graph"),node=nodes[0],size={width:node.children[0].offsetWidth,height:node.children[0].offsetHeight};for(var i=0;i<graphs.length;i++)window.D3GRPH.buildGraph({node:nodes[i].children[0],
graph:graphs[i],size:size})},initPrism:function(){var textareas=document.getElementsByClassName("code-input");function renderOutput(input){var value=input.value;value=value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"\n";$(input).next().children(0)[0].innerHTML=value;Prism.highlightAll()}function listenForInput(input){function replicate(event){var selStartPos=this.selectionStart,inputVal=this.value;inputVal=inputVal.replace(/\t/g,"    ");this.value=inputVal;if(event.keyCode===
9){this.value=inputVal.substring(0,selStartPos)+"    "+inputVal.substring(selStartPos,this.value.length);this.selectionStart=selStartPos+4;this.selectionEnd=selStartPos+4;event.preventDefault()}renderOutput(this)}input.addEventListener("input",replicate,false);input.addEventListener("keydown",replicate,false);Prism.highlightAll()}function listenerForScroll(input){input.addEventListener("scroll",function(event){$(this).next()[0].scrollTop=this.scrollTop},false)}for(var i=0;i<textareas.length;i++){renderOutput(textareas[i]);
listenerForScroll(textareas[i])}},initStack:function(){var data=this.data;function displayDescription(name){var blocks=data.techDescription.children;for(var i=0;i<blocks.length;i++)if(blocks[i].getAttribute("data-name")!==name)blocks[i].classList.remove("active");else{blocks[i].classList.add("active");data.techDescription.style.height=blocks[i].offsetHeight+"px"}}function toggleStack(event){var el=getParentElement(event.target,"tab");if(!el)return;var target=el.getAttribute("data-target");for(var i=
0;i<data.techTabs.length;i++)data.techTabs[i].classList.remove("active");el.classList.add("active");displayDescription(target)}data.techStack=document.getElementsByClassName("tech-stack")[0];data.techDescription=data.techStack.getElementsByClassName("description")[0];data.techTabs=data.techStack.getElementsByClassName("tab");data.techStack.addEventListener("click",toggleStack,false);displayDescription("graph")},initJobs:function(){var data=this.data,domParser=new DOMParser,loading=document.getElementsByClassName("loading")[0];
data.jobsBlock=document.getElementById("section-jobs").children[0];function kFormatter(num){num=parseInt(num,10);var newNum=num>999?Math.floor(num/1E3):num;return newNum+"K"}function timeFormatter(date){var monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];var date=new Date(date),day=date.getDate(),monthIndex=date.getMonth(),year=date.getFullYear();return newDate=day+" "+monthNames[monthIndex]+" "+year}function generateJob(obj){var jobBlock=document.createElement("div");
jobBlock.classList.add("job");jobBlock.innerHTML="<h3>"+obj.title+'</h3>                <div class="text-block columns">                    <p>'+obj.description.replace(/[0-9]+\.[^.]*\.(?!\s*[0-9])/g,"$&<br>").replace(/[0-9]+\./g,"<br>$&").replace(/\*/g,"<br>")+"</p>                </div>                <ul>                    <li>Updated on: "+timeFormatter(obj.updated_at)+"</li>                    <li>Remote: "+(obj.remote_ok?"Yes":"No")+'</li>                    <li>Type: <span class="capitalise">'+
obj.job_type+"</span></li>                    <li>Compensation: &pound;"+kFormatter(obj.salary_min)+" \u2014 &pound;"+kFormatter(obj.salary_max)+"</li>                    <li>Equity: "+obj.equity_min+"% \u2014 "+obj.equity_max+'%</li>                </ul>                <div class="bottomLinks">                    <a href="mailto:recruitment@mindmaps.io">Apply</a> or <a target="_blank" rel="nofollow" href="'+obj.angellist_url+'">Check on AngelList</a>                </div>';return jobBlock}window.MNDMPS.ajax.getAngelJobs().then(function(response){response=
JSON.parse(response);data.jobsBlock.removeChild(loading);for(var i=0;i<response.jobs.length;i++)data.jobsBlock.appendChild(generateJob(response.jobs[i]))},function(error){console.log(error)})},initPlatform:function(){var examples=document.getElementsByClassName("example"),codes=null;function switchView(event){var target=event.target.getAttribute("data-target");if(!target)return;var content=this.nextElementSibling,tabs=this.children,blocks=content.children;for(var i=0;i<blocks.length;i++){blocks[i].classList.remove("active");
if(blocks[i].getAttribute("data-type")===target)blocks[i].classList.add("active")}for(var i=0;i<tabs.length;i++){tabs[i].classList.remove("active");if(tabs[i].getAttribute("data-target")===target)tabs[i].classList.add("active")}}function redraw(event){var el=this;el.style.transform="translateZ(0)";setTimeout(function(){el.style.transform="scale(1)"},0)}for(var i=0;i<examples.length;i++){examples[i].children[0].addEventListener("click",switchView,false);examples[i].children[0].children[0].classList.add("active");
examples[i].children[1].children[0].classList.add("active");codes=examples[i].children[1].getElementsByClassName("code-output");for(var k=0;k<codes.length;k++)codes[k].addEventListener("scroll",redraw,false)}},init:function(){this.data.windowHeight=f_clientHeight();this.data.windowWidth=f_clientWidth();this.data.menuBar=document.getElementsByClassName("nav")[0];if(document.getElementsByClassName("splash").length)if(webGLAvailable())window.MNDMPS.threeD.init();else this.appendSVGSplash();vanillaSmoothScroller.bind({selector:".scrollTrigger",
offset:function(){return window.MNDMPS.App.data.menuBar.offsetHeight}});if(document.getElementById("graql-slider")){this.initSlick();this.initHomepageGraphs();this.initPrism()}if(document.getElementById("section-jobs"))this.initJobs();if(document.getElementById("section-platform"))this.initStack();if(document.getElementsByClassName("splash").length)this.watchScroll();else this.data.menuBar.classList.add("white");if(document.getElementById("section-team"))atvImg();if(document.getElementsByClassName("modal-underlay").length)window.MNDMPS.modal.init();
if(document.getElementsByClassName("google-map")[0])google.maps.event.addDomListener(window,"load",window.MNDMPS.map.load);if(document.getElementById("section-platform-full")){this.initPlatform();this.initPrism();this.initPlatformGraphs()}var getMindmapsButton=document.getElementsByClassName("getMindmaps");if(getMindmapsButton.length)for(var i=0;i<getMindmapsButton.length;i++)getMindmapsButton[i].addEventListener("click",window.MNDMPS.modal.open,false)}};window.D3GRPH.init();window.MNDMPS.App.init();
