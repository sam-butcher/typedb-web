Options +MultiViews

ErrorDocument 404 /pages/404.html

RewriteEngine on
<FilesMatch "(error_log|php\.ini|index\.php\.swp)$">
  Order deny,allow
  Deny from all
</FilesMatch>

<FilesMatch ".(eot|ttf|otf|woff)">
    Header set Access-Control-Allow-Origin "*"
</FilesMatch>

# Redirect for grakn.ai/discuss
RewriteCond %{HTTP_HOST} ^grakn\.ai$ [OR]
RewriteCond %{HTTP_HOST} ^www\.grakn\.ai$
RewriteRule ^discuss$ "https://discuss.grakn.ai/" [R=301,L]

# Redirect www to non-www
RewriteCond %{HTTP_HOST} ^www\.grakn\.ai$
RewriteRule ^(.*)$ "https://grakn.ai/$1" [R=301,L]

# Redirect to https
RewriteCond %{HTTP_HOST} ^grakn\.ai [NC]
RewriteCond %{SERVER_PORT} 80
RewriteRule ^(.*)$  "https://grakn.ai/$1" [R=301,L]

# Canonicalisation
RewriteCond %{HTTP_HOST} ^grakn\.ai [NC]
RewriteRule ^index.html$  "https://grakn.ai/" [R=301,L]

# Redirect old api-reference links
RedirectMatch "^/pages/api-reference/(.*)" "/pages/documentation/api-reference/api-reference.html"

# Redirect for Mindmaps release archive
Redirect /download/latest "https://github.com/graknlabs/grakn/releases/download/v0.9.0/grakn-dist-0.9.0.zip"
Redirect /download "https://github.com/graknlabs/grakn/releases/"
Redirect /docs "/pages/index.html"
Redirect /install "/pages/documentation/get-started/setup-guide.html"

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.html [NC,L]
